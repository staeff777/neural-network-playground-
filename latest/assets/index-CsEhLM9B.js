(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();var Ht,it,Ce,At,le,Ae,We,Le,Kt,Ut,jt,Rt={},Re=[],Qe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Bt=Array.isArray;function Tt(e,t){for(var n in t)e[n]=t[n];return e}function Zt(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function tn(e,t,n){var i,o,r,c={};for(r in t)r=="key"?i=t[r]:r=="ref"?o=t[r]:c[r]=t[r];if(arguments.length>2&&(c.children=arguments.length>3?Ht.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)c[r]===void 0&&(c[r]=e.defaultProps[r]);return Et(e,c,i,o,null)}function Et(e,t,n,i,o){var r={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++Ce,__i:-1,__u:0};return o==null&&it.vnode!=null&&it.vnode(r),r}function Pt(e){return e.children}function Yt(e,t){this.props=e,this.context=t}function Lt(e,t){if(t==null)return e.__?Lt(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Lt(e):null}function ze(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return ze(e)}}function ce(e){(!e.__d&&(e.__d=!0)&&At.push(e)&&!Nt.__r++||le!=it.debounceRendering)&&((le=it.debounceRendering)||Ae)(Nt)}function Nt(){for(var e,t,n,i,o,r,c,h=1;At.length;)At.length>h&&At.sort(We),e=At.shift(),h=At.length,e.__d&&(n=void 0,i=void 0,o=(i=(t=e).__v).__e,r=[],c=[],t.__P&&((n=Tt({},i)).__v=i.__v+1,it.vnode&&it.vnode(n),Jt(t.__P,n,i,t.__n,t.__P.namespaceURI,32&i.__u?[o]:null,r,o??Lt(i),!!(32&i.__u),c),n.__v=i.__v,n.__.__k[n.__i]=n,Ee(r,n,c),i.__e=i.__=null,n.__e!=o&&ze(n)));Nt.__r=0}function De(e,t,n,i,o,r,c,h,g,u,a){var d,_,b,y,k,T,C,P=i&&i.__k||Re,z=t.length;for(g=en(n,t,P,g,z),d=0;d<z;d++)(b=n.__k[d])!=null&&(_=b.__i==-1?Rt:P[b.__i]||Rt,b.__i=d,T=Jt(e,b,_,o,r,c,h,g,u,a),y=b.__e,b.ref&&_.ref!=b.ref&&(_.ref&&Qt(_.ref,null,b),a.push(b.ref,b.__c||y,b)),k==null&&y!=null&&(k=y),(C=!!(4&b.__u))||_.__k===b.__k?g=$e(b,g,e,C):typeof b.type=="function"&&T!==void 0?g=T:y&&(g=y.nextSibling),b.__u&=-7);return n.__e=k,g}function en(e,t,n,i,o){var r,c,h,g,u,a=n.length,d=a,_=0;for(e.__k=new Array(o),r=0;r<o;r++)(c=t[r])!=null&&typeof c!="boolean"&&typeof c!="function"?(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?c=e.__k[r]=Et(null,c,null,null,null):Bt(c)?c=e.__k[r]=Et(Pt,{children:c},null,null,null):c.constructor==null&&c.__b>0?c=e.__k[r]=Et(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):e.__k[r]=c,g=r+_,c.__=e,c.__b=e.__b+1,h=null,(u=c.__i=nn(c,n,g,d))!=-1&&(d--,(h=n[u])&&(h.__u|=2)),h==null||h.__v==null?(u==-1&&(o>a?_--:o<a&&_++),typeof c.type!="function"&&(c.__u|=4)):u!=g&&(u==g-1?_--:u==g+1?_++:(u>g?_--:_++,c.__u|=4))):e.__k[r]=null;if(d)for(r=0;r<a;r++)(h=n[r])!=null&&(2&h.__u)==0&&(h.__e==i&&(i=Lt(h)),Ie(h,h));return i}function $e(e,t,n,i){var o,r;if(typeof e.type=="function"){for(o=e.__k,r=0;o&&r<o.length;r++)o[r]&&(o[r].__=e,t=$e(o[r],t,n,i));return t}e.__e!=t&&(i&&(t&&e.type&&!t.parentNode&&(t=Lt(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function nn(e,t,n,i){var o,r,c,h=e.key,g=e.type,u=t[n],a=u!=null&&(2&u.__u)==0;if(u===null&&h==null||a&&h==u.key&&g==u.type)return n;if(i>(a?1:0)){for(o=n-1,r=n+1;o>=0||r<t.length;)if((u=t[c=o>=0?o--:r++])!=null&&(2&u.__u)==0&&h==u.key&&g==u.type)return c}return-1}function he(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Qe.test(t)?n:n+"px"}function $t(e,t,n,i,o){var r,c;t:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||he(e.style,t,"");if(n)for(t in n)i&&n[t]==i[t]||he(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")r=t!=(t=t.replace(Le,"$1")),c=t.toLowerCase(),t=c in e||t=="onFocusOut"||t=="onFocusIn"?c.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?i?n.u=i.u:(n.u=Kt,e.addEventListener(t,r?jt:Ut,r)):e.removeEventListener(t,r?jt:Ut,r);else{if(o=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function de(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Kt++;else if(t.t<n.u)return;return n(it.event?it.event(t):t)}}}function Jt(e,t,n,i,o,r,c,h,g,u){var a,d,_,b,y,k,T,C,P,z,V,U,W,M,f,I,m,p=t.type;if(t.constructor!=null)return null;128&n.__u&&(g=!!(32&n.__u),r=[h=t.__e=n.__e]),(a=it.__b)&&a(t);t:if(typeof p=="function")try{if(C=t.props,P="prototype"in p&&p.prototype.render,z=(a=p.contextType)&&i[a.__c],V=a?z?z.props.value:a.__:i,n.__c?T=(d=t.__c=n.__c).__=d.__E:(P?t.__c=d=new p(C,V):(t.__c=d=new Yt(C,V),d.constructor=p,d.render=on),z&&z.sub(d),d.state||(d.state={}),d.__n=i,_=d.__d=!0,d.__h=[],d._sb=[]),P&&d.__s==null&&(d.__s=d.state),P&&p.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=Tt({},d.__s)),Tt(d.__s,p.getDerivedStateFromProps(C,d.__s))),b=d.props,y=d.state,d.__v=t,_)P&&p.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),P&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(P&&p.getDerivedStateFromProps==null&&C!==b&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(C,V),t.__v==n.__v||!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(C,d.__s,V)===!1){for(t.__v!=n.__v&&(d.props=C,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(v){v&&(v.__=t)}),U=0;U<d._sb.length;U++)d.__h.push(d._sb[U]);d._sb=[],d.__h.length&&c.push(d);break t}d.componentWillUpdate!=null&&d.componentWillUpdate(C,d.__s,V),P&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(b,y,k)})}if(d.context=V,d.props=C,d.__P=e,d.__e=!1,W=it.__r,M=0,P){for(d.state=d.__s,d.__d=!1,W&&W(t),a=d.render(d.props,d.state,d.context),f=0;f<d._sb.length;f++)d.__h.push(d._sb[f]);d._sb=[]}else do d.__d=!1,W&&W(t),a=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++M<25);d.state=d.__s,d.getChildContext!=null&&(i=Tt(Tt({},i),d.getChildContext())),P&&!_&&d.getSnapshotBeforeUpdate!=null&&(k=d.getSnapshotBeforeUpdate(b,y)),I=a,a!=null&&a.type===Pt&&a.key==null&&(I=Ye(a.props.children)),h=De(e,Bt(I)?I:[I],t,n,i,o,r,c,h,g,u),d.base=t.__e,t.__u&=-161,d.__h.length&&c.push(d),T&&(d.__E=d.__=null)}catch(v){if(t.__v=null,g||r!=null)if(v.then){for(t.__u|=g?160:128;h&&h.nodeType==8&&h.nextSibling;)h=h.nextSibling;r[r.indexOf(h)]=null,t.__e=h}else{for(m=r.length;m--;)Zt(r[m]);Ot(t)}else t.__e=n.__e,t.__k=n.__k,v.then||Ot(t);it.__e(v,t,n)}else r==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):h=t.__e=rn(n.__e,t,n,i,o,r,c,g,u);return(a=it.diffed)&&a(t),128&t.__u?void 0:h}function Ot(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Ot)}function Ee(e,t,n){for(var i=0;i<n.length;i++)Qt(n[i],n[++i],n[++i]);it.__c&&it.__c(t,e),e.some(function(o){try{e=o.__h,o.__h=[],e.some(function(r){r.call(o)})}catch(r){it.__e(r,o.__v)}})}function Ye(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Bt(e)?e.map(Ye):Tt({},e)}function rn(e,t,n,i,o,r,c,h,g){var u,a,d,_,b,y,k,T=n.props||Rt,C=t.props,P=t.type;if(P=="svg"?o="http://www.w3.org/2000/svg":P=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),r!=null){for(u=0;u<r.length;u++)if((b=r[u])&&"setAttribute"in b==!!P&&(P?b.localName==P:b.nodeType==3)){e=b,r[u]=null;break}}if(e==null){if(P==null)return document.createTextNode(C);e=document.createElementNS(o,P,C.is&&C),h&&(it.__m&&it.__m(t,r),h=!1),r=null}if(P==null)T===C||h&&e.data==C||(e.data=C);else{if(r=r&&Ht.call(e.childNodes),!h&&r!=null)for(T={},u=0;u<e.attributes.length;u++)T[(b=e.attributes[u]).name]=b.value;for(u in T)if(b=T[u],u!="children"){if(u=="dangerouslySetInnerHTML")d=b;else if(!(u in C)){if(u=="value"&&"defaultValue"in C||u=="checked"&&"defaultChecked"in C)continue;$t(e,u,null,b,o)}}for(u in C)b=C[u],u=="children"?_=b:u=="dangerouslySetInnerHTML"?a=b:u=="value"?y=b:u=="checked"?k=b:h&&typeof b!="function"||T[u]===b||$t(e,u,b,T[u],o);if(a)h||d&&(a.__html==d.__html||a.__html==e.innerHTML)||(e.innerHTML=a.__html),t.__k=[];else if(d&&(e.innerHTML=""),De(t.type=="template"?e.content:e,Bt(_)?_:[_],t,n,i,P=="foreignObject"?"http://www.w3.org/1999/xhtml":o,r,c,r?r[0]:n.__k&&Lt(n,0),h,g),r!=null)for(u=r.length;u--;)Zt(r[u]);h||(u="value",P=="progress"&&y==null?e.removeAttribute("value"):y!=null&&(y!==e[u]||P=="progress"&&!y||P=="option"&&y!=T[u])&&$t(e,u,y,T[u],o),u="checked",k!=null&&k!=e[u]&&$t(e,u,k,T[u],o))}return e}function Qt(e,t,n){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&t==null||(e.__u=e(t))}else e.current=t}catch(o){it.__e(o,n)}}function Ie(e,t,n){var i,o;if(it.unmount&&it.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||Qt(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){it.__e(r,t)}i.base=i.__P=null}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&Ie(i[o],t,n||typeof e.type!="function");n||Zt(e.__e),e.__c=e.__=e.__e=void 0}function on(e,t,n){return this.constructor(e,n)}function sn(e,t,n){var i,o,r,c;t==document&&(t=document.documentElement),it.__&&it.__(e,t),o=(i=!1)?null:t.__k,r=[],c=[],Jt(t,e=t.__k=tn(Pt,null,[e]),o||Rt,Rt,t.namespaceURI,o?null:t.firstChild?Ht.call(t.childNodes):null,r,o?o.__e:t.firstChild,i,c),Ee(r,e,c)}Ht=Re.slice,it={__e:function(e,t,n,i){for(var o,r,c;t=t.__;)if((o=t.__c)&&!o.__)try{if((r=o.constructor)&&r.getDerivedStateFromError!=null&&(o.setState(r.getDerivedStateFromError(e)),c=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,i||{}),c=o.__d),c)return o.__E=o}catch(h){e=h}throw e}},Ce=0,Yt.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Tt({},this.state),typeof e=="function"&&(e=e(Tt({},n),this.props)),e&&Tt(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),ce(this))},Yt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ce(this))},Yt.prototype.render=Pt,At=[],Ae=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,We=function(e,t){return e.__v.__b-t.__v.__b},Nt.__r=0,Le=/(PointerCapture)$|Capture$/i,Kt=0,Ut=de(!1),jt=de(!0);var an=0;function l(e,t,n,i,o,r){t||(t={});var c,h,g=t;if("ref"in g)for(h in g={},t)h=="ref"?c=t[h]:g[h]=t[h];var u={type:e,props:g,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--an,__i:-1,__u:0,__source:o,__self:r};if(typeof e=="function"&&(c=e.defaultProps))for(h in c)g[h]===void 0&&(g[h]=c[h]);return it.vnode&&it.vnode(u),u}var zt,at,Xt,ue,Vt=0,Ne=[],dt=it,fe=dt.__b,pe=dt.__r,ge=dt.diffed,me=dt.__c,xe=dt.unmount,_e=dt.__;function te(e,t){dt.__h&&dt.__h(at,e,Vt||t),Vt=0;var n=at.__H||(at.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function rt(e){return Vt=1,ln(Fe,e)}function ln(e,t,n){var i=te(zt++,2);if(i.t=e,!i.__c&&(i.__=[Fe(void 0,t),function(h){var g=i.__N?i.__N[0]:i.__[0],u=i.t(g,h);g!==u&&(i.__N=[u,i.__[1]],i.__c.setState({}))}],i.__c=at,!at.__f)){var o=function(h,g,u){if(!i.__c.__H)return!0;var a=i.__c.__H.__.filter(function(_){return!!_.__c});if(a.every(function(_){return!_.__N}))return!r||r.call(this,h,g,u);var d=i.__c.props!==h;return a.forEach(function(_){if(_.__N){var b=_.__[0];_.__=_.__N,_.__N=void 0,b!==_.__[0]&&(d=!0)}}),r&&r.call(this,h,g,u)||d};at.__f=!0;var r=at.shouldComponentUpdate,c=at.componentWillUpdate;at.componentWillUpdate=function(h,g,u){if(this.__e){var a=r;r=void 0,o(h,g,u),r=a}c&&c.call(this,h,g,u)},at.shouldComponentUpdate=o}return i.__N||i.__}function St(e,t){var n=te(zt++,3);!dt.__s&&Ve(n.__H,t)&&(n.__=e,n.u=t,at.__H.__h.push(n))}function xt(e){return Vt=5,cn(function(){return{current:e}},[])}function cn(e,t){var n=te(zt++,7);return Ve(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function hn(){for(var e;e=Ne.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(It),e.__H.__h.forEach(qt),e.__H.__h=[]}catch(t){e.__H.__h=[],dt.__e(t,e.__v)}}dt.__b=function(e){at=null,fe&&fe(e)},dt.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),_e&&_e(e,t)},dt.__r=function(e){pe&&pe(e),zt=0;var t=(at=e.__c).__H;t&&(Xt===at?(t.__h=[],at.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(It),t.__h.forEach(qt),t.__h=[],zt=0)),Xt=at},dt.diffed=function(e){ge&&ge(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ne.push(t)!==1&&ue===dt.requestAnimationFrame||((ue=dt.requestAnimationFrame)||dn)(hn)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Xt=at=null},dt.__c=function(e,t){t.some(function(n){try{n.__h.forEach(It),n.__h=n.__h.filter(function(i){return!i.__||qt(i)})}catch(i){t.some(function(o){o.__h&&(o.__h=[])}),t=[],dt.__e(i,n.__v)}}),me&&me(e,t)},dt.unmount=function(e){xe&&xe(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{It(i)}catch(o){t=o}}),n.__H=void 0,t&&dt.__e(t,n.__v))};var ye=typeof requestAnimationFrame=="function";function dn(e){var t,n=function(){clearTimeout(i),ye&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,35);ye&&(t=requestAnimationFrame(n))}function It(e){var t=at,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),at=t}function qt(e){var t=at;e.__c=e.__(),at=t}function Ve(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function Fe(e,t){return typeof t=="function"?t(e):t}function un(e){return function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}class fn{constructor(t){this.model=t}train(t,n,i){if(i!==void 0)return this.trainLegacy(t,n,i);const o=n,r=[];let c=1/0,h={};const g=a=>{const d=[];if(a.step<=0)return[a.min];for(let _=a.min;_<=a.max+1e-4;_+=a.step)d.push(parseFloat(_.toFixed(2)));return d},u=(a,d)=>{if(console.log({paramIndex:a,currentParams:d}),a===o.length){const y=[];let k=0;d.forEach((W,M)=>{o[M].name.toLowerCase().includes("bias")?k=W:y.push(W)}),this.model.setWeights?this.model.setWeights(y):this.model.setWeight&&this.model.setWeight(y[0]),this.model.setBias(k);let T=0,C=0;for(const W of t){const M=this.model.predict(W.input),f=W.target-M;T+=f*f,C+=Math.abs(f)}const P=T/t.length,z=C/t.length;let V=0;for(const W of t)(this.model.predict(W.input)>=.5?1:0)===W.target&&V++;const U=V/t.length;P<c&&(c=P,h={weights:[...y],bias:k}),r.push({params:[...d],error:P,mae:z,accuracy:U});return}const _=o[a],b=g(_);for(const y of b)d[a]=y,u(a+1,d)};return u(0,new Array(o.length)),{bestParams:h,history:r,minError:c}}trainLegacy(t,n,i){const o=[];let r=n.min,c=i.min,h=1/0;for(let g=n.min;g<=n.max;g+=n.step)for(let u=i.min;u<=i.max;u+=i.step){const a=parseFloat(g.toFixed(2)),d=parseFloat(u.toFixed(2));this.model.setWeight(a),this.model.setBias(d);let _=0,b=0;for(const P of t){const z=this.model.predict(P.input),V=P.target-z;_+=V*V,b+=Math.abs(V)}const y=_/t.length,k=b/t.length;let T=0;for(const P of t)(this.model.predict(P.input)>=.5?1:0)===P.target&&T++;const C=T/t.length;y<h&&(h=y,r=a,c=d),o.push({weight:a,bias:d,error:y,mae:k,accuracy:C})}return{bestWeight:r,bestBias:c,history:o}}async trainAsync(t,n,i){if(!Array.isArray(n)){const b=arguments[1],y=arguments[2],k=arguments[3];let T=b.min,C=y.min,P=1/0,z=[];const V=20;let U=0;for(let W=b.min;W<=b.max;W+=b.step)for(let M=y.min;M<=y.max;M+=y.step){const f=parseFloat(W.toFixed(2)),I=parseFloat(M.toFixed(2));this.model.setWeight(f),this.model.setBias(I);let m=0,p=0;for(const D of t){const B=this.model.predict(D.input),E=D.target-B;m+=E*E,p+=Math.abs(E)}const v=m/t.length,x=p/t.length;let A=0;for(const D of t)(this.model.predict(D.input)>=.5?1:0)===D.target&&A++;const L=A/t.length;v<P&&(P=v,T=f,C=I);const j={weight:f,bias:I,error:v,mae:x,accuracy:L};z.push(j),U++,U%V===0&&(k&&k(z,{bestWeight:T,bestBias:C,minError:P}),z=[],await new Promise(D=>setTimeout(D,0)))}return z.length>0&&k&&k(z,{bestWeight:T,bestBias:C,minError:P}),{bestWeight:T,bestBias:C,minError:P}}let r=1/0,c={},h=0;const g=50;let u=[];const a=b=>{const y=[];if(b.step<=0)return[b.min];for(let k=b.min;k<=b.max+1e-4;k+=b.step)y.push(parseFloat(k.toFixed(2)));return y},d=n.map(a),_=async(b,y)=>{if(b===n.length){const T=[];let C=0;y.forEach((m,p)=>{n[p].name.toLowerCase().includes("bias")?C=m:T.push(m)});let P={};this.model.setParams?(y.forEach((m,p)=>{P[n[p].name]=m}),this.model.setParams(P),C===void 0&&(C=0)):(this.model.setWeights?this.model.setWeights(T):this.model.setWeight&&this.model.setWeight(T[0]),this.model.setBias(C),P={weights:[...T],bias:C});let z=0,V=0;for(const m of t){const p=this.model.predict(m.input),v=m.target-p;z+=v*v,V+=Math.abs(v)}const U=z/t.length,W=V/t.length;let M=0;for(const m of t)(this.model.predict(m.input)>=.5?1:0)===m.target&&M++;const f=M/t.length;U<r&&(r=U,c=P);const I={params:[...y],error:U,mae:W,accuracy:f};u.push(I),h++,h%g===0&&(i&&i(u,{bestParams:c,minError:r}),u=[],await new Promise(m=>setTimeout(m,0)));return}const k=d[b];for(const T of k)y[b]=T,await _(b+1,y)};return await _(0,new Array(n.length)),u.length>0&&i&&i(u,{bestParams:c,minError:r}),{bestParams:c,minError:r}}async trainRandomAsync(t,n,i,o={}){const{patience:r=5e3,seed:c,maxSteps:h=1e4,initialRadius:g=.8,phase1Ratio:u=.8}=o,a=h,d=g,_=.999,b=u;let y=1/0,k={},T=c;T==null?(T=Math.floor(Math.random()*2147483647),console.log(`[AdaptiveRandom] Generated Seed: ${T}`)):console.log(`[AdaptiveRandom] Using Seed: ${T}`);const C=un(T);let P=n.map(p=>({min:p.min,max:p.max,span:p.max-p.min})),z=P.map(p=>p.min+C()*p.span);const V=p=>{const v=[];let x=0;p.forEach((E,N)=>{n[N].name.toLowerCase().includes("bias")?x=E:v.push(E)});let A={};this.model.setParams?(p.forEach((E,N)=>{A[n[N].name]=E}),this.model.setParams(A)):(this.model.setWeights?this.model.setWeights(v):this.model.setWeight&&this.model.setWeight(v[0]),this.model.setBias(x),A={weights:v,bias:x});let L=0,j=0;for(const E of t){const N=this.model.predict(E.input),w=E.target-N;L+=w*w,j+=Math.abs(w)}let D=0;for(const E of t)(this.model.predict(E.input)>=.5?1:0)===E.target&&D++;const B=D/t.length;return{mse:L/t.length,mae:j/t.length,accuracy:B,decodedParams:A,weights:v,bias:x}};let U=V(z);y=U.mse,k=U.decodedParams?{...U.decodedParams,_array:[...z]}:{weights:U.weights,bias:U.bias,_array:[...z]},i&&i([{params:[...z],error:y,mae:U.mae,accuracy:U.accuracy}],{bestParams:k,minError:y}),await new Promise(p=>setTimeout(p,0));let W=[];const M=10;let f=y,I=[...z],m=0;for(let p=0;p<a;p++){const v=p<a*b;let x;if(v){const N=p/(a*b);x=d*(1-N*.5)}else x=d*.5*Math.pow(_,p-a*b);let A=!1;const L=[...I];let j=!1;for(;!j;)L.forEach((N,w)=>{if(C()<.4)return;j=!0;const s=P[w];let K=!1;if(v){const _t=s.span*.3,$=k._array&&Math.abs(N-k._array[w])<1e-9;$&&N<s.min+_t&&(s.min-=s.span*.4,s.span=s.max-s.min,K=!0),$&&N>s.max-_t&&(s.max+=s.span*.4,s.span=s.max-s.min,K=!0),K&&(A=!0)}let q=s.span*x;K&&(q=Math.max(q,s.span*.25));const lt=q;let ct=N+(C()-.5)*2*lt;ct<s.min&&(ct=s.min),ct>s.max&&(ct=s.max),L[w]=ct});const D=V(L),B=D.mse-f;let E=!1;if(B<0&&(E=!0),E&&(I=L,f=D.mse),D.mse<y?(y=D.mse,k=D.decodedParams?{...D.decodedParams,_array:[...L]}:{weights:D.weights,bias:D.bias,_array:[...L]},m=0):m++,m>=r&&!v)break;if(W.push({params:[...L],error:D.mse,mae:D.mae,accuracy:D.accuracy}),W.length>=M){let N;A&&(N="Grenzen dynamisch erweitert..."),i&&i(W,{bestParams:k,minError:y,message:N}),W=[],await new Promise(w=>setTimeout(w,0))}}return W.length>0&&i&&i(W,{bestParams:k,minError:y}),{bestParams:k,minError:y}}}class pn{constructor(t=30,n=50){this.velocity=t,this.initialPosition=n}getPosition(t){return this.velocity*t+this.initialPosition}}class gn{constructor(){this.weight=0,this.bias=0}predict(t){return this.weight*t+this.bias}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function mn({time:e,groundTruth:t,neuralNet:n,maxDistance:i=300}){const o=xt(null);St(()=>{const c=o.current;if(!c)return;const h=c.getContext("2d"),g=c.width,u=c.height,a=50,d=g-2*a;h.clearRect(0,0,g,u);const _=t.getPosition(e),b=n.predict(e),y=a+_%i/i*d,k=a+b%i/i*d;h.fillStyle="#f0f0f0",h.fillRect(0,0,g,u/2),h.fillStyle="#e0e0e0",h.fillRect(0,u/2,g,u/2),h.beginPath(),h.strokeStyle="#fff",h.setLineDash([20,20]),h.moveTo(0,u/4),h.lineTo(g,u/4),h.moveTo(0,u*3/4),h.lineTo(g,u*3/4),h.stroke(),h.beginPath(),h.strokeStyle="#ccc",h.setLineDash([]),h.moveTo(a,0),h.lineTo(a,u),h.moveTo(g-a,0),h.lineTo(g-a,u),h.stroke(),r(h,y,u/4,"#2ecc71","Ground Truth"),r(h,k,u*3/4,"#e74c3c","Neural Net"),h.fillStyle="#333",h.font="14px monospace",h.fillText(`Zeit: ${e.toFixed(1)}s`,10,20),h.fillText(`Pos GT: ${_.toFixed(1)}m`,10,40),h.fillText(`Pos NN: ${b.toFixed(1)}m`,10,u/2+40)},[e,t,n,i]);function r(c,h,g,u,a){c.save(),c.translate(h,g),c.fillStyle=u,c.fillRect(-20,-10,40,20),c.fillStyle="#000",c.fillRect(-15,-15,10,5),c.fillRect(5,-15,10,5),c.fillRect(-15,10,10,5),c.fillRect(5,10,10,5),c.fillStyle="#000",c.font="10px sans-serif",c.textAlign="center",c.fillText(a,0,-20),c.restore()}return l("div",{style:{border:"2px solid #333",borderRadius:"8px",overflow:"hidden"},children:l("canvas",{ref:o,width:800,height:300,style:{width:"100%",display:"block"}})})}const be={id:"physics",title:"Phase 1: Lineare Regression (Exhaustive Search 2D)",description:"Physiksimulation: Weg-Zeit-Gesetz (s = v*t + s0)",Model:gn,GroundTruth:pn,CanvasComponent:mn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[30,50],getInput:e=>e,generateData:e=>Array.from({length:20},(n,i)=>i*.5).map(n=>({input:n,target:e.getPosition(n)})),trainingConfig:{maxSteps:2e3,params:[{name:"weight",min:0,max:60,step:1},{name:"bias",min:0,max:100,step:2}]},networkViz:{formula:"pos = w * t + b",inputLabel:"Zeit (t)",outputLabel:"Pos (m)",biasLabel:"b"}};class xn{constructor(t=.5,n=-5){this.weight=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){const n=this.sigmoid(this.weight*t+this.bias);return Math.random()<n?1:0}getProbability(t){return this.sigmoid(this.weight*t+this.bias)}}class _n{constructor(){this.weight=0,this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=this.weight*t+this.bias;return this.sigmoid(n)}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function Ft(e,t,n=10){if(e===t)return[e];const i=we(t-e,!1),o=we(i/(n-1),!0),r=Math.floor(e/o)*o,c=Math.ceil(t/o)*o,h=[],g=o/1e3;for(let u=r;u<c+o/2;u+=o)u>=e-g&&u<=t+g&&h.push(Number(u.toPrecision(12)));return h}function we(e,t){const n=Math.floor(Math.log10(e)),i=e/Math.pow(10,n);let o;return t?i<1.5?o=1:i<3?o=2:i<7?o=5:o=10:i<=1?o=1:i<=2?o=2:i<=5?o=5:o=10,o*Math.pow(10,n)}function yn({time:e,groundTruth:t,neuralNet:n,data:i,staticMode:o=!1,showModel:r=!0,showGroundTruth:c=!0}){const h=xt(null),[g,u]=rt({k:1,x:0,y:0}),[a,d]=rt(!1),_=xt({x:0,y:0}),[b,y]=rt(null),k=xt([]),T=M=>{M.preventDefault();const I=-M.deltaY*.001,m=g.k;let p=m*(1+I);p=Math.max(.5,Math.min(p,10));const v=h.current.getBoundingClientRect(),x=h.current.width/v.width,A=h.current.height/v.height,L=(M.clientX-v.left)*x,j=(M.clientY-v.top)*A,D=40,B=(L-D-g.x)/m,E=(j-(300-D)-g.y)/m,N=L-D-B*p,w=j-(300-D)-E*p;u({k:p,x:N,y:w})},C=M=>{d(!0),_.current={x:M.clientX,y:M.clientY}},P=M=>{const f=h.current;if(!f)return;const I=f.getBoundingClientRect(),m=f.width/I.width,p=f.height/I.height;if(a){const v=(M.clientX-_.current.x)*m,x=(M.clientY-_.current.y)*p;_.current={x:M.clientX,y:M.clientY},u(A=>({...A,x:A.x+v,y:A.y+x})),y(null)}else{const v=(M.clientX-I.left)*m,x=(M.clientY-I.top)*p;let A=null,L=15;const j=k.current;for(let D=j.length-1;D>=0;D--){const B=j[D],E=Math.sqrt(Math.pow(B.x-v,2)+Math.pow(B.y-x,2));E<L&&(L=E,A=B.info)}y(A)}},z=()=>d(!1),V=()=>{d(!1),y(null)},U=xt(0),W=()=>{const M=Date.now();M-U.current<300&&y(null),U.current=M};return St(()=>{const M=h.current;if(!M)return;const f=M.getContext("2d"),I=M.width,m=M.height;f.clearRect(0,0,I,m),k.current=[];const p=40,v=I-2*p,x=m-2*p,A=0,L=20,j=1,D=$=>p+$/L*v*g.k+g.x,B=$=>m-p-$/j*x*g.k+g.y,E=$=>($-p-g.x)/(v*g.k)*L,N=$=>-(($-(m-p)-g.y)/(x*g.k))*j,w=E(p),s=E(I-p),K=N(m-p),q=N(p),lt=Ft(w,s,10),ct=Ft(K,q,5);f.beginPath(),f.strokeStyle="#eee",f.lineWidth=1,f.fillStyle="#333",f.textAlign="center",f.textBaseline="top",f.font="10px sans-serif",lt.forEach($=>{const G=D($);G<p||G>I-p||(f.moveTo(G,p),f.lineTo(G,m-p),f.fillText(Number($.toFixed(2)),G,m-p+5))}),f.textAlign="right",f.textBaseline="middle",ct.forEach($=>{const G=B($);G<p||G>m-p||(f.moveTo(p,G),f.lineTo(I-p,G),f.fillText(Number($.toFixed(2)),p-5,G))}),f.stroke(),f.beginPath(),f.strokeStyle="#333",f.lineWidth=1,f.rect(p,p,v,x),f.stroke(),f.fillStyle="#333",f.textAlign="center",f.textBaseline="alphabetic",f.fillText("Anzahl 'Spam' Wörter",I/2,m-10),f.save(),f.translate(15,m/2),f.rotate(-Math.PI/2),f.textAlign="center",f.fillText("Spam Wahrscheinlichkeit",0,0),f.restore(),f.save(),f.beginPath(),f.rect(p,p,v,x),f.clip();const _t=($,G,Y=[])=>{f.beginPath(),f.strokeStyle=G,f.setLineDash(Y),f.lineWidth=2;const X=Math.max(A,w),R=Math.min(L,s);if(R<X)return;const S=(R-X)/100,F=Math.max(S,.05);let J=!1;for(let Z=X;Z<=R+F;Z+=F){const et=Math.min(Math.max(Z,A),L);let gt=0;typeof $.getProbability=="function"?gt=$.getProbability(et):typeof $.predict=="function"&&(gt=$.predict(et));const ft=D(et),ot=B(gt);J?f.lineTo(ft,ot):(f.moveTo(ft,ot),J=!0)}f.stroke(),f.setLineDash([])};if(c&&t&&_t(t,"#ccc",[5,5]),r&&n&&_t(n,"#e74c3c"),o&&i)i.forEach($=>{if($.input<w-5||$.input>s+5)return;const G=D($.input),Y=B($.target);k.current.push({x:G,y:Y,info:{x:G,y:Y,input:$.input,target:$.target}});let X=null;if(n&&r)try{X=n.predict($.input)>.5?"#e74c3c":"#2ecc71"}catch{}const R=Math.sin($.input*123)*5,S=Math.cos($.input*321)*5;X&&(f.beginPath(),f.arc(G+R,Y+S,8,0,Math.PI*2),f.strokeStyle=X,f.lineWidth=2,f.stroke()),f.beginPath(),f.arc(G+R,Y+S,5,0,Math.PI*2),f.fillStyle=$.target===1?"#e74c3c":"#2ecc71",f.fill(),f.strokeStyle="#fff",f.lineWidth=1,f.stroke()});else if(!o){const G=Math.floor(e*2),Y=50,X=S=>{const F=Math.sin(S*123.456)*1e4;return F-Math.floor(F)},R=Math.min(G,Y);for(let S=0;S<R;S++){const F=X(S+1),J=Math.floor(F*21),Z=t?t.getProbability(J):0,et=X(S+999)<Z?1:0;if(J<w-5||J>s+5)continue;const gt=D(J),ft=B(et);let ot=null;if(n&&r)try{ot=n.predict(J)>.5?"#e74c3c":"#2ecc71"}catch{}const pt=(X(S+333)-.5)*10,wt=(X(S+444)-.5)*10,H=gt+pt,ut=ft+wt;k.current.push({x:H,y:ut,info:{x:H,y:ut,input:J,target:et}}),ot&&(f.beginPath(),f.arc(H,ut,8,0,Math.PI*2),f.strokeStyle=ot,f.lineWidth=2,f.stroke()),f.beginPath(),f.arc(H,ut,5,0,Math.PI*2),f.fillStyle=et?"#e74c3c":"#2ecc71",f.fill(),f.strokeStyle="#fff",f.lineWidth=1,f.stroke()}if(R>0&&R<=Y){const S=R-1,F=X(S+1),J=Math.floor(F*21),Z=t.getProbability(J),et=X(S+999)<Z?1:0,gt=(X(S+333)-.5)*10,ft=(X(S+444)-.5)*10,ot=D(J)+gt,pt=B(et)+ft;ot>p&&ot<I-p&&pt>p&&pt<m-p&&(f.beginPath(),f.arc(ot,pt,8,0,Math.PI*2),f.strokeStyle="#333",f.stroke(),f.fillStyle="#333",f.font="10px sans-serif",f.fillText(`${J}`,ot,pt-12))}}if(f.restore(),b){f.save(),f.fillStyle="rgba(0,0,0,0.8)",f.strokeStyle="#fff";const $=b.target===1?"SPAM":"HAM",G=`Words: ${b.input}`,Y=100,X=40;let R=b.x+10,S=b.y-10;R+Y>I&&(R=b.x-Y-10),S+X>m&&(S=b.y-X-10),S<0&&(S=b.y+10),f.beginPath(),f.roundRect(R,S,Y,X,4),f.fill(),f.lineWidth=1,f.stroke(),f.textBaseline="top",f.textAlign="left",f.font="bold 11px sans-serif",f.fillStyle=b.target===1?"#e74c3c":"#2ecc71",f.fillText($,R+8,S+6),f.fillStyle="#ddd",f.font="10px sans-serif",f.fillText(G,R+8,S+20),f.restore()}},[e,t,n,i,o,r,c,g,b]),l("div",{className:"canvas-container",children:l("canvas",{ref:h,width:600,height:300,style:{width:"100%",border:"1px solid #ccc",background:"#fff",cursor:b?"pointer":a?"grabbing":"grab"},onWheel:T,onMouseDown:C,onMouseMove:P,onMouseUp:z,onMouseLeave:V,onClick:W})})}const bn=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},ve={id:"spam",title:"Phase 2: Logistische Regression (Spam Filter)",description:"Spam-Erkennung: Wahrscheinlichkeit p = σ(w*x + b)",Model:_n,GroundTruth:xn,CanvasComponent:yn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[.5,-5],getInput:e=>{const t=Math.floor(e);return Math.floor(bn(t)*20)},generateData:e=>{const t=[];for(let n=0;n<50;n++){const i=Math.floor(Math.random()*21),o=e.classify(i);t.push({input:i,target:o})}return t.sort((n,i)=>n.input-i.input)},trainingConfig:{maxSteps:3e3,params:[{name:"weight",min:0,max:2,step:.1},{name:"bias",min:-10,max:5,step:.5}]},networkViz:{formula:"p = σ(w * x + b)",inputLabel:"Wörter (x)",outputLabel:"Spam? (p)",biasLabel:"b"},isFinished:e=>e>=25};class ee{constructor(t=[.5,.2,.8,-.1],n=-3){this.weights=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){let n=this.bias;for(let o=0;o<this.weights.length;o++)n+=this.weights[o]*t[o];const i=this.sigmoid(n);return Math.random()<i?1:0}getProbability(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}}class He{constructor(t=4){this.weights=new Array(t).fill(0),this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}setWeights(t){this.weights=[...t]}setBias(t){this.bias=t}setWeightAt(t,n){t>=0&&t<this.weights.length&&(this.weights[t]=n)}}const wn=[{label:"Spam Words",idx:0,max:15},{label:"Großbuchstaben",idx:1,max:25},{label:"Links",idx:2,max:8},{label:"Gesamtworte",idx:3,max:100}];function ne({data:e,currentInput:t,currentPrediction:n,neuralNet:i,allowedModes:o=["features","scatter","3d","text"],hideControls:r=!1,showModel:c=!0,additionalControls:h=null,features:g=wn}){const u=xt(null),[a,d]=rt(o[0]);St(()=>{o.includes(a)||d(o[0])},[o]);const[_,b]=rt(0),[y,k]=rt(g.length===2?1:3),[T,C]=rt(2),[P,z]=rt(!1),[V,U]=rt({x:-.5,y:.5}),[W,M]=rt({k:1,x:0,y:0}),f=xt(!1),I=xt({x:0,y:0}),[m,p]=rt(null),v=xt([]),x=w=>{if(a!=="scatter")return;w.preventDefault();const K=-w.deltaY*.001,q=W.k;let lt=q*(1+K);lt=Math.max(.5,Math.min(lt,50));const ct=u.current;if(!ct)return;const _t=ct.getBoundingClientRect(),$=ct.width/_t.width,G=ct.height/_t.height,Y=(w.clientX-_t.left)*$,X=(w.clientY-_t.top)*G,R=50,S=ct.height-R,F=(Y-R-W.x)/q,J=(S+W.y-X)/q,Z=Y-R-F*lt,et=X-S+J*lt;M({k:lt,x:Z,y:et})},A=w=>{a!=="3d"&&a!=="scatter"||(f.current=!0,I.current={x:w.clientX,y:w.clientY})},L=w=>{const s=u.current;if(!s)return;const K=s.getBoundingClientRect(),q=s.width/K.width,lt=s.height/K.height;if(f.current){const R=(w.clientX-I.current.x)*q,S=(w.clientY-I.current.y)*lt;I.current={x:w.clientX,y:w.clientY},a==="3d"?U(F=>({x:F.x+S*.01,y:F.y+R*.01})):a==="scatter"&&M(F=>({...F,x:F.x+R,y:F.y+S}));return}const ct=(w.clientX-K.left)*q,_t=(w.clientY-K.top)*lt;let $=null,Y=15;const X=v.current;for(let R=X.length-1;R>=0;R--){const S=X[R],F=Math.sqrt((S.x-ct)**2+(S.y-_t)**2);F<Y&&(Y=F,$=S.info)}p($)},j=()=>{f.current=!1},D=()=>{p(null),f.current=!1},B=xt(0),E=()=>{const w=Date.now();w-B.current<300&&p(null),B.current=w};St(()=>{const w=u.current;if(!w)return;const s=w.getContext("2d"),K=w.width,q=w.height;s.clearRect(0,0,K,q),s.fillStyle="#fff",s.fillRect(0,0,K,q),v.current=[];const lt=$=>{if(!e||e.length===0)return g[$].max;const G=Math.max(...e.map(Y=>Y.input[$]));return G>0?G:g[$].max},ct=$=>$===2?"#3498db":$===1?"#e74c3c":"#2ecc71",_t=$=>$===3?"CLASS 3":$===1?"SPAM":"HAM";if(a==="3d"){const $=lt(_),G=lt(y),Y=lt(T),X=K/2,R=q/2,S=150,F=(H,ut,yt)=>{let Mt=H*Math.cos(V.y)-yt*Math.sin(V.y),O=H*Math.sin(V.y)+yt*Math.cos(V.y),Q=ut*Math.cos(V.x)-O*Math.sin(V.x),st=ut*Math.sin(V.x)+O*Math.cos(V.x);const tt=400/(400-st);return{x:X+Mt*tt,y:R+Q*tt,z:st}},Z=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]].map(H=>F(H[0]*S,H[1]*S,H[2]*S)),et="#e29301ff",gt="#2980b9",ft="#c00798ff",ot=(H,ut)=>{s.beginPath(),s.strokeStyle=ut,s.lineWidth=1,H.forEach(([yt,Mt])=>{s.moveTo(Z[yt].x,Z[yt].y),s.lineTo(Z[Mt].x,Z[Mt].y)}),s.stroke()};ot([[0,1],[3,2],[4,5],[7,6]],et),ot([[0,3],[1,2],[4,7],[5,6]],gt),ot([[0,4],[1,5],[2,6],[3,7]],ft),s.font="bold 11px sans-serif",s.fillStyle=et,s.fillText("X: "+g[_].label,Z[1].x,Z[1].y),s.fillStyle=gt,s.fillText("Y: "+g[y].label,Z[3].x,Z[3].y),s.fillStyle=ft,s.fillText("Z: "+g[T].label,Z[4].x,Z[4].y);const pt=[],wt=(H,ut)=>H/ut*2-1;if(c&&i&&i.weights){const H=i.weights[_]||0,ut=i.weights[y]||0,yt=i.weights[T]||0,Mt=i.bias||0;if(Math.abs(yt)>.001){s.strokeStyle="rgba(142, 68, 173, 0.3)",s.lineWidth=1;const O=(tt,nt)=>{const mt=(tt+1)/2*$,ht=(nt+1)/2*G,vt=(-H*mt-ut*ht-Mt)/yt;return wt(vt,Y)},Q=(tt,nt)=>{if(Math.abs(tt.z)<=3&&Math.abs(nt.z)<=3){const mt=F(tt.x*S,-tt.y*S,tt.z*S),ht=F(nt.x*S,-nt.y*S,nt.z*S);s.beginPath(),s.moveTo(mt.x,mt.y),s.lineTo(ht.x,ht.y),s.stroke()}},st=6;for(let tt=0;tt<=st;tt++){const nt=-1+tt/st*2,mt=O(-1,nt),ht=O(1,nt);Q({x:-1,y:nt,z:mt},{x:1,y:nt,z:ht})}for(let tt=0;tt<=st;tt++){const nt=-1+tt/st*2,mt=O(nt,-1),ht=O(nt,1);Q({x:nt,y:-1,z:mt},{x:nt,y:1,z:ht})}}}e&&e.forEach(H=>{const ut=wt(H.input[_],$),yt=-wt(H.input[y],G),Mt=wt(H.input[T],Y),O=F(ut*S,yt*S,Mt*S);let Q=null;if(i&&c)try{Q=i.predict(H.input)>.5?"#e74c3c":"#2ecc71"}catch{}pt.push({...O,color:ct(H.target),radius:3,haloColor:Q,pt:H})}),pt.sort((H,ut)=>H.z-ut.z),pt.forEach(H=>{H.z<3&&v.current.push({x:H.x,y:H.y,info:{x:H.x,y:H.y,text:H.pt.text,target:H.pt.target,isSpam:H.pt.target===1,features:{xLabel:g[_].label,xVal:H.pt.input[_],yLabel:g[y].label,yVal:H.pt.input[y],zLabel:g[T].label,zVal:H.pt.input[T]}}}),H.haloColor&&(s.beginPath(),s.arc(H.x,H.y,H.radius+2,0,Math.PI*2),s.strokeStyle=H.haloColor,s.lineWidth=1.5,s.stroke()),s.beginPath(),s.arc(H.x,H.y,H.radius,0,Math.PI*2),s.fillStyle=H.color,s.fill()})}if(a==="scatter"){const $=lt(_),G=lt(y),Y=50,X=K-2*Y,R=q-2*Y,S=q-Y,F="#c0392b",J="#2980b9",Z=O=>Y+O/$*X*W.k+W.x,et=O=>S-O/G*R*W.k+W.y;s.save(),s.beginPath(),s.rect(Y,Y,X,R),s.clip(),s.restore();const gt=O=>(O-Y-W.x)/(X*W.k)*$,ft=O=>(S+W.y-O)/(R*W.k)*G,ot=gt(Y),pt=gt(Y+X),wt=ft(S),H=ft(Y),ut=Ft(Math.min(ot,pt),Math.max(ot,pt),8),yt=Ft(Math.min(wt,H),Math.max(wt,H),6);if(s.lineWidth=1,s.strokeStyle="#eee",s.fillStyle="#666",s.font="10px sans-serif",s.textAlign="center",s.textBaseline="top",ut.forEach(O=>{const Q=Z(O);Q<Y||Q>Y+X||(s.beginPath(),s.moveTo(Q,Y),s.lineTo(Q,S),s.stroke(),s.fillText(Number(O.toFixed(2)),Q,S+5))}),s.textAlign="right",s.textBaseline="middle",yt.forEach(O=>{const Q=et(O);Q<Y||Q>S||(s.beginPath(),s.moveTo(Y,Q),s.lineTo(Y+X,Q),s.stroke(),s.fillText(Number(O.toFixed(2)),Y-5,Q))}),s.strokeStyle="#ccc",s.lineWidth=2,s.strokeRect(Y,Y,X,R),s.textAlign="center",s.font="bold 12px sans-serif",s.fillStyle=F,s.fillText(`${g[_].label}`,Y+X/2,S+30),s.save(),s.translate(15,S-R/2),s.rotate(-Math.PI/2),s.fillStyle=J,s.fillText(`${g[y].label}`,0,0),s.restore(),s.save(),s.beginPath(),s.rect(Y,Y,X,R),s.clip(),P&&i&&g.length===2){const Q=Math.floor(ot/.5)*.5,st=Math.ceil(pt/.5)*.5,tt=Math.floor(wt/.5)*.5,nt=Math.ceil(H/.5)*.5;if((st-Q)/.5*((nt-tt)/.5)<5e4)for(let ht=Q;ht<=st;ht+=.5)for(let vt=tt;vt<=nt;vt+=.5)try{const kt=[0,0];_<2&&(kt[_]=ht),y<2&&(kt[y]=vt);const bt=i.predict(kt),Ct=Z(ht),Dt=et(vt),se=Z(ht+.5),ae=et(vt+.5),Ue=Math.abs(se-Ct),je=Math.abs(Dt-ae),Oe=Math.min(Ct,se),qe=Math.min(Dt,ae),Ke=Math.round(46*(1-bt)+231*bt),Ze=Math.round(204*(1-bt)+76*bt),Je=Math.round(113*(1-bt)+60*bt);s.fillStyle=`rgba(${Ke}, ${Ze}, ${Je}, 0.2)`,s.fillRect(Oe,qe,Ue+.5,je+.5)}catch{}}const Mt=(O,Q,st,tt,nt)=>{const mt=Z(O[_]),ht=et(O[y]);nt&&(s.beginPath(),s.arc(mt,ht,st+3,0,2*Math.PI),s.strokeStyle=nt,s.lineWidth=2,s.stroke()),s.beginPath(),s.arc(mt,ht,st,0,2*Math.PI),s.fillStyle=Q,s.fill(),tt&&(s.strokeStyle=tt,s.lineWidth=2,s.stroke())};if(e&&e.forEach(O=>{const Q=Z(O.input[_]),st=et(O.input[y]);if(Q<Y||Q>Y+X||st<Y||st>S)return;v.current.push({x:Q,y:st,info:{x:Q,y:st,text:O.text,target:O.target,isSpam:O.target===1,features:{xLabel:g[_].label,xVal:O.input[_],yLabel:g[y].label,yVal:O.input[y]}}});let tt=null;if(i&&c)try{tt=i.predict(O.input)>.5?"#e74c3c":"#2ecc71"}catch{}Mt(O.input,ct(O.target),5,"#fff",tt)}),c&&i){let O=i.weights;const Q=i.bias||0;if(O){const st=O[_]||0,tt=O[y]||0,nt=Q;s.beginPath(),s.strokeStyle="rgba(142, 68, 173, 0.8)",s.lineWidth=2,s.setLineDash([10,5]);const mt=ot-(pt-ot),ht=pt+(pt-ot),vt=(kt,bt)=>({x:Z(kt),y:et(bt)});if(Math.abs(tt)>.001){const kt=Dt=>(-st*Dt-nt)/tt,bt=vt(mt,kt(mt)),Ct=vt(ht,kt(ht));s.moveTo(bt.x,bt.y),s.lineTo(Ct.x,Ct.y)}else if(Math.abs(st)>.001){const kt=-nt/st,bt=vt(kt,wt-100),Ct=vt(kt,H+100);s.moveTo(bt.x,bt.y),s.lineTo(Ct.x,Ct.y)}s.stroke(),s.setLineDash([])}}t&&Mt(t,"#3498db",8,"#2980b9"),s.restore(),s.fillStyle="#666",s.textAlign="right",s.font="11px sans-serif",s.fillText("Rot=Spam, Grün=OK",K-10,20)}if(a==="text"){if(s.textAlign="center",s.textBaseline="middle",!t||!t.text){s.fillStyle="#999",s.font="20px sans-serif",s.fillText("Kein Text verfügbar",K/2,q/2);return}const $=n>.5,G=$?"#feeff0":"#effaf0";s.fillStyle=G,s.fillRect(0,0,K,q);const Y=t.text;s.fillStyle="#333",s.font="24px serif";const X=Y.split(" ");let R="";const S=35,F=K/2;let J=q/3;const Z=K-100;for(let ft=0;ft<X.length;ft++){const ot=R+X[ft]+" ";s.measureText(ot).width>Z&&ft>0?(s.fillText(R,F,J),R=X[ft]+" ",J+=S):R=ot}s.fillText(R,F,J),J+=60;const et=t.groundTruth===1;s.font="bold 16px sans-serif",s.fillStyle="#555",s.fillText(`Wahrheit: ${et?"SPAM":"HAM"}`,F,J),J+=30;const gt=(n*100).toFixed(1);s.font="bold 20px sans-serif",s.fillStyle=$?"#c0392b":"#27ae60",s.fillText(`Vorhersage: ${$?"SPAM":"HAM"} (${gt}%)`,F,J);return}if(a==="features"){const G=(K-90)/2,Y=(q-90)/2;[{x:30,y:30,...g[0]},{x:30+G+30,y:30,...g[1]},{x:30,y:30+Y+30,...g[2]},{x:30+G+30,y:30+Y+30,...g[3]}].forEach(R=>{if(s.strokeStyle="#ccc",s.strokeRect(R.x,R.y,G,Y),s.fillStyle="#333",s.font="12px Arial",s.textAlign="center",s.fillText(R.label,R.x+G/2,R.y-5),e&&e.forEach(S=>{const F=S.input[R.idx],J=R.x+F/R.max*G,Z=R.y+Y-S.target*(Y-20)-10;v.current.push({x:J,y:Z,info:{x:J,y:Z,text:S.text,target:S.target,isSpam:S.target===1,features:{valLabel:R.label,val:F}}});let et=null;if(i&&c)try{et=i.predict(S.input)>.5?"#e74c3c":"#2ecc71"}catch{}et&&(s.beginPath(),s.arc(J,Z,4.5,0,2*Math.PI),s.strokeStyle=et,s.lineWidth=1,s.stroke()),s.beginPath(),s.arc(J,Z,3,0,2*Math.PI),s.fillStyle=ct(S.target),s.globalAlpha=.6,s.fill(),s.globalAlpha=1}),t){const S=t[R.idx],F=R.x+S/R.max*G;s.beginPath(),s.moveTo(F,R.y),s.lineTo(F,R.y+Y),s.strokeStyle="#3498db",s.setLineDash([5,5]),s.stroke(),s.setLineDash([])}})}if(m&&(a==="features"||a==="scatter"||a==="3d")){s.save(),s.fillStyle="rgba(0,0,0,0.85)",s.strokeStyle="#fff";const $=m.text||"No Text",G=_t(m.target!==void 0?m.target:m.isSpam?1:0),Y=s.measureText($),X=Math.max(Y.width,140)+20;let R=70;m.features&&(m.features.zLabel?R=90:m.features.yLabel?R=85:R=60);let S=m.x+15,F=m.y-15;S+X>K&&(S=m.x-X-10),F+R>q&&(F=m.y-R-10),F<0&&(F=m.y+20),s.beginPath(),s.roundRect(S,F,X,R,5),s.fill(),s.lineWidth=1,s.stroke(),s.textBaseline="top",s.textAlign="left",s.font="bold 12px sans-serif",s.fillStyle=ct(m.target!==void 0?m.target:m.isSpam?1:0),s.fillText(G,S+10,F+10),s.fillStyle="#ddd",s.font="italic 11px sans-serif",s.fillText($,S+10,F+28),m.features&&(s.fillStyle="#fff",s.font="11px monospace",m.features.xLabel?(s.fillText(`${m.features.xLabel}: ${m.features.xVal}`,S+10,F+46),s.fillText(`${m.features.yLabel}: ${m.features.yVal}`,S+10,F+60),m.features.zLabel&&s.fillText(`${m.features.zLabel}: ${m.features.zVal}`,S+10,F+74)):m.features.valLabel&&s.fillText(`${m.features.valLabel}: ${m.features.val}`,S+10,F+46)),s.restore()}},[e,t,n,i,a,_,y,T,V,c,W,P]);const N={features:"Alle Features",scatter:"2D Plot","3d":"3D Plot",text:"Text Mode"};return l("div",{style:{textAlign:"center"},children:[!r&&l("div",{style:{marginBottom:"10px",display:"flex",gap:"5px",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",fontSize:"0.9rem"},children:[l("div",{children:h}),l("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[l("select",{value:a,onChange:w=>d(w.target.value),style:{padding:"4px"},children:o.map(w=>l("option",{value:w,children:N[w]},w))}),(a==="scatter"||a==="3d")&&l(Pt,{children:[l("span",{children:"X:"}),l("select",{value:_,onChange:w=>b(parseInt(w.target.value)),style:{padding:"4px"},children:g.map(w=>l("option",{value:w.idx,children:w.label},w.idx))}),l("span",{children:"Y:"}),l("select",{value:y,onChange:w=>k(parseInt(w.target.value)),style:{padding:"4px"},children:g.map(w=>l("option",{value:w.idx,children:w.label},w.idx))})]}),a==="scatter"&&g.length===2&&l("label",{style:{display:"flex",alignItems:"center",gap:"3px",marginLeft:"5px",fontSize:"0.8rem",cursor:"pointer",background:"#f5f5f5",padding:"2px 5px",borderRadius:"3px",border:"1px solid #ddd"},children:[l("input",{type:"checkbox",checked:P,onChange:w=>z(w.target.checked)}),"Show Grid"]}),a==="3d"&&l(Pt,{children:[l("span",{children:"Z:"}),l("select",{value:T,onChange:w=>C(parseInt(w.target.value)),style:{padding:"4px"},children:g.map(w=>l("option",{value:w.idx,children:w.label},w.idx))})]})]})]}),l("canvas",{ref:u,width:600,height:400,style:{border:"1px solid #eee",maxWidth:"100%",borderRadius:"4px",cursor:m?"pointer":a==="3d"||a==="scatter"?f.current?"grabbing":"grab":"default"},onWheel:x,onMouseDown:A,onMouseMove:L,onMouseUp:j,onMouseLeave:j,onMouseOut:D,onClick:E}),!r&&l("div",{style:{fontSize:"0.8rem",color:"#666",marginTop:"5px"},children:a==="3d"?"Drag to rotate 3D view":a==="scatter"?"Drag to Pan, Scroll to Zoom":"Wähle Achsen für die Visualisierung"})]})}const ke=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Gt=e=>{const t=["winner","won","gift card","urgent","rolex","viagra","cash","prize","singles","marketing","buy","free","money","security alert","click","claim","fake","verification"],n=e.toLowerCase();let i=0;t.forEach(h=>{n.includes(h)&&(i+=1)}),i>10&&(i=10);const o=(e.match(/[A-Z]/g)||[]).length,r=(e.match(/http/g)||[]).length,c=e.split(/\s+/).length;return[i,o,r,c]},Wt={id:"spam_advanced",title:"Phase 3: Erweiterter Spam-Filter (4 Eingaben)",description:"Spam-Erkennung mit 4 Merkmalen: Spam-Worte, Großbuchstaben, Links, Gesamtworte.",Model:He,GroundTruth:ee,CanvasComponent:ne,defaultParams:{weights:[0,0,0,0],bias:0},groundTruthDefaults:[[1.5,.5,2,-.5],-5],getInput:e=>{const t=Math.floor(e*.3),n=ke(t)>.5,i=n?Wt.examples.spam:Wt.examples.ham,o=Math.floor(ke(t+99)*i.length),r=i[o],c=Gt(r);return c.text=r,c.groundTruth=n?1:0,c},examples:{spam:["WINNER! Won $1000 Gift Card! Claim at http://prize-giveaway.net","URGENT: Verify account at http://secure-bank-login.com/fraud","Cheap Rolex watches! 50% OFF at www.fake-watches.cn","Lose weight fast! Buy pills: http://diet-miracle.com","CONGRATS! Cash prize waiting: http://claim-money.org","HOT singles waiting! Chat now: http://local-dating.xyz","Refinance 1% APR. Apply: http://easy-loans.biz","Buy 1 get 1 FREE Viagra. http://meds-direct.com","Meet rich men. Signup: http://millionaire-match.com","SECURITY ALERT: Suspicious activity. Check http://account-security-check.com"],ham:["Meeting agenda for tomorrow's team sync","Hey, are we still on for lunch?","Invoice #12345 from AWS Services","Project deadline extended to Friday","Happy Birthday! Hope you have a great day.","Can you review this pull request?","Your Amazon order has shipped.","Fwd: Tickets for the concert","Question about the quarterly report","Let's catch up sometime next week."]},generateData:e=>{const t=[];Wt.examples.spam.forEach(n=>{const i=Gt(n),o=()=>(Math.random()-.5)*.1,r=i.map(c=>Math.max(0,c+o()));t.push({input:r,target:1,text:n})}),Wt.examples.ham.forEach(n=>{const o=Gt(n).map(r=>Math.max(0,r+(Math.random()-.5)*.1));t.push({input:o,target:0,text:n})});for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t},trainingConfig:{maxSteps:3e3,params:[{name:"w1 (Spam-Worte)",min:1,max:4,step:.5},{name:"w2 (Großbuchst.)",min:0,max:2,step:.5},{name:"w3 (Links)",min:0,max:3,step:.5},{name:"w4 (Gesamtworte)",min:-2,max:2,step:.5},{name:"bias",min:-8,max:8,step:2}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + w₃x₃ + w₄x₄ + b)",inputLabels:["Spam-Worte","Großbuchst.","Links","Gesamtworte"],outputLabel:"Spam? (p)",biasLabel:"b"},isFinished:e=>e>=50};class vn{constructor(t=2,n=10){this.inputCount=t,this.hiddenCount=n;const i=Math.sqrt(6/(t+n));this.weights1=Array(n).fill(0).map(()=>Array.from({length:t},()=>Math.random()*2*i-i)),this.biases1=Array(n).fill(0);const o=Math.sqrt(6/(n+1));this.weights2=Array.from({length:n},()=>Math.random()*2*o-o),this.bias2=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=[];for(let r=0;r<this.hiddenCount;r++){let c=this.biases1[r];for(let h=0;h<this.inputCount;h++)c+=this.weights1[r][h]*t[h];n.push(this.sigmoid(c))}let i=this.bias2;for(let r=0;r<this.hiddenCount;r++)i+=this.weights2[r]*n[r];return this.sigmoid(i)}getActivations(t){const n=[];for(let r=0;r<this.hiddenCount;r++){let c=this.biases1[r];for(let h=0;h<this.inputCount;h++)c+=this.weights1[r][h]*t[h];n.push(this.sigmoid(c))}let i=this.bias2;for(let r=0;r<this.hiddenCount;r++)i+=this.weights2[r]*n[r];const o=this.sigmoid(i);return{hidden:n,output:[o]}}setParams(t){for(let i=0;i<this.hiddenCount;i++){const o=`b1_${i}`;t[o]!==void 0&&(this.biases1[i]=t[o]);for(let r=0;r<this.inputCount;r++){const c=`w1_${i}_${r}`;t[c]!==void 0&&(this.weights1[i][r]=t[c])}}const n="b2";t[n]!==void 0&&(this.bias2=t[n]);for(let i=0;i<this.hiddenCount;i++){const o=`w2_${i}`;t[o]!==void 0&&(this.weights2[i]=t[o])}}getTopology(){return{inputCount:this.inputCount,hiddenCounts:[this.hiddenCount],outputCount:1,weights1:this.weights1,biases1:this.biases1,weights2:this.weights2,bias2:this.bias2}}}const Be=[{label:"Gesamtworte",idx:0,max:400},{label:"Links",idx:1,max:10}],Me=[{input:[367,5],target:0,text:"Attached is the quarterly report found at..."},{input:[365,2],target:0,text:"Attached is the quarterly report found at..."},{input:[364,6],target:0,text:"Attached is the quarterly report found at..."},{input:[327,7],target:0,text:"Attached is the quarterly report found at..."},{input:[302,5],target:0,text:"Attached is the quarterly report found at..."},{input:[314,3],target:0,text:"Attached is the quarterly report found at..."},{input:[345,4],target:0,text:"Attached is the quarterly report found at..."},{input:[265,5],target:0,text:"Attached is the quarterly report found at..."},{input:[287,4],target:0,text:"Attached is the quarterly report found at..."},{input:[311,1],target:0,text:"Attached is the quarterly report found at..."},{input:[268,2],target:0,text:"Attached is the quarterly report found at..."},{input:[283,0],target:0,text:"Attached is the quarterly report found at..."},{input:[261,3],target:0,text:"Attached is the quarterly report found at..."},{input:[197,0],target:0,text:"Just a normal short message."},{input:[150,0],target:0,text:"Just a normal short message."},{input:[124,0],target:0,text:"Just a normal short message."},{input:[65,1],target:0,text:"Just a normal short message."},{input:[85,0],target:0,text:"Just a normal short message."},{input:[58,0],target:0,text:"Just a normal short message."},{input:[45,0],target:0,text:"Security Alert: Login Code 2542"},{input:[36,0],target:0,text:"Security Alert: Login Code 5607"},{input:[38,1],target:0,text:"Security Alert: Login Code 909"},{input:[24,1],target:0,text:"Security Alert: Login Code 8385"},{input:[17,1],target:0,text:"Security Alert: Login Code 2083"},{input:[215,1],target:1,text:"You won a prize! Click here."},{input:[230,3],target:1,text:"You won a prize! Click here."},{input:[234,5],target:1,text:"You won a prize! Click here."},{input:[221,2],target:1,text:"You won a prize! Click here."},{input:[215,4],target:1,text:"You won a prize! Click here."},{input:[153,3],target:1,text:"You won a prize! Click here."},{input:[152,1],target:1,text:"You won a prize! Click here."},{input:[137,2],target:1,text:"You won a prize! Click here."},{input:[124,4],target:1,text:"You won a prize! Click here."},{input:[120,2],target:1,text:"You won a prize! Click here."},{input:[92,3],target:1,text:"You won a prize! Click here."},{input:[93,5],target:1,text:"You won a prize! Click here."},{input:[86,5],target:1,text:"You won a prize! Click here."},{input:[84,3],target:1,text:"You won a prize! Click here."},{input:[53,4],target:1,text:"You won a prize! Click here."},{input:[55,3],target:1,text:"You won a prize! Click here."}],Xe=()=>(console.log("Using prepared data with length "+Me.length),Me),Se={id:"spam_nonlinear",title:"Phase 4: Nicht-lineare Daten",description:"Spam-Erkennung mit nur 2 Merkmalen, aber komplexer Verteilung. Ein einfacher linearer Klassifikator (Perzeptron) wird hier scheitern.",Model:He,GroundTruth:ee,CanvasComponent:ne,defaultParams:{weights:[0,0],bias:0},getInput:e=>{const t=[50,0];return t.text="Live Input",t},generateData:e=>Xe(),trainingConfig:{maxSteps:4e3,params:[{name:"w1 (Worte)",min:-5,max:5,step:.5},{name:"w2 (Links)",min:-5,max:5,step:.5},{name:"bias",min:-10,max:10,step:1}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + b)",inputLabels:["Worte","Links"],outputLabel:"Spam?",biasLabel:"b"},featuresConfig:Be,isFinished:e=>!1},kn=()=>{const e=[];for(let t=0;t<10;t++){e.push({name:`b1_${t}`,min:-30,max:30,step:1});for(let n=0;n<2;n++)e.push({name:`w1_${t}_${n}`,min:-30,max:30,step:1})}e.push({name:"b2",min:-3,max:3,step:1});for(let t=0;t<10;t++)e.push({name:`w2_${t}`,min:-50,max:50,step:1});return e},Te={id:"spam_hidden",title:"Phase 5: Deep Learning (Hidden Layer)",description:'Spam-Erkennung mit einem Hidden Layer (10 Neuronen). Das Deep Neural Network kann die nicht-lineare Verteilung ("Spam-Insel") erkennen.',Model:vn,GroundTruth:ee,CanvasComponent:ne,defaultParams:{},getInput:e=>({input:[50,0],text:"Live Input"}),generateData:e=>Xe(),trainingConfig:{seed:1319434789,maxSteps:1e4,params:kn()},networkViz:{formula:"Deep Network",inputLabels:["Worte","Links"],outputLabel:"Spam?",biasLabel:"b"},featuresConfig:Be,isFinished:e=>e>=50},Pe={[be.id]:be,[ve.id]:ve,[Wt.id]:Wt,[Se.id]:Se,[Te.id]:Te};function Mn(e){return Pe[e]||Pe.physics}function ie(e){const[t,n]=rt(null),i=xt(null),o=xt(null),[r,c]=rt(0),[h,g]=rt(!1),[u,a]=rt([]),[d,_]=rt([]),[b,y]=rt(-1),[k,T]=rt(!1),[C,P]=rt("simulation"),[z,V]=rt("table"),[U,W]=rt("random"),[M,f]=rt("Bereit."),I=xt(0);return St(()=>{if(!e)return;if(e==="gallery"){n({id:"gallery",type:"gallery"});return}const x=Mn(e);if(!x){f("Fehler: Simulation nicht gefunden.");return}try{if(i.current=new x.GroundTruth(...x.groundTruthDefaults||[]),o.current=new x.Model,x.defaultParams&&(x.defaultParams.weight!==void 0&&o.current.setWeight(x.defaultParams.weight),x.defaultParams.weights!==void 0&&o.current.setWeights&&o.current.setWeights(x.defaultParams.weights),x.defaultParams.bias!==void 0&&o.current.setBias(x.defaultParams.bias)),n(x),i.current)try{const A=x.generateData(i.current);a(A)}catch(A){console.error("Auto-generate data error:",A)}}catch(A){console.error("Initialization Error:",A),f(`Init Fehler: ${A.message}`)}},[e]),St(()=>{let x;const A=L=>{if(!h)return;I.current===0&&(I.current=L);const j=(L-I.current)/1e3;I.current=L;const D=Math.min(j,.1);c(B=>{const N=B+D*3;return t&&t.isFinished&&t.isFinished(N)&&(g(!1),f("Simulation beendet.")),N}),x=requestAnimationFrame(A)};return h&&(I.current=0,x=requestAnimationFrame(A)),()=>cancelAnimationFrame(x)},[h,t]),{simConfig:t,groundTruth:i,neuralNet:o,time:r,isRunning:h,trainingData:u,trainingHistory:d,trainingStepIndex:b,isTraining:k,activeTab:C,dataViewMode:z,trainerType:U,statusMsg:M,handleTrain:async()=>{try{if(u.length===0||!t)return;T(!0),y(0),_([]),f("Suche optimales Gewicht und Bias (Live Visualisierung)..."),P("training");const x=new t.Model,A=new fn(x),L=(D,B)=>{if(_(E=>{const N=[...E,...D];return y(N.length-1),N}),B&&B.message&&f(B.message),B&&B.bestParams){if(o.current.setParams)o.current.setParams(B.bestParams);else if(o.current.setWeights){const{weights:E,bias:N}=B.bestParams;o.current.setWeights(E),o.current.setBias(N)}}else B&&B.bestWeight!==void 0&&(o.current.setWeight(B.bestWeight),o.current.setBias(B.bestBias))};let j;if(U==="random"){f("Suche optimales Gewicht und Bias (Random Search)...");const D={seed:t.trainingConfig.seed,maxSteps:t.trainingConfig.maxSteps,initialRadius:t.trainingConfig.initialRadius,phase1Ratio:t.trainingConfig.phase1Ratio};j=await A.trainRandomAsync(u,t.trainingConfig.params,L,D)}else t.trainingConfig.params?j=await A.trainAsync(u,t.trainingConfig.params,L):j=await A.trainAsync(u,t.trainingConfig.weightRange,t.trainingConfig.biasRange,L);f(`Training fertig! Min Error: ${j.minError.toFixed(5)}`),T(!1)}catch(x){console.error("Training Error:",x),T(!1),f(`Fehler beim Training: ${x.message}`)}},handleRun:()=>{c(0),g(!0),f("Simulation läuft..."),P("simulation")},handleReset:()=>{if(g(!1),c(0),_([]),y(-1),t&&t.generateData&&i.current)try{const x=t.generateData(i.current);a(x),f("Reset durchgeführt & Daten neu generiert.")}catch(x){console.error("Regenerate Data Error:",x),a([])}else a([]),f("Reset durchgeführt.");try{o.current&&t?.defaultParams&&(t.defaultParams.weight!==void 0&&o.current.setWeight(t.defaultParams.weight),t.defaultParams.weights!==void 0&&o.current.setWeights&&o.current.setWeights(t.defaultParams.weights),t.defaultParams.bias!==void 0&&o.current.setBias(t.defaultParams.bias))}catch(x){console.error("Reset Error:",x)}},setTrainerType:W,setActiveTab:P,setDataViewMode:V}}function Sn({history:e,currentStepIndex:t,isTraining:n,paramsConfig:i}){const o=xt(null),[r,c]=rt(0),h=6;St(()=>{c(0)},[i]),St(()=>{const u=o.current;if(!u||!e||e.length===0)return;const a=u.getContext("2d"),d=u.width,_=u.height;a.clearRect(0,0,d,_),a.fillStyle="#fff",a.fillRect(0,0,d,_);const b=Math.max(...e.map(W=>W.error)),k=!n&&e.length>0?e.length-1:t!==null&&t>=0?Math.min(t,e.length-1):-1;let T=-1,C=1/0;for(let W=0;W<=k;W++)e[W].error<C&&(C=e[W].error,T=W);let P=[];if(i){const W=1+i.length,M=r*h,f=Math.min(M+h,W),I=3,m=2,p=d/I,v=_/m;for(let x=M;x<f;x++){const A=x-M,L=A%I,j=Math.floor(A/I),D=L*p,B=j*v;if(x===0){const E=Math.max(10,e.length-1);P.push({type:"accuracy_step",xLabel:"Training Step",xMin:0,xMax:E,yMode:"accuracy",getValue:(N,w)=>w,getYValue:N=>N.accuracy||0,offsetX:D,offsetY:B,w:p,h:v,showYAxis:!0})}else if(x===1){const E=Math.max(10,e.length-1);P.push({type:"error_step",xLabel:"Training Step",xMin:0,xMax:E,yMode:"error_log",getValue:(N,w)=>w,getYValue:N=>N.error,offsetX:D,offsetY:B,w:p,h:v,showYAxis:!0})}else{const E=x-2,N=i[E],w=e.map(q=>q.params[E]),s=Math.min(...w),K=Math.max(...w);P.push({type:"param_error",xLabel:N.name,xMin:s,xMax:K,yMode:"error_log",getValue:q=>q.params[E],getYValue:q=>q.error,offsetX:D,offsetY:B,w:p,h:v})}}}else{const W=d/2,M=_/2,f=e.map(p=>p.weight),I=e.map(p=>p.bias),m=Math.max(10,e.length-1);P=[{type:"accuracy_step",xLabel:"Accuracy",xMin:0,xMax:m,yMode:"accuracy",getValue:(p,v)=>v,getYValue:p=>p.accuracy||0,offsetX:0,offsetY:0,w:W,h:M,showYAxis:!0},{type:"error_step",xLabel:"Step",xMin:0,xMax:m,yMode:"error_log",getValue:(p,v)=>v,getYValue:p=>p.error,offsetX:W,offsetY:0,w:W,h:M,showYAxis:!0},{xLabel:"Weight",xMin:Math.min(...f),xMax:Math.max(...f),yMode:"error_log",getValue:p=>p.weight,getYValue:p=>p.error,offsetX:0,offsetY:M,w:W,h:M},{xLabel:"Bias",xMin:Math.min(...I),xMax:Math.max(...I),yMode:"error_log",getValue:p=>p.bias,getYValue:p=>p.error,offsetX:W,offsetY:M,w:W,h:M}]}const z=50;P.forEach(W=>{const{xLabel:M,xMin:f,xMax:I,getValue:m,getYValue:p,offsetX:v,offsetY:x,w:A,h:L,yMode:j,showYAxis:D}=W,B=w=>v+z+(w-f)/(I-f||1)*(A-2*z);let E;if(j==="accuracy")E=w=>x+L-z-w*(L-2*z);else{const s=b||1;E=K=>{const q=(K-0)/(s-0);return x+L-z-q*(L-2*z)}}a.strokeStyle="#eee",a.lineWidth=2,a.strokeRect(v,x,A,L),a.beginPath(),a.strokeStyle="#333",a.lineWidth=2,a.moveTo(v+z,x+z),a.lineTo(v+z,x+L-z),a.lineTo(v+A-z,x+L-z),a.stroke(),a.fillStyle="#333",a.font="22px sans-serif",a.textAlign="center";let N=M;if(N.length>20&&(N=N.substring(0,18)+"..."),a.fillText(N,v+A/2,x+L-15),v===0||D)if(a.save(),a.translate(v+15,x+L/2),a.rotate(-Math.PI/2),j==="accuracy")a.fillText("Accuracy",0,0),a.restore(),a.textAlign="right",a.fillStyle="#666",a.font="18px sans-serif",[0,.25,.5,.75,1].forEach(w=>{const s=E(w);a.fillText(w.toFixed(2),v+z-8,s+6),a.beginPath(),a.lineWidth=1,a.strokeStyle="#f0f0f0",a.moveTo(v+z,s),a.lineTo(v+A-z,s),a.stroke()});else{a.fillText("Error",0,0),a.restore(),a.textAlign="right",a.fillStyle="#666",a.font="18px sans-serif";const w=5;for(let s=0;s<=w;s++){const K=s/w*b,q=E(K);a.fillText(K.toFixed(2),v+z-8,q+6),s>0&&(a.beginPath(),a.lineWidth=1,a.strokeStyle="#f0f0f0",a.moveTo(v+z,q),a.lineTo(v+A-z,q),a.stroke())}}a.fillStyle="#666",a.font="18px sans-serif",a.textAlign="center",a.fillText(f.toFixed(1),v+z,x+L-z+25),a.fillText(I.toFixed(1),v+A-z,x+L-z+25),a.fillStyle=j==="accuracy"?"rgba(155, 89, 182, 0.4)":"rgba(52, 152, 219, 0.4)";for(let w=0;w<=k;w++){const s=m(e[w],w),K=p(e[w]),q=B(s),lt=E(K);a.fillRect(q,lt,4,4)}if(T>=0){const w=m(e[T],T),s=p(e[T]),K=B(w),q=E(s);a.beginPath(),a.fillStyle="#2ecc71",a.strokeStyle="#27ae60",a.lineWidth=2,a.arc(K,q,10,0,Math.PI*2),a.fill(),a.stroke()}if(n&&t!==null&&t>=0&&t<=k){const w=m(e[t],t),s=p(e[t]),K=B(w),q=E(s);a.beginPath(),a.fillStyle="#e74c3c",a.strokeStyle="#c0392b",a.lineWidth=2,a.arc(K,q,8,0,Math.PI*2),a.fill(),a.stroke()}});const V=d-150,U=20;a.fillStyle="rgba(255,255,255,0.9)",a.fillRect(V,U,140,70),a.strokeStyle="#ccc",a.lineWidth=1,a.strokeRect(V,U,140,70),a.textAlign="left",a.font="16px sans-serif",a.beginPath(),a.fillStyle="#e74c3c",a.arc(V+15,U+20,6,0,Math.PI*2),a.fill(),a.fillStyle="#333",a.fillText("Current Scan",V+30,U+25),a.beginPath(),a.fillStyle="#2ecc71",a.arc(V+15,U+50,6,0,Math.PI*2),a.fill(),a.fillStyle="#333",a.fillText("Best So Far",V+30,U+55),!n&&T>=0&&(a.fillStyle="#333",a.font="bold 18px sans-serif",a.textAlign="right",a.fillText(`Min Error: ${C.toFixed(5)}`,d-20,_-20))},[e,t,n,i,r]);const g=i?Math.ceil((i.length+1)/h):1;return l("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff"},children:[l("canvas",{ref:o,width:1600,height:800,style:{width:"100%",height:"auto"}}),g>1&&l("div",{style:{display:"flex",justifyContent:"center",marginTop:"10px",gap:"10px"},children:[l("button",{onClick:()=>c(u=>Math.max(0,u-1)),disabled:r===0,children:"Previous"}),l("span",{style:{alignSelf:"center"},children:["Page ",r+1," of ",g]}),l("button",{onClick:()=>c(u=>Math.min(g-1,u+1)),disabled:r===g-1,children:"Next"})]})]})}function Tn({model:e,inputs:t,inputLabels:n,output:i,outputLabel:o}){if(!e||!e.getTopology)return null;const{inputCount:r,hiddenCounts:c,outputCount:h,weights1:g,biases1:u,weights2:a}=e.getTopology();let d={hidden:[],output:[]};e.getActivations&&(d=e.getActivations(t));const _=600,b=400,y=b/2,k=_/2,T=350,C=280,P=k-T/2,z=k+T/2,V=[{count:r,x:P,labels:n,values:t},{count:c[0],x:k,values:d.hidden},{count:h,x:z,labels:[o],values:d.output}],U=Math.max(...V.map(m=>m.count)),W=Math.min(50,C/U),M=(m,p)=>{const x=(V[m].count-1)*W;return y-x/2+p*W},f=m=>{const p=Math.max(.2,Math.min(.8,Math.abs(m)/2));return m>0?`rgba(46, 204, 113, ${p})`:`rgba(231, 76, 60, ${p})`},I=m=>{const p=Math.max(0,Math.min(1,m)),v=Math.round(255+-203*p),x=Math.round(255+-103*p),A=Math.round(255+-36*p);return`rgb(${v},${x},${A})`};return l("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center"},children:[l("h3",{style:{marginBottom:"10px",fontSize:"1rem",color:"#555"},children:"Neural Network Activity"}),l("svg",{width:_,height:b,style:{overflow:"visible"},children:[l("rect",{x:P,y:y-C/2,width:T,height:C,rx:"15",fill:"none",stroke:"#333",strokeWidth:"3",strokeDasharray:"5,5"}),l("text",{x:k,y:y-C/2+20,textAnchor:"middle",fill:"#777",fontSize:"12",fontWeight:"bold",children:"NEURAL NETWORK"}),g.map((m,p)=>m.map((v,x)=>l("line",{x1:V[0].x,y1:M(0,x),x2:V[1].x,y2:M(1,p),stroke:f(v),strokeWidth:Math.max(1,Math.min(4,Math.abs(v)))},`L0-${x}-${p}`))),a.map((m,p)=>l("line",{x1:V[1].x,y1:M(1,p),x2:V[2].x,y2:M(2,0),stroke:f(m),strokeWidth:Math.max(1,Math.min(4,Math.abs(m)))},`L1-${p}-0`)),V.map((m,p)=>l("g",{children:Array.from({length:m.count}).map((v,x)=>{const A=m.x,L=M(p,x),j=m.values&&m.values[x]!==void 0?m.values[x]:0;return l("g",{children:[l("circle",{cx:A,cy:L,r:12,fill:I(j),stroke:"#333",strokeWidth:"1.5"}),m.labels&&l("text",{x:p===0?A-30:A+30,y:L,textAnchor:p===0?"end":"start",dominantBaseline:"middle",fontSize:"13",fontWeight:"bold",fill:"#333",children:m.labels[x]||""}),l("title",{children:j.toFixed(3)})]},`n-${p}-${x}`)})},`layer-${p}`)),l("g",{transform:`translate(${_-100}, ${b-50})`,children:[l("rect",{width:"90",height:"40",fill:"white",stroke:"#ccc",rx:"4"}),l("line",{x1:"10",y1:"10",x2:"30",y2:"10",stroke:"#2ecc71",strokeWidth:"3"}),l("text",{x:"35",y:"14",fontSize:"10",children:"Positive"}),l("line",{x1:"10",y1:"28",x2:"30",y2:"28",stroke:"#e74c3c",strokeWidth:"3"}),l("text",{x:"35",y:"32",fontSize:"10",children:"Negative"})]})]})]})}function Ge({input:e,weight:t,bias:n,output:i,formula:o="y = w * x + b",inputLabel:r="Input",outputLabel:c="Output",biasLabel:h="b",decimals:g=1,model:u=null}){if(u&&u.getTopology){let D=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(D=e.input);const B=Array.isArray(D)?D:[D],E=Array.isArray(r)?r:[r];return l(Tn,{model:u,inputs:B,inputLabels:E,output:i,outputLabel:c})}let a=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(a=e.input);const d=Array.isArray(a)?a:[a],_=Array.isArray(t)?t:[t],b=Array.isArray(r)?r:[r],y=Number(n)||0,k=Number(i)||0,T=d.length,C=24,P=90,z=300,V=60,U=60,W=Math.max(1,T-1)*P,M=Math.max(150,W+V+U),f=M+60,I=600,m=I/2,p=m-z/2,v=m+z/2,x=M/2+20,A=x-W/2,L=v-50,j=L-60;return l("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[l("h3",{style:{marginBottom:"10px"},children:"Modell Architektur"}),l("svg",{width:I,height:f,style:{overflow:"visible"},children:[l("defs",{children:l("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"27",refY:"3.5",orient:"auto",children:l("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#333"})})}),l("rect",{x:p,y:20,width:z,height:M,rx:"15",fill:"none",stroke:"#333",strokeWidth:"3",strokeDasharray:"5,5"}),l("text",{x:m,y:40,textAnchor:"middle",fill:"#777",fontSize:"12",fontWeight:"bold",children:"NEURAL NETWORK"}),(()=>{const D=x-50;return l(Pt,{children:[d.map((B,E)=>{const N=T>1?A+E*P:x,w=Number(_[E])||0,s=b[E]||`x${E+1}`,K=Number(B)||0;return l("g",{children:[l("line",{x1:p,y1:N,x2:j,y2:x,stroke:"#999",strokeWidth:"1"}),l("g",{transform:`translate(${(p+j)/2+(E-(T-1)/2)*5}, ${(N+x)/2})`,children:[l("rect",{x:"-24",y:"-9",width:"50",height:"18",fill:"#fff",rx:"4",stroke:"#e0e0e0"}),l("text",{x:"0",y:"4",textAnchor:"middle",fill:"#e74c3c",fontSize:"10",fontWeight:"bold",children:w.toFixed(1)})]}),l("circle",{cx:p,cy:N,r:C,fill:"#fff",stroke:"#333",strokeWidth:"2"}),l("text",{x:p-40,y:N,textAnchor:"end",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",children:s}),l("text",{x:p,y:N,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fill:"#333",children:K.toFixed(g)})]},E)}),l("line",{x1:j,y1:x,x2:L,y2:x,stroke:"#333",strokeWidth:"2"}),l("g",{transform:`translate(${L}, ${x})`,children:[l("rect",{x:"-18",y:"-18",width:"36",height:"36",rx:"6",fill:"#fff",stroke:"#333",strokeWidth:"2"}),l("path",{d:"M -10 8 C -4 8, -4 -8, 10 -8",stroke:"#333",strokeWidth:"2",fill:"none"})]}),l("line",{x1:L+18,y1:x,x2:v-C,y2:x,stroke:"#333",strokeWidth:"2"}),l("path",{d:`M ${L-20} ${D} Q ${L-20} ${x} ${j+10} ${x}`,fill:"none",stroke:"#f39c12",strokeWidth:"1",markerEnd:"url(#arrowhead)"}),l("circle",{cx:L-20,cy:D,r:12,fill:"#f1c40f",stroke:"#f39c12"}),l("text",{x:L-23,y:D+5,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fontWeight:"bold",fill:"#fff",children:"b"}),l("text",{x:L-5,y:D+5,textAnchor:"start",dominantBaseline:"middle",fontSize:"12",fill:"#f39c12",fontWeight:"bold",children:y.toFixed(2)})]})})(),l("circle",{cx:v,cy:x,r:C,fill:"#fff",stroke:"#333",strokeWidth:"2"}),l("text",{x:v-14,y:x+4,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",fontSize:"12",children:k.toFixed(2)}),l("text",{x:v+40,y:x+4,textAnchor:"start",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:c}),l("text",{x:m,y:f-15,textAnchor:"middle",fontSize:"12",fontStyle:"italic",fill:"#777",children:o})]})]})}function Pn({onTrain:e,onRun:t,onReset:n,isTraining:i,trainingStep:o,dataCount:r,trainerType:c,onTrainerTypeChange:h}){return l("div",{role:"region","aria-label":"Steuerung",style:{padding:"20px",background:"#eee",borderRadius:"8px",display:"flex",gap:"10px",flexWrap:"wrap",alignItems:"center"},children:[l("span",{"aria-live":"polite",children:["Datenpunkte: ",r]}),l("div",{style:{borderLeft:"1px solid #ccc",paddingLeft:"10px",marginLeft:"10px",display:"flex",gap:"5px",alignItems:"center"},children:[l("select",{"aria-label":"Trainingsmethode auswählen",value:c,onChange:g=>h(g.target.value),disabled:i,style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[l("option",{value:"exhaustive",children:"Grid Search "}),l("option",{value:"random",children:"Adaptive Random "})]}),l("button",{onClick:e,disabled:i||r===0,"aria-busy":i,title:r===0?"Zuerst Daten generieren":"",children:i?"Suche läuft...":"2. Trainieren"})]}),l("button",{onClick:t,disabled:i,title:i?"Bitte warten bis das Training beendet ist":"",children:"3. Simulation Starten"}),l("button",{onClick:n,style:{marginLeft:"auto",background:"#e74c3c",color:"white"},"aria-label":"Simulation zurücksetzen",children:"Reset"})]})}function re({hookState:e,renderSimulationView:t,renderDataView:n,networkVizProps:i={}}){const{simConfig:o,activeTab:r,setActiveTab:c,trainingHistory:h,trainingStepIndex:g,isTraining:u,dataViewMode:a,setDataViewMode:d,trainingData:_,groundTruth:b,neuralNet:y,time:k,statusMsg:T,handleTrain:C,handleRun:P,handleReset:z,trainerType:V,setTrainerType:U,currentInput:W}=e,[M,f]=rt(null),I=A=>{f(L=>L===A?null:A)},m={position:"absolute",top:"10px",right:"10px",zIndex:10,background:"rgba(255, 255, 255, 0.9)",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"0px"},p="all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",v=W!==void 0?W:o.getInput?o.getInput(k):k,x=o.networkViz||{};return l("div",{className:"layout-container",style:{display:"flex",flexDirection:"column",height:"100%"},children:[l("div",{className:"top-section",style:{display:"flex",gap:M?"0px":"20px",flexWrap:"nowrap",alignItems:"stretch",height:M?"calc(100vh - 200px)":"auto",minHeight:"500px",transition:p,marginBottom:"20px"},children:[l("div",{className:"simulation-wrapper",style:{flex:M==="simulation"?"1 0 100%":M==="network"?"0 0 0%":"1 1 500px",opacity:M==="network"?0:1,overflow:"hidden",maxWidth:M==="network"?"0px":"100%",transition:p,position:"relative",display:"flex",flexDirection:"column"},children:[l("button",{onClick:()=>I("simulation"),style:m,title:M==="simulation"?"Originalgröße":"Maximieren",children:M==="simulation"?l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M4 14h6v6"}),l("path",{d:"M20 10h-6V4"}),l("path",{d:"M14 10l7-7"}),l("path",{d:"M3 21l7-7"})]}):l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M15 3h6v6"}),l("path",{d:"M9 21H3v-6"}),l("path",{d:"M21 3l-7 7"}),l("path",{d:"M3 21l7-7"})]})}),l("div",{className:"simulation-section",style:{height:"100%",display:"flex",flexDirection:"column"},children:[l("div",{className:"tabs",style:{paddingRight:"120px"},children:[l("button",{className:`tab-button ${r==="simulation"?"active":""}`,onClick:()=>c("simulation"),children:"Simulation"}),l("button",{className:`tab-button ${r==="data"?"active":""}`,onClick:()=>c("data"),children:"Daten"}),l("button",{className:`tab-button ${r==="training"?"active":""}`,onClick:()=>c("training"),children:"Training"})]}),l("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[r==="simulation"&&l(Pt,{children:[t(),l("div",{className:"stats",style:{marginTop:"auto",paddingTop:"10px"},children:[l("p",{children:o.description}),l("p",{style:{color:"#646cff",fontWeight:"bold"},children:["Status: ",T]})]})]}),r==="data"&&l("div",{className:"data-content",style:{flex:1,overflowY:"auto"},children:[!["gallery"].includes(o.id)&&l("div",{style:{display:"flex",justifyContent:"center",marginBottom:"15px"},children:l("div",{style:{background:"#eee",borderRadius:"4px",padding:"2px",display:"flex",gap:"2px"},children:[l("button",{onClick:()=>d("table"),style:{background:a==="table"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:a==="table"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:a==="table"?"bold":"normal",color:a==="table"?"#333":"#666"},children:"Tabelle"}),l("button",{onClick:()=>d("plot"),style:{background:a==="plot"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:a==="plot"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:a==="plot"?"bold":"normal",color:a==="plot"?"#333":"#666"},children:"Graph"})]})}),a==="plot"&&l("div",{style:{marginBottom:"20px"},children:n?n():l("p",{children:"Kein Graph verfügbar."})}),a==="table"&&l(Pt,{children:_.length>0?l("div",{style:{maxHeight:M?"calc(100vh - 350px)":"400px",overflowY:"auto"},children:l("table",{style:{width:"100%",textAlign:"left",borderCollapse:"collapse",fontSize:"0.9rem"},children:[l("thead",{children:l("tr",{style:{background:"#eee",borderBottom:"2px solid #ddd"},children:[Array.isArray(x.inputLabels)?x.inputLabels.map((A,L)=>l("th",{style:{padding:"8px"},children:A},L)):l("th",{style:{padding:"8px"},children:["Input (",x.inputLabel,")"]}),l("th",{style:{padding:"8px"},children:"Target"}),_.length>0&&_[0].text&&l("th",{style:{padding:"8px"},children:"E-Mail Text"})]})}),l("tbody",{children:_.map((A,L)=>{const j=["spam","spam_advanced","spam_hidden","spam_nonlinear"].includes(o.id);let D="transparent",B=A.target,E={padding:"8px"};if(j){const N=A.target===1;D=N?"#ffebee":"#e8f5e9",B=N?"SPAM":"HAM",E={...E,fontWeight:"bold",color:N?"#c0392b":"#27ae60"}}else B=typeof A.target=="number"?A.target.toFixed(2):A.target;return l("tr",{style:{background:D,borderBottom:"1px solid #ddd"},children:[Array.isArray(A.input)?A.input.map((N,w)=>l("td",{style:{padding:"8px"},children:N.toFixed(0)},w)):l("td",{style:{padding:"8px"},children:A.input.toFixed(2)}),l("td",{style:E,children:B}),A.text&&l("td",{style:{padding:"8px",color:"#555",fontStyle:"italic",maxWidth:"300px"},children:A.text})]},L)})})]})}):l("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Noch keine Trainingsdaten generiert."})})]}),r==="training"&&l("div",{className:"training-content",style:{flex:1},children:h.length>0?l(Sn,{history:h,currentStepIndex:g,isTraining:u,paramsConfig:o.trainingConfig.params}):l("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Noch kein Training gestartet."})})]})]})]}),l("div",{className:"network-wrapper",style:{flex:M==="network"?"1 0 100%":M==="simulation"?"0 0 0%":`0 0 ${o.id==="spam_hidden"?"500px":"350px"}`,opacity:M==="simulation"?0:1,overflow:"hidden",maxWidth:M==="simulation"?"0px":"100%",transition:p,position:"relative",display:"flex",flexDirection:"column"},children:[l("button",{onClick:()=>I("network"),style:m,title:M==="network"?"Originalgröße":"Maximieren",children:M==="network"?l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M4 14h6v6"}),l("path",{d:"M20 10h-6V4"}),l("path",{d:"M14 10l7-7"}),l("path",{d:"M3 21l7-7"})]}):l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M15 3h6v6"}),l("path",{d:"M9 21H3v-6"}),l("path",{d:"M21 3l-7 7"}),l("path",{d:"M3 21l7-7"})]})}),l("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:l(Ge,{input:v,weight:y.current?y.current.weights||y.current.weight:0,bias:y.current?y.current.bias:0,output:y.current?y.current.predict(v):0,model:y.current,formula:x.formula,inputLabel:x.inputLabels||x.inputLabel,outputLabel:x.outputLabel,biasLabel:x.biasLabel,decimals:o.id.includes("spam")?0:1})})]})]}),l(Pn,{onTrain:C,onRun:P,onReset:z,isTraining:u,trainingStep:g,dataCount:_.length,trainerType:V,onTrainerTypeChange:U,simConfig:o})]})}function Cn({data:e,groundTruth:t,neuralNet:n}){const i=xt(null);return St(()=>{const o=i.current;if(!o)return;const r=o.getContext("2d"),c=o.width,h=o.height;if(r.clearRect(0,0,c,h),!e||e.length===0){r.fillStyle="#999",r.textAlign="center",r.fillText("Keine Daten vorhanden",c/2,h/2);return}const g=40,u=c-2*g,a=h-2*g,d=Math.max(...e.map(k=>k.input))||10,_=Math.max(...e.map(k=>k.target))||100,b=k=>g+k/d*u,y=k=>h-g-k/_*a;if(r.beginPath(),r.strokeStyle="#333",r.moveTo(g,g),r.lineTo(g,h-g),r.lineTo(c-g,h-g),r.stroke(),r.fillStyle="#333",r.textAlign="center",r.fillText("Zeit (t)",c/2,h-10),r.save(),r.translate(15,h/2),r.rotate(-Math.PI/2),r.fillText("Position (s)",0,0),r.restore(),e.forEach(k=>{const T=b(k.input),C=y(k.target);r.beginPath(),r.arc(T,C,3,0,Math.PI*2),r.fillStyle="#2ecc71",r.fill()}),n){r.beginPath(),r.strokeStyle="#e74c3c",r.lineWidth=2;for(let k=0;k<=d;k+=.1){const T=n.predict(k),C=b(k),P=y(T);k===0?r.moveTo(C,P):r.lineTo(C,P)}r.stroke()}},[e,t,n]),l("div",{style:{border:"1px solid #ccc",margin:"10px 0",borderRadius:"4px"},children:l("canvas",{ref:i,width:600,height:300,style:{width:"100%",display:"block"}})})}function An(){const e=ie("physics"),{simConfig:t,trainingData:n,groundTruth:i,trainingHistory:o,neuralNet:r,time:c,currentInput:h}=e;if(!t)return l("div",{className:"loading",children:"Lade Simulation..."});const g=t.CanvasComponent;return l(re,{hookState:e,renderSimulationView:()=>{let d=0;try{if(r.current){const _=h!==void 0?h:c;d=r.current.predict(_)}}catch(_){console.error("Predict Error",_)}return l("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:l(g,{time:c,data:n,currentInput:h!==void 0?h:c,currentPrediction:d,groundTruth:i.current,neuralNet:r.current})})},renderDataView:()=>l(Cn,{data:n,groundTruth:i.current,neuralNet:o.length>0?r.current:null})})}function Wn(){const e=ie("spam"),{simConfig:t,trainingData:n,groundTruth:i,trainingHistory:o,neuralNet:r}=e;if(!t)return l("div",{className:"loading",children:"Lade Simulation..."});const c=t.CanvasComponent;return l(re,{hookState:e,renderSimulationView:()=>l("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",border:"2px dashed #ddd",borderRadius:"8px",minHeight:"300px"},children:l("p",{style:{color:"#999"},children:'Daten-Visualisierung jetzt im "Daten" Tab'})}),renderDataView:()=>{const u={staticMode:!0,showGroundTruth:!0,showModel:o.length>0};return t.featuresConfig&&(u.features=t.featuresConfig),l(c,{time:0,data:n,groundTruth:i.current,neuralNet:r.current,...u})}})}function oe({simId:e}){const t=ie(e),{simConfig:n,trainingData:i,groundTruth:o,trainingHistory:r,neuralNet:c,time:h,currentInput:g,dataViewMode:u,setDataViewMode:a}=t;if(!n)return l("div",{className:"loading",children:"Lade Simulation..."});const d=n.CanvasComponent,_=l("div",{style:{display:"flex",justifyContent:"center"},children:l("div",{style:{background:"#eee",borderRadius:"4px",padding:"2px",display:"flex",gap:"2px"},children:[l("button",{onClick:()=>a("table"),style:{background:u==="table"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:u==="table"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:u==="table"?"bold":"normal",color:u==="table"?"#333":"#666"},children:"Tabelle"}),l("button",{onClick:()=>a("plot"),style:{background:u==="plot"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:u==="plot"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:u==="plot"?"bold":"normal",color:u==="plot"?"#333":"#666"},children:"Graph"})]})});return l(re,{hookState:t,renderSimulationView:()=>{let k=0;try{c.current&&(k=c.current.predict(g))}catch(C){console.error("Predict Error",C)}const T={allowedModes:["text"],hideControls:!0,features:n.featuresConfig};return l("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:l(d,{time:h,data:i,currentInput:g,currentPrediction:k,groundTruth:o.current,neuralNet:c.current,...T})})},renderDataView:()=>{const k={allowedModes:["scatter","3d","features"],showModel:r.length>0,additionalControls:_,features:n.featuresConfig};return l(d,{time:0,data:i,groundTruth:o.current,neuralNet:c.current,...k})}})}function Ln(){return l(oe,{simId:"spam_advanced"})}function Rn(){return l(oe,{simId:"spam_nonlinear"})}function zn(){return l(oe,{simId:"spam_hidden"})}function Dn(){const[e,t]=rt(0),n=[{name:"Simple Perceptron",input:.5,weight:.8,bias:.2,output:.6,inputLabel:"Input",formula:"y = w * x + b"},{name:"Spam Filter (2 Inputs)",input:[1,0],weight:[.5,-.2],bias:.1,output:.8,inputLabel:["Spam Word","Suspicious Link"],formula:"y = w1*x1 + w2*x2 + b"},{name:"Complex Model (5 Inputs)",input:[1,.5,-1,0,.2],weight:[.1,.2,.3,.4,.5],bias:-.5,output:.1,inputLabel:["F1","F2","F3","F4","F5"],formula:"y = Σ(wi*xi) + b"},{name:"Many Inputs (8 Inputs)",input:[1,0,1,0,1,0,1,0],weight:[.1,-.1,.1,-.1,.1,-.1,.1,-.1],bias:0,output:.5,inputLabel:["I1","I2","I3","I4","I5","I6","I7","I8"],formula:"y = ... "}],i=n[e];return l("div",{style:{padding:"20px"},children:[l("h2",{children:"Architecture Gallery"}),l("div",{style:{marginBottom:"20px"},children:[l("button",{onClick:()=>t((e-1+n.length)%n.length),children:"Previous"}),l("span",{style:{margin:"0 10px"},children:[i.name," (",e+1,"/",n.length,")"]}),l("button",{onClick:()=>t((e+1)%n.length),children:"Next"})]}),l("div",{style:{width:"400px",border:"1px dashed #ccc",padding:"10px"},children:l(Ge,{input:i.input,weight:i.weight,bias:i.bias,output:i.output,formula:i.formula,inputLabel:i.inputLabel})})]})}const $n=[{id:"physics",label:"Phase 1 (Physik)"},{id:"spam",label:"Phase 2 (Spam)"},{id:"spam_advanced",label:"Phase 3 (Spam Extended)"},{id:"spam_nonlinear",label:"Phase 4 (Nonlinear)"},{id:"spam_hidden",label:"Phase 5 (Deep)"}];function En(){const[e,t]=rt(null);return St(()=>{const o=new URLSearchParams(window.location.search).get("sim")||"physics";t(o)},[]),e?e==="gallery"?l("div",{className:"container",children:[l("header",{children:[l("h1",{children:"Neural Network Demonstrator"}),l("p",{children:"Architecture Gallery (Debug)"}),l("nav",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:l("a",{href:"?sim=physics",style:{marginRight:"10px"},children:"Back to App"})})]}),l("main",{children:l(Dn,{})})]}):l("div",{className:"container",children:[l("header",{children:[l("h1",{children:"Neural Network Demonstrator"}),l("p",{children:(i=>{switch(i){case"physics":return"Phase 1: Physik Simulation";case"spam":return"Phase 2: Spam Klassifikation (Basic)";case"spam_advanced":return"Phase 3: Spam Klassifikation (Erweitert)";case"spam_nonlinear":return"Phase 4: Nicht-Lineare Klassifikation";case"spam_hidden":return"Phase 5: Deep Learning (Hidden Layers)";default:return"Neural Network Demonstrator"}})(e)}),l("nav",{className:"sim-selector","aria-label":"Phasen-Auswahl",style:{fontSize:"0.8rem",marginTop:"5px"},children:$n.map(i=>l("a",{href:`?sim=${i.id}`,style:{marginRight:"10px",fontWeight:e===i.id?"bold":"normal",textDecoration:e===i.id?"underline":"none"},"aria-current":e===i.id?"page":void 0,children:i.label},i.id))})]}),l("main",{style:{height:"100%"},children:[e==="physics"&&l(An,{}),e==="spam"&&l(Wn,{}),e==="spam_advanced"&&l(Ln,{}),e==="spam_nonlinear"&&l(Rn,{}),e==="spam_hidden"&&l(zn,{})]})]}):l("div",{role:"status",children:"Lade App..."})}sn(l(En,{}),document.getElementById("app"));
