(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var Zt,et,Je,It,ke,Qe,tn,en,ce,ie,re,Nt={},nn=[],Tn=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Bt=Array.isArray;function At(e,t){for(var n in t)e[n]=t[n];return e}function de(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function oe(e,t,n){var i,r,o,l={};for(o in t)o=="key"?i=t[o]:o=="ref"?r=t[o]:l[o]=t[o];if(arguments.length>2&&(l.children=arguments.length>3?Zt.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)l[o]===void 0&&(l[o]=e.defaultProps[o]);return Ft(e,l,i,r,null)}function Ft(e,t,n,i,r){var o={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++Je,__i:-1,__u:0};return r==null&&et.vnode!=null&&et.vnode(o),o}function gt(e){return e.children}function Lt(e,t){this.props=e,this.context=t}function zt(e,t){if(t==null)return e.__?zt(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?zt(e):null}function rn(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return rn(e)}}function Me(e){(!e.__d&&(e.__d=!0)&&It.push(e)&&!jt.__r++||ke!=et.debounceRendering)&&((ke=et.debounceRendering)||Qe)(jt)}function jt(){for(var e,t,n,i,r,o,l,d=1;It.length;)It.length>d&&It.sort(tn),e=It.shift(),d=It.length,e.__d&&(n=void 0,i=void 0,r=(i=(t=e).__v).__e,o=[],l=[],t.__P&&((n=At({},i)).__v=i.__v+1,et.vnode&&et.vnode(n),ue(t.__P,n,i,t.__n,t.__P.namespaceURI,32&i.__u?[r]:null,o,r??zt(i),!!(32&i.__u),l),n.__v=i.__v,n.__.__k[n.__i]=n,an(o,n,l),i.__e=i.__=null,n.__e!=r&&rn(n)));jt.__r=0}function on(e,t,n,i,r,o,l,d,f,u,y){var a,v,p,g,b,x,S,k=i&&i.__k||nn,X=t.length;for(f=Cn(n,t,k,f,X),a=0;a<X;a++)(p=n.__k[a])!=null&&(v=p.__i==-1?Nt:k[p.__i]||Nt,p.__i=a,x=ue(e,p,v,r,o,l,d,f,u,y),g=p.__e,p.ref&&v.ref!=p.ref&&(v.ref&&he(v.ref,null,p),y.push(p.ref,p.__c||g,p)),b==null&&g!=null&&(b=g),(S=!!(4&p.__u))||v.__k===p.__k?f=sn(p,f,e,S):typeof p.type=="function"&&x!==void 0?f=x:g&&(f=g.nextSibling),p.__u&=-7);return n.__e=b,f}function Cn(e,t,n,i,r){var o,l,d,f,u,y=n.length,a=y,v=0;for(e.__k=new Array(r),o=0;o<r;o++)(l=t[o])!=null&&typeof l!="boolean"&&typeof l!="function"?(typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?l=e.__k[o]=Ft(null,l,null,null,null):Bt(l)?l=e.__k[o]=Ft(gt,{children:l},null,null,null):l.constructor==null&&l.__b>0?l=e.__k[o]=Ft(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):e.__k[o]=l,f=o+v,l.__=e,l.__b=e.__b+1,d=null,(u=l.__i=Pn(l,n,f,a))!=-1&&(a--,(d=n[u])&&(d.__u|=2)),d==null||d.__v==null?(u==-1&&(r>y?v--:r<y&&v++),typeof l.type!="function"&&(l.__u|=4)):u!=f&&(u==f-1?v--:u==f+1?v++:(u>f?v--:v++,l.__u|=4))):e.__k[o]=null;if(a)for(o=0;o<y;o++)(d=n[o])!=null&&(2&d.__u)==0&&(d.__e==i&&(i=zt(d)),cn(d,d));return i}function sn(e,t,n,i){var r,o;if(typeof e.type=="function"){for(r=e.__k,o=0;r&&o<r.length;o++)r[o]&&(r[o].__=e,t=sn(r[o],t,n,i));return t}e.__e!=t&&(i&&(t&&e.type&&!t.parentNode&&(t=zt(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Ut(e,t){return t=t||[],e==null||typeof e=="boolean"||(Bt(e)?e.some(function(n){Ut(n,t)}):t.push(e)),t}function Pn(e,t,n,i){var r,o,l,d=e.key,f=e.type,u=t[n],y=u!=null&&(2&u.__u)==0;if(u===null&&d==null||y&&d==u.key&&f==u.type)return n;if(i>(y?1:0)){for(r=n-1,o=n+1;r>=0||o<t.length;)if((u=t[l=r>=0?r--:o++])!=null&&(2&u.__u)==0&&d==u.key&&f==u.type)return l}return-1}function Se(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Tn.test(t)?n:n+"px"}function Vt(e,t,n,i,r){var o,l;t:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||Se(e.style,t,"");if(n)for(t in n)i&&n[t]==i[t]||Se(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")o=t!=(t=t.replace(en,"$1")),l=t.toLowerCase(),t=l in e||t=="onFocusOut"||t=="onFocusIn"?l.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?i?n.u=i.u:(n.u=ce,e.addEventListener(t,o?re:ie,o)):e.removeEventListener(t,o?re:ie,o);else{if(r=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function Te(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=ce++;else if(t.t<n.u)return;return n(et.event?et.event(t):t)}}}function ue(e,t,n,i,r,o,l,d,f,u){var y,a,v,p,g,b,x,S,k,X,V,K,tt,Z,T,h,W,w=t.type;if(t.constructor!=null)return null;128&n.__u&&(f=!!(32&n.__u),o=[d=t.__e=n.__e]),(y=et.__b)&&y(t);t:if(typeof w=="function")try{if(S=t.props,k="prototype"in w&&w.prototype.render,X=(y=w.contextType)&&i[y.__c],V=y?X?X.props.value:y.__:i,n.__c?x=(a=t.__c=n.__c).__=a.__E:(k?t.__c=a=new w(S,V):(t.__c=a=new Lt(S,V),a.constructor=w,a.render=Ln),X&&X.sub(a),a.state||(a.state={}),a.__n=i,v=a.__d=!0,a.__h=[],a._sb=[]),k&&a.__s==null&&(a.__s=a.state),k&&w.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=At({},a.__s)),At(a.__s,w.getDerivedStateFromProps(S,a.__s))),p=a.props,g=a.state,a.__v=t,v)k&&w.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),k&&a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(k&&w.getDerivedStateFromProps==null&&S!==p&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(S,V),t.__v==n.__v||!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(S,a.__s,V)===!1){for(t.__v!=n.__v&&(a.props=S,a.state=a.__s,a.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(m){m&&(m.__=t)}),K=0;K<a._sb.length;K++)a.__h.push(a._sb[K]);a._sb=[],a.__h.length&&l.push(a);break t}a.componentWillUpdate!=null&&a.componentWillUpdate(S,a.__s,V),k&&a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(p,g,b)})}if(a.context=V,a.props=S,a.__P=e,a.__e=!1,tt=et.__r,Z=0,k){for(a.state=a.__s,a.__d=!1,tt&&tt(t),y=a.render(a.props,a.state,a.context),T=0;T<a._sb.length;T++)a.__h.push(a._sb[T]);a._sb=[]}else do a.__d=!1,tt&&tt(t),y=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++Z<25);a.state=a.__s,a.getChildContext!=null&&(i=At(At({},i),a.getChildContext())),k&&!v&&a.getSnapshotBeforeUpdate!=null&&(b=a.getSnapshotBeforeUpdate(p,g)),h=y,y!=null&&y.type===gt&&y.key==null&&(h=ln(y.props.children)),d=on(e,Bt(h)?h:[h],t,n,i,r,o,l,d,f,u),a.base=t.__e,t.__u&=-161,a.__h.length&&l.push(a),x&&(a.__E=a.__=null)}catch(m){if(t.__v=null,f||o!=null)if(m.then){for(t.__u|=f?160:128;d&&d.nodeType==8&&d.nextSibling;)d=d.nextSibling;o[o.indexOf(d)]=null,t.__e=d}else{for(W=o.length;W--;)de(o[W]);se(t)}else t.__e=n.__e,t.__k=n.__k,m.then||se(t);et.__e(m,t,n)}else o==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):d=t.__e=An(n.__e,t,n,i,r,o,l,f,u);return(y=et.diffed)&&y(t),128&t.__u?void 0:d}function se(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(se)}function an(e,t,n){for(var i=0;i<n.length;i++)he(n[i],n[++i],n[++i]);et.__c&&et.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(o){o.call(r)})}catch(o){et.__e(o,r.__v)}})}function ln(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Bt(e)?e.map(ln):At({},e)}function An(e,t,n,i,r,o,l,d,f){var u,y,a,v,p,g,b,x=n.props||Nt,S=t.props,k=t.type;if(k=="svg"?r="http://www.w3.org/2000/svg":k=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),o!=null){for(u=0;u<o.length;u++)if((p=o[u])&&"setAttribute"in p==!!k&&(k?p.localName==k:p.nodeType==3)){e=p,o[u]=null;break}}if(e==null){if(k==null)return document.createTextNode(S);e=document.createElementNS(r,k,S.is&&S),d&&(et.__m&&et.__m(t,o),d=!1),o=null}if(k==null)x===S||d&&e.data==S||(e.data=S);else{if(o=o&&Zt.call(e.childNodes),!d&&o!=null)for(x={},u=0;u<e.attributes.length;u++)x[(p=e.attributes[u]).name]=p.value;for(u in x)if(p=x[u],u!="children"){if(u=="dangerouslySetInnerHTML")a=p;else if(!(u in S)){if(u=="value"&&"defaultValue"in S||u=="checked"&&"defaultChecked"in S)continue;Vt(e,u,null,p,r)}}for(u in S)p=S[u],u=="children"?v=p:u=="dangerouslySetInnerHTML"?y=p:u=="value"?g=p:u=="checked"?b=p:d&&typeof p!="function"||x[u]===p||Vt(e,u,p,x[u],r);if(y)d||a&&(y.__html==a.__html||y.__html==e.innerHTML)||(e.innerHTML=y.__html),t.__k=[];else if(a&&(e.innerHTML=""),on(t.type=="template"?e.content:e,Bt(v)?v:[v],t,n,i,k=="foreignObject"?"http://www.w3.org/1999/xhtml":r,o,l,o?o[0]:n.__k&&zt(n,0),d,f),o!=null)for(u=o.length;u--;)de(o[u]);d||(u="value",k=="progress"&&g==null?e.removeAttribute("value"):g!=null&&(g!==e[u]||k=="progress"&&!g||k=="option"&&g!=x[u])&&Vt(e,u,g,x[u],r),u="checked",b!=null&&b!=e[u]&&Vt(e,u,b,x[u],r))}return e}function he(e,t,n){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&t==null||(e.__u=e(t))}else e.current=t}catch(r){et.__e(r,n)}}function cn(e,t,n){var i,r;if(et.unmount&&et.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||he(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){et.__e(o,t)}i.base=i.__P=null}if(i=e.__k)for(r=0;r<i.length;r++)i[r]&&cn(i[r],t,n||typeof e.type!="function");n||de(e.__e),e.__c=e.__=e.__e=void 0}function Ln(e,t,n){return this.constructor(e,n)}function Wn(e,t,n){var i,r,o,l;t==document&&(t=document.documentElement),et.__&&et.__(e,t),r=(i=!1)?null:t.__k,o=[],l=[],ue(t,e=t.__k=oe(gt,null,[e]),r||Nt,Nt,t.namespaceURI,r?null:t.firstChild?Zt.call(t.childNodes):null,o,r?r.__e:t.firstChild,i,l),an(o,e,l)}Zt=nn.slice,et={__e:function(e,t,n,i){for(var r,o,l;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(e)),l=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,i||{}),l=r.__d),l)return r.__E=r}catch(d){e=d}throw e}},Je=0,Lt.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=At({},this.state),typeof e=="function"&&(e=e(At({},n),this.props)),e&&At(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),Me(this))},Lt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Me(this))},Lt.prototype.render=gt,It=[],Qe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,tn=function(e,t){return e.__v.__b-t.__v.__b},jt.__r=0,en=/(PointerCapture)$|Capture$/i,ce=0,ie=Te(!1),re=Te(!0);var In=0;function s(e,t,n,i,r,o){t||(t={});var l,d,f=t;if("ref"in f)for(d in f={},t)d=="ref"?l=t[d]:f[d]=t[d];var u={type:e,props:f,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--In,__i:-1,__u:0,__source:r,__self:o};if(typeof e=="function"&&(l=e.defaultProps))for(d in l)f[d]===void 0&&(f[d]=l[d]);return et.vnode&&et.vnode(u),u}var Ht,pt,Qt,Ce,Gt=0,dn=[],_t=et,Pe=_t.__b,Ae=_t.__r,Le=_t.diffed,We=_t.__c,Ie=_t.unmount,Re=_t.__;function fe(e,t){_t.__h&&_t.__h(pt,e,Gt||t),Gt=0;var n=pt.__H||(pt.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function lt(e){return Gt=1,Rn(hn,e)}function Rn(e,t,n){var i=fe(Ht++,2);if(i.t=e,!i.__c&&(i.__=[n?n(t):hn(void 0,t),function(d){var f=i.__N?i.__N[0]:i.__[0],u=i.t(f,d);f!==u&&(i.__N=[u,i.__[1]],i.__c.setState({}))}],i.__c=pt,!pt.__f)){var r=function(d,f,u){if(!i.__c.__H)return!0;var y=i.__c.__H.__.filter(function(v){return!!v.__c});if(y.every(function(v){return!v.__N}))return!o||o.call(this,d,f,u);var a=i.__c.props!==d;return y.forEach(function(v){if(v.__N){var p=v.__[0];v.__=v.__N,v.__N=void 0,p!==v.__[0]&&(a=!0)}}),o&&o.call(this,d,f,u)||a};pt.__f=!0;var o=pt.shouldComponentUpdate,l=pt.componentWillUpdate;pt.componentWillUpdate=function(d,f,u){if(this.__e){var y=o;o=void 0,r(d,f,u),o=y}l&&l.call(this,d,f,u)},pt.shouldComponentUpdate=r}return i.__N||i.__}function wt(e,t){var n=fe(Ht++,3);!_t.__s&&un(n.__H,t)&&(n.__=e,n.u=t,pt.__H.__h.push(n))}function yt(e){return Gt=5,$n(function(){return{current:e}},[])}function $n(e,t){var n=fe(Ht++,7);return un(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Dn(){for(var e;e=dn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Xt),e.__H.__h.forEach(ae),e.__H.__h=[]}catch(t){e.__H.__h=[],_t.__e(t,e.__v)}}_t.__b=function(e){pt=null,Pe&&Pe(e)},_t.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Re&&Re(e,t)},_t.__r=function(e){Ae&&Ae(e),Ht=0;var t=(pt=e.__c).__H;t&&(Qt===pt?(t.__h=[],pt.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(Xt),t.__h.forEach(ae),t.__h=[],Ht=0)),Qt=pt},_t.diffed=function(e){Le&&Le(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(dn.push(t)!==1&&Ce===_t.requestAnimationFrame||((Ce=_t.requestAnimationFrame)||zn)(Dn)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Qt=pt=null},_t.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Xt),n.__h=n.__h.filter(function(i){return!i.__||ae(i)})}catch(i){t.some(function(r){r.__h&&(r.__h=[])}),t=[],_t.__e(i,n.__v)}}),We&&We(e,t)},_t.unmount=function(e){Ie&&Ie(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{Xt(i)}catch(r){t=r}}),n.__H=void 0,t&&_t.__e(t,n.__v))};var $e=typeof requestAnimationFrame=="function";function zn(e){var t,n=function(){clearTimeout(i),$e&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,35);$e&&(t=requestAnimationFrame(n))}function Xt(e){var t=pt,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),pt=t}function ae(e){var t=pt;e.__c=e.__(),pt=t}function un(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function hn(e,t){return typeof t=="function"?t(e):t}function En(e){return function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}class Nn{constructor(t){this.model=t}async trainAsync(t,n,i){if(!Array.isArray(n)){const p=arguments[1],g=arguments[2],b=arguments[3];let x=p.min,S=g.min,k=1/0,X=[];const V=20;let K=0;for(let tt=p.min;tt<=p.max;tt+=p.step)for(let Z=g.min;Z<=g.max;Z+=g.step){const T=parseFloat(tt.toFixed(2)),h=parseFloat(Z.toFixed(2));this.model.setWeight(T),this.model.setBias(h);let W=0,w=0;for(const B of t){const O=this.model.predict(B.input),F=B.target-O;W+=F*F,w+=Math.abs(F)}const m=W/t.length,N=w/t.length;let C=0;for(const B of t)(this.model.predict(B.input)>=.5?1:0)===B.target&&C++;const M=C/t.length;m<k&&(k=m,x=T,S=h);const I={weight:T,bias:h,error:m,mae:N,accuracy:M};X.push(I),K++,K%V===0&&(b&&b(X,{bestWeight:x,bestBias:S,minError:k}),X=[],await new Promise(B=>setTimeout(B,0)))}return X.length>0&&b&&b(X,{bestWeight:x,bestBias:S,minError:k}),{bestWeight:x,bestBias:S,minError:k}}let o=1/0,l={},d=0;const f=50;let u=[];const y=p=>{const g=[];if(p.step<=0)return[p.min];for(let b=p.min;b<=p.max+1e-4;b+=p.step)g.push(parseFloat(b.toFixed(2)));return g},a=n.map(y),v=async(p,g)=>{if(p===n.length){const x=[];let S=0;g.forEach((W,w)=>{n[w].name.toLowerCase().includes("bias")?S=W:x.push(W)});let k={};this.model.setParams?(g.forEach((W,w)=>{k[n[w].name]=W}),this.model.setParams(k),S===void 0&&(S=0)):(this.model.setWeights?this.model.setWeights(x):this.model.setWeight&&this.model.setWeight(x[0]),this.model.setBias(S),k={weights:[...x],bias:S});let X=0,V=0;for(const W of t){const w=this.model.predict(W.input),m=W.target-w;X+=m*m,V+=Math.abs(m)}const K=X/t.length,tt=V/t.length;let Z=0;for(const W of t)(this.model.predict(W.input)>=.5?1:0)===W.target&&Z++;const T=Z/t.length;K<o&&(o=K,l=k);const h={params:[...g],error:K,mae:tt,accuracy:T};u.push(h),d++,d%f===0&&(i&&i(u,{bestParams:l,minError:o}),u=[],await new Promise(W=>setTimeout(W,0)));return}const b=a[p];for(const x of b)g[p]=x,await v(p+1,g)};return await v(0,new Array(n.length)),u.length>0&&i&&i(u,{bestParams:l,minError:o}),{bestParams:l,minError:o}}async trainRandomAsync(t,n,i,r={}){const{patience:o=5e3,seed:l,maxSteps:d=1e4,initialRadius:f=.8,phase1Ratio:u=.8}=r,y=d,a=f,v=.999,p=u;let g=1/0,b={},x=l;x==null?(x=Math.floor(Math.random()*2147483647),console.log(`[AdaptiveRandom] Generated Seed: ${x}`)):console.log(`[AdaptiveRandom] Using Seed: ${x}`);const S=En(x);let k=n.map(w=>({min:w.min,max:w.max,span:w.max-w.min})),X=k.map(w=>w.min+S()*w.span);const V=w=>{const m=[];let N=0;w.forEach((F,R)=>{n[R].name.toLowerCase().includes("bias")?N=F:m.push(F)});let C={};this.model.setParams?(w.forEach((F,R)=>{C[n[R].name]=F}),this.model.setParams(C)):(this.model.setWeights?this.model.setWeights(m):this.model.setWeight&&this.model.setWeight(m[0]),this.model.setBias(N),C={weights:m,bias:N});let M=0,I=0;for(const F of t){const R=this.model.predict(F.input),G=F.target-R;M+=G*G,I+=Math.abs(G)}let B=0;for(const F of t)(this.model.predict(F.input)>=.5?1:0)===F.target&&B++;const O=B/t.length;return{mse:M/t.length,mae:I/t.length,accuracy:O,decodedParams:C,weights:m,bias:N}};let K=V(X);g=K.mse,b=K.decodedParams?{...K.decodedParams,_array:[...X]}:{weights:K.weights,bias:K.bias,_array:[...X]},i&&i([{params:[...X],error:g,mae:K.mae,accuracy:K.accuracy}],{bestParams:b,minError:g}),await new Promise(w=>setTimeout(w,0));let tt=[];const Z=10;let T=g,h=[...X],W=0;for(let w=0;w<y;w++){const m=w<y*p;let N;if(m){const R=w/(y*p);N=a*(1-R*.5)}else N=a*.5*Math.pow(v,w-y*p);let C=!1;const M=[...h];let I=!1;for(;!I;)M.forEach((R,G)=>{if(S()<.4)return;I=!0;const P=k[G];let A=!1;if(m){const j=P.span*.3,nt=b._array&&Math.abs(R-b._array[G])<1e-9;nt&&R<P.min+j&&(P.min-=P.span*.4,P.span=P.max-P.min,A=!0),nt&&R>P.max-j&&(P.max+=P.span*.4,P.span=P.max-P.min,A=!0),A&&(C=!0)}let U=P.span*N;A&&(U=Math.max(U,P.span*.25));const _=U;let c=R+(S()-.5)*2*_;c<P.min&&(c=P.min),c>P.max&&(c=P.max),M[G]=c});const B=V(M),O=B.mse-T;let F=!1;if(O<0&&(F=!0),F&&(h=M,T=B.mse),B.mse<g?(g=B.mse,b=B.decodedParams?{...B.decodedParams,_array:[...M]}:{weights:B.weights,bias:B.bias,_array:[...M]},W=0):W++,W>=o&&!m)break;if(tt.push({params:[...M],error:B.mse,mae:B.mae,accuracy:B.accuracy}),tt.length>=Z){let R;C&&(R="Grenzen dynamisch erweitert..."),i&&i(tt,{bestParams:b,minError:g,message:R}),tt=[],await new Promise(G=>setTimeout(G,0))}}return tt.length>0&&i&&i(tt,{bestParams:b,minError:g}),{bestParams:b,minError:g}}}class Hn{constructor(t=30,n=50){this.velocity=t,this.initialPosition=n}getPosition(t){return this.velocity*t+this.initialPosition}}class Bn{constructor(){this.weight=0,this.bias=0}predict(t){return this.weight*t+this.bias}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function Yn({time:e,groundTruth:t,neuralNet:n,maxDistance:i=300}){const r=yt(null);wt(()=>{const l=r.current;if(!l)return;const d=l.getContext("2d"),f=l.width,u=l.height,y=50,a=f-2*y;d.clearRect(0,0,f,u);const v=t.getPosition(e),p=n.predict(e),g=y+v%i/i*a,b=y+p%i/i*a;d.fillStyle="#f0f0f0",d.fillRect(0,0,f,u/2),d.fillStyle="#e0e0e0",d.fillRect(0,u/2,f,u/2),d.beginPath(),d.strokeStyle="#fff",d.setLineDash([20,20]),d.moveTo(0,u/4),d.lineTo(f,u/4),d.moveTo(0,u*3/4),d.lineTo(f,u*3/4),d.stroke(),d.beginPath(),d.strokeStyle="#ccc",d.setLineDash([]),d.moveTo(y,0),d.lineTo(y,u),d.moveTo(f-y,0),d.lineTo(f-y,u),d.stroke(),o(d,g,u/4,"#2ecc71","Ground Truth"),o(d,b,u*3/4,"#e74c3c","Neural Net"),d.fillStyle="#333",d.font="14px monospace",d.fillText(`Zeit: ${e.toFixed(1)}s`,10,20),d.fillText(`Pos GT: ${v.toFixed(1)}m`,10,40),d.fillText(`Pos NN: ${p.toFixed(1)}m`,10,u/2+40)},[e,t,n,i]);function o(l,d,f,u,y){l.save(),l.translate(d,f),l.fillStyle=u,l.fillRect(-20,-10,40,20),l.fillStyle="#000",l.fillRect(-15,-15,10,5),l.fillRect(5,-15,10,5),l.fillRect(-15,10,10,5),l.fillRect(5,10,10,5),l.fillStyle="#000",l.font="10px sans-serif",l.textAlign="center",l.fillText(y,0,-20),l.restore()}return s("div",{style:{border:"2px solid #333",borderRadius:"8px",overflow:"hidden"},children:s("canvas",{ref:r,width:800,height:300,style:{width:"100%",display:"block"}})})}const De={id:"linear_regression",title:"Phase 1: Linear Regression",description:"A simple neuron learns the relationship between time and position. This corresponds to a linear regression.",collapseModelArchitectureByDefault:!0,Model:Bn,GroundTruth:Hn,CanvasComponent:Yn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[30,50],getInput:e=>e,generateData:e=>Array.from({length:20},(n,i)=>i*.5).map(n=>({input:n,target:e.getPosition(n)})),trainingConfig:{maxSteps:2e3,showAccuracyPlot:!1,params:[{name:"weight",min:0,max:60,step:1},{name:"bias",min:0,max:100,step:2}]},networkViz:{formula:"pos = w * t + b",inputLabel:"Zeit (t)",outputLabel:"Pos (m)",biasLabel:"b",showActivation:!1}};class Vn{constructor(t=.5,n=-5){this.weight=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){const n=this.sigmoid(this.weight*t+this.bias);return Math.random()<n?1:0}getProbability(t){return this.sigmoid(this.weight*t+this.bias)}}class On{constructor(){this.weight=0,this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=this.weight*t+this.bias;return this.sigmoid(n)}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function qt(e,t,n=10){if(e===t)return[e];const i=ze(t-e,!1),r=ze(i/(n-1),!0),o=Math.floor(e/r)*r,l=Math.ceil(t/r)*r,d=[],f=r/1e3;for(let u=o;u<l+r/2;u+=r)u>=e-f&&u<=t+f&&d.push(Number(u.toPrecision(12)));return d}function ze(e,t){const n=Math.floor(Math.log10(e)),i=e/Math.pow(10,n);let r;return t?i<1.5?r=1:i<3?r=2:i<7?r=5:r=10:i<=1?r=1:i<=2?r=2:i<=5?r=5:r=10,r*Math.pow(10,n)}function Fn({time:e,groundTruth:t,neuralNet:n,data:i,staticMode:r=!1,showModel:o=!0,showGroundTruth:l=!0,showProbabilities:d=!1}){const f=yt(null),[u,y]=lt({k:1,x:0,y:0}),[a,v]=lt(!1),p=yt({x:0,y:0}),[g,b]=lt(null),x=yt([]),S=T=>{T.preventDefault();const W=-T.deltaY*.001,w=u.k;let m=w*(1+W);m=Math.max(.5,Math.min(m,10));const N=f.current.getBoundingClientRect(),C=f.current.width/N.width,M=f.current.height/N.height,I=(T.clientX-N.left)*C,B=(T.clientY-N.top)*M,O=40,F=(I-O-u.x)/w,R=(B-(300-O)-u.y)/w,G=I-O-F*m,P=B-(300-O)-R*m;y({k:m,x:G,y:P})},k=T=>{v(!0),p.current={x:T.clientX,y:T.clientY}},X=T=>{const h=f.current;if(!h)return;const W=h.getBoundingClientRect(),w=h.width/W.width,m=h.height/W.height;if(a){const N=(T.clientX-p.current.x)*w,C=(T.clientY-p.current.y)*m;p.current={x:T.clientX,y:T.clientY},y(M=>({...M,x:M.x+N,y:M.y+C})),b(null)}else{const N=(T.clientX-W.left)*w,C=(T.clientY-W.top)*m;let M=null,I=15;const B=x.current;for(let O=B.length-1;O>=0;O--){const F=B[O],R=Math.sqrt(Math.pow(F.x-N,2)+Math.pow(F.y-C,2));R<I&&(I=R,M=F.info)}b(M)}},V=()=>v(!1),K=()=>{v(!1),b(null)},tt=yt(0),Z=()=>{const T=Date.now();T-tt.current<300&&b(null),tt.current=T};return wt(()=>{const T=f.current;if(!T)return;const h=T.getContext("2d"),W=T.width,w=T.height;h.clearRect(0,0,W,w),x.current=[];const m=40,N=W-2*m,C=w-2*m,M=0,I=20,B=1,O=D=>m+D/I*N*u.k+u.x,F=D=>w-m-D/B*C*u.k+u.y,R=D=>(D-m-u.x)/(N*u.k)*I,G=D=>-((D-(w-m)-u.y)/(C*u.k))*B,P=R(m),A=R(W-m),U=G(w-m),_=G(m),c=qt(P,A,10),j=qt(U,_,5);if(h.beginPath(),h.strokeStyle="#eee",h.lineWidth=1,h.fillStyle="#333",h.textAlign="center",h.textBaseline="top",h.font="10px sans-serif",c.forEach(D=>{const Q=O(D);Q<m||Q>W-m||(h.moveTo(Q,m),h.lineTo(Q,w-m),h.fillText(Number(D.toFixed(2)),Q,w-m+5))}),h.textAlign="right",h.textBaseline="middle",j.forEach(D=>{const Q=F(D);Q<m||Q>w-m||(h.moveTo(m,Q),h.lineTo(W-m,Q),h.fillText(Number(D.toFixed(2)),m-5,Q))}),h.stroke(),h.beginPath(),h.strokeStyle="#333",h.lineWidth=1,h.rect(m,m,N,C),h.stroke(),h.fillStyle="#333",h.textAlign="center",h.textBaseline="alphabetic",h.fillText("Number of 'Spam' Words",W/2,w-10),h.save(),h.translate(15,w/2),h.rotate(-Math.PI/2),h.textAlign="center",h.fillText("Spam Probability",0,0),h.restore(),h.save(),h.beginPath(),h.rect(m,m,N,C),h.clip(),o&&n&&((D,Q,at=[])=>{h.beginPath(),h.strokeStyle=Q,h.setLineDash(at),h.lineWidth=2;const z=Math.max(M,P),q=Math.min(I,A);if(q<z)return;const L=(q-z)/100,Y=Math.max(L,.05);let E=!1;for(let H=z;H<=q+Y;H+=Y){const $=Math.min(Math.max(H,M),I);let st=0;typeof D.getProbability=="function"?st=D.getProbability($):typeof D.predict=="function"&&(st=D.predict($));const it=O($),rt=F(st);E?h.lineTo(it,rt):(h.moveTo(it,rt),E=!0)}h.stroke(),h.setLineDash([])})(n,"#e74c3c"),r&&i)i.forEach(D=>{if(D.input<P-5||D.input>A+5)return;const Q=0,at=0,z=O(D.input),q=F(D.target);x.current.push({x:z,y:q,info:{x:z,y:q,input:D.input,target:D.target,type:"Ground Truth"}});let L=null;if(n&&o)try{L=n.predict(D.input)>.5?"#e74c3c":"#2ecc71"}catch{}if(d&&n&&typeof n.predict=="function")try{const Y=n.predict(D.input),E=F(Y);o&&(h.beginPath(),h.moveTo(z,q),h.lineTo(z,E),h.setLineDash([2,4]),h.strokeStyle="rgba(0,0,0,0.15)",h.lineWidth=1,h.stroke(),h.setLineDash([]));let H=null;n&&o&&(H=n.predict(D.input)>.5?"#e74c3c":"#2ecc71"),H&&(h.beginPath(),h.arc(z,E,6,0,Math.PI*2),h.strokeStyle=H,h.lineWidth=2,h.stroke()),x.current.push({x:z,y:E,info:{x:z,y:E,input:D.input,target:D.target,prediction:Y,type:"Prediction"}})}catch{}else L&&(h.beginPath(),h.arc(z+Q,q+at,8,0,Math.PI*2),h.strokeStyle=L,h.lineWidth=2,h.stroke());h.beginPath(),h.arc(z+Q,q+at,5,0,Math.PI*2),h.fillStyle=D.target===1?"#e74c3c":"#2ecc71",h.fill(),h.strokeStyle="#fff",h.lineWidth=1,h.stroke()});else if(!r){const Q=Math.floor(e*2),at=50,z=L=>{const Y=Math.sin(L*123.456)*1e4;return Y-Math.floor(Y)},q=Math.min(Q,at);for(let L=0;L<q;L++){const Y=z(L+1),E=Math.floor(Y*21),H=t?t.getProbability(E):0,$=z(L+999)<H?1:0;if(E<P-5||E>A+5)continue;const st=O(E),it=F($);let rt=null;if(n&&o)try{rt=n.predict(E)>.5?"#e74c3c":"#2ecc71"}catch{}if(d&&n&&typeof n.predict=="function")try{const ct=n.predict(E),ft=F(ct);o&&(h.beginPath(),h.moveTo(st,it),h.lineTo(st,ft),h.setLineDash([2,4]),h.strokeStyle="rgba(0,0,0,0.35)",h.lineWidth=1,h.stroke(),h.setLineDash([]));let xt=null;n&&o&&(xt=n.predict(E)>.5?"#e74c3c":"#2ecc71"),xt&&(h.beginPath(),h.arc(st,ft,6,0,Math.PI*2),h.strokeStyle=xt,h.lineWidth=2,h.stroke())}catch{}else rt&&(h.beginPath(),h.arc(finalX,finalY,8,0,Math.PI*2),h.strokeStyle=rt,h.lineWidth=2,h.stroke());h.beginPath(),h.arc(finalX,finalY,5,0,Math.PI*2),h.fillStyle=$?"#e74c3c":"#2ecc71",h.fill(),h.strokeStyle="#fff",h.lineWidth=1,h.stroke()}if(q>0&&q<=at){const L=q-1,Y=z(L+1),E=Math.floor(Y*21),H=t.getProbability(E),$=z(L+999)<H?1:0,st=0,it=0,rt=O(E)+st,ct=F($)+it;rt>m&&rt<W-m&&ct>m&&ct<w-m&&(h.beginPath(),h.arc(rt,ct,8,0,Math.PI*2),h.strokeStyle="#333",h.stroke(),h.fillStyle="#333",h.font="10px sans-serif",h.fillText(`${E}`,rt,ct-12))}}if(h.restore(),g){h.save(),h.fillStyle="rgba(0,0,0,0.8)",h.strokeStyle="#fff";const D=typeof g.prediction=="number"&&Number.isFinite(g.prediction),Q=g.type==="Prediction"&&D,at=D?g.prediction>.5?1:0:null,z=Q?at:g.target,q=z===1?"SPAM":"HAM",L=z===1?"#e74c3c":"#2ecc71",Y=`Words: ${g.input}`,E=g.type?`(${g.type})`:"",H=145,$=15,st=(D?1:0)+(Q?1:0),it=(g.type?35:25)+st*$;let rt=g.x+10,ct=g.y-10;rt+H>W&&(rt=g.x-H-10),ct+it>w&&(ct=g.y-it-10),ct<0&&(ct=g.y+10),h.beginPath(),h.roundRect(rt,ct,H,it,4),h.fill(),h.lineWidth=1,h.stroke(),h.textBaseline="top",h.textAlign="left",h.font="bold 11px sans-serif",h.fillStyle=L,h.fillText(`${q} ${E}`,rt+8,ct+6),h.fillStyle="#ddd",h.font="10px sans-serif",h.fillText(Y,rt+8,ct+20);let ft=ct+32;if(D&&(h.fillText(`Pred: ${g.prediction.toFixed(2)}`,rt+8,ft),ft+=$),Q){const xt=g.target===1?"SPAM":"HAM";h.fillText(`GT: ${xt}`,rt+8,ft)}h.restore()}},[e,t,n,i,r,o,l,d,u,g]),s("div",{className:"canvas-container",children:s("canvas",{ref:f,width:600,height:300,style:{width:"100%",border:"1px solid #ccc",background:"#fff",cursor:g?"pointer":a?"grabbing":"grab"},onWheel:S,onMouseDown:k,onMouseMove:X,onMouseUp:V,onMouseLeave:K,onClick:Z})})}const Et=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Ee={id:"logistic_regression",title:"Phase 2: Logistic Regression",description:'Classification of emails as "Spam" or "Not Spam" based on word count. This is a logistic regression.',collapseModelArchitectureByDefault:!1,Model:On,GroundTruth:Vn,CanvasComponent:Fn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[.5,-5],getInput:e=>{const t=Math.floor(e);return Math.floor(Et(t)*20)},generateData:e=>{const t=new Set(["FREE","WIN","PRIZE","CLAIM","URGENT","OFFER","BONUS","CLICK","LINK","NOW","LIMITED","DISCOUNT","VERIFY","ACCOUNT","PAYMENT","SUSPENDED","APPROVED","CASH","REWARD","SECURITY","ALERT","ACT","TODAY"]),n=p=>{const g=String(p||"").match(/[A-Z0-9]+/g)||[];let b=0;for(const x of g)t.has(x)&&b++;return b},i=(p,g)=>({input:n(p),target:g,text:p}),r=Array.from(t),o=(p,g)=>{const b=[...r];for(let x=b.length-1;x>0;x--){const S=Math.floor(Et(g+x*97)*(x+1));[b[x],b[S]]=[b[S],b[x]]}return b.slice(0,p)},l=["Project update","Quick question","Invoice follow up","Meeting schedule","Account notice","Delivery status","Action required","Weekly summary"],d=["Hi, just following up. Could you take a look when you have a moment?","Hello, sharing the details below. Thanks for your time.","Hey, can you confirm receipt and let me know if anything is missing?","Hi, please review and reply when convenient. Appreciate it.","Hello, sending this over for your review. Thanks."],f=(p,g)=>{const b=l[Math.floor(Et(g+11)*l.length)],x=d[Math.floor(Et(g+29)*d.length)],S=o(p,g+101),k=S.length?` ${S.join(" ")}`:"";return`Subject: ${b}${k}
${x}`},u=[];for(let p=0;p<=20;p++)u.push(p,p);for(let p=0;p<8;p++)u.push(p);const y=u.map((p,g)=>{const b=p*1e3+g,x=f(p,b),S=e?.getProbability?e.getProbability(p):0,k=Et(b+999);return{x:p,idx:g,text:x,score:S-k}}),a=new Set([...y].sort((p,g)=>g.score-p.score).slice(0,25).map(p=>p.idx));return y.map(p=>i(p.text,a.has(p.idx)?1:0)).sort((p,g)=>p.input-g.input)},trainingConfig:{maxSteps:3e3,params:[{name:"weight",min:0,max:2,step:.1},{name:"bias",min:-10,max:5,step:.5}]},networkViz:{formula:"p = σ(w * x + b)",inputLabel:"Spam Words",outputLabel:"Spam (p)",biasLabel:"b"},isFinished:e=>e>=25};class pe{constructor(t=[.5,.2,.8,-.1],n=-3){this.weights=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){let n=this.bias;const i=Math.min(this.weights.length,t?.length??0);for(let o=0;o<i;o++)n+=this.weights[o]*t[o];const r=this.sigmoid(n);return Math.random()<r?1:0}getProbability(t){let n=this.bias;const i=Math.min(this.weights.length,t?.length??0);for(let r=0;r<i;r++)n+=this.weights[r]*t[r];return this.sigmoid(n)}}class fn{constructor(t=3){this.weights=new Array(t).fill(0),this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){let n=this.bias;const i=Math.min(this.weights.length,t?.length??0);for(let r=0;r<i;r++)n+=this.weights[r]*t[r];return this.sigmoid(n)}setWeights(t){this.weights=[...t]}setBias(t){this.bias=t}setWeightAt(t,n){t>=0&&t<this.weights.length&&(this.weights[t]=n)}}const Xn=[{label:"Spam Words",idx:0,max:15},{label:"Links",idx:1,max:8},{label:"Total Words",idx:2,max:100}];function ge({data:e,currentInput:t,currentPrediction:n,neuralNet:i,allowedModes:r=["features","scatter","3d","text"],hideControls:o=!1,showModel:l=!0,additionalControls:d=null,features:f=Xn}){const u=_=>{const c=f.length;return!Number.isFinite(_)||c<=0?0:Math.max(0,Math.min(c-1,_))},y=(_,c,j)=>{const nt=f.length,D=u(_),Q=u(c),at=u(j);if(nt<3)return{x:D,y:Q,z:at};const z=new Set([D]);let q=Q;z.has(q)&&(q=Array.from({length:nt},(Y,E)=>E).find(Y=>!z.has(Y))??q),z.add(q);let L=at;return z.has(L)&&(L=Array.from({length:nt},(Y,E)=>E).find(Y=>!z.has(Y))??L),{x:D,y:q,z:L}},a=yt(null),v=r.filter(_=>_!=="3d"||f.length>=3),p=v[0]??r[0],[g,b]=lt(p);wt(()=>{v.includes(g)||b(v[0]??r[0])},[v,r,g]);const[x,S]=lt(0),[k,X]=lt(f.length>1?1:0),[V,K]=lt(f.length>2?2:f.length>1?1:0),[tt,Z]=lt(!1),[T,h]=lt({x:-.5,y:.5}),[W,w]=lt({k:1,x:0,y:0}),m=yt(!1),N=yt({x:0,y:0}),[C,M]=lt(null),I=yt([]),B=_=>{if(g!=="scatter")return;_.preventDefault();const j=-_.deltaY*.001,nt=W.k;let D=nt*(1+j);D=Math.max(.5,Math.min(D,50));const Q=a.current;if(!Q)return;const at=Q.getBoundingClientRect(),z=Q.width/at.width,q=Q.height/at.height,L=(_.clientX-at.left)*z,Y=(_.clientY-at.top)*q,E=50,H=Q.height-E,$=(L-E-W.x)/nt,st=(H+W.y-Y)/nt,it=L-E-$*D,rt=Y-H+st*D;w({k:D,x:it,y:rt})},O=_=>{g!=="3d"&&g!=="scatter"||(m.current=!0,N.current={x:_.clientX,y:_.clientY})},F=_=>{const c=a.current;if(!c)return;const j=c.getBoundingClientRect(),nt=c.width/j.width,D=c.height/j.height;if(m.current){const E=(_.clientX-N.current.x)*nt,H=(_.clientY-N.current.y)*D;N.current={x:_.clientX,y:_.clientY},g==="3d"?h($=>({x:$.x+H*.01,y:$.y+E*.01})):g==="scatter"&&w($=>({...$,x:$.x+E,y:$.y+H}));return}const Q=(_.clientX-j.left)*nt,at=(_.clientY-j.top)*D;let z=null,L=15;const Y=I.current;for(let E=Y.length-1;E>=0;E--){const H=Y[E],$=Math.sqrt((H.x-Q)**2+(H.y-at)**2);$<L&&(L=$,z=H.info)}M(z)},R=()=>{m.current=!1},G=()=>{M(null),m.current=!1},P=yt(0),A=()=>{const _=Date.now();_-P.current<300&&M(null),P.current=_};wt(()=>{if(g!=="3d")return;const _=y(x,k,V);(_.x!==x||_.y!==k||_.z!==V)&&(S(_.x),X(_.y),K(_.z))},[f.length,g,x,k,V]),wt(()=>{const _=a.current;if(!_)return;const c=_.getContext("2d"),j=_.width,nt=_.height;c.clearRect(0,0,j,nt),c.fillStyle="#fff",c.fillRect(0,0,j,nt),I.current=[];const D=z=>{if(!e||e.length===0)return f[z].max;const q=Math.max(...e.map(L=>L.input[z]));return q>0?q:f[z].max},Q=z=>z===2?"#3498db":z===1?"#e74c3c":"#2ecc71",at=z=>z===3?"CLASS 3":z===1?"SPAM":"HAM";if(g==="3d"){const z=D(x),q=D(k),L=D(V),Y=j/2,E=nt/2,H=150,$=(J,vt,kt)=>{let St=J*Math.cos(T.y)-kt*Math.sin(T.y),ot=J*Math.sin(T.y)+kt*Math.cos(T.y),dt=vt*Math.cos(T.x)-ot*Math.sin(T.x),mt=vt*Math.sin(T.x)+ot*Math.cos(T.x);const ut=400/(400-mt);return{x:Y+St*ut,y:E+dt*ut,z:mt}},it=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]].map(J=>$(J[0]*H,J[1]*H,J[2]*H)),rt="#e29301ff",ct="#2980b9",ft="#c00798ff",xt=(J,vt)=>{c.beginPath(),c.strokeStyle=vt,c.lineWidth=1,J.forEach(([kt,St])=>{c.moveTo(it[kt].x,it[kt].y),c.lineTo(it[St].x,it[St].y)}),c.stroke()};xt([[0,1],[3,2],[4,5],[7,6]],rt),xt([[0,3],[1,2],[4,7],[5,6]],ct),xt([[0,4],[1,5],[2,6],[3,7]],ft),c.font="bold 11px sans-serif",c.fillStyle=rt,c.fillText("X: "+f[x].label,it[1].x,it[1].y),c.fillStyle=ct,c.fillText("Y: "+f[k].label,it[3].x,it[3].y),c.fillStyle=ft,c.fillText("Z: "+f[V].label,it[4].x,it[4].y);const Ct=[],Pt=(J,vt)=>J/vt*2-1;if(l&&i&&i.weights){const J=i.weights[x]||0,vt=i.weights[k]||0,kt=i.weights[V]||0,St=i.bias||0;if(Math.abs(kt)>.001){c.strokeStyle="rgba(142, 68, 173, 0.3)",c.lineWidth=1;const ot=(ut,ht)=>{const Mt=(ut+1)/2*z,bt=(ht+1)/2*q,Wt=(-J*Mt-vt*bt-St)/kt;return Pt(Wt,L)},dt=(ut,ht)=>{if(Math.abs(ut.z)<=3&&Math.abs(ht.z)<=3){const Mt=$(ut.x*H,-ut.y*H,ut.z*H),bt=$(ht.x*H,-ht.y*H,ht.z*H);c.beginPath(),c.moveTo(Mt.x,Mt.y),c.lineTo(bt.x,bt.y),c.stroke()}},mt=6;for(let ut=0;ut<=mt;ut++){const ht=-1+ut/mt*2,Mt=ot(-1,ht),bt=ot(1,ht);dt({x:-1,y:ht,z:Mt},{x:1,y:ht,z:bt})}for(let ut=0;ut<=mt;ut++){const ht=-1+ut/mt*2,Mt=ot(ht,-1),bt=ot(ht,1);dt({x:ht,y:-1,z:Mt},{x:ht,y:1,z:bt})}}}e&&e.forEach(J=>{const vt=Pt(J.input[x],z),kt=-Pt(J.input[k],q),St=Pt(J.input[V],L),ot=$(vt*H,kt*H,St*H);let dt=null;if(i&&l)try{dt=i.predict(J.input)>.5?"#e74c3c":"#2ecc71"}catch{}Ct.push({...ot,color:Q(J.target),radius:3,haloColor:dt,pt:J})}),Ct.sort((J,vt)=>J.z-vt.z),Ct.forEach(J=>{J.z<3&&I.current.push({x:J.x,y:J.y,info:{x:J.x,y:J.y,text:J.pt.text,target:J.pt.target,isSpam:J.pt.target===1,features:{xLabel:f[x].label,xVal:J.pt.input[x],yLabel:f[k].label,yVal:J.pt.input[k],zLabel:f[V].label,zVal:J.pt.input[V]}}}),J.haloColor&&(c.beginPath(),c.arc(J.x,J.y,J.radius+2,0,Math.PI*2),c.strokeStyle=J.haloColor,c.lineWidth=1.5,c.stroke()),c.beginPath(),c.arc(J.x,J.y,J.radius,0,Math.PI*2),c.fillStyle=J.color,c.fill()})}if(g==="scatter"){const z=D(x),q=D(k),L=50,Y=j-2*L,E=nt-2*L,H=nt-L,$="#c0392b",st="#2980b9",it=ot=>L+ot/z*Y*W.k+W.x,rt=ot=>H-ot/q*E*W.k+W.y;c.save(),c.beginPath(),c.rect(L,L,Y,E),c.clip(),c.restore();const ct=ot=>(ot-L-W.x)/(Y*W.k)*z,ft=ot=>(H+W.y-ot)/(E*W.k)*q,xt=ct(L),Ct=ct(L+Y),Pt=ft(H),J=ft(L),vt=qt(Math.min(xt,Ct),Math.max(xt,Ct),8),kt=qt(Math.min(Pt,J),Math.max(Pt,J),6);if(c.lineWidth=1,c.strokeStyle="#eee",c.fillStyle="#666",c.font="10px sans-serif",c.textAlign="center",c.textBaseline="top",vt.forEach(ot=>{const dt=it(ot);dt<L||dt>L+Y||(c.beginPath(),c.moveTo(dt,L),c.lineTo(dt,H),c.stroke(),c.fillText(Number(ot.toFixed(2)),dt,H+5))}),c.textAlign="right",c.textBaseline="middle",kt.forEach(ot=>{const dt=rt(ot);dt<L||dt>H||(c.beginPath(),c.moveTo(L,dt),c.lineTo(L+Y,dt),c.stroke(),c.fillText(Number(ot.toFixed(2)),L-5,dt))}),c.strokeStyle="#ccc",c.lineWidth=2,c.strokeRect(L,L,Y,E),c.textAlign="center",c.font="bold 12px sans-serif",c.fillStyle=$,c.fillText(`${f[x].label}`,L+Y/2,H+30),c.save(),c.translate(15,H-E/2),c.rotate(-Math.PI/2),c.fillStyle=st,c.fillText(`${f[k].label}`,0,0),c.restore(),c.save(),c.beginPath(),c.rect(L,L,Y,E),c.clip(),tt&&i&&f.length===2){const dt=Math.floor(xt/.5)*.5,mt=Math.ceil(Ct/.5)*.5,ut=Math.floor(Pt/.5)*.5,ht=Math.ceil(J/.5)*.5;if((mt-dt)/.5*((ht-ut)/.5)<5e4)for(let bt=dt;bt<=mt;bt+=.5)for(let Wt=ut;Wt<=ht;Wt+=.5)try{const Yt=[0,0];x<2&&(Yt[x]=bt),k<2&&(Yt[k]=Wt);const $t=i.predict(Yt),ye=it(bt),be=rt(Wt),ve=it(bt+.5),we=rt(Wt+.5),yn=Math.abs(ve-ye),bn=Math.abs(be-we),vn=Math.min(ye,ve),wn=Math.min(be,we),kn=Math.round(46*(1-$t)+231*$t),Mn=Math.round(204*(1-$t)+76*$t),Sn=Math.round(113*(1-$t)+60*$t);c.fillStyle=`rgba(${kn}, ${Mn}, ${Sn}, 0.2)`,c.fillRect(vn,wn,yn+.5,bn+.5)}catch{}}const St=(ot,dt,mt,ut,ht)=>{const Mt=it(ot[x]),bt=rt(ot[k]);ht&&(c.beginPath(),c.arc(Mt,bt,mt+3,0,2*Math.PI),c.strokeStyle=ht,c.lineWidth=2,c.stroke()),c.beginPath(),c.arc(Mt,bt,mt,0,2*Math.PI),c.fillStyle=dt,c.fill(),ut&&(c.strokeStyle=ut,c.lineWidth=2,c.stroke())};e&&e.forEach(ot=>{const dt=it(ot.input[x]),mt=rt(ot.input[k]);if(dt<L||dt>L+Y||mt<L||mt>H)return;I.current.push({x:dt,y:mt,info:{x:dt,y:mt,text:ot.text,target:ot.target,isSpam:ot.target===1,features:{xLabel:f[x].label,xVal:ot.input[x],yLabel:f[k].label,yVal:ot.input[k]}}});let ut=null;if(i&&l)try{ut=i.predict(ot.input)>.5?"#e74c3c":"#2ecc71"}catch{}St(ot.input,Q(ot.target),5,"#fff",ut)}),t&&St(t,"#3498db",8,"#2980b9"),c.restore(),c.fillStyle="#666",c.textAlign="right",c.font="11px sans-serif",c.fillText("Red=Spam, Green=OK",j-10,20)}if(g==="text"){if(c.textAlign="center",c.textBaseline="middle",!t||!t.text){c.fillStyle="#999",c.font="20px sans-serif",c.fillText("No text available",j/2,nt/2);return}const z=n>.5,q=z?"#feeff0":"#effaf0";c.fillStyle=q,c.fillRect(0,0,j,nt);const L=t.text;c.fillStyle="#333",c.font="24px serif";const Y=L.split(" ");let E="";const H=35,$=j/2;let st=nt/3;const it=j-100;for(let ft=0;ft<Y.length;ft++){const xt=E+Y[ft]+" ";c.measureText(xt).width>it&&ft>0?(c.fillText(E,$,st),E=Y[ft]+" ",st+=H):E=xt}c.fillText(E,$,st),st+=60;const rt=t.groundTruth===1;c.font="bold 16px sans-serif",c.fillStyle="#555",c.fillText(`Truth: ${rt?"SPAM":"HAM"}`,$,st),st+=30;const ct=(n*100).toFixed(1);c.font="bold 20px sans-serif",c.fillStyle=z?"#c0392b":"#27ae60",c.fillText(`Prediction: ${z?"SPAM":"HAM"} (${ct}%)`,$,st);return}if(g==="features"){const L=Math.max(1,Math.ceil(f.length/2)),Y=(j-90)/2,E=(nt-(L+1)*30)/L;f.map(($,st)=>{const it=st%2,rt=Math.floor(st/2);return{x:30+it*(Y+30),y:30+rt*(E+30),...$}}).forEach($=>{if(c.strokeStyle="#ccc",c.strokeRect($.x,$.y,Y,E),c.fillStyle="#333",c.font="12px Arial",c.textAlign="center",c.fillText($.label,$.x+Y/2,$.y-5),e&&e.forEach(st=>{const it=st.input[$.idx],rt=$.x+it/$.max*Y,ct=$.y+E-st.target*(E-20)-10;I.current.push({x:rt,y:ct,info:{x:rt,y:ct,text:st.text,target:st.target,isSpam:st.target===1,features:{valLabel:$.label,val:it}}});let ft=null;if(i&&l)try{ft=i.predict(st.input)>.5?"#e74c3c":"#2ecc71"}catch{}ft&&(c.beginPath(),c.arc(rt,ct,4.5,0,2*Math.PI),c.strokeStyle=ft,c.lineWidth=1,c.stroke()),c.beginPath(),c.arc(rt,ct,3,0,2*Math.PI),c.fillStyle=Q(st.target),c.globalAlpha=.6,c.fill(),c.globalAlpha=1}),t){const st=t[$.idx],it=$.x+st/$.max*Y;c.beginPath(),c.moveTo(it,$.y),c.lineTo(it,$.y+E),c.strokeStyle="#3498db",c.setLineDash([5,5]),c.stroke(),c.setLineDash([])}})}if(C&&(g==="features"||g==="scatter"||g==="3d")){c.save(),c.fillStyle="rgba(0,0,0,0.85)",c.strokeStyle="#fff";const z=C.text||"No Text",q=at(C.target!==void 0?C.target:C.isSpam?1:0),L=c.measureText(z),Y=Math.max(L.width,140)+20;let E=70;C.features&&(C.features.zLabel?E=90:C.features.yLabel?E=85:E=60);let H=C.x+15,$=C.y-15;H+Y>j&&(H=C.x-Y-10),$+E>nt&&($=C.y-E-10),$<0&&($=C.y+20),c.beginPath(),c.roundRect(H,$,Y,E,5),c.fill(),c.lineWidth=1,c.stroke(),c.textBaseline="top",c.textAlign="left",c.font="bold 12px sans-serif",c.fillStyle=Q(C.target!==void 0?C.target:C.isSpam?1:0),c.fillText(q,H+10,$+10),c.fillStyle="#ddd",c.font="italic 11px sans-serif",c.fillText(z,H+10,$+28),C.features&&(c.fillStyle="#fff",c.font="11px monospace",C.features.xLabel?(c.fillText(`${C.features.xLabel}: ${C.features.xVal}`,H+10,$+46),c.fillText(`${C.features.yLabel}: ${C.features.yVal}`,H+10,$+60),C.features.zLabel&&c.fillText(`${C.features.zLabel}: ${C.features.zVal}`,H+10,$+74)):C.features.valLabel&&c.fillText(`${C.features.valLabel}: ${C.features.val}`,H+10,$+46)),c.restore()}},[e,t,n,i,g,x,k,V,T,l,W,tt]);const U={features:"Alle Features",scatter:"2D Plot","3d":"3D Plot",text:"Text Mode"};return s("div",{style:{textAlign:"center"},children:[!o&&s("div",{style:{marginBottom:"10px",display:"flex",gap:"5px",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",fontSize:"0.9rem"},children:[s("div",{children:d}),s("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[s("select",{value:g,onChange:_=>b(_.target.value),style:{padding:"4px"},children:v.map(_=>s("option",{value:_,children:U[_]},_))}),(g==="scatter"||g==="3d")&&s(gt,{children:[s("span",{children:"X:"}),s("select",{value:x,onChange:_=>S(parseInt(_.target.value)),style:{padding:"4px"},children:f.map(_=>s("option",{value:_.idx,children:_.label},_.idx))}),s("span",{children:"Y:"}),s("select",{value:k,onChange:_=>X(parseInt(_.target.value)),style:{padding:"4px"},children:f.map(_=>s("option",{value:_.idx,children:_.label},_.idx))})]}),g==="scatter"&&f.length===2&&s("label",{style:{display:"flex",alignItems:"center",gap:"3px",marginLeft:"5px",fontSize:"0.8rem",cursor:"pointer",background:"#f5f5f5",padding:"2px 5px",borderRadius:"3px",border:"1px solid #ddd"},children:[s("input",{type:"checkbox",checked:tt,onChange:_=>Z(_.target.checked)}),"Show Grid"]}),g==="3d"&&s(gt,{children:[s("span",{children:"Z:"}),s("select",{value:V,onChange:_=>K(parseInt(_.target.value)),style:{padding:"4px"},children:f.map(_=>s("option",{value:_.idx,children:_.label},_.idx))})]})]})]}),s("canvas",{ref:a,width:600,height:400,style:{border:"1px solid #eee",maxWidth:"100%",borderRadius:"4px",cursor:C?"pointer":g==="3d"||g==="scatter"?m.current?"grabbing":"grab":"default"},onWheel:B,onMouseDown:O,onMouseMove:F,onMouseUp:R,onMouseLeave:R,onMouseOut:G,onClick:A}),!o&&s("div",{class:"control-text",style:{fontSize:"0.8rem",color:"#666",marginTop:"5px"},children:g==="3d"?"Drag to rotate 3D view":g==="scatter"?"Drag to Pan, Scroll to Zoom":"Wähle Achsen für die Visualisierung"})]})}const Ne=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},te=e=>{const t=["winner","won","gift card","urgent","rolex","viagra","cash","prize","singles","marketing","buy","free","money","security alert","click","claim","fake","verification"],n=e.toLowerCase();let i=0;t.forEach(l=>{n.includes(l)&&(i+=1)}),i>10&&(i=10);const r=(e.match(/http/g)||[]).length,o=e.split(/\s+/).length;return[i,r,o]},Dt={id:"multiple_inputs",title:"Phase 3: Multiple Inputs",description:"Advanced spam detection with multiple linear features (spam words, links, total words). The network learns a separation line.",collapseModelArchitectureByDefault:!1,Model:fn,GroundTruth:pe,CanvasComponent:ge,defaultParams:{weights:[0,0,0],bias:0},groundTruthDefaults:[[1.5,2,-.5],-5],getInput:e=>{const t=Math.floor(e*.3),n=Ne(t)>.5,i=n?Dt.examples.spam:Dt.examples.ham,r=Math.floor(Ne(t+99)*i.length),o=i[r],l=te(o);return l.text=o,l.groundTruth=n?1:0,l},examples:{spam:["See the details here: http://rewards-center.example","Free sample available today: http://meds-offer.example","Winner: you won a prize and a free gift card. Click to claim at http://rewards-center.example","Urgent verification required. Security alert: click http://secure-verify.example to claim access","Buy Viagra today, free delivery. Claim cash bonus at http://meds-offer.example","Marketing promo: winner cash prize today. Click http://promo-redeem.example to claim now","Fake Rolex deal: buy now and claim a free upgrade at http://rolex-deals.example","Singles offer: click http://dating-now.example to claim your free match","Urgent: claim money refund. Click http://money-claim.example for verification","Winner notice: free cash prize inside. Claim at http://instant-prize.example http://promo-redeem.example","Security alert: verification needed—click http://account-check.example or http://secure-verify.example to claim access","Gift card bonus: claim your prize at http://gift-redeem.example http://rewards-center.example http://instant-prize.example http://promo-redeem.example"],ham:["Quick reminder: standup is 9:15 in Room B, please be on time.","Lunch at 12:30 today? If that works, I will book a table.","Can you review the slides and leave comments by end of day?","Your package is at reception; please pick it up before 5pm.","Security alert: new sign-in from your laptop. Verification is required in the portal.","Urgent: can you review the release checklist today and reply with any blockers?","Please click the doc link and confirm the numbers match the spreadsheet.","Hi team, here are the notes from today's planning session: scope, risks, and owners. Please add comments in the doc before Thursday afternoon.","Can you review the latest API changes and confirm the error codes match the spec? I pushed a small patch and added a checklist for QA.","Reminder: the workshop is next Wednesday at 10:00. Agenda and slides are here: http://intranet.example/events/workshop. Let me know if you have topics to add.","I updated the quarterly report draft with the new charts and assumptions. If you spot any inconsistencies, reply with the section number and your suggestion.","Thanks for your help earlier. I tested the release candidate on staging and everything looks stable, including the migration and rollback steps.","Could you send the updated invoice details for vendor ACME? Finance needs the PO number, billing address, and the cost center for this month.","Please confirm whether we should keep the current caching strategy for search results. I can write up the trade-offs and share a proposal tomorrow.","Fwd: travel itinerary for the conference. Flights and hotel are attached; the venue map is here: http://maps.example/venue. I'll arrive Monday evening.","Here are the references for the design review: http://intranet.example/designs/v2 and http://intranet.example/notes/1234. Please skim before the meeting.","I uploaded the draft docs and samples here: http://intranet.example/docs/api http://intranet.example/docs/errors http://intranet.example/docs/examples. Feedback welcome.","I created a short checklist for onboarding the new engineer: accounts, access requests, and first-week tasks. Happy to walk through it on our next call.","Do you have time to pair on the UI polish? I'd like to align on spacing, typography, and accessibility before we merge the final changes."]},generateData:e=>{const t=[];Dt.examples.spam.forEach(n=>{const i=te(n),r=()=>(Math.random()-.5)*.1,o=i.map(l=>Math.max(0,l+r()));t.push({input:o,target:1,text:n})}),Dt.examples.ham.forEach(n=>{const r=te(n).map(o=>Math.max(0,o+(Math.random()-.5)*.1));t.push({input:r,target:0,text:n})});for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t},trainingConfig:{maxSteps:3e3,params:[{name:"w1 (Spam Words)",min:1,max:4,step:.5},{name:"w2 (Links)",min:0,max:3,step:.5},{name:"w3 (Total Words)",min:-2,max:2,step:.5},{name:"bias",min:-8,max:8,step:2}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + w₃x₃ + b)",inputLabels:["Spam Words","Links","Total Words"],outputLabel:"Spam (p)",biasLabel:"b"},featuresConfig:[{label:"Spam Words",idx:0,max:15},{label:"Links",idx:1,max:8},{label:"Total Words",idx:2,max:100}],isFinished:e=>e>=50};class jn{constructor(t=2,n=10){this.inputCount=t,this.hiddenCount=n;const i=Math.sqrt(6/(t+n));this.weights1=Array(n).fill(0).map(()=>Array.from({length:t},()=>Math.random()*2*i-i)),this.biases1=Array(n).fill(0);const r=Math.sqrt(6/(n+1));this.weights2=Array.from({length:n},()=>Math.random()*2*r-r),this.bias2=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=[];for(let o=0;o<this.hiddenCount;o++){let l=this.biases1[o];for(let d=0;d<this.inputCount;d++)l+=this.weights1[o][d]*t[d];n.push(this.sigmoid(l))}let i=this.bias2;for(let o=0;o<this.hiddenCount;o++)i+=this.weights2[o]*n[o];return this.sigmoid(i)}getActivations(t){const n=[];for(let o=0;o<this.hiddenCount;o++){let l=this.biases1[o];for(let d=0;d<this.inputCount;d++)l+=this.weights1[o][d]*t[d];n.push(this.sigmoid(l))}let i=this.bias2;for(let o=0;o<this.hiddenCount;o++)i+=this.weights2[o]*n[o];const r=this.sigmoid(i);return{hidden:n,output:[r]}}setParams(t){for(let i=0;i<this.hiddenCount;i++){const r=`b1_${i}`;t[r]!==void 0&&(this.biases1[i]=t[r]);for(let o=0;o<this.inputCount;o++){const l=`w1_${i}_${o}`;t[l]!==void 0&&(this.weights1[i][o]=t[l])}}const n="b2";t[n]!==void 0&&(this.bias2=t[n]);for(let i=0;i<this.hiddenCount;i++){const r=`w2_${i}`;t[r]!==void 0&&(this.weights2[i]=t[r])}}getTopology(){return{inputCount:this.inputCount,hiddenCounts:[this.hiddenCount],outputCount:1,weights1:this.weights1,biases1:this.biases1,weights2:this.weights2,bias2:this.bias2}}}const pn=[{label:"Total Words",idx:0,max:400},{label:"Links",idx:1,max:10}],Kt=[{input:[367,5],target:0,text:"Attached is the quarterly report found at..."},{input:[365,2],target:0,text:"Attached is the quarterly report found at..."},{input:[364,6],target:0,text:"Attached is the quarterly report found at..."},{input:[327,7],target:0,text:"Attached is the quarterly report found at..."},{input:[302,5],target:0,text:"Attached is the quarterly report found at..."},{input:[314,3],target:0,text:"Attached is the quarterly report found at..."},{input:[345,4],target:0,text:"Attached is the quarterly report found at..."},{input:[265,5],target:0,text:"Attached is the quarterly report found at..."},{input:[287,4],target:0,text:"Attached is the quarterly report found at..."},{input:[311,1],target:0,text:"Attached is the quarterly report found at..."},{input:[268,2],target:0,text:"Attached is the quarterly report found at..."},{input:[283,0],target:0,text:"Attached is the quarterly report found at..."},{input:[261,3],target:0,text:"Attached is the quarterly report found at..."},{input:[197,0],target:0,text:"Just a normal short message."},{input:[150,0],target:0,text:"Just a normal short message."},{input:[124,0],target:0,text:"Just a normal short message."},{input:[65,1],target:0,text:"Just a normal short message."},{input:[85,0],target:0,text:"Just a normal short message."},{input:[58,0],target:0,text:"Just a normal short message."},{input:[45,0],target:0,text:"Security Alert: Login Code 2542"},{input:[36,0],target:0,text:"Security Alert: Login Code 5607"},{input:[38,1],target:0,text:"Security Alert: Login Code 909"},{input:[24,1],target:0,text:"Security Alert: Login Code 8385"},{input:[17,1],target:0,text:"Security Alert: Login Code 2083"},{input:[215,1],target:1,text:"You won a prize! Click here."},{input:[230,3],target:1,text:"You won a prize! Click here."},{input:[234,5],target:1,text:"You won a prize! Click here."},{input:[221,2],target:1,text:"You won a prize! Click here."},{input:[215,4],target:1,text:"You won a prize! Click here."},{input:[153,3],target:1,text:"You won a prize! Click here."},{input:[152,1],target:1,text:"You won a prize! Click here."},{input:[137,2],target:1,text:"You won a prize! Click here."},{input:[124,4],target:1,text:"You won a prize! Click here."},{input:[120,2],target:1,text:"You won a prize! Click here."},{input:[92,3],target:1,text:"You won a prize! Click here."},{input:[93,5],target:1,text:"You won a prize! Click here."},{input:[86,5],target:1,text:"You won a prize! Click here."},{input:[84,3],target:1,text:"You won a prize! Click here."},{input:[53,4],target:1,text:"You won a prize! Click here."},{input:[55,3],target:1,text:"You won a prize! Click here."}],le=()=>(console.log("Using prepared data with length "+Kt.length),Kt),He={id:"single_layer_nonlinear",title:"Phase 4: Single Layer Nonlinear Data",description:"Spam detection with only 2 features but complex distribution. A simple linear classifier (perceptron) will fail here.",collapseModelArchitectureByDefault:!1,Model:fn,GroundTruth:pe,CanvasComponent:ge,defaultParams:{weights:[0,0],bias:0},getInput:e=>{const t=Math.floor(e*.5)%Kt.length,n=Kt[t],i=[...n.input];return i.text=n.text,i.groundTruth=n.target,i},generateData:e=>le(),trainingConfig:{maxSteps:4e3,params:[{name:"w1 (Words)",min:-5,max:5,step:.5},{name:"w2 (Links)",min:-5,max:5,step:.5},{name:"bias",min:-10,max:10,step:1}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + b)",inputLabels:["Total Words","Links"],outputLabel:"Spam (p)",biasLabel:"b"},featuresConfig:pn,isFinished:e=>!1},Tt=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Un=(e,t)=>{if(!e)return"";const n=["login","verify","offer","invoice","tracking","reset","promo","survey"],i=["example.com","secure-mail.net","tracking-info.org","account-help.co","promo-deals.io"],r=[];for(let o=0;o<e;o++){const l=i[Math.floor(Tt(t+o*31)*i.length)],d=n[Math.floor(Tt(t+o*57)*n.length)];r.push(`http://${l}/${d}/${Math.floor(Tt(t+o*97)*9e3+1e3)}`)}return r.join(" ")},Be=(e,t)=>{const[n,i]=e.input,r=n*100+i*10+t,o=["Security notice","Login code","2FA code","Device sign-in","One-time password"],l=["Quarterly report attached","Project status update","Meeting notes and next steps","Draft contract for review","Budget summary"],d=["LIMITED OFFER inside","URGENT: VERIFY ACCOUNT","WIN a PRIZE today","FREE BONUS available","SECURITY ALERT: action required"],f=["Thanks,","Best regards,","Kind regards,","Sincerely,","—"],u=["Alex","Sam","Taylor","Jordan","Casey"][Math.floor(Tt(r+7)*5)],y=`${f[Math.floor(Tt(r+13)*f.length)]} ${u}`,a=Un(i,r+101);if(e.target===0&&n<60){const b=o[Math.floor(Tt(r+19)*o.length)],S=`Your login code is ${Math.floor(Tt(r+23)*9e5+1e5)}. It expires in 10 minutes.
If you did not request this, ignore this message.`;return`Subject: ${b}
${S}
${y}`}if(e.target===0){const b=l[Math.floor(Tt(r+29)*l.length)],x=["Hi team,","Sharing the latest update and a few action items for this week.","Please review when you have a moment and reply with any questions.",a?`References: ${a}`:""].filter(Boolean).join(`
`);return`Subject: ${b}
${x}
${y}`}const v=d[Math.floor(Tt(r+37)*d.length)],p=["CLICK LINK NOW to CLAIM your REWARD.","ACT NOW: LIMITED DISCOUNT expires TODAY.","VERIFY ACCOUNT to avoid SUSPENDED access.","WIN CASH PRIZE — CLAIM BONUS NOW.","FREE OFFER available — CLICK LINK to continue."],g=[p[Math.floor(Tt(r+41)*p.length)],a?`Links: ${a}`:"Links: http://promo-deals.io/offer/1234",y].join(`
`);return`Subject: ${v}
${g}`},Gn=()=>{const e=[];for(let t=0;t<10;t++){e.push({name:`b1_${t}`,min:-30,max:30,step:1});for(let n=0;n<2;n++)e.push({name:`w1_${t}_${n}`,min:-30,max:30,step:1})}e.push({name:"b2",min:-3,max:3,step:1});for(let t=0;t<10;t++)e.push({name:`w2_${t}`,min:-50,max:50,step:1});return e},Ye={id:"double_layer_nonlinear",title:"Phase 5: Double Layer Nonlinear Data",description:'Spam detection with a Hidden Layer (10 neurons). The Deep Neural Network can detect the nonlinear distribution ("Spam Island").',collapseModelArchitectureByDefault:!1,Model:jn,GroundTruth:pe,CanvasComponent:ge,defaultParams:{},getInput:e=>{const t=le(),n=Math.floor(e*.5)%t.length,i=t[n],r=[...i.input];return r.text=Be(i,n),r.groundTruth=i.target,r},generateData:e=>le().map((t,n)=>({...t,text:Be(t,n)})),trainingConfig:{seed:1319434789,maxSteps:1e4,params:Gn()},networkViz:{formula:"p = σ(W₂ · σ(W₁ · x + b₁) + b₂)",inputLabels:[`Total
Words`,"Links"],outputLabel:"Spam (p)",biasLabel:"b"},featuresConfig:pn,isFinished:e=>e>=50},Ve={[De.id]:De,[Ee.id]:Ee,[Dt.id]:Dt,[He.id]:He,[Ye.id]:Ye};function qn(e){return Ve[e]||Ve.linear_regression}function me(e){const[t,n]=lt(null),i=yt(null),r=yt(null),[o,l]=lt(0),[d,f]=lt(!1),[u,y]=lt([]),[a,v]=lt([]),[p,g]=lt(-1),[b,x]=lt(!1),[S,k]=lt("simulation"),[X,V]=lt("table"),[K,tt]=lt("random"),[Z,T]=lt("Ready."),h=yt(0);wt(()=>{if(!e)return;if(e==="gallery"){n({id:"gallery",type:"gallery"});return}const M=qn(e);if(!M){T("Error: Simulation not found.");return}try{if(i.current=new M.GroundTruth(...M.groundTruthDefaults||[]),r.current=new M.Model,M.defaultParams&&(M.defaultParams.weight!==void 0&&r.current.setWeight(M.defaultParams.weight),M.defaultParams.weights!==void 0&&r.current.setWeights&&r.current.setWeights(M.defaultParams.weights),M.defaultParams.bias!==void 0&&r.current.setBias(M.defaultParams.bias)),n(M),i.current)try{const I=M.generateData(i.current);y(I)}catch(I){console.error("Auto-generate data error:",I)}}catch(I){console.error("Initialization Error:",I),T(`Init Error: ${I.message}`)}},[e]),wt(()=>{let M;const I=B=>{if(!d)return;h.current===0&&(h.current=B);const O=(B-h.current)/1e3;h.current=B;const F=Math.min(O,.1);l(R=>{const P=R+F*3;return t&&t.isFinished&&t.isFinished(P)&&(f(!1),T("Simulation finished.")),P}),M=requestAnimationFrame(I)};return d&&(h.current=0,M=requestAnimationFrame(I)),()=>cancelAnimationFrame(M)},[d,t]);const W=()=>{l(0),f(!0),T("Simulation running..."),k("simulation")},w=()=>{f(!1),T("Simulation paused.")},m=()=>{d?w():W()},N=async()=>{try{if(u.length===0||!t)return;x(!0),g(0),v([]),T("Searching for optimal weight and bias (Live Visualization)..."),k("training");const M=new t.Model,I=new Nn(M),B=(F,R)=>{if(v(G=>{const P=[...G,...F];return g(P.length-1),P}),R&&R.message&&T(R.message),R&&R.bestParams)if(r.current.setParams)r.current.setParams(R.bestParams);else if(r.current.setWeights){const{weights:G,bias:P}=R.bestParams;r.current.setWeights(G),r.current.setBias(P)}else r.current.setWeight&&R.bestParams&&R.bestParams.weights&&R.bestParams.weights.length>=1&&(r.current.setWeight(R.bestParams.weights[0]),r.current.setBias(R.bestParams.bias));else R&&R.bestWeight!==void 0&&(r.current.setWeight(R.bestWeight),r.current.setBias(R.bestBias))};let O;if(K==="random"){T("Searching for optimal weight and bias (Random Search)...");const F={seed:t.trainingConfig.seed,maxSteps:t.trainingConfig.maxSteps,initialRadius:t.trainingConfig.initialRadius,phase1Ratio:t.trainingConfig.phase1Ratio};O=await I.trainRandomAsync(u,t.trainingConfig.params,B,F)}else t.trainingConfig.params?O=await I.trainAsync(u,t.trainingConfig.params,B):O=await I.trainAsync(u,t.trainingConfig.weightRange,t.trainingConfig.biasRange,B);T(`Training finished! Min Error: ${O.minError.toFixed(5)}`),x(!1)}catch(M){console.error("Training Error:",M),x(!1),T(`Training Error: ${M.message}`)}},C=t&&t.getInput?t.getInput(o):void 0;return{simConfig:t,groundTruth:i,neuralNet:r,time:o,currentInput:C,isRunning:d,trainingData:u,trainingHistory:a,trainingStepIndex:p,isTraining:b,activeTab:S,dataViewMode:X,trainerType:K,statusMsg:Z,handleTrain:N,handleRun:m,handleStop:w,toggleRun:m,setTrainerType:tt,setActiveTab:k,setDataViewMode:V}}function Kn({history:e,currentStepIndex:t,isTraining:n,paramsConfig:i,showAccuracyPlot:r=!0}){const o=yt(null),[l,d]=lt(0),f=6;wt(()=>{d(0)},[i]),wt(()=>{const y=o.current;if(!y||!e||e.length===0)return;const a=y.getContext("2d"),v=y.width,p=y.height;a.clearRect(0,0,v,p),a.fillStyle="#fff",a.fillRect(0,0,v,p);const g=Math.max(...e.map(Z=>Z.error)),x=!n&&e.length>0?e.length-1:t!==null&&t>=0?Math.min(t,e.length-1):-1;let S=-1,k=1/0;for(let Z=0;Z<=x;Z++)e[Z].error<k&&(k=e[Z].error,S=Z);let X=[];if(i){const Z=r?2:1,T=Z+i.length,h=l*f,W=Math.min(h+f,T),w=3,m=2,N=v/w,C=p/m;for(let M=h;M<W;M++){const I=M-h,B=I%w,O=Math.floor(I/w),F=B*N,R=O*C;if(r&&M===0){const G=Math.max(10,e.length-1);X.push({type:"accuracy_step",xLabel:"Training Step",xMin:0,xMax:G,yMode:"accuracy",getValue:(P,A)=>A,getYValue:P=>P.accuracy||0,offsetX:F,offsetY:R,w:N,h:C,showYAxis:!0})}else if(r&&M===1||!r&&M===0){const G=Math.max(10,e.length-1);X.push({type:"error_step",xLabel:"Training Step",xMin:0,xMax:G,yMode:"error_log",getValue:(P,A)=>A,getYValue:P=>P.error,offsetX:F,offsetY:R,w:N,h:C,showYAxis:!0})}else{const G=M-Z,P=i[G],A=e.map(c=>c.params[G]),U=Math.min(...A),_=Math.max(...A);X.push({type:"param_error",xLabel:P.name,xMin:U,xMax:_,yMode:"error_log",getValue:c=>c.params[G],getYValue:c=>c.error,offsetX:F,offsetY:R,w:N,h:C})}}}else{const Z=v/2,T=p/2,h=e.map(m=>m.weight),W=e.map(m=>m.bias),w=Math.max(10,e.length-1);X=[],r&&X.push({type:"accuracy_step",xLabel:"Accuracy",xMin:0,xMax:w,yMode:"accuracy",getValue:(m,N)=>N,getYValue:m=>m.accuracy||0,offsetX:0,offsetY:0,w:Z,h:T,showYAxis:!0}),X.push({type:"error_step",xLabel:"Step",xMin:0,xMax:w,yMode:"error_log",getValue:(m,N)=>N,getYValue:m=>m.error,offsetX:r?Z:0,offsetY:0,w:Z,h:T,showYAxis:!0},{xLabel:"Weight",xMin:Math.min(...h),xMax:Math.max(...h),yMode:"error_log",getValue:m=>m.weight,getYValue:m=>m.error,offsetX:r?0:Z,offsetY:r?T:0,w:Z,h:T},{xLabel:"Bias",xMin:Math.min(...W),xMax:Math.max(...W),yMode:"error_log",getValue:m=>m.bias,getYValue:m=>m.error,offsetX:r?Z:0,offsetY:T,w:Z,h:T})}const V=50;X.forEach(Z=>{const{xLabel:T,xMin:h,xMax:W,getValue:w,getYValue:m,offsetX:N,offsetY:C,w:M,h:I,yMode:B,showYAxis:O}=Z,F=P=>N+V+(P-h)/(W-h||1)*(M-2*V);let R;if(B==="accuracy")R=P=>C+I-V-P*(I-2*V);else{const A=g||1;R=U=>{const _=(U-0)/(A-0);return C+I-V-_*(I-2*V)}}a.strokeStyle="#eee",a.lineWidth=2,a.strokeRect(N,C,M,I),a.beginPath(),a.strokeStyle="#333",a.lineWidth=2,a.moveTo(N+V,C+V),a.lineTo(N+V,C+I-V),a.lineTo(N+M-V,C+I-V),a.stroke(),a.fillStyle="#333",a.font="22px sans-serif",a.textAlign="center";let G=T;if(G.length>20&&(G=G.substring(0,18)+"..."),a.fillText(G,N+M/2,C+I-15),N===0||O)if(a.save(),a.translate(N+15,C+I/2),a.rotate(-Math.PI/2),B==="accuracy")a.fillText("Accuracy",0,0),a.restore(),a.textAlign="right",a.fillStyle="#666",a.font="18px sans-serif",[0,.25,.5,.75,1].forEach(P=>{const A=R(P);a.fillText(P.toFixed(2),N+V-8,A+6),a.beginPath(),a.lineWidth=1,a.strokeStyle="#f0f0f0",a.moveTo(N+V,A),a.lineTo(N+M-V,A),a.stroke()});else{a.fillText("Error",0,0),a.restore(),a.textAlign="right",a.fillStyle="#666",a.font="18px sans-serif";const P=5;for(let A=0;A<=P;A++){const U=A/P*g,_=R(U);a.fillText(U.toFixed(2),N+V-8,_+6),A>0&&(a.beginPath(),a.lineWidth=1,a.strokeStyle="#f0f0f0",a.moveTo(N+V,_),a.lineTo(N+M-V,_),a.stroke())}}a.fillStyle="#666",a.font="18px sans-serif",a.textAlign="center",a.fillText(h.toFixed(1),N+V,C+I-V+25),a.fillText(W.toFixed(1),N+M-V,C+I-V+25),a.fillStyle=B==="accuracy"?"rgba(155, 89, 182, 0.4)":"rgba(52, 152, 219, 0.4)";for(let P=0;P<=x;P++){const A=w(e[P],P),U=m(e[P]),_=F(A),c=R(U);a.fillRect(_,c,4,4)}if(S>=0){const P=w(e[S],S),A=m(e[S]),U=F(P),_=R(A);a.beginPath(),a.fillStyle="#2ecc71",a.strokeStyle="#27ae60",a.lineWidth=2,a.arc(U,_,10,0,Math.PI*2),a.fill(),a.stroke()}if(n&&t!==null&&t>=0&&t<=x){const P=w(e[t],t),A=m(e[t]),U=F(P),_=R(A);a.beginPath(),a.fillStyle="#e74c3c",a.strokeStyle="#c0392b",a.lineWidth=2,a.arc(U,_,8,0,Math.PI*2),a.fill(),a.stroke()}});const K=v-150,tt=20;a.fillStyle="rgba(255,255,255,0.9)",a.fillRect(K,tt,140,70),a.strokeStyle="#ccc",a.lineWidth=1,a.strokeRect(K,tt,140,70),a.textAlign="left",a.font="16px sans-serif",a.beginPath(),a.fillStyle="#e74c3c",a.arc(K+15,tt+20,6,0,Math.PI*2),a.fill(),a.fillStyle="#333",a.fillText("Current Scan",K+30,tt+25),a.beginPath(),a.fillStyle="#2ecc71",a.arc(K+15,tt+50,6,0,Math.PI*2),a.fill(),a.fillStyle="#333",a.fillText("Best So Far",K+30,tt+55),!n&&S>=0&&(a.fillStyle="#333",a.font="bold 18px sans-serif",a.textAlign="right",a.textBaseline="bottom",a.fillText(`Min Error: ${k.toFixed(5)}`,v-20,p-8))},[e,t,n,i,l]);const u=i?Math.ceil((i.length+1)/f):1;return s("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff"},children:[s("canvas",{ref:o,width:1600,height:800,style:{width:"100%",height:"auto"}}),u>1&&s("div",{style:{display:"flex",justifyContent:"center",marginTop:"10px",gap:"10px"},children:[s("button",{onClick:()=>d(y=>Math.max(0,y-1)),disabled:l===0,children:"Previous"}),s("span",{style:{alignSelf:"center"},children:["Page ",l+1," of ",u]}),s("button",{onClick:()=>d(y=>Math.min(u-1,y+1)),disabled:l===u-1,children:"Next"})]})]})}function Zn(e,t){for(var n in t)e[n]=t[n];return e}function Oe(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var i in t)if(i!=="__source"&&e[i]!==t[i])return!0;return!1}function Fe(e,t){this.props=e,this.context=t}(Fe.prototype=new Lt).isPureReactComponent=!0,Fe.prototype.shouldComponentUpdate=function(e,t){return Oe(this.props,e)||Oe(this.state,t)};var Xe=et.__b;et.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Xe&&Xe(e)};var Jn=et.__e;et.__e=function(e,t,n,i){if(e.then){for(var r,o=t;o=o.__;)if((r=o.__c)&&r.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t)}Jn(e,t,n,i)};var je=et.unmount;function gn(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(i){typeof i.__c=="function"&&i.__c()}),e.__c.__H=null),(e=Zn({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(i){return gn(i,t,n)})),e}function mn(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(i){return mn(i,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function ee(){this.__u=0,this.o=null,this.__b=null}function _n(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Ot(){this.i=null,this.l=null}et.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),je&&je(e)},(ee.prototype=new Lt).__c=function(e,t){var n=t.__c,i=this;i.o==null&&(i.o=[]),i.o.push(n);var r=_n(i.__v),o=!1,l=function(){o||(o=!0,n.__R=null,r?r(d):d())};n.__R=l;var d=function(){if(!--i.__u){if(i.state.__a){var f=i.state.__a;i.__v.__k[0]=mn(f,f.__c.__P,f.__c.__O)}var u;for(i.setState({__a:i.__b=null});u=i.o.pop();)u.forceUpdate()}};i.__u++||32&t.__u||i.setState({__a:i.__b=i.__v.__k[0]}),e.then(l,l)},ee.prototype.componentWillUnmount=function(){this.o=[]},ee.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=gn(this.__b,n,i.__O=i.__P)}this.__b=null}var r=t.__a&&oe(gt,null,e.fallback);return r&&(r.__u&=-33),[oe(gt,null,t.__a?null:e.children),r]};var Ue=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};(Ot.prototype=new Lt).__a=function(e){var t=this,n=_n(t.__v),i=t.l.get(e);return i[0]++,function(r){var o=function(){t.props.revealOrder?(i.push(r),Ue(t,e,i)):r()};n?n(o):o()}},Ot.prototype.render=function(e){this.i=null,this.l=new Map;var t=Ut(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},Ot.prototype.componentDidUpdate=Ot.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){Ue(e,n,t)})};var Qn=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,ti=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,ei=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,ni=/[A-Z0-9]/g,ii=typeof document<"u",ri=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};Lt.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Lt.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Ge=et.event;function oi(){}function si(){return this.cancelBubble}function ai(){return this.defaultPrevented}et.event=function(e){return Ge&&(e=Ge(e)),e.persist=oi,e.isPropagationStopped=si,e.isDefaultPrevented=ai,e.nativeEvent=e};var li={enumerable:!1,configurable:!0,get:function(){return this.class}},qe=et.vnode;et.vnode=function(e){typeof e.type=="string"&&(function(t){var n=t.props,i=t.type,r={},o=i.indexOf("-")===-1;for(var l in n){var d=n[l];if(!(l==="value"&&"defaultValue"in n&&d==null||ii&&l==="children"&&i==="noscript"||l==="class"||l==="className")){var f=l.toLowerCase();l==="defaultValue"&&"value"in n&&n.value==null?l="value":l==="download"&&d===!0?d="":f==="translate"&&d==="no"?d=!1:f[0]==="o"&&f[1]==="n"?f==="ondoubleclick"?l="ondblclick":f!=="onchange"||i!=="input"&&i!=="textarea"||ri(n.type)?f==="onfocus"?l="onfocusin":f==="onblur"?l="onfocusout":ei.test(l)&&(l=f):f=l="oninput":o&&ti.test(l)?l=l.replace(ni,"-$&").toLowerCase():d===null&&(d=void 0),f==="oninput"&&r[l=f]&&(l="oninputCapture"),r[l]=d}}i=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=Ut(n.children).forEach(function(u){u.props.selected=r.value.indexOf(u.props.value)!=-1})),i=="select"&&r.defaultValue!=null&&(r.value=Ut(n.children).forEach(function(u){u.props.selected=r.multiple?r.defaultValue.indexOf(u.props.value)!=-1:r.defaultValue==u.props.value})),n.class&&!n.className?(r.class=n.class,Object.defineProperty(r,"className",li)):(n.className&&!n.class||n.class&&n.className)&&(r.class=r.className=n.className),t.props=r})(e),e.$$typeof=Qn,qe&&qe(e)};var Ke=et.__r;et.__r=function(e){Ke&&Ke(e),e.__c};var Ze=et.diffed;et.diffed=function(e){Ze&&Ze(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value)};function ci({model:e,inputs:t,inputLabels:n,output:i,outputLabel:r,formula:o,collapseModelArchitectureByDefault:l}){if(!e||!e.getTopology)return null;const d=e.getTopology(),{inputCount:f,hiddenCounts:u,outputCount:y,weights1:a,biases1:v,weights2:p}=d,g=d.biases2||(d.bias2!==void 0?[d.bias2]:null);let b={hidden:[],output:[]};e.getActivations&&(b=e.getActivations(t));const[x,S]=lt(null),[k,X]=lt(!1),V=typeof l=="boolean"?l:!1,[K,tt]=lt(!V),Z=400,T=400,h=T/2,W=Z/2,w=300,m=300,N=W-w/2,C=W+w/2,M=[{count:f,x:N,labels:n,values:t},{count:u[0],x:W,values:b.hidden},{count:y,x:C,labels:[r],values:b.output}];Math.max(...M.map(A=>A.count));const I=(A,U)=>{const _=M[A].count;let c=Math.min(50,m/_);const j=(_-1)*c;return h-j/2+U*c},B=(A,U)=>{x&&x.layer===A&&x.index===U?S(null):S({layer:A,index:U})},O=(A,U,_,c)=>x?x.layer===A&&x.index===U||x.layer===_&&x.index===c:!1,F=(A,U)=>x&&x.layer===A&&x.index===U;if(k)return s("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center",height:"400px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[s("div",{style:{flex:"0 0 auto",marginBottom:"10px"},children:s("h3",{style:{margin:"0",fontSize:"1rem",color:"#555"},children:"Network Parameters"})}),s("div",{style:{flex:"1 1 auto",overflow:"auto",display:"flex",justifyContent:"center",alignItems:"flex-start"},children:s("div",{style:{display:"flex",gap:"20px",alignItems:"flex-start",justifyContent:"center",flexWrap:"wrap",paddingBottom:"10px"},children:[s("div",{style:{textAlign:"center"},children:[s("h4",{style:{fontSize:"0.9rem",marginBottom:"5px"},children:"Layer 1 Weights"}),s(di,{data:a}),s("h4",{style:{fontSize:"0.9rem",marginBottom:"5px",marginTop:"10px"},children:"Layer 1 Biases"}),s(ne,{data:v})]}),s("div",{style:{textAlign:"center"},children:[s("h4",{style:{fontSize:"0.9rem",marginBottom:"5px"},children:"Layer 2 Weights (to Output)"}),s(ne,{data:Array.isArray(p[0])?p.flat():p,isVertical:!0}),g&&s(gt,{children:[s("h4",{style:{fontSize:"0.9rem",marginBottom:"5px",marginTop:"10px"},children:"Layer 2 Bias"}),s(ne,{data:Array.isArray(g)?g:[g]})]})]})]})}),s("div",{style:{flex:"0 0 auto",marginTop:"10px",cursor:"pointer",fontStyle:"italic",color:"#777",padding:"5px"},onClick:()=>X(!1),children:"Back to Network"})]});const R=[{fill:"#e3f2fd",stroke:"#2196f3",highlight:"#1976d2"},{fill:"#f3e5f5",stroke:"#9c27b0",highlight:"#7b1fa2"},{fill:"#e8f5e9",stroke:"#4caf50",highlight:"#388e3c"}],G="#bdbdbd",P="#ff9800";return s("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center"},children:[s("h3",{style:{marginBottom:"10px",fontSize:"1rem",color:"#555"},children:"Neural Network Activity"}),s("svg",{width:Z,height:T,style:{overflow:"visible"},children:[s("rect",{x:N,y:h-m/2,width:w,height:m,rx:"15",fill:"transparent",stroke:"#333",strokeWidth:"2",style:{cursor:"pointer"},onClick:()=>tt(A=>!A)}),K&&a.map((A,U)=>A.map((_,c)=>{const j=O(0,c,1,U),nt=x&&!j,D=j?P:G,Q=j?3:1.5,at=nt?.2:1;return s("line",{x1:M[0].x,y1:I(0,c),x2:M[1].x,y2:I(1,U),stroke:D,strokeWidth:Q,strokeOpacity:at,style:{transition:"all 0.3s ease"}},`L0-${c}-${U}`)})),K&&p.map((A,U)=>{const _=O(1,U,2,0),c=x&&!_,j=_?P:G,nt=_?3:1.5,D=c?.2:1;return s("line",{x1:M[1].x,y1:I(1,U),x2:M[2].x,y2:I(2,0),stroke:j,strokeWidth:nt,strokeOpacity:D,style:{transition:"all 0.3s ease"}},`L1-${U}-0`)}),(K?M:[M[0],M[2]]).map((A,U)=>{const _=K?U:U===0?0:2;return s("g",{children:Array.from({length:A.count}).map((c,j)=>{const nt=A.x,D=I(_,j),Q=A.values&&A.values[j]!==void 0?A.values[j]:0,at=F(_,j),z=R[_]||R[0];return s("g",{onClick:()=>B(_,j),style:{cursor:"pointer"},children:[s("circle",{cx:nt,cy:D,r:12,fill:at?z.highlight:z.fill,stroke:z.stroke,strokeWidth:at?"3":"2",style:{transition:"all 0.3s ease"}}),A.labels&&s("text",{x:_===0?nt-18:nt+18,y:D,textAnchor:_===0?"end":"start",style:{textAnchor:_===0?"end":"start",pointerEvents:"none"},dominantBaseline:"middle",fontSize:"14",fontWeight:"600",fill:"#444",children:(A.labels[j]||"").toString().split(`
`).map((q,L,Y)=>s("tspan",{x:_===0?nt-18:nt+18,dy:L===0?`${(Y.length-1)*-.6}em`:"1.2em",children:q},L))}),s("title",{children:Q.toFixed(3)})]},`n-${_}-${j}`)})},`layer-${_}`)}),K&&o&&s("foreignObject",{className:"formula",x:W-200,y:T-25,width:400,height:20,children:s("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",fontSize:"18px",fontStyle:"italic",color:"#777",cursor:"pointer",userSelect:"none"},onClick:()=>X(!0),title:"Click to view matrices",children:o})})]})]})}function di({data:e}){return e?s("div",{style:{display:"grid",gridTemplateColumns:`repeat(${e[0].length}, 1fr)`,gap:"2px",border:"1px solid #999",padding:"2px",background:"#eee"},children:e.map((t,n)=>t.map((i,r)=>s("div",{style:{padding:"2px 4px",background:"#fff",fontSize:"10px",textAlign:"center"},children:i.toFixed(2)},`${n} -${r} `)))}):null}function ne({data:e,isVertical:t=!1}){if(!e)return null;const n=Array.isArray(e)?e:[e];return s("div",{style:{display:"flex",flexDirection:t?"column":"row",gap:"2px",border:"1px solid #999",padding:"2px",background:"#eee"},children:n.map((i,r)=>s("div",{style:{padding:"2px 4px",background:"#fff",fontSize:"10px",textAlign:"center"},children:i.toFixed(2)},r))})}function xn({input:e,weight:t,bias:n,output:i,formula:r="y = w * x + b",inputLabel:o="Input",outputLabel:l="Output",biasLabel:d="b",decimals:f=1,model:u=null,collapseModelArchitectureByDefault:y,showActivation:a=!0}){const v=typeof y=="boolean"?y:!1,[p,g]=lt(!v);if(u&&u.getTopology){let A=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(A=e.input);const U=Array.isArray(A)?A:[A],_=Array.isArray(o)?o:[o];return s(ci,{model:u,inputs:U,inputLabels:_,output:i,outputLabel:l,formula:r,collapseModelArchitectureByDefault:v})}let b=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(b=e.input);const x=Array.isArray(b)?b:[b],S=Array.isArray(t)?t:[t],k=Array.isArray(o)?o:[o],X=Number(n)||0,V=Number(i)||0,K=x.length,tt=24,Z=90,T=260,h=60,W=60,w=Math.max(1,K-1)*Z,m=Math.max(150,w+h+W),N=m+60,C=600,M=C/2+10,I=M-T/2,B=M+T/2,O=m/2+20,F=O-w/2,R=B-50,G=(a?R:B-tt)-60,P=a?R-20:G;return s("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[s("div",{className:"model-title",style:{marginBottom:"10px"},children:"Model Architecture"}),s("svg",{width:C,height:N,style:{overflow:"visible"},children:[s("defs",{children:s("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"27",refY:"3.5",orient:"auto",children:s("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#333"})})}),s("rect",{x:I,y:20,width:T,height:m,rx:"15",fill:"transparent",stroke:"#333",strokeWidth:"2",style:{cursor:"pointer"},onClick:()=>g(A=>!A)}),(()=>{const A=O-50;return s(gt,{children:[x.map((U,_)=>{const c=K>1?F+_*Z:O,j=Number(S[_])||0,nt=k[_]||`x${_+1}`,D=Number(U)||0;return s("g",{children:[p&&s(gt,{children:[s("line",{x1:I,y1:c,x2:G,y2:O,stroke:"#666",strokeWidth:"1"}),s("g",{transform:`translate(${(I+G)/2+(1-(K-1)/2)*5}, ${(c+O)/2})`,children:[s("rect",{x:"-24",y:"-8",width:"50",height:"18",fill:"#fff",rx:"4",stroke:"#e0e0e0"}),s("text",{x:"0",y:"5",textAnchor:"middle",fill:"#e74c3c",fontSize:"10",fontWeight:"bold",children:j.toFixed(1)})]})]}),s("circle",{cx:I,cy:c,r:tt,fill:"#fff",stroke:"#333",strokeWidth:"2"}),s("text",{x:I-30,y:c+2,textAnchor:"end",style:{textAnchor:"end"},dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:nt.toString().split(`
`).map((Q,at,z)=>s("tspan",{x:I-30,dy:at===0?`${(z.length-1)*-.6}em`:"1.2em",children:Q},at))}),s("text",{x:I-1,y:c+2,textAnchor:"middle",dominantBaseline:"middle",fontSize:"14",fill:"#333",children:D.toFixed(f)})]},_)}),p&&s(gt,{children:[s("line",{x1:G,y1:O,x2:a?R:B-tt,y2:O,stroke:"#666",strokeWidth:"1"}),a&&s(gt,{children:[s("g",{transform:`translate(${R}, ${O})`,children:[s("rect",{x:"-18",y:"-18",width:"36",height:"36",rx:"6",fill:"#fff",stroke:"#333",strokeWidth:"2"}),s("path",{d:"M -10 8 C -4 8, -4 -8, 10 -8",stroke:"#333",strokeWidth:"2",fill:"none"})]}),s("line",{x1:R+18,y1:O,x2:B-tt,y2:O,stroke:"#333",strokeWidth:"2"})]}),s("path",{d:`M ${P} ${A} Q ${P} ${O} ${G+10} ${O}`,fill:"none",stroke:"#f39c12",strokeWidth:"1"}),s("circle",{cx:P,cy:A,r:12,fill:"#f1c40f",stroke:"#f39c12"}),s("text",{x:P,y:A+2,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fontWeight:"bold",fill:"#fff",children:d}),s("text",{x:P+18,y:A+1,textAnchor:"start",dominantBaseline:"middle",fontSize:"12",fill:"#f39c12",fontWeight:"bold",children:X.toFixed(2)})]})]})})(),s("circle",{cx:B,cy:O,r:tt,fill:"#fff",stroke:"#333",strokeWidth:"2"}),s("text",{x:B+6,y:O+3,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",children:V.toFixed(2)}),s("text",{x:B+30,y:O+2,textAnchor:"start",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:l.toString().split(`
`).map((A,U,_)=>s("tspan",{x:B+33,dy:U===0?`${(_.length-1)*-.6}em`:"1.2em",children:A},U))}),p&&s("foreignObject",{className:"formula",x:M-200,y:N-25,width:400,height:20,children:s("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",fontSize:"18px",fontStyle:"italic",color:"#777"},children:r})})]})]})}function ui({className:e="",...t}){return s("span",{className:`spinner ${e}`,role:"status","aria-label":"loading",...t})}function hi({onTrain:e,onRun:t,isTraining:n,trainingStep:i,dataCount:r,trainerType:o,onTrainerTypeChange:l,isRunning:d,simulationEnabled:f=!0}){return s("div",{class:"control-panel",role:"region","aria-label":"Controls",style:{padding:"20px",background:"#eee",borderRadius:"8px",display:"flex",gap:"10px",flexWrap:"wrap",alignItems:"center"},children:[s("span",{"aria-live":"polite",children:["Data Points: ",r]}),s("div",{style:{borderLeft:"1px solid #ccc",paddingLeft:"10px",marginLeft:"10px",display:"flex",gap:"5px",alignItems:"center"},children:[s("select",{"aria-label":"Training Method",value:o,onChange:u=>l(u.target.value),disabled:n,style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[s("option",{value:"exhaustive",children:"Grid Search "}),s("option",{value:"random",children:"Adaptive Random "})]}),s("button",{onClick:e,disabled:n||r===0,"aria-busy":n,title:r===0?"Generate data first":"Start training",style:{display:"flex",alignItems:"center",gap:"8px"},children:n?s(gt,{children:[s(ui,{})," Searching..."]}):"2. Train"})]}),f&&s("button",{onClick:t,disabled:n,style:d?{background:"#f39c12",color:"white"}:{},"aria-pressed":d,children:["3. Simulation ",d?"Stop":"Start"]})]})}function Rt({viewMode:e,onChange:t}){return s("div",{style:{display:"flex"},children:s("div",{style:{background:"#eee",borderRadius:"4px",padding:"2px",display:"flex",gap:"2px"},children:[s("button",{onClick:()=>t("table"),style:{background:e==="table"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:e==="table"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:e==="table"?"bold":"normal",color:e==="table"?"#333":"#666"},children:"Table"}),s("button",{onClick:()=>t("plot"),style:{background:e==="plot"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:e==="plot"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:e==="plot"?"bold":"normal",color:e==="plot"?"#333":"#666"},children:"Graph"})]})})}function Jt({data:e,vizProps:t,simConfig:n}){if(!e||e.length===0)return s("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No training data generated yet."});const i=["logistic_regression","spam","spam_advanced","spam_hidden","spam_nonlinear","multiple_inputs","single_layer_nonlinear","double_layer_nonlinear"].includes(n?.id),r=(o,l=2)=>{const d=String(o??"").split(/\r?\n/);return d.length<=l?String(o??""):`${d.slice(0,l).join(`
`)}...`};return s("div",{style:{maxHeight:"400px",overflowY:"auto"},children:s("table",{style:{width:"100%",textAlign:"left",borderCollapse:"collapse",fontSize:"0.9rem"},children:[s("thead",{children:s("tr",{style:{background:"#eee",borderBottom:"2px solid #ddd"},children:[Array.isArray(t.inputLabels)?t.inputLabels.map((o,l)=>s("th",{style:{padding:"8px"},children:o},l)):s("th",{style:{padding:"8px"},children:["Input (",t.inputLabel,")"]}),s("th",{style:{padding:"8px"},children:i?"Spam?":"Pos"}),e.length>0&&e[0].text&&s("th",{style:{padding:"8px"},children:"Email Text"})]})}),s("tbody",{children:e.map((o,l)=>{let d="transparent",f=o.target,u={padding:"8px"};if(i){const y=o.target===1;d=y?"#ffebee":"#e8f5e9",f=y?"SPAM":"HAM",u={...u,fontWeight:"bold",color:y?"#c0392b":"#27ae60"}}else f=typeof o.target=="number"?o.target.toFixed(2):o.target;return s("tr",{style:{background:d,borderBottom:"1px solid #ddd"},children:[Array.isArray(o.input)?o.input.map((y,a)=>s("td",{style:{padding:"8px"},children:y.toFixed(0)},a)):s("td",{style:{padding:"8px"},children:o.input.toFixed(2)}),s("td",{style:u,children:f}),o.text&&s("td",{style:{padding:"8px",color:"#555",fontStyle:"italic",maxWidth:"300px",whiteSpace:"pre-line",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:r(o.text,2)})]},l)})})]})})}function _e({hookState:e,renderSimulationView:t,renderDataView:n,networkVizProps:i={},collapseModelArchitectureByDefault:r,simulationEnabled:o=!0,customDataHandling:l=!1}){const{simConfig:u,activeTab:y,setActiveTab:a,trainingHistory:v,trainingStepIndex:p,isTraining:g,dataViewMode:b,setDataViewMode:x,trainingData:S,groundTruth:k,neuralNet:X,time:V,statusMsg:K,handleTrain:tt,handleRun:Z,isRunning:T,trainerType:h,setTrainerType:W,currentInput:w}=e,[m,N]=lt(null),C=yt(null),M=yt(null),I=yt(null),[B,O]=lt(null),[F,R]=lt(0),[G,P]=lt(0);wt(()=>{const at=()=>{const z=C.current?.offsetHeight??0,q=I.current?.offsetHeight??0;P(z),R(q)};return at(),window.addEventListener("resize",at),()=>window.removeEventListener("resize",at)},[]);const A=at=>{N(z=>{const q=z===at?null:at;if(q&&!z){const L=M.current?.offsetHeight,Y=C.current?.offsetHeight,E=I.current?.offsetHeight,H=typeof Y=="number"&&Y>0?Math.max(0,Y-(E||0)-20):null;if(typeof L=="number"&&L>0){const $=typeof H=="number"?Math.min(L,H):L;O($)}}else q||O(null);return q})},U={position:"absolute",top:"10px",right:"10px",zIndex:10,background:"rgba(255, 255, 255, 0.9)",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"0px"},_="all 0.4s cubic-bezier(0.4, 0, 0.2, 1)";wt(()=>{!o&&y==="simulation"&&a("data")},[o,y,a]);const c=w!==void 0?w:u.getInput?u.getInput(V):V,j=u.networkViz||{},nt=typeof r=="boolean"?r:u.collapseModelArchitectureByDefault,D=B?`${B}px`:G>0?`calc(${G}px - ${F}px - 20px)`:"auto";return s("div",{ref:C,className:"nn-demonstrator layout-container",style:{display:"flex",flexDirection:"column",height:"100%",minHeight:0,overflow:"hidden"},children:[s("div",{ref:M,className:"top-section",style:{display:"flex",gap:m?"0px":"20px",flexWrap:"nowrap",alignItems:"stretch",height:m?D:"auto",minHeight:B?0:"500px",overflow:m?"hidden":"visible",transition:_,marginBottom:"20px"},children:[s("div",{className:"simulation-wrapper",style:{flex:m==="simulation"?"1 0 100%":m==="network"?"0 0 0%":"1 1 500px",opacity:m==="network"?0:1,overflow:"hidden",maxWidth:m==="network"?"0px":"100%",transition:_,position:"relative",display:"flex",flexDirection:"column",minHeight:0},children:[s("button",{onClick:()=>A("simulation"),style:U,title:m==="simulation"?"Original Size":"Maximize",children:m==="simulation"?s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s("path",{d:"M4 14h6v6"}),s("path",{d:"M20 10h-6V4"}),s("path",{d:"M14 10l7-7"}),s("path",{d:"M3 21l7-7"})]}):s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s("path",{d:"M15 3h6v6"}),s("path",{d:"M9 21H3v-6"}),s("path",{d:"M21 3l-7 7"}),s("path",{d:"M3 21l7-7"})]})}),s("div",{className:"simulation-section",style:{height:"100%",display:"flex",flexDirection:"column",minHeight:0},children:[s("div",{className:"tabs",style:{paddingRight:"120px"},children:[o&&s("button",{className:`tab-button ${y==="simulation"?"active":""}`,onClick:()=>a("simulation"),children:"Simulation"}),s("button",{className:`tab-button ${y==="data"?"active":""}`,onClick:()=>a("data"),children:"Data"}),s("button",{className:`tab-button ${y==="training"?"active":""}`,onClick:()=>a("training"),children:"Training"})]}),s("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[y==="simulation"&&s(gt,{children:[t(),s("div",{className:"stats",style:{marginTop:"auto",paddingTop:"10px"},children:[s("p",{children:u.description}),s("p",{style:{color:"#646cff",fontWeight:"bold"},children:["Status: ",K]})]})]}),y==="data"&&s("div",{className:"data-content",style:{flex:1,overflowY:"auto",minHeight:0},children:l?n?n():s("p",{children:"No data view available."}):s(gt,{children:[!["gallery"].includes(u.id)&&s("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:s(Rt,{viewMode:b,onChange:x})}),s("div",{style:{marginTop:"15px"},children:[b==="plot"&&s("div",{style:{marginBottom:"20px"},children:n?n():s("p",{children:"No graph available."})}),b==="table"&&s(Jt,{data:S,vizProps:j,simConfig:u})]})]})}),y==="training"&&s("div",{className:"training-content",style:{flex:1,minHeight:0,overflow:"auto"},children:v.length>0?s(Kn,{history:v,currentStepIndex:p,isTraining:g,paramsConfig:u.trainingConfig.params,showAccuracyPlot:u.trainingConfig?.showAccuracyPlot??!0}):s("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No training started yet."})})]})]})]}),s("div",{className:"network-wrapper",style:{flex:m==="network"?"1 0 100%":m==="simulation"?"0 0 0%":`0 0 ${u.id==="spam_hidden","500px"}`,opacity:m==="simulation"?0:1,overflow:"hidden",maxWidth:m==="simulation"?"0px":"100%",transition:_,position:"relative",display:"flex",flexDirection:"column",minHeight:0},children:[s("button",{onClick:()=>A("network"),style:U,title:m==="network"?"Original Size":"Maximize",children:m==="network"?s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s("path",{d:"M4 14h6v6"}),s("path",{d:"M20 10h-6V4"}),s("path",{d:"M14 10l7-7"}),s("path",{d:"M3 21l7-7"})]}):s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s("path",{d:"M15 3h6v6"}),s("path",{d:"M9 21H3v-6"}),s("path",{d:"M21 3l-7 7"}),s("path",{d:"M3 21l7-7"})]})}),s("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:s(xn,{input:c,weight:X.current?X.current.weights||X.current.weight:0,bias:X.current?X.current.bias:0,output:X.current?X.current.predict(c):0,model:X.current,formula:j.formula,inputLabel:j.inputLabels||j.inputLabel,outputLabel:j.outputLabel,biasLabel:j.biasLabel,decimals:u.id.includes("spam")?0:1,showActivation:j.showActivation,collapseModelArchitectureByDefault:nt})})]})]}),s("div",{ref:I,style:{flex:"0 0 auto"},children:s(hi,{onTrain:tt,onRun:Z,isTraining:g,trainingStep:p,dataCount:S.length,trainerType:h,onTrainerTypeChange:W,simConfig:u,isRunning:T,simulationEnabled:o})})]})}function fi({data:e,groundTruth:t,neuralNet:n}){const i=yt(null);return wt(()=>{const r=i.current;if(!r)return;const o=r.getContext("2d"),l=r.width,d=r.height;if(o.clearRect(0,0,l,d),!e||e.length===0){o.fillStyle="#999",o.textAlign="center",o.fillText("No data available",l/2,d/2);return}const f=40,u=l-2*f,y=d-2*f,a=Math.max(...e.map(b=>b.input))||10,v=Math.max(...e.map(b=>b.target))||100,p=b=>f+b/a*u,g=b=>d-f-b/v*y;if(o.beginPath(),o.strokeStyle="#333",o.moveTo(f,f),o.lineTo(f,d-f),o.lineTo(l-f,d-f),o.stroke(),o.fillStyle="#333",o.textAlign="center",o.fillText("Time (t)",l/2,d-10),o.save(),o.translate(15,d/2),o.rotate(-Math.PI/2),o.fillText("Position (s)",0,0),o.restore(),e.forEach(b=>{const x=p(b.input),S=g(b.target);o.beginPath(),o.arc(x,S,3,0,Math.PI*2),o.fillStyle="#2ecc71",o.fill()}),n){o.beginPath(),o.strokeStyle="#e74c3c",o.lineWidth=2;for(let b=0;b<=a;b+=.1){const x=n.predict(b),S=p(b),k=g(x);b===0?o.moveTo(S,k):o.lineTo(S,k)}o.stroke()}},[e,t,n]),s("div",{style:{border:"1px solid #ccc",margin:"10px 0",borderRadius:"4px"},children:s("canvas",{ref:i,width:600,height:300,style:{width:"100%",display:"block"}})})}function pi({collapseModelArchitectureByDefault:e}={}){const t=me("linear_regression"),{simConfig:n,trainingData:i,groundTruth:r,trainingHistory:o,neuralNet:l,time:d,currentInput:f}=t;if(!n)return s("div",{className:"loading",children:"Loading Simulation..."});const u=n.CanvasComponent;return s(_e,{hookState:t,renderSimulationView:()=>{let v=0;try{if(l.current){const p=f!==void 0?f:d;v=l.current.predict(p)}}catch(p){console.error("Predict Error",p)}return s("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:s(u,{time:d,data:i,currentInput:f!==void 0?f:d,currentPrediction:v,groundTruth:r.current,neuralNet:l.current})})},renderDataView:()=>{const{dataViewMode:v,setDataViewMode:p}=t;return s("div",{style:{flex:1,display:"flex",flexDirection:"column",width:"100%"},children:v==="table"?s(gt,{children:[s("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:s(Rt,{viewMode:v,onChange:p})}),s(Jt,{data:i,vizProps:n.networkViz||{},simConfig:n})]}):s(gt,{children:[s("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:s(Rt,{viewMode:v,onChange:p})}),s(fi,{data:i,groundTruth:r.current,neuralNet:o.length>0?l.current:null})]})})},collapseModelArchitectureByDefault:e,customDataHandling:!0})}function gi({collapseModelArchitectureByDefault:e}={}){const t=me("logistic_regression"),{simConfig:n,trainingData:i,groundTruth:r,trainingHistory:o,neuralNet:l}=t;if(!n)return s("div",{className:"loading",children:"Loading Simulation..."});const d=n.CanvasComponent;return s(_e,{hookState:t,renderSimulationView:()=>s("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",border:"2px dashed #ddd",borderRadius:"8px",minHeight:"300px"},children:s("p",{style:{color:"#999"},children:'Data visualization is now in the "Data" tab'})}),renderDataView:()=>{const{dataViewMode:y,setDataViewMode:a}=t,v={staticMode:!0,showGroundTruth:!0,showModel:o.length>0};return n.featuresConfig&&(v.features=n.featuresConfig),s("div",{style:{padding:"10px 0",display:"flex",flexDirection:"column",width:"100%"},children:y==="table"?s(gt,{children:[s("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:s(Rt,{viewMode:y,onChange:a})}),s(Jt,{data:i,vizProps:n.networkViz||{},simConfig:n})]}):s(gt,{children:[s("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:s(Rt,{viewMode:y,onChange:a})}),s(d,{time:0,data:i,groundTruth:r.current,neuralNet:l.current,showProbabilities:!0,...v})]})})},collapseModelArchitectureByDefault:e,simulationEnabled:!1,customDataHandling:!0})}function xe({simId:e,collapseModelArchitectureByDefault:t}){const n=me(e),{simConfig:i,trainingData:r,groundTruth:o,trainingHistory:l,neuralNet:d,time:f,currentInput:u,dataViewMode:y,setDataViewMode:a}=n;if(!i)return s("div",{className:"loading",children:"Loading Simulation..."});const v=i.CanvasComponent,p=s(Rt,{viewMode:y,onChange:a});return s(_e,{hookState:n,renderSimulationView:()=>{let x=0;try{d.current&&u&&(x=d.current.predict(u))}catch(k){console.error("Predict Error",k)}const S={allowedModes:["text"],hideControls:!0,features:i.featuresConfig};return s("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:s(v,{time:f,data:r,currentInput:u,currentPrediction:x,groundTruth:o.current,neuralNet:d.current,...S})})},renderDataView:()=>{const x={allowedModes:["scatter","3d","features"],showModel:l.length>0,additionalControls:p,features:i.featuresConfig};return s("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px",width:"100%"},children:y==="table"?s(gt,{children:[s("div",{style:{marginBottom:"15px"},children:s(Rt,{viewMode:y,onChange:a})}),s(Jt,{data:r,vizProps:i.networkViz||{},simConfig:i})]}):s(v,{time:0,data:r,groundTruth:o.current,neuralNet:d.current,...x})})},collapseModelArchitectureByDefault:t,simulationEnabled:!1,customDataHandling:!0})}function mi({collapseModelArchitectureByDefault:e}={}){return s(xe,{simId:"multiple_inputs",collapseModelArchitectureByDefault:e})}function _i({collapseModelArchitectureByDefault:e}={}){return s(xe,{simId:"single_layer_nonlinear",collapseModelArchitectureByDefault:e})}function xi({collapseModelArchitectureByDefault:e}={}){return s(xe,{simId:"double_layer_nonlinear",collapseModelArchitectureByDefault:e})}function yi(){const[e,t]=lt(0),n=[{name:"Simple Perceptron",input:.5,weight:.8,bias:.2,output:.6,inputLabel:"Input",formula:"y = w * x + b"},{name:"Spam Filter (2 Inputs)",input:[1,0],weight:[.5,-.2],bias:.1,output:.8,inputLabel:["Spam Word","Suspicious Link"],formula:"y = w1*x1 + w2*x2 + b"},{name:"Complex Model (5 Inputs)",input:[1,.5,-1,0,.2],weight:[.1,.2,.3,.4,.5],bias:-.5,output:.1,inputLabel:["F1","F2","F3","F4","F5"],formula:"y = Σ(wi*xi) + b"},{name:"Many Inputs (8 Inputs)",input:[1,0,1,0,1,0,1,0],weight:[.1,-.1,.1,-.1,.1,-.1,.1,-.1],bias:0,output:.5,inputLabel:["I1","I2","I3","I4","I5","I6","I7","I8"],formula:"y = ... "}],i=n[e];return s("div",{style:{padding:"20px"},children:[s("h2",{children:"Architecture Gallery"}),s("div",{style:{marginBottom:"20px"},children:[s("button",{onClick:()=>t((e-1+n.length)%n.length),children:"Previous"}),s("span",{style:{margin:"0 10px"},children:[i.name," (",e+1,"/",n.length,")"]}),s("button",{onClick:()=>t((e+1)%n.length),children:"Next"})]}),s("div",{style:{width:"400px",border:"1px dashed #ccc",padding:"10px"},children:s(xn,{input:i.input,weight:i.weight,bias:i.bias,output:i.output,formula:i.formula,inputLabel:i.inputLabel})})]})}function bi(){const[e,t]=lt(null);return wt(()=>{const r=new URLSearchParams(window.location.search).get("sim")||"linear_regression";t(r)},[]),e?e==="gallery"?s("div",{className:"container",children:[s("header",{children:[s("h1",{children:"Neural Network Demonstrator"}),s("p",{children:"Architecture Gallery (Debug)"}),s("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:s("a",{href:"?sim=linear_regression",style:{marginRight:"10px"},children:"Back to App"})})]}),s("main",{children:s(yi,{})})]}):s("div",{className:"container",children:[s("header",{children:[s("h1",{children:"Neural Network Demonstrator"}),s("p",{children:(i=>{switch(i){case"linear_regression":return"Phase 1: Linear Regression";case"logistic_regression":return"Phase 2: Logistic Regression";case"multiple_inputs":return"Phase 3: Multiple Inputs";case"single_layer_nonlinear":return"Phase 4: Single Layer Nonlinear Data";case"double_layer_nonlinear":return"Phase 5: Double Layer Nonlinear Data";default:return"Neural Network Demonstrator"}})(e)}),s("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:[s("a",{href:"?sim=linear_regression",style:{marginRight:"10px",fontWeight:e==="linear_regression"?"bold":"normal"},children:"Phase 1 (Linear)"}),s("a",{href:"?sim=logistic_regression",style:{marginRight:"10px",fontWeight:e==="logistic_regression"?"bold":"normal"},children:"Phase 2 (Logistic)"}),s("a",{href:"?sim=multiple_inputs",style:{marginRight:"10px",fontWeight:e==="multiple_inputs"?"bold":"normal"},children:"Phase 3 (Multi)"}),s("a",{href:"?sim=single_layer_nonlinear",style:{marginRight:"10px",fontWeight:e==="single_layer_nonlinear"?"bold":"normal"},children:"Phase 4 (Nonlinear 1)"}),s("a",{href:"?sim=double_layer_nonlinear",style:{fontWeight:e==="double_layer_nonlinear"?"bold":"normal"},children:"Phase 5 (Nonlinear 2)"})]})]}),s("main",{style:{height:"100%"},children:[e==="linear_regression"&&s(pi,{}),e==="logistic_regression"&&s(gi,{}),e==="multiple_inputs"&&s(mi,{}),e==="single_layer_nonlinear"&&s(_i,{}),e==="double_layer_nonlinear"&&s(xi,{})]})]}):s("div",{children:"Loading App..."})}Wn(s(bi,{}),document.getElementById("app"));
