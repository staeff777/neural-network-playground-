(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();var Ft,ot,we,Pt,ie,Me,ke,Se,Ot,Xt,Gt,Wt={},Te=[],je=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Bt=Array.isArray;function kt(e,t){for(var n in t)e[n]=t[n];return e}function Kt(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Oe(e,t,n){var i,a,s,c={};for(s in t)s=="key"?i=t[s]:s=="ref"?a=t[s]:c[s]=t[s];if(arguments.length>2&&(c.children=arguments.length>3?Ft.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)c[s]===void 0&&(c[s]=e.defaultProps[s]);return Et(e,c,i,a,null)}function Et(e,t,n,i,a){var s={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++we,__i:-1,__u:0};return a==null&&ot.vnode!=null&&ot.vnode(s),s}function vt(e){return e.children}function zt(e,t){this.props=e,this.context=t}function Ct(e,t){if(t==null)return e.__?Ct(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Ct(e):null}function Pe(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Pe(e)}}function oe(e){(!e.__d&&(e.__d=!0)&&Pt.push(e)&&!It.__r++||ie!=ot.debounceRendering)&&((ie=ot.debounceRendering)||Me)(It)}function It(){for(var e,t,n,i,a,s,c,d=1;Pt.length;)Pt.length>d&&Pt.sort(ke),e=Pt.shift(),d=Pt.length,e.__d&&(n=void 0,i=void 0,a=(i=(t=e).__v).__e,s=[],c=[],t.__P&&((n=kt({},i)).__v=i.__v+1,ot.vnode&&ot.vnode(n),qt(t.__P,n,i,t.__n,t.__P.namespaceURI,32&i.__u?[a]:null,s,a??Ct(i),!!(32&i.__u),c),n.__v=i.__v,n.__.__k[n.__i]=n,We(s,n,c),i.__e=i.__=null,n.__e!=a&&Pe(n)));It.__r=0}function Ae(e,t,n,i,a,s,c,d,u,p,r){var f,y,x,w,P,S,A,b=i&&i.__k||Te,L=t.length;for(u=Ke(n,t,b,u,L),f=0;f<L;f++)(x=n.__k[f])!=null&&(y=x.__i==-1?Wt:b[x.__i]||Wt,x.__i=f,S=qt(e,x,y,a,s,c,d,u,p,r),w=x.__e,x.ref&&y.ref!=x.ref&&(y.ref&&Zt(y.ref,null,x),r.push(x.ref,x.__c||w,x)),P==null&&w!=null&&(P=w),(A=!!(4&x.__u))||y.__k===x.__k?u=Ce(x,u,e,A):typeof x.type=="function"&&S!==void 0?u=S:w&&(u=w.nextSibling),x.__u&=-7);return n.__e=P,u}function Ke(e,t,n,i,a){var s,c,d,u,p,r=n.length,f=r,y=0;for(e.__k=new Array(a),s=0;s<a;s++)(c=t[s])!=null&&typeof c!="boolean"&&typeof c!="function"?(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?c=e.__k[s]=Et(null,c,null,null,null):Bt(c)?c=e.__k[s]=Et(vt,{children:c},null,null,null):c.constructor==null&&c.__b>0?c=e.__k[s]=Et(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):e.__k[s]=c,u=s+y,c.__=e,c.__b=e.__b+1,d=null,(p=c.__i=qe(c,n,u,f))!=-1&&(f--,(d=n[p])&&(d.__u|=2)),d==null||d.__v==null?(p==-1&&(a>r?y--:a<r&&y++),typeof c.type!="function"&&(c.__u|=4)):p!=u&&(p==u-1?y--:p==u+1?y++:(p>u?y--:y++,c.__u|=4))):e.__k[s]=null;if(f)for(s=0;s<r;s++)(d=n[s])!=null&&(2&d.__u)==0&&(d.__e==i&&(i=Ct(d)),Re(d,d));return i}function Ce(e,t,n,i){var a,s;if(typeof e.type=="function"){for(a=e.__k,s=0;a&&s<a.length;s++)a[s]&&(a[s].__=e,t=Ce(a[s],t,n,i));return t}e.__e!=t&&(i&&(t&&e.type&&!t.parentNode&&(t=Ct(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function qe(e,t,n,i){var a,s,c,d=e.key,u=e.type,p=t[n],r=p!=null&&(2&p.__u)==0;if(p===null&&d==null||r&&d==p.key&&u==p.type)return n;if(i>(r?1:0)){for(a=n-1,s=n+1;a>=0||s<t.length;)if((p=t[c=a>=0?a--:s++])!=null&&(2&p.__u)==0&&d==p.key&&u==p.type)return c}return-1}function se(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||je.test(t)?n:n+"px"}function $t(e,t,n,i,a){var s,c;t:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||se(e.style,t,"");if(n)for(t in n)i&&n[t]==i[t]||se(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")s=t!=(t=t.replace(Se,"$1")),c=t.toLowerCase(),t=c in e||t=="onFocusOut"||t=="onFocusIn"?c.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?i?n.u=i.u:(n.u=Ot,e.addEventListener(t,s?Gt:Xt,s)):e.removeEventListener(t,s?Gt:Xt,s);else{if(a=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function re(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Ot++;else if(t.t<n.u)return;return n(ot.event?ot.event(t):t)}}}function qt(e,t,n,i,a,s,c,d,u,p){var r,f,y,x,w,P,S,A,b,L,B,J,R,M,h,I,_,g=t.type;if(t.constructor!=null)return null;128&n.__u&&(u=!!(32&n.__u),s=[d=t.__e=n.__e]),(r=ot.__b)&&r(t);t:if(typeof g=="function")try{if(A=t.props,b="prototype"in g&&g.prototype.render,L=(r=g.contextType)&&i[r.__c],B=r?L?L.props.value:r.__:i,n.__c?S=(f=t.__c=n.__c).__=f.__E:(b?t.__c=f=new g(A,B):(t.__c=f=new zt(A,B),f.constructor=g,f.render=Je),L&&L.sub(f),f.state||(f.state={}),f.__n=i,y=f.__d=!0,f.__h=[],f._sb=[]),b&&f.__s==null&&(f.__s=f.state),b&&g.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=kt({},f.__s)),kt(f.__s,g.getDerivedStateFromProps(A,f.__s))),x=f.props,w=f.state,f.__v=t,y)b&&g.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),b&&f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(b&&g.getDerivedStateFromProps==null&&A!==x&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(A,B),t.__v==n.__v||!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(A,f.__s,B)===!1){for(t.__v!=n.__v&&(f.props=A,f.state=f.__s,f.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(v){v&&(v.__=t)}),J=0;J<f._sb.length;J++)f.__h.push(f._sb[J]);f._sb=[],f.__h.length&&c.push(f);break t}f.componentWillUpdate!=null&&f.componentWillUpdate(A,f.__s,B),b&&f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(x,w,P)})}if(f.context=B,f.props=A,f.__P=e,f.__e=!1,R=ot.__r,M=0,b){for(f.state=f.__s,f.__d=!1,R&&R(t),r=f.render(f.props,f.state,f.context),h=0;h<f._sb.length;h++)f.__h.push(f._sb[h]);f._sb=[]}else do f.__d=!1,R&&R(t),r=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++M<25);f.state=f.__s,f.getChildContext!=null&&(i=kt(kt({},i),f.getChildContext())),b&&!y&&f.getSnapshotBeforeUpdate!=null&&(P=f.getSnapshotBeforeUpdate(x,w)),I=r,r!=null&&r.type===vt&&r.key==null&&(I=Le(r.props.children)),d=Ae(e,Bt(I)?I:[I],t,n,i,a,s,c,d,u,p),f.base=t.__e,t.__u&=-161,f.__h.length&&c.push(f),S&&(f.__E=f.__=null)}catch(v){if(t.__v=null,u||s!=null)if(v.then){for(t.__u|=u?160:128;d&&d.nodeType==8&&d.nextSibling;)d=d.nextSibling;s[s.indexOf(d)]=null,t.__e=d}else{for(_=s.length;_--;)Kt(s[_]);Ut(t)}else t.__e=n.__e,t.__k=n.__k,v.then||Ut(t);ot.__e(v,t,n)}else s==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):d=t.__e=Ze(n.__e,t,n,i,a,s,c,u,p);return(r=ot.diffed)&&r(t),128&t.__u?void 0:d}function Ut(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Ut)}function We(e,t,n){for(var i=0;i<n.length;i++)Zt(n[i],n[++i],n[++i]);ot.__c&&ot.__c(t,e),e.some(function(a){try{e=a.__h,a.__h=[],e.some(function(s){s.call(a)})}catch(s){ot.__e(s,a.__v)}})}function Le(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Bt(e)?e.map(Le):kt({},e)}function Ze(e,t,n,i,a,s,c,d,u){var p,r,f,y,x,w,P,S=n.props||Wt,A=t.props,b=t.type;if(b=="svg"?a="http://www.w3.org/2000/svg":b=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),s!=null){for(p=0;p<s.length;p++)if((x=s[p])&&"setAttribute"in x==!!b&&(b?x.localName==b:x.nodeType==3)){e=x,s[p]=null;break}}if(e==null){if(b==null)return document.createTextNode(A);e=document.createElementNS(a,b,A.is&&A),d&&(ot.__m&&ot.__m(t,s),d=!1),s=null}if(b==null)S===A||d&&e.data==A||(e.data=A);else{if(s=s&&Ft.call(e.childNodes),!d&&s!=null)for(S={},p=0;p<e.attributes.length;p++)S[(x=e.attributes[p]).name]=x.value;for(p in S)if(x=S[p],p!="children"){if(p=="dangerouslySetInnerHTML")f=x;else if(!(p in A)){if(p=="value"&&"defaultValue"in A||p=="checked"&&"defaultChecked"in A)continue;$t(e,p,null,x,a)}}for(p in A)x=A[p],p=="children"?y=x:p=="dangerouslySetInnerHTML"?r=x:p=="value"?w=x:p=="checked"?P=x:d&&typeof x!="function"||S[p]===x||$t(e,p,x,S[p],a);if(r)d||f&&(r.__html==f.__html||r.__html==e.innerHTML)||(e.innerHTML=r.__html),t.__k=[];else if(f&&(e.innerHTML=""),Ae(t.type=="template"?e.content:e,Bt(y)?y:[y],t,n,i,b=="foreignObject"?"http://www.w3.org/1999/xhtml":a,s,c,s?s[0]:n.__k&&Ct(n,0),d,u),s!=null)for(p=s.length;p--;)Kt(s[p]);d||(p="value",b=="progress"&&w==null?e.removeAttribute("value"):w!=null&&(w!==e[p]||b=="progress"&&!w||b=="option"&&w!=S[p])&&$t(e,p,w,S[p],a),p="checked",P!=null&&P!=e[p]&&$t(e,p,P,S[p],a))}return e}function Zt(e,t,n){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&t==null||(e.__u=e(t))}else e.current=t}catch(a){ot.__e(a,n)}}function Re(e,t,n){var i,a;if(ot.unmount&&ot.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||Zt(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){ot.__e(s,t)}i.base=i.__P=null}if(i=e.__k)for(a=0;a<i.length;a++)i[a]&&Re(i[a],t,n||typeof e.type!="function");n||Kt(e.__e),e.__c=e.__=e.__e=void 0}function Je(e,t,n){return this.constructor(e,n)}function Qe(e,t,n){var i,a,s,c;t==document&&(t=document.documentElement),ot.__&&ot.__(e,t),a=(i=!1)?null:t.__k,s=[],c=[],qt(t,e=t.__k=Oe(vt,null,[e]),a||Wt,Wt,t.namespaceURI,a?null:t.firstChild?Ft.call(t.childNodes):null,s,a?a.__e:t.firstChild,i,c),We(s,e,c)}Ft=Te.slice,ot={__e:function(e,t,n,i){for(var a,s,c;t=t.__;)if((a=t.__c)&&!a.__)try{if((s=a.constructor)&&s.getDerivedStateFromError!=null&&(a.setState(s.getDerivedStateFromError(e)),c=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(e,i||{}),c=a.__d),c)return a.__E=a}catch(d){e=d}throw e}},we=0,zt.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=kt({},this.state),typeof e=="function"&&(e=e(kt({},n),this.props)),e&&kt(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),oe(this))},zt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),oe(this))},zt.prototype.render=vt,Pt=[],Me=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ke=function(e,t){return e.__v.__b-t.__v.__b},It.__r=0,Se=/(PointerCapture)$|Capture$/i,Ot=0,Xt=re(!1),Gt=re(!0);var tn=0;function l(e,t,n,i,a,s){t||(t={});var c,d,u=t;if("ref"in u)for(d in u={},t)d=="ref"?c=t[d]:u[d]=t[d];var p={type:e,props:u,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--tn,__i:-1,__u:0,__source:a,__self:s};if(typeof e=="function"&&(c=e.defaultProps))for(d in c)u[d]===void 0&&(u[d]=c[d]);return ot.vnode&&ot.vnode(p),p}var Lt,ht,Ht,le,Yt=0,$e=[],ft=ot,ae=ft.__b,ce=ft.__r,he=ft.diffed,de=ft.__c,fe=ft.unmount,ue=ft.__;function Jt(e,t){ft.__h&&ft.__h(ht,e,Yt||t),Yt=0;var n=ht.__H||(ht.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function st(e){return Yt=1,en(ze,e)}function en(e,t,n){var i=Jt(Lt++,2);if(i.t=e,!i.__c&&(i.__=[ze(void 0,t),function(d){var u=i.__N?i.__N[0]:i.__[0],p=i.t(u,d);u!==p&&(i.__N=[p,i.__[1]],i.__c.setState({}))}],i.__c=ht,!ht.__f)){var a=function(d,u,p){if(!i.__c.__H)return!0;var r=i.__c.__H.__.filter(function(y){return!!y.__c});if(r.every(function(y){return!y.__N}))return!s||s.call(this,d,u,p);var f=i.__c.props!==d;return r.forEach(function(y){if(y.__N){var x=y.__[0];y.__=y.__N,y.__N=void 0,x!==y.__[0]&&(f=!0)}}),s&&s.call(this,d,u,p)||f};ht.__f=!0;var s=ht.shouldComponentUpdate,c=ht.componentWillUpdate;ht.componentWillUpdate=function(d,u,p){if(this.__e){var r=s;s=void 0,a(d,u,p),s=r}c&&c.call(this,d,u,p)},ht.shouldComponentUpdate=a}return i.__N||i.__}function St(e,t){var n=Jt(Lt++,3);!ft.__s&&Ee(n.__H,t)&&(n.__=e,n.u=t,ht.__H.__h.push(n))}function yt(e){return Yt=5,nn(function(){return{current:e}},[])}function nn(e,t){var n=Jt(Lt++,7);return Ee(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function on(){for(var e;e=$e.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Dt),e.__H.__h.forEach(jt),e.__H.__h=[]}catch(t){e.__H.__h=[],ft.__e(t,e.__v)}}ft.__b=function(e){ht=null,ae&&ae(e)},ft.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),ue&&ue(e,t)},ft.__r=function(e){ce&&ce(e),Lt=0;var t=(ht=e.__c).__H;t&&(Ht===ht?(t.__h=[],ht.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(Dt),t.__h.forEach(jt),t.__h=[],Lt=0)),Ht=ht},ft.diffed=function(e){he&&he(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&($e.push(t)!==1&&le===ft.requestAnimationFrame||((le=ft.requestAnimationFrame)||sn)(on)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Ht=ht=null},ft.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Dt),n.__h=n.__h.filter(function(i){return!i.__||jt(i)})}catch(i){t.some(function(a){a.__h&&(a.__h=[])}),t=[],ft.__e(i,n.__v)}}),de&&de(e,t)},ft.unmount=function(e){fe&&fe(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{Dt(i)}catch(a){t=a}}),n.__H=void 0,t&&ft.__e(t,n.__v))};var pe=typeof requestAnimationFrame=="function";function sn(e){var t,n=function(){clearTimeout(i),pe&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,35);pe&&(t=requestAnimationFrame(n))}function Dt(e){var t=ht,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),ht=t}function jt(e){var t=ht;e.__c=e.__(),ht=t}function Ee(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function ze(e,t){return typeof t=="function"?t(e):t}function rn(e){return function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}class ln{constructor(t){this.model=t}train(t,n,i){if(i!==void 0)return this.trainLegacy(t,n,i);const a=n,s=[];let c=1/0,d={};const u=r=>{const f=[];if(r.step<=0)return[r.min];for(let y=r.min;y<=r.max+1e-4;y+=r.step)f.push(parseFloat(y.toFixed(2)));return f},p=(r,f)=>{if(console.log({paramIndex:r,currentParams:f}),r===a.length){const w=[];let P=0;f.forEach((R,M)=>{a[M].name.toLowerCase().includes("bias")?P=R:w.push(R)}),this.model.setWeights?this.model.setWeights(w):this.model.setWeight&&this.model.setWeight(w[0]),this.model.setBias(P);let S=0,A=0;for(const R of t){const M=this.model.predict(R.input),h=R.target-M;S+=h*h,A+=Math.abs(h)}const b=S/t.length,L=A/t.length;let B=0;for(const R of t)(this.model.predict(R.input)>=.5?1:0)===R.target&&B++;const J=B/t.length;b<c&&(c=b,d={weights:[...w],bias:P}),s.push({params:[...f],error:b,mae:L,accuracy:J});return}const y=a[r],x=u(y);for(const w of x)f[r]=w,p(r+1,f)};return p(0,new Array(a.length)),{bestParams:d,history:s,minError:c}}trainLegacy(t,n,i){const a=[];let s=n.min,c=i.min,d=1/0;for(let u=n.min;u<=n.max;u+=n.step)for(let p=i.min;p<=i.max;p+=i.step){const r=parseFloat(u.toFixed(2)),f=parseFloat(p.toFixed(2));this.model.setWeight(r),this.model.setBias(f);let y=0,x=0;for(const b of t){const L=this.model.predict(b.input),B=b.target-L;y+=B*B,x+=Math.abs(B)}const w=y/t.length,P=x/t.length;let S=0;for(const b of t)(this.model.predict(b.input)>=.5?1:0)===b.target&&S++;const A=S/t.length;w<d&&(d=w,s=r,c=f),a.push({weight:r,bias:f,error:w,mae:P,accuracy:A})}return{bestWeight:s,bestBias:c,history:a}}async trainAsync(t,n,i){if(!Array.isArray(n)){const x=arguments[1],w=arguments[2],P=arguments[3];let S=x.min,A=w.min,b=1/0,L=[];const B=20;let J=0;for(let R=x.min;R<=x.max;R+=x.step)for(let M=w.min;M<=w.max;M+=w.step){const h=parseFloat(R.toFixed(2)),I=parseFloat(M.toFixed(2));this.model.setWeight(h),this.model.setBias(I);let _=0,g=0;for(const D of t){const j=this.model.predict(D.input),$=D.target-j;_+=$*$,g+=Math.abs($)}const v=_/t.length,T=g/t.length;let H=0;for(const D of t)(this.model.predict(D.input)>=.5?1:0)===D.target&&H++;const E=H/t.length;v<b&&(b=v,S=h,A=I);const O={weight:h,bias:I,error:v,mae:T,accuracy:E};L.push(O),J++,J%B===0&&(P&&P(L,{bestWeight:S,bestBias:A,minError:b}),L=[],await new Promise(D=>setTimeout(D,0)))}return L.length>0&&P&&P(L,{bestWeight:S,bestBias:A,minError:b}),{bestWeight:S,bestBias:A,minError:b}}let s=1/0,c={},d=0;const u=50;let p=[];const r=x=>{const w=[];if(x.step<=0)return[x.min];for(let P=x.min;P<=x.max+1e-4;P+=x.step)w.push(parseFloat(P.toFixed(2)));return w},f=n.map(r),y=async(x,w)=>{if(x===n.length){const S=[];let A=0;w.forEach((_,g)=>{n[g].name.toLowerCase().includes("bias")?A=_:S.push(_)});let b={};this.model.setParams?(w.forEach((_,g)=>{b[n[g].name]=_}),this.model.setParams(b),A===void 0&&(A=0)):(this.model.setWeights?this.model.setWeights(S):this.model.setWeight&&this.model.setWeight(S[0]),this.model.setBias(A),b={weights:[...S],bias:A});let L=0,B=0;for(const _ of t){const g=this.model.predict(_.input),v=_.target-g;L+=v*v,B+=Math.abs(v)}const J=L/t.length,R=B/t.length;let M=0;for(const _ of t)(this.model.predict(_.input)>=.5?1:0)===_.target&&M++;const h=M/t.length;J<s&&(s=J,c=b);const I={params:[...w],error:J,mae:R,accuracy:h};p.push(I),d++,d%u===0&&(i&&i(p,{bestParams:c,minError:s}),p=[],await new Promise(_=>setTimeout(_,0)));return}const P=f[x];for(const S of P)w[x]=S,await y(x+1,w)};return await y(0,new Array(n.length)),p.length>0&&i&&i(p,{bestParams:c,minError:s}),{bestParams:c,minError:s}}async trainRandomAsync(t,n,i,a={}){const{patience:s=5e3,seed:c}=a,d=2e4,u=.8,p=.999,r=.8;let f=1/0,y={},x=c;x==null?(x=Math.floor(Math.random()*2147483647),console.log(`[AdaptiveRandom] Generated Seed: ${x}`)):console.log(`[AdaptiveRandom] Using Seed: ${x}`);const w=rn(x);let P=n.map(h=>({min:h.min,max:h.max,span:h.max-h.min})),S=P.map(h=>h.min+w()*h.span);const A=h=>{const I=[];let _=0;h.forEach((O,D)=>{n[D].name.toLowerCase().includes("bias")?_=O:I.push(O)});let g={};this.model.setParams?(h.forEach((O,D)=>{g[n[D].name]=O}),this.model.setParams(g)):(this.model.setWeights?this.model.setWeights(I):this.model.setWeight&&this.model.setWeight(I[0]),this.model.setBias(_),g={weights:I,bias:_});let v=0,T=0;for(const O of t){const D=this.model.predict(O.input),j=O.target-D;v+=j*j,T+=Math.abs(j)}let H=0;for(const O of t)(this.model.predict(O.input)>=.5?1:0)===O.target&&H++;const E=H/t.length;return{mse:v/t.length,mae:T/t.length,accuracy:E,decodedParams:g,weights:I,bias:_}};let b=A(S);f=b.mse,y=b.decodedParams?{...b.decodedParams,_array:[...S]}:{weights:b.weights,bias:b.bias,_array:[...S]},i&&i([{params:[...S],error:f,mae:b.mae,accuracy:b.accuracy}],{bestParams:y,minError:f}),await new Promise(h=>setTimeout(h,0));let L=[];const B=10;let J=f,R=[...S],M=0;for(let h=0;h<d;h++){const I=h<d*r;let _;if(I){const D=h/(d*r);_=u*(1-D*.5)}else _=u*.5*Math.pow(p,h-d*r);let g=!1;const v=[...R];let T=!1;for(;!T;)v.forEach((D,j)=>{if(w()<.4)return;T=!0;const $=P[j];let W=!1;if(I){const z=$.span*.3,Q=y._array&&Math.abs(D-y._array[j])<1e-9;Q&&D<$.min+z&&($.min-=$.span*.4,$.span=$.max-$.min,W=!0),Q&&D>$.max-z&&($.max+=$.span*.4,$.span=$.max-$.min,W=!0),W&&(g=!0)}let m=$.span*_;W&&(m=Math.max(m,$.span*.25));const o=m;let F=D+(w()-.5)*2*o;F<$.min&&(F=$.min),F>$.max&&(F=$.max),v[j]=F});const H=A(v),E=H.mse-J;let O=!1;if(E<0&&(O=!0),O&&(R=v,J=H.mse),H.mse<f?(f=H.mse,y={weights:H.weights,bias:H.bias,_array:[...v]},M=0):M++,M>=s&&!I)break;if(L.push({params:[...v],error:H.mse,mae:H.mae,accuracy:H.accuracy}),L.length>=B){let D;g&&(D="Grenzen dynamisch erweitert..."),i&&i(L,{bestParams:y,minError:f,message:D}),L=[],await new Promise(j=>setTimeout(j,0))}}return L.length>0&&i&&i(L,{bestParams:y,minError:f}),{bestParams:y,minError:f}}}function an({history:e,currentStepIndex:t,isTraining:n,paramsConfig:i}){const a=yt(null),[s,c]=st(0),d=6;St(()=>{c(0)},[i]),St(()=>{const p=a.current;if(!p||!e||e.length===0)return;const r=p.getContext("2d"),f=p.width,y=p.height;r.clearRect(0,0,f,y),r.fillStyle="#fff",r.fillRect(0,0,f,y);const x=Math.max(...e.map(R=>R.error)),P=!n&&e.length>0?e.length-1:t!==null&&t>=0?Math.min(t,e.length-1):-1;let S=-1,A=1/0;for(let R=0;R<=P;R++)e[R].error<A&&(A=e[R].error,S=R);let b=[];if(i){const R=1+i.length,M=s*d,h=Math.min(M+d,R),I=3,_=2,g=f/I,v=y/_;for(let T=M;T<h;T++){const H=T-M,E=H%I,O=Math.floor(H/I),D=E*g,j=O*v;if(T===0){const $=Math.max(10,e.length-1);b.push({type:"accuracy_step",xLabel:"Training Step",xMin:0,xMax:$,yMode:"accuracy",getValue:(W,m)=>m,getYValue:W=>W.accuracy||0,offsetX:D,offsetY:j,w:g,h:v,showYAxis:!0})}else if(T===1){const $=Math.max(10,e.length-1);b.push({type:"error_step",xLabel:"Training Step",xMin:0,xMax:$,yMode:"error_log",getValue:(W,m)=>m,getYValue:W=>W.error,offsetX:D,offsetY:j,w:g,h:v,showYAxis:!0})}else{const $=T-2,W=i[$],m=e.map(z=>z.params[$]),o=Math.min(...m),F=Math.max(...m);b.push({type:"param_error",xLabel:W.name,xMin:o,xMax:F,yMode:"error_log",getValue:z=>z.params[$],getYValue:z=>z.error,offsetX:D,offsetY:j,w:g,h:v})}}}else{const R=f/2,M=y/2,h=e.map(g=>g.weight),I=e.map(g=>g.bias),_=Math.max(10,e.length-1);b=[{type:"accuracy_step",xLabel:"Accuracy",xMin:0,xMax:_,yMode:"accuracy",getValue:(g,v)=>v,getYValue:g=>g.accuracy||0,offsetX:0,offsetY:0,w:R,h:M,showYAxis:!0},{type:"error_step",xLabel:"Step",xMin:0,xMax:_,yMode:"error_log",getValue:(g,v)=>v,getYValue:g=>g.error,offsetX:R,offsetY:0,w:R,h:M,showYAxis:!0},{xLabel:"Weight",xMin:Math.min(...h),xMax:Math.max(...h),yMode:"error_log",getValue:g=>g.weight,getYValue:g=>g.error,offsetX:0,offsetY:M,w:R,h:M},{xLabel:"Bias",xMin:Math.min(...I),xMax:Math.max(...I),yMode:"error_log",getValue:g=>g.bias,getYValue:g=>g.error,offsetX:R,offsetY:M,w:R,h:M}]}const L=50;b.forEach(R=>{const{xLabel:M,xMin:h,xMax:I,getValue:_,getYValue:g,offsetX:v,offsetY:T,w:H,h:E,yMode:O,showYAxis:D}=R,j=m=>v+L+(m-h)/(I-h||1)*(H-2*L);let $;if(O==="accuracy")$=m=>T+E-L-m*(E-2*L);else{const o=x||1;$=F=>{const z=(F-0)/(o-0);return T+E-L-z*(E-2*L)}}r.strokeStyle="#eee",r.lineWidth=2,r.strokeRect(v,T,H,E),r.beginPath(),r.strokeStyle="#333",r.lineWidth=2,r.moveTo(v+L,T+L),r.lineTo(v+L,T+E-L),r.lineTo(v+H-L,T+E-L),r.stroke(),r.fillStyle="#333",r.font="22px sans-serif",r.textAlign="center";let W=M;if(W.length>20&&(W=W.substring(0,18)+"..."),r.fillText(W,v+H/2,T+E-15),v===0||D)if(r.save(),r.translate(v+15,T+E/2),r.rotate(-Math.PI/2),O==="accuracy")r.fillText("Accuracy",0,0),r.restore(),r.textAlign="right",r.fillStyle="#666",r.font="18px sans-serif",[0,.25,.5,.75,1].forEach(m=>{const o=$(m);r.fillText(m.toFixed(2),v+L-8,o+6),r.beginPath(),r.lineWidth=1,r.strokeStyle="#f0f0f0",r.moveTo(v+L,o),r.lineTo(v+H-L,o),r.stroke()});else{r.fillText("Error",0,0),r.restore(),r.textAlign="right",r.fillStyle="#666",r.font="18px sans-serif";const m=5;for(let o=0;o<=m;o++){const F=o/m*x,z=$(F);r.fillText(F.toFixed(2),v+L-8,z+6),o>0&&(r.beginPath(),r.lineWidth=1,r.strokeStyle="#f0f0f0",r.moveTo(v+L,z),r.lineTo(v+H-L,z),r.stroke())}}r.fillStyle="#666",r.font="18px sans-serif",r.textAlign="center",r.fillText(h.toFixed(1),v+L,T+E-L+25),r.fillText(I.toFixed(1),v+H-L,T+E-L+25),r.fillStyle=O==="accuracy"?"rgba(155, 89, 182, 0.4)":"rgba(52, 152, 219, 0.4)";for(let m=0;m<=P;m++){const o=_(e[m],m),F=g(e[m]),z=j(o),Q=$(F);r.fillRect(z,Q,4,4)}if(S>=0){const m=_(e[S],S),o=g(e[S]),F=j(m),z=$(o);r.beginPath(),r.fillStyle="#2ecc71",r.strokeStyle="#27ae60",r.lineWidth=2,r.arc(F,z,10,0,Math.PI*2),r.fill(),r.stroke()}if(n&&t!==null&&t>=0&&t<=P){const m=_(e[t],t),o=g(e[t]),F=j(m),z=$(o);r.beginPath(),r.fillStyle="#e74c3c",r.strokeStyle="#c0392b",r.lineWidth=2,r.arc(F,z,8,0,Math.PI*2),r.fill(),r.stroke()}});const B=f-150,J=20;r.fillStyle="rgba(255,255,255,0.9)",r.fillRect(B,J,140,70),r.strokeStyle="#ccc",r.lineWidth=1,r.strokeRect(B,J,140,70),r.textAlign="left",r.font="16px sans-serif",r.beginPath(),r.fillStyle="#e74c3c",r.arc(B+15,J+20,6,0,Math.PI*2),r.fill(),r.fillStyle="#333",r.fillText("Current Scan",B+30,J+25),r.beginPath(),r.fillStyle="#2ecc71",r.arc(B+15,J+50,6,0,Math.PI*2),r.fill(),r.fillStyle="#333",r.fillText("Best So Far",B+30,J+55),!n&&S>=0&&(r.fillStyle="#333",r.font="bold 18px sans-serif",r.textAlign="right",r.fillText(`Min Error: ${A.toFixed(5)}`,f-20,y-20))},[e,t,n,i,s]);const u=i?Math.ceil((i.length+1)/d):1;return l("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff"},children:[l("canvas",{ref:a,width:1600,height:800,style:{width:"100%",height:"auto"}}),u>1&&l("div",{style:{display:"flex",justifyContent:"center",marginTop:"10px",gap:"10px"},children:[l("button",{onClick:()=>c(p=>Math.max(0,p-1)),disabled:s===0,children:"Previous"}),l("span",{style:{alignSelf:"center"},children:["Page ",s+1," of ",u]}),l("button",{onClick:()=>c(p=>Math.min(u-1,p+1)),disabled:s===u-1,children:"Next"})]})]})}function cn({model:e,inputs:t,inputLabels:n,output:i,outputLabel:a}){if(!e||!e.getTopology)return null;const{inputCount:s,hiddenCounts:c,outputCount:d,weights1:u,biases1:p,weights2:r}=e.getTopology();let f={hidden:[],output:[]};e.getActivations&&(f=e.getActivations(t));const y=600,x=400,w=x/2,P=y/2,S=350,A=280,b=P-S/2,L=P+S/2,B=[{count:s,x:b,labels:n,values:t},{count:c[0],x:P,values:f.hidden},{count:d,x:L,labels:[a],values:f.output}],J=Math.max(...B.map(_=>_.count)),R=Math.min(50,A/J),M=(_,g)=>{const T=(B[_].count-1)*R;return w-T/2+g*R},h=_=>{const g=Math.max(.2,Math.min(.8,Math.abs(_)/2));return _>0?`rgba(46, 204, 113, ${g})`:`rgba(231, 76, 60, ${g})`},I=_=>{const g=Math.max(0,Math.min(1,_)),v=Math.round(255+-203*g),T=Math.round(255+-103*g),H=Math.round(255+-36*g);return`rgb(${v},${T},${H})`};return l("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center"},children:[l("h3",{style:{marginBottom:"10px",fontSize:"1rem",color:"#555"},children:"Neural Network Activity"}),l("svg",{width:y,height:x,style:{overflow:"visible"},children:[l("rect",{x:b,y:w-A/2,width:S,height:A,rx:"15",fill:"none",stroke:"#333",strokeWidth:"3",strokeDasharray:"5,5"}),l("text",{x:P,y:w-A/2+20,textAnchor:"middle",fill:"#777",fontSize:"12",fontWeight:"bold",children:"NEURAL NETWORK"}),u.map((_,g)=>_.map((v,T)=>l("line",{x1:B[0].x,y1:M(0,T),x2:B[1].x,y2:M(1,g),stroke:h(v),strokeWidth:Math.max(1,Math.min(4,Math.abs(v)))},`L0-${T}-${g}`))),r.map((_,g)=>l("line",{x1:B[1].x,y1:M(1,g),x2:B[2].x,y2:M(2,0),stroke:h(_),strokeWidth:Math.max(1,Math.min(4,Math.abs(_)))},`L1-${g}-0`)),B.map((_,g)=>l("g",{children:Array.from({length:_.count}).map((v,T)=>{const H=_.x,E=M(g,T),O=_.values&&_.values[T]!==void 0?_.values[T]:0;return l("g",{children:[l("circle",{cx:H,cy:E,r:12,fill:I(O),stroke:"#333",strokeWidth:"1.5"}),_.labels&&l("text",{x:g===0?H-30:H+30,y:E,textAnchor:g===0?"end":"start",dominantBaseline:"middle",fontSize:"13",fontWeight:"bold",fill:"#333",children:_.labels[T]||""}),l("title",{children:O.toFixed(3)})]},`n-${g}-${T}`)})},`layer-${g}`)),l("g",{transform:`translate(${y-100}, ${x-50})`,children:[l("rect",{width:"90",height:"40",fill:"white",stroke:"#ccc",rx:"4"}),l("line",{x1:"10",y1:"10",x2:"30",y2:"10",stroke:"#2ecc71",strokeWidth:"3"}),l("text",{x:"35",y:"14",fontSize:"10",children:"Positive"}),l("line",{x1:"10",y1:"28",x2:"30",y2:"28",stroke:"#e74c3c",strokeWidth:"3"}),l("text",{x:"35",y:"32",fontSize:"10",children:"Negative"})]})]})]})}function De({input:e,weight:t,bias:n,output:i,formula:a="y = w * x + b",inputLabel:s="Input",outputLabel:c="Output",biasLabel:d="b",decimals:u=1,model:p=null}){if(p&&p.getTopology){let D=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(D=e.input);const j=Array.isArray(D)?D:[D],$=Array.isArray(s)?s:[s];return l(cn,{model:p,inputs:j,inputLabels:$,output:i,outputLabel:c})}let r=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(r=e.input);const f=Array.isArray(r)?r:[r],y=Array.isArray(t)?t:[t],x=Array.isArray(s)?s:[s],w=Number(n)||0,P=Number(i)||0,S=f.length,A=24,b=90,L=300,B=60,J=60,R=Math.max(1,S-1)*b,M=Math.max(150,R+B+J),h=M+60,I=600,_=I/2,g=_-L/2,v=_+L/2,T=M/2+20,H=T-R/2,E=v-50,O=E-60;return l("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[l("h3",{style:{marginBottom:"10px"},children:"Modell Architektur"}),l("svg",{width:I,height:h,style:{overflow:"visible"},children:[l("defs",{children:l("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"27",refY:"3.5",orient:"auto",children:l("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#333"})})}),l("rect",{x:g,y:20,width:L,height:M,rx:"15",fill:"none",stroke:"#333",strokeWidth:"3",strokeDasharray:"5,5"}),l("text",{x:_,y:40,textAnchor:"middle",fill:"#777",fontSize:"12",fontWeight:"bold",children:"NEURAL NETWORK"}),(()=>{const D=T-50;return l(vt,{children:[f.map((j,$)=>{const W=S>1?H+$*b:T,m=Number(y[$])||0,o=x[$]||`x${$+1}`,F=Number(j)||0;return l("g",{children:[l("line",{x1:g,y1:W,x2:O,y2:T,stroke:"#999",strokeWidth:"1"}),l("g",{transform:`translate(${(g+O)/2+($-(S-1)/2)*5}, ${(W+T)/2})`,children:[l("rect",{x:"-24",y:"-9",width:"50",height:"18",fill:"#fff",rx:"4",stroke:"#e0e0e0"}),l("text",{x:"0",y:"4",textAnchor:"middle",fill:"#e74c3c",fontSize:"10",fontWeight:"bold",children:m.toFixed(1)})]}),l("circle",{cx:g,cy:W,r:A,fill:"#fff",stroke:"#333",strokeWidth:"2"}),l("text",{x:g-40,y:W,textAnchor:"end",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",children:o}),l("text",{x:g,y:W,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fill:"#333",children:F.toFixed(u)})]},$)}),l("line",{x1:O,y1:T,x2:E,y2:T,stroke:"#333",strokeWidth:"2"}),l("g",{transform:`translate(${E}, ${T})`,children:[l("rect",{x:"-18",y:"-18",width:"36",height:"36",rx:"6",fill:"#fff",stroke:"#333",strokeWidth:"2"}),l("path",{d:"M -10 8 C -4 8, -4 -8, 10 -8",stroke:"#333",strokeWidth:"2",fill:"none"})]}),l("line",{x1:E+18,y1:T,x2:v-A,y2:T,stroke:"#333",strokeWidth:"2"}),l("path",{d:`M ${E-20} ${D} Q ${E-20} ${T} ${O+10} ${T}`,fill:"none",stroke:"#f39c12",strokeWidth:"1",markerEnd:"url(#arrowhead)"}),l("circle",{cx:E-20,cy:D,r:12,fill:"#f1c40f",stroke:"#f39c12"}),l("text",{x:E-23,y:D+5,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fontWeight:"bold",fill:"#fff",children:"b"}),l("text",{x:E-5,y:D+5,textAnchor:"start",dominantBaseline:"middle",fontSize:"12",fill:"#f39c12",fontWeight:"bold",children:w.toFixed(2)})]})})(),l("circle",{cx:v,cy:T,r:A,fill:"#fff",stroke:"#333",strokeWidth:"2"}),l("text",{x:v-14,y:T+4,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",fontSize:"12",children:P.toFixed(2)}),l("text",{x:v+40,y:T+4,textAnchor:"start",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:c}),l("text",{x:_,y:h-15,textAnchor:"middle",fontSize:"12",fontStyle:"italic",fill:"#777",children:a})]})]})}function hn({data:e,groundTruth:t,neuralNet:n}){const i=yt(null);return St(()=>{const a=i.current;if(!a)return;const s=a.getContext("2d"),c=a.width,d=a.height;if(s.clearRect(0,0,c,d),!e||e.length===0){s.fillStyle="#999",s.textAlign="center",s.fillText("Keine Daten vorhanden",c/2,d/2);return}const u=40,p=c-2*u,r=d-2*u,f=Math.max(...e.map(P=>P.input))||10,y=Math.max(...e.map(P=>P.target))||100,x=P=>u+P/f*p,w=P=>d-u-P/y*r;if(s.beginPath(),s.strokeStyle="#333",s.moveTo(u,u),s.lineTo(u,d-u),s.lineTo(c-u,d-u),s.stroke(),s.fillStyle="#333",s.textAlign="center",s.fillText("Zeit (t)",c/2,d-10),s.save(),s.translate(15,d/2),s.rotate(-Math.PI/2),s.fillText("Position (s)",0,0),s.restore(),e.forEach(P=>{const S=x(P.input),A=w(P.target);s.beginPath(),s.arc(S,A,3,0,Math.PI*2),s.fillStyle="#2ecc71",s.fill()}),n){s.beginPath(),s.strokeStyle="#e74c3c",s.lineWidth=2;for(let P=0;P<=f;P+=.1){const S=n.predict(P),A=x(P),b=w(S);P===0?s.moveTo(A,b):s.lineTo(A,b)}s.stroke()}},[e,t,n]),l("div",{style:{border:"1px solid #ccc",margin:"10px 0",borderRadius:"4px"},children:l("canvas",{ref:i,width:600,height:300,style:{width:"100%",display:"block"}})})}function dn({onTrain:e,onRun:t,onReset:n,isTraining:i,trainingStep:a,dataCount:s,trainerType:c,onTrainerTypeChange:d}){return l("div",{role:"region","aria-label":"Steuerung",style:{padding:"20px",background:"#eee",borderRadius:"8px",display:"flex",gap:"10px",flexWrap:"wrap",alignItems:"center"},children:[l("span",{"aria-live":"polite",children:["Datenpunkte: ",s]}),l("div",{style:{borderLeft:"1px solid #ccc",paddingLeft:"10px",marginLeft:"10px",display:"flex",gap:"5px",alignItems:"center"},children:[l("select",{value:c,onChange:u=>d(u.target.value),disabled:i,style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[l("option",{value:"exhaustive",children:"Grid Search "}),l("option",{value:"random",children:"Adaptive Random "})]}),l("button",{onClick:e,disabled:i||s===0,"aria-busy":i,children:i?"Suche läuft...":"2. Trainieren"})]}),l("button",{onClick:t,disabled:i,children:"3. Simulation Starten"}),l("button",{onClick:n,style:{marginLeft:"auto",background:"#e74c3c",color:"white"},"aria-label":"Simulation zurücksetzen",children:"Reset"})]})}function fn(){const[e,t]=st(0),n=[{name:"Simple Perceptron",input:.5,weight:.8,bias:.2,output:.6,inputLabel:"Input",formula:"y = w * x + b"},{name:"Spam Filter (2 Inputs)",input:[1,0],weight:[.5,-.2],bias:.1,output:.8,inputLabel:["Spam Word","Suspicious Link"],formula:"y = w1*x1 + w2*x2 + b"},{name:"Complex Model (5 Inputs)",input:[1,.5,-1,0,.2],weight:[.1,.2,.3,.4,.5],bias:-.5,output:.1,inputLabel:["F1","F2","F3","F4","F5"],formula:"y = Σ(wi*xi) + b"},{name:"Many Inputs (8 Inputs)",input:[1,0,1,0,1,0,1,0],weight:[.1,-.1,.1,-.1,.1,-.1,.1,-.1],bias:0,output:.5,inputLabel:["I1","I2","I3","I4","I5","I6","I7","I8"],formula:"y = ... "}],i=n[e];return l("div",{style:{padding:"20px"},children:[l("h2",{children:"Architecture Gallery"}),l("div",{style:{marginBottom:"20px"},children:[l("button",{onClick:()=>t((e-1+n.length)%n.length),children:"Previous"}),l("span",{style:{margin:"0 10px"},children:[i.name," (",e+1,"/",n.length,")"]}),l("button",{onClick:()=>t((e+1)%n.length),children:"Next"})]}),l("div",{style:{width:"400px",border:"1px dashed #ccc",padding:"10px"},children:l(De,{input:i.input,weight:i.weight,bias:i.bias,output:i.output,formula:i.formula,inputLabel:i.inputLabel})})]})}class un{constructor(t=30,n=50){this.velocity=t,this.initialPosition=n}getPosition(t){return this.velocity*t+this.initialPosition}}class pn{constructor(){this.weight=0,this.bias=0}predict(t){return this.weight*t+this.bias}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function gn({time:e,groundTruth:t,neuralNet:n,maxDistance:i=300}){const a=yt(null);St(()=>{const c=a.current;if(!c)return;const d=c.getContext("2d"),u=c.width,p=c.height,r=50,f=u-2*r;d.clearRect(0,0,u,p);const y=t.getPosition(e),x=n.predict(e),w=r+y%i/i*f,P=r+x%i/i*f;d.fillStyle="#f0f0f0",d.fillRect(0,0,u,p/2),d.fillStyle="#e0e0e0",d.fillRect(0,p/2,u,p/2),d.beginPath(),d.strokeStyle="#fff",d.setLineDash([20,20]),d.moveTo(0,p/4),d.lineTo(u,p/4),d.moveTo(0,p*3/4),d.lineTo(u,p*3/4),d.stroke(),d.beginPath(),d.strokeStyle="#ccc",d.setLineDash([]),d.moveTo(r,0),d.lineTo(r,p),d.moveTo(u-r,0),d.lineTo(u-r,p),d.stroke(),s(d,w,p/4,"#2ecc71","Ground Truth"),s(d,P,p*3/4,"#e74c3c","Neural Net"),d.fillStyle="#333",d.font="14px monospace",d.fillText(`Zeit: ${e.toFixed(1)}s`,10,20),d.fillText(`Pos GT: ${y.toFixed(1)}m`,10,40),d.fillText(`Pos NN: ${x.toFixed(1)}m`,10,p/2+40)},[e,t,n,i]);function s(c,d,u,p,r){c.save(),c.translate(d,u),c.fillStyle=p,c.fillRect(-20,-10,40,20),c.fillStyle="#000",c.fillRect(-15,-15,10,5),c.fillRect(5,-15,10,5),c.fillRect(-15,10,10,5),c.fillRect(5,10,10,5),c.fillStyle="#000",c.font="10px sans-serif",c.textAlign="center",c.fillText(r,0,-20),c.restore()}return l("div",{style:{border:"2px solid #333",borderRadius:"8px",overflow:"hidden"},children:l("canvas",{ref:a,width:800,height:300,style:{width:"100%",display:"block"}})})}const ge={id:"physics",title:"Phase 1: Lineare Regression (Exhaustive Search 2D)",description:"Physiksimulation: Weg-Zeit-Gesetz (s = v*t + s0)",Model:pn,GroundTruth:un,CanvasComponent:gn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[30,50],getInput:e=>e,generateData:e=>Array.from({length:20},(n,i)=>i*.5).map(n=>({input:n,target:e.getPosition(n)})),trainingConfig:{params:[{name:"weight",min:0,max:60,step:1},{name:"bias",min:0,max:100,step:2}]},networkViz:{formula:"pos = w * t + b",inputLabel:"Zeit (t)",outputLabel:"Pos (m)",biasLabel:"b"}};class mn{constructor(t=.5,n=-5){this.weight=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){const n=this.sigmoid(this.weight*t+this.bias);return Math.random()<n?1:0}getProbability(t){return this.sigmoid(this.weight*t+this.bias)}}class _n{constructor(){this.weight=0,this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=this.weight*t+this.bias;return this.sigmoid(n)}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function Nt(e,t,n=10){if(e===t)return[e];const i=me(t-e,!1),a=me(i/(n-1),!0),s=Math.floor(e/a)*a,c=Math.ceil(t/a)*a,d=[],u=a/1e3;for(let p=s;p<c+a/2;p+=a)p>=e-u&&p<=t+u&&d.push(Number(p.toPrecision(12)));return d}function me(e,t){const n=Math.floor(Math.log10(e)),i=e/Math.pow(10,n);let a;return t?i<1.5?a=1:i<3?a=2:i<7?a=5:a=10:i<=1?a=1:i<=2?a=2:i<=5?a=5:a=10,a*Math.pow(10,n)}function xn({time:e,groundTruth:t,neuralNet:n,data:i,staticMode:a=!1,showModel:s=!0,showGroundTruth:c=!0}){const d=yt(null),[u,p]=st({k:1,x:0,y:0}),[r,f]=st(!1),y=yt({x:0,y:0}),[x,w]=st(null),P=yt([]),S=M=>{M.preventDefault();const I=-M.deltaY*.001,_=u.k;let g=_*(1+I);g=Math.max(.5,Math.min(g,10));const v=d.current.getBoundingClientRect(),T=d.current.width/v.width,H=d.current.height/v.height,E=(M.clientX-v.left)*T,O=(M.clientY-v.top)*H,D=40,j=(E-D-u.x)/_,$=(O-(300-D)-u.y)/_,W=E-D-j*g,m=O-(300-D)-$*g;p({k:g,x:W,y:m})},A=M=>{f(!0),y.current={x:M.clientX,y:M.clientY}},b=M=>{const h=d.current;if(!h)return;const I=h.getBoundingClientRect(),_=h.width/I.width,g=h.height/I.height;if(r){const v=(M.clientX-y.current.x)*_,T=(M.clientY-y.current.y)*g;y.current={x:M.clientX,y:M.clientY},p(H=>({...H,x:H.x+v,y:H.y+T})),w(null)}else{const v=(M.clientX-I.left)*_,T=(M.clientY-I.top)*g;let H=null,E=15;const O=P.current;for(let D=O.length-1;D>=0;D--){const j=O[D],$=Math.sqrt(Math.pow(j.x-v,2)+Math.pow(j.y-T,2));$<E&&(E=$,H=j.info)}w(H)}},L=()=>f(!1),B=()=>{f(!1),w(null)},J=yt(0),R=()=>{const M=Date.now();M-J.current<300&&w(null),J.current=M};return St(()=>{const M=d.current;if(!M)return;const h=M.getContext("2d"),I=M.width,_=M.height;h.clearRect(0,0,I,_),P.current=[];const g=40,v=I-2*g,T=_-2*g,H=0,E=20,O=1,D=k=>g+k/E*v*u.k+u.x,j=k=>_-g-k/O*T*u.k+u.y,$=k=>(k-g-u.x)/(v*u.k)*E,W=k=>-((k-(_-g)-u.y)/(T*u.k))*O,m=$(g),o=$(I-g),F=W(_-g),z=W(g),Q=Nt(m,o,10),q=Nt(F,z,5);h.beginPath(),h.strokeStyle="#eee",h.lineWidth=1,h.fillStyle="#333",h.textAlign="center",h.textBaseline="top",h.font="10px sans-serif",Q.forEach(k=>{const U=D(k);U<g||U>I-g||(h.moveTo(U,g),h.lineTo(U,_-g),h.fillText(Number(k.toFixed(2)),U,_-g+5))}),h.textAlign="right",h.textBaseline="middle",q.forEach(k=>{const U=j(k);U<g||U>_-g||(h.moveTo(g,U),h.lineTo(I-g,U),h.fillText(Number(k.toFixed(2)),g-5,U))}),h.stroke(),h.beginPath(),h.strokeStyle="#333",h.lineWidth=1,h.rect(g,g,v,T),h.stroke(),h.fillStyle="#333",h.textAlign="center",h.textBaseline="alphabetic",h.fillText("Anzahl 'Spam' Wörter",I/2,_-10),h.save(),h.translate(15,_/2),h.rotate(-Math.PI/2),h.textAlign="center",h.fillText("Spam Wahrscheinlichkeit",0,0),h.restore(),h.save(),h.beginPath(),h.rect(g,g,v,T),h.clip();const Z=(k,U,N=[])=>{h.beginPath(),h.strokeStyle=U,h.setLineDash(N),h.lineWidth=2;const C=Math.max(H,m),Y=Math.min(E,o);if(Y<C)return;const X=(Y-C)/100,G=Math.max(X,.05);let tt=!1;for(let ut=C;ut<=Y+G;ut+=G){const lt=Math.min(Math.max(ut,H),E);let ct=0;typeof k.getProbability=="function"?ct=k.getProbability(lt):typeof k.predict=="function"&&(ct=k.predict(lt));const pt=D(lt),at=j(ct);tt?h.lineTo(pt,at):(h.moveTo(pt,at),tt=!0)}h.stroke(),h.setLineDash([])};if(c&&t&&Z(t,"#ccc",[5,5]),s&&n&&Z(n,"#e74c3c"),a&&i)i.forEach(k=>{if(k.input<m-5||k.input>o+5)return;const U=D(k.input),N=j(k.target);P.current.push({x:U,y:N,info:{x:U,y:N,input:k.input,target:k.target}});let C=null;if(n&&s)try{C=n.predict(k.input)>.5?"#e74c3c":"#2ecc71"}catch{}const Y=Math.sin(k.input*123)*5,X=Math.cos(k.input*321)*5;C&&(h.beginPath(),h.arc(U+Y,N+X,8,0,Math.PI*2),h.strokeStyle=C,h.lineWidth=2,h.stroke()),h.beginPath(),h.arc(U+Y,N+X,5,0,Math.PI*2),h.fillStyle=k.target===1?"#e74c3c":"#2ecc71",h.fill(),h.strokeStyle="#fff",h.lineWidth=1,h.stroke()});else if(!a){const U=Math.floor(e*2),N=50,C=X=>{const G=Math.sin(X*123.456)*1e4;return G-Math.floor(G)},Y=Math.min(U,N);for(let X=0;X<Y;X++){const G=C(X+1),tt=Math.floor(G*21),ut=t?t.getProbability(tt):0,lt=C(X+999)<ut?1:0;if(tt<m-5||tt>o+5)continue;const ct=D(tt),pt=j(lt);let at=null;if(n&&s)try{at=n.predict(tt)>.5?"#e74c3c":"#2ecc71"}catch{}const V=(C(X+333)-.5)*10,mt=(C(X+444)-.5)*10,gt=ct+V,_t=pt+mt;P.current.push({x:gt,y:_t,info:{x:gt,y:_t,input:tt,target:lt}}),at&&(h.beginPath(),h.arc(gt,_t,8,0,Math.PI*2),h.strokeStyle=at,h.lineWidth=2,h.stroke()),h.beginPath(),h.arc(gt,_t,5,0,Math.PI*2),h.fillStyle=lt?"#e74c3c":"#2ecc71",h.fill(),h.strokeStyle="#fff",h.lineWidth=1,h.stroke()}if(Y>0&&Y<=N){const X=Y-1,G=C(X+1),tt=Math.floor(G*21),ut=t.getProbability(tt),lt=C(X+999)<ut?1:0,ct=(C(X+333)-.5)*10,pt=(C(X+444)-.5)*10,at=D(tt)+ct,V=j(lt)+pt;at>g&&at<I-g&&V>g&&V<_-g&&(h.beginPath(),h.arc(at,V,8,0,Math.PI*2),h.strokeStyle="#333",h.stroke(),h.fillStyle="#333",h.font="10px sans-serif",h.fillText(`${tt}`,at,V-12))}}if(h.restore(),x){h.save(),h.fillStyle="rgba(0,0,0,0.8)",h.strokeStyle="#fff";const k=x.target===1?"SPAM":"HAM",U=`Words: ${x.input}`,N=100,C=40;let Y=x.x+10,X=x.y-10;Y+N>I&&(Y=x.x-N-10),X+C>_&&(X=x.y-C-10),X<0&&(X=x.y+10),h.beginPath(),h.roundRect(Y,X,N,C,4),h.fill(),h.lineWidth=1,h.stroke(),h.textBaseline="top",h.textAlign="left",h.font="bold 11px sans-serif",h.fillStyle=x.target===1?"#e74c3c":"#2ecc71",h.fillText(k,Y+8,X+6),h.fillStyle="#ddd",h.font="10px sans-serif",h.fillText(U,Y+8,X+20),h.restore()}},[e,t,n,i,a,s,c,u,x]),l("div",{className:"canvas-container",children:l("canvas",{ref:d,width:600,height:300,style:{width:"100%",border:"1px solid #ccc",background:"#fff",cursor:x?"pointer":r?"grabbing":"grab"},onWheel:S,onMouseDown:A,onMouseMove:b,onMouseUp:L,onMouseLeave:B,onClick:R})})}const yn=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},_e={id:"spam",title:"Phase 2: Logistische Regression (Spam Filter)",description:"Spam-Erkennung: Wahrscheinlichkeit p = σ(w*x + b)",Model:_n,GroundTruth:mn,CanvasComponent:xn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[.5,-5],getInput:e=>{const t=Math.floor(e);return Math.floor(yn(t)*20)},generateData:e=>{const t=[];for(let n=0;n<50;n++){const i=Math.floor(Math.random()*21),a=e.classify(i);t.push({input:i,target:a})}return t.sort((n,i)=>n.input-i.input)},trainingConfig:{params:[{name:"weight",min:0,max:2,step:.1},{name:"bias",min:-10,max:5,step:.5}]},networkViz:{formula:"p = σ(w * x + b)",inputLabel:"Wörter (x)",outputLabel:"Spam? (p)",biasLabel:"b"},isFinished:e=>e>=25};class Qt{constructor(t=[.5,.2,.8,-.1],n=-3){this.weights=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){let n=this.bias;for(let a=0;a<this.weights.length;a++)n+=this.weights[a]*t[a];const i=this.sigmoid(n);return Math.random()<i?1:0}getProbability(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}}class Ie{constructor(t=4){this.weights=new Array(t).fill(0),this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}setWeights(t){this.weights=[...t]}setBias(t){this.bias=t}setWeightAt(t,n){t>=0&&t<this.weights.length&&(this.weights[t]=n)}}const bn=[{label:"Spam Words",idx:0,max:15},{label:"Großbuchstaben",idx:1,max:25},{label:"Links",idx:2,max:8},{label:"Gesamtworte",idx:3,max:100}];function te({data:e,currentInput:t,currentPrediction:n,neuralNet:i,allowedModes:a=["features","scatter","3d","text"],hideControls:s=!1,showModel:c=!0,additionalControls:d=null,features:u=bn}){const p=yt(null),[r,f]=st(a[0]);St(()=>{a.includes(r)||f(a[0])},[a]);const[y,x]=st(0),[w,P]=st(u.length===2?1:3),[S,A]=st(2),[b,L]=st(!1),[B,J]=st({x:-.5,y:.5}),[R,M]=st({k:1,x:0,y:0}),h=yt(!1),I=yt({x:0,y:0}),[_,g]=st(null),v=yt([]),T=m=>{if(r!=="scatter")return;m.preventDefault();const F=-m.deltaY*.001,z=R.k;let Q=z*(1+F);Q=Math.max(.5,Math.min(Q,50));const q=p.current;if(!q)return;const Z=q.getBoundingClientRect(),k=q.width/Z.width,U=q.height/Z.height,N=(m.clientX-Z.left)*k,C=(m.clientY-Z.top)*U,Y=50,X=q.height-Y,G=(N-Y-R.x)/z,tt=(X+R.y-C)/z,ut=N-Y-G*Q,lt=C-X+tt*Q;M({k:Q,x:ut,y:lt})},H=m=>{r!=="3d"&&r!=="scatter"||(h.current=!0,I.current={x:m.clientX,y:m.clientY})},E=m=>{const o=p.current;if(!o)return;const F=o.getBoundingClientRect(),z=o.width/F.width,Q=o.height/F.height;if(h.current){const Y=(m.clientX-I.current.x)*z,X=(m.clientY-I.current.y)*Q;I.current={x:m.clientX,y:m.clientY},r==="3d"?J(G=>({x:G.x+X*.01,y:G.y+Y*.01})):r==="scatter"&&M(G=>({...G,x:G.x+Y,y:G.y+X}));return}const q=(m.clientX-F.left)*z,Z=(m.clientY-F.top)*Q;let k=null,N=15;const C=v.current;for(let Y=C.length-1;Y>=0;Y--){const X=C[Y],G=Math.sqrt((X.x-q)**2+(X.y-Z)**2);G<N&&(N=G,k=X.info)}g(k)},O=()=>{h.current=!1},D=()=>{g(null),h.current=!1},j=yt(0),$=()=>{const m=Date.now();m-j.current<300&&g(null),j.current=m};St(()=>{const m=p.current;if(!m)return;const o=m.getContext("2d"),F=m.width,z=m.height;o.clearRect(0,0,F,z),o.fillStyle="#fff",o.fillRect(0,0,F,z),v.current=[];const Q=q=>{if(!e||e.length===0)return u[q].max;const Z=Math.max(...e.map(k=>k.input[q]));return Z>0?Z:u[q].max};if(r==="3d"){const q=Q(y),Z=Q(w),k=Q(S),U=F/2,N=z/2,C=150,Y=(V,mt,gt)=>{let _t=V*Math.cos(B.y)-gt*Math.sin(B.y),K=V*Math.sin(B.y)+gt*Math.cos(B.y),et=mt*Math.cos(B.x)-K*Math.sin(B.x),rt=mt*Math.sin(B.x)+K*Math.cos(B.x);const nt=400/(400-rt);return{x:U+_t*nt,y:N+et*nt,z:rt}},G=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]].map(V=>Y(V[0]*C,V[1]*C,V[2]*C)),tt="#e29301ff",ut="#2980b9",lt="#c00798ff",ct=(V,mt)=>{o.beginPath(),o.strokeStyle=mt,o.lineWidth=1,V.forEach(([gt,_t])=>{o.moveTo(G[gt].x,G[gt].y),o.lineTo(G[_t].x,G[_t].y)}),o.stroke()};ct([[0,1],[3,2],[4,5],[7,6]],tt),ct([[0,3],[1,2],[4,7],[5,6]],ut),ct([[0,4],[1,5],[2,6],[3,7]],lt),o.font="bold 11px sans-serif",o.fillStyle=tt,o.fillText("X: "+u[y].label,G[1].x,G[1].y),o.fillStyle=ut,o.fillText("Y: "+u[w].label,G[3].x,G[3].y),o.fillStyle=lt,o.fillText("Z: "+u[S].label,G[4].x,G[4].y);const pt=[],at=(V,mt)=>V/mt*2-1;if(c&&i&&i.weights){const V=i.weights[y]||0,mt=i.weights[w]||0,gt=i.weights[S]||0,_t=i.bias||0;if(Math.abs(gt)>.001){o.strokeStyle="rgba(142, 68, 173, 0.3)",o.lineWidth=1;const K=(nt,it)=>{const xt=(nt+1)/2*q,dt=(it+1)/2*Z,wt=(-V*xt-mt*dt-_t)/gt;return at(wt,k)},et=(nt,it)=>{if(Math.abs(nt.z)<=3&&Math.abs(it.z)<=3){const xt=Y(nt.x*C,-nt.y*C,nt.z*C),dt=Y(it.x*C,-it.y*C,it.z*C);o.beginPath(),o.moveTo(xt.x,xt.y),o.lineTo(dt.x,dt.y),o.stroke()}},rt=6;for(let nt=0;nt<=rt;nt++){const it=-1+nt/rt*2,xt=K(-1,it),dt=K(1,it);et({x:-1,y:it,z:xt},{x:1,y:it,z:dt})}for(let nt=0;nt<=rt;nt++){const it=-1+nt/rt*2,xt=K(it,-1),dt=K(it,1);et({x:it,y:-1,z:xt},{x:it,y:1,z:dt})}}}e&&e.forEach(V=>{const mt=at(V.input[y],q),gt=-at(V.input[w],Z),_t=at(V.input[S],k),K=Y(mt*C,gt*C,_t*C);let et=null;if(i&&c)try{et=i.predict(V.input)>.5?"#e74c3c":"#2ecc71"}catch{}pt.push({...K,color:V.target===1?"#e74c3c":"#2ecc71",radius:3,haloColor:et,pt:V})}),pt.sort((V,mt)=>V.z-mt.z),pt.forEach(V=>{V.z<3&&v.current.push({x:V.x,y:V.y,info:{x:V.x,y:V.y,text:V.pt.text,isSpam:V.pt.target===1,features:{xLabel:u[y].label,xVal:V.pt.input[y],yLabel:u[w].label,yVal:V.pt.input[w],zLabel:u[S].label,zVal:V.pt.input[S]}}}),V.haloColor&&(o.beginPath(),o.arc(V.x,V.y,V.radius+2,0,Math.PI*2),o.strokeStyle=V.haloColor,o.lineWidth=1.5,o.stroke()),o.beginPath(),o.arc(V.x,V.y,V.radius,0,Math.PI*2),o.fillStyle=V.color,o.fill()})}if(r==="scatter"){const q=Q(y),Z=Q(w),k=50,U=F-2*k,N=z-2*k,C=z-k,Y="#c0392b",X="#2980b9",G=K=>k+K/q*U*R.k+R.x,tt=K=>C-K/Z*N*R.k+R.y;o.save(),o.beginPath(),o.rect(k,k,U,N),o.clip(),o.restore();const ut=K=>(K-k-R.x)/(U*R.k)*q,lt=K=>(C+R.y-K)/(N*R.k)*Z,ct=ut(k),pt=ut(k+U),at=lt(C),V=lt(k),mt=Nt(Math.min(ct,pt),Math.max(ct,pt),8),gt=Nt(Math.min(at,V),Math.max(at,V),6);if(o.lineWidth=1,o.strokeStyle="#eee",o.fillStyle="#666",o.font="10px sans-serif",o.textAlign="center",o.textBaseline="top",mt.forEach(K=>{const et=G(K);et<k||et>k+U||(o.beginPath(),o.moveTo(et,k),o.lineTo(et,C),o.stroke(),o.fillText(Number(K.toFixed(2)),et,C+5))}),o.textAlign="right",o.textBaseline="middle",gt.forEach(K=>{const et=tt(K);et<k||et>C||(o.beginPath(),o.moveTo(k,et),o.lineTo(k+U,et),o.stroke(),o.fillText(Number(K.toFixed(2)),k-5,et))}),o.strokeStyle="#ccc",o.lineWidth=2,o.strokeRect(k,k,U,N),o.textAlign="center",o.font="bold 12px sans-serif",o.fillStyle=Y,o.fillText(`${u[y].label}`,k+U/2,C+30),o.save(),o.translate(15,C-N/2),o.rotate(-Math.PI/2),o.fillStyle=X,o.fillText(`${u[w].label}`,0,0),o.restore(),o.save(),o.beginPath(),o.rect(k,k,U,N),o.clip(),b&&i&&u.length===2){const et=Math.floor(ct/.5)*.5,rt=Math.ceil(pt/.5)*.5,nt=Math.floor(at/.5)*.5,it=Math.ceil(V/.5)*.5;if((rt-et)/.5*((it-nt)/.5)<5e4)for(let dt=et;dt<=rt;dt+=.5)for(let wt=nt;wt<=it;wt+=.5)try{const Mt=[0,0];y<2&&(Mt[y]=dt),w<2&&(Mt[w]=wt);const bt=i.predict(Mt),Tt=G(dt),Rt=tt(wt),ee=G(dt+.5),ne=tt(wt+.5),Fe=Math.abs(ee-Tt),Be=Math.abs(Rt-ne),He=Math.min(Tt,ee),Ve=Math.min(Rt,ne),Xe=Math.round(46*(1-bt)+231*bt),Ge=Math.round(204*(1-bt)+76*bt),Ue=Math.round(113*(1-bt)+60*bt);o.fillStyle=`rgba(${Xe}, ${Ge}, ${Ue}, 0.2)`,o.fillRect(He,Ve,Fe+.5,Be+.5)}catch{}}const _t=(K,et,rt,nt,it)=>{const xt=G(K[y]),dt=tt(K[w]);it&&(o.beginPath(),o.arc(xt,dt,rt+3,0,2*Math.PI),o.strokeStyle=it,o.lineWidth=2,o.stroke()),o.beginPath(),o.arc(xt,dt,rt,0,2*Math.PI),o.fillStyle=et,o.fill(),nt&&(o.strokeStyle=nt,o.lineWidth=2,o.stroke())};if(e&&e.forEach(K=>{const et=G(K.input[y]),rt=tt(K.input[w]);if(et<k||et>k+U||rt<k||rt>C)return;v.current.push({x:et,y:rt,info:{x:et,y:rt,text:K.text,isSpam:K.target===1,features:{xLabel:u[y].label,xVal:K.input[y],yLabel:u[w].label,yVal:K.input[w]}}});let nt=null;if(i&&c)try{nt=i.predict(K.input)>.5?"#e74c3c":"#2ecc71"}catch{}_t(K.input,K.target===1?"#e74c3c":"#2ecc71",5,"#fff",nt)}),c&&i){let K=i.weights;const et=i.bias||0;if(K){const rt=K[y]||0,nt=K[w]||0,it=et;o.beginPath(),o.strokeStyle="rgba(142, 68, 173, 0.8)",o.lineWidth=2,o.setLineDash([10,5]);const xt=ct-(pt-ct),dt=pt+(pt-ct),wt=(Mt,bt)=>({x:G(Mt),y:tt(bt)});if(Math.abs(nt)>.001){const Mt=Rt=>(-rt*Rt-it)/nt,bt=wt(xt,Mt(xt)),Tt=wt(dt,Mt(dt));o.moveTo(bt.x,bt.y),o.lineTo(Tt.x,Tt.y)}else if(Math.abs(rt)>.001){const Mt=-it/rt,bt=wt(Mt,at-100),Tt=wt(Mt,V+100);o.moveTo(bt.x,bt.y),o.lineTo(Tt.x,Tt.y)}o.stroke(),o.setLineDash([])}}t&&_t(t,"#3498db",8,"#2980b9"),o.restore(),o.fillStyle="#666",o.textAlign="right",o.font="11px sans-serif",o.fillText("Rot=Spam, Grün=OK",F-10,20)}if(r==="text"){if(o.textAlign="center",o.textBaseline="middle",!t||!t.text){o.fillStyle="#999",o.font="20px sans-serif",o.fillText("Kein Text verfügbar",F/2,z/2);return}const q=n>.5,Z=q?"#feeff0":"#effaf0";o.fillStyle=Z,o.fillRect(0,0,F,z);const k=t.text;o.fillStyle="#333",o.font="24px serif";const U=k.split(" ");let N="";const C=35,Y=F/2;let X=z/3;const G=F-100;for(let lt=0;lt<U.length;lt++){const ct=N+U[lt]+" ";o.measureText(ct).width>G&&lt>0?(o.fillText(N,Y,X),N=U[lt]+" ",X+=C):N=ct}o.fillText(N,Y,X),X+=60;const tt=t.groundTruth===1;o.font="bold 16px sans-serif",o.fillStyle="#555",o.fillText(`Wahrheit: ${tt?"SPAM":"HAM"}`,Y,X),X+=30;const ut=(n*100).toFixed(1);o.font="bold 20px sans-serif",o.fillStyle=q?"#c0392b":"#27ae60",o.fillText(`Vorhersage: ${q?"SPAM":"HAM"} (${ut}%)`,Y,X);return}if(r==="features"){const Z=(F-90)/2,k=(z-90)/2;[{x:30,y:30,...u[0]},{x:30+Z+30,y:30,...u[1]},{x:30,y:30+k+30,...u[2]},{x:30+Z+30,y:30+k+30,...u[3]}].forEach(N=>{if(o.strokeStyle="#ccc",o.strokeRect(N.x,N.y,Z,k),o.fillStyle="#333",o.font="12px Arial",o.textAlign="center",o.fillText(N.label,N.x+Z/2,N.y-5),e&&e.forEach(C=>{const Y=C.input[N.idx],X=N.x+Y/N.max*Z,G=N.y+k-C.target*(k-20)-10;v.current.push({x:X,y:G,info:{x:X,y:G,text:C.text,isSpam:C.target===1,features:{valLabel:N.label,val:Y}}});let tt=null;if(i&&c)try{tt=i.predict(C.input)>.5?"#e74c3c":"#2ecc71"}catch{}tt&&(o.beginPath(),o.arc(X,G,4.5,0,2*Math.PI),o.strokeStyle=tt,o.lineWidth=1,o.stroke()),o.beginPath(),o.arc(X,G,3,0,2*Math.PI),o.fillStyle=C.target?"rgba(231, 76, 60, 0.6)":"rgba(46, 204, 113, 0.6)",o.fill()}),t){const C=t[N.idx],Y=N.x+C/N.max*Z;o.beginPath(),o.moveTo(Y,N.y),o.lineTo(Y,N.y+k),o.strokeStyle="#3498db",o.setLineDash([5,5]),o.stroke(),o.setLineDash([])}})}if(_&&(r==="features"||r==="scatter"||r==="3d")){o.save(),o.fillStyle="rgba(0,0,0,0.85)",o.strokeStyle="#fff";const q=_.text||"No Text",Z=_.isSpam?"SPAM":"HAM",k=o.measureText(q),U=Math.max(k.width,140)+20;let N=70;_.features&&(_.features.zLabel?N=90:_.features.yLabel?N=85:N=60);let C=_.x+15,Y=_.y-15;C+U>F&&(C=_.x-U-10),Y+N>z&&(Y=_.y-N-10),Y<0&&(Y=_.y+20),o.beginPath(),o.roundRect(C,Y,U,N,5),o.fill(),o.lineWidth=1,o.stroke(),o.textBaseline="top",o.textAlign="left",o.font="bold 12px sans-serif",o.fillStyle=_.isSpam?"#e74c3c":"#2ecc71",o.fillText(Z,C+10,Y+10),o.fillStyle="#ddd",o.font="italic 11px sans-serif",o.fillText(q,C+10,Y+28),_.features&&(o.fillStyle="#fff",o.font="11px monospace",_.features.xLabel?(o.fillText(`${_.features.xLabel}: ${_.features.xVal}`,C+10,Y+46),o.fillText(`${_.features.yLabel}: ${_.features.yVal}`,C+10,Y+60),_.features.zLabel&&o.fillText(`${_.features.zLabel}: ${_.features.zVal}`,C+10,Y+74)):_.features.valLabel&&o.fillText(`${_.features.valLabel}: ${_.features.val}`,C+10,Y+46)),o.restore()}},[e,t,n,i,r,y,w,S,B,c,R,b]);const W={features:"Alle Features",scatter:"2D Plot","3d":"3D Plot",text:"Text Mode"};return l("div",{style:{textAlign:"center"},children:[!s&&l("div",{style:{marginBottom:"10px",display:"flex",gap:"5px",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",fontSize:"0.9rem"},children:[l("div",{children:d}),l("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[l("select",{value:r,onChange:m=>f(m.target.value),style:{padding:"4px"},children:a.map(m=>l("option",{value:m,children:W[m]},m))}),(r==="scatter"||r==="3d")&&l(vt,{children:[l("span",{children:"X:"}),l("select",{value:y,onChange:m=>x(parseInt(m.target.value)),style:{padding:"4px"},children:u.map(m=>l("option",{value:m.idx,children:m.label},m.idx))}),l("span",{children:"Y:"}),l("select",{value:w,onChange:m=>P(parseInt(m.target.value)),style:{padding:"4px"},children:u.map(m=>l("option",{value:m.idx,children:m.label},m.idx))})]}),r==="scatter"&&u.length===2&&l("label",{style:{display:"flex",alignItems:"center",gap:"3px",marginLeft:"5px",fontSize:"0.8rem",cursor:"pointer",background:"#f5f5f5",padding:"2px 5px",borderRadius:"3px",border:"1px solid #ddd"},children:[l("input",{type:"checkbox",checked:b,onChange:m=>L(m.target.checked)}),"Show Grid"]}),r==="3d"&&l(vt,{children:[l("span",{children:"Z:"}),l("select",{value:S,onChange:m=>A(parseInt(m.target.value)),style:{padding:"4px"},children:u.map(m=>l("option",{value:m.idx,children:m.label},m.idx))})]})]})]}),l("canvas",{ref:p,width:600,height:400,style:{border:"1px solid #eee",maxWidth:"100%",borderRadius:"4px",cursor:_?"pointer":r==="3d"||r==="scatter"?h.current?"grabbing":"grab":"default"},onWheel:T,onMouseDown:H,onMouseMove:E,onMouseUp:O,onMouseLeave:O,onMouseOut:D,onClick:$}),!s&&l("div",{style:{fontSize:"0.8rem",color:"#666",marginTop:"5px"},children:r==="3d"?"Drag to rotate 3D view":r==="scatter"?"Drag to Pan, Scroll to Zoom":"Wähle Achsen für die Visualisierung"})]})}const xe=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Vt=e=>{const t=["winner","won","gift card","urgent","rolex","viagra","cash","prize","singles","marketing","buy","free","money","security alert","click","claim","fake","verification"],n=e.toLowerCase();let i=0;t.forEach(d=>{n.includes(d)&&(i+=1)}),i>10&&(i=10);const a=(e.match(/[A-Z]/g)||[]).length,s=(e.match(/http/g)||[]).length,c=e.split(/\s+/).length;return[i,a,s,c]},At={id:"spam_advanced",title:"Phase 3: Erweiterter Spam-Filter (4 Eingaben)",description:"Spam-Erkennung mit 4 Merkmalen: Spam-Worte, Großbuchstaben, Links, Gesamtworte.",Model:Ie,GroundTruth:Qt,CanvasComponent:te,defaultParams:{weights:[0,0,0,0],bias:0},groundTruthDefaults:[[1.5,.5,2,-.5],-5],getInput:e=>{const t=Math.floor(e*.3),n=xe(t)>.5,i=n?At.examples.spam:At.examples.ham,a=Math.floor(xe(t+99)*i.length),s=i[a],c=Vt(s);return c.text=s,c.groundTruth=n?1:0,c},examples:{spam:["WINNER! Won $1000 Gift Card! Claim at http://prize-giveaway.net","URGENT: Verify account at http://secure-bank-login.com/fraud","Cheap Rolex watches! 50% OFF at www.fake-watches.cn","Lose weight fast! Buy pills: http://diet-miracle.com","CONGRATS! Cash prize waiting: http://claim-money.org","HOT singles waiting! Chat now: http://local-dating.xyz","Refinance 1% APR. Apply: http://easy-loans.biz","Buy 1 get 1 FREE Viagra. http://meds-direct.com","Meet rich men. Signup: http://millionaire-match.com","SECURITY ALERT: Suspicious activity. Check http://account-security-check.com"],ham:["Meeting agenda for tomorrow's team sync","Hey, are we still on for lunch?","Invoice #12345 from AWS Services","Project deadline extended to Friday","Happy Birthday! Hope you have a great day.","Can you review this pull request?","Your Amazon order has shipped.","Fwd: Tickets for the concert","Question about the quarterly report","Let's catch up sometime next week."]},generateData:e=>{const t=[];At.examples.spam.forEach(n=>{const i=Vt(n),a=()=>(Math.random()-.5)*.1,s=i.map(c=>Math.max(0,c+a()));t.push({input:s,target:1,text:n})}),At.examples.ham.forEach(n=>{const a=Vt(n).map(s=>Math.max(0,s+(Math.random()-.5)*.1));t.push({input:a,target:0,text:n})});for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t},trainingConfig:{params:[{name:"w1 (Spam-Worte)",min:1,max:4,step:.5},{name:"w2 (Großbuchst.)",min:0,max:2,step:.5},{name:"w3 (Links)",min:0,max:3,step:.5},{name:"w4 (Gesamtworte)",min:-2,max:2,step:.5},{name:"bias",min:-8,max:8,step:2}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + w₃x₃ + w₄x₄ + b)",inputLabels:["Spam-Worte","Großbuchst.","Links","Gesamtworte"],outputLabel:"Spam? (p)",biasLabel:"b"},isFinished:e=>e>=50};class vn{constructor(t=2,n=10){this.inputCount=t,this.hiddenCount=n;const i=Math.sqrt(6/(t+n));this.weights1=Array(n).fill(0).map(()=>Array.from({length:t},()=>Math.random()*2*i-i)),this.biases1=Array(n).fill(0);const a=Math.sqrt(6/(n+1));this.weights2=Array.from({length:n},()=>Math.random()*2*a-a),this.bias2=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=[];for(let s=0;s<this.hiddenCount;s++){let c=this.biases1[s];for(let d=0;d<this.inputCount;d++)c+=this.weights1[s][d]*t[d];n.push(this.sigmoid(c))}let i=this.bias2;for(let s=0;s<this.hiddenCount;s++)i+=this.weights2[s]*n[s];return this.sigmoid(i)}getActivations(t){const n=[];for(let s=0;s<this.hiddenCount;s++){let c=this.biases1[s];for(let d=0;d<this.inputCount;d++)c+=this.weights1[s][d]*t[d];n.push(this.sigmoid(c))}let i=this.bias2;for(let s=0;s<this.hiddenCount;s++)i+=this.weights2[s]*n[s];const a=this.sigmoid(i);return{hidden:n,output:[a]}}setParams(t){for(let i=0;i<this.hiddenCount;i++){const a=`b1_${i}`;t[a]!==void 0&&(this.biases1[i]=t[a]);for(let s=0;s<this.inputCount;s++){const c=`w1_${i}_${s}`;t[c]!==void 0&&(this.weights1[i][s]=t[c])}}const n="b2";t[n]!==void 0&&(this.bias2=t[n]);for(let i=0;i<this.hiddenCount;i++){const a=`w2_${i}`;t[a]!==void 0&&(this.weights2[i]=t[a])}}getTopology(){return{inputCount:this.inputCount,hiddenCounts:[this.hiddenCount],outputCount:1,weights1:this.weights1,biases1:this.biases1,weights2:this.weights2,bias2:this.bias2}}}const Ye=[{label:"Gesamtworte",idx:0,max:400},{label:"Links",idx:1,max:10}],Ne=()=>{const e=[];for(let n=0;n<40;n++){let i,a,s;const c=Math.random();if(c<.1){const d=Math.floor(Math.max(0,10+Math.random()*40)),u=Math.floor(Math.random()*2);i=[d,u],a=0,s="Security Alert: Login Code "+Math.floor(Math.random()*9999)}else if(c<.6){const d=Math.floor(50+Math.random()*200),p=Math.random()>.2?1+Math.floor(Math.random()*5):0;i=[d,p],a=p>0?1:0,s=p>0?"You won a prize! Click here.":"Just a normal short message."}else{const d=250+Math.random()*150,u=Math.floor(Math.random()*8);i=[d,u],a=0,s="Attached is the quarterly report found at..."}i[0]=Math.max(0,Math.floor(i[0])),i[1]=Math.max(0,Math.floor(i[1])),e.push({input:i,target:a,text:s})}return console.log("Generated Data Export:"),console.log(JSON.stringify(e,null,2)),e},ye={id:"spam_nonlinear",title:"Phase 4: Nicht-lineare Daten",description:"Spam-Erkennung mit nur 2 Merkmalen, aber komplexer Verteilung. Ein einfacher linearer Klassifikator (Perzeptron) wird hier scheitern.",Model:Ie,GroundTruth:Qt,CanvasComponent:te,defaultParams:{weights:[0,0],bias:0},getInput:e=>({input:[50,0],text:"Live Input"}),generateData:e=>Ne(),trainingConfig:{params:[{name:"w1 (Worte)",min:-5,max:5,step:.5},{name:"w2 (Links)",min:-5,max:5,step:.5},{name:"bias",min:-10,max:10,step:1}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + b)",inputLabels:["Worte","Links"],outputLabel:"Spam?",biasLabel:"b"},featuresConfig:Ye,isFinished:e=>!1},wn=()=>{const e=[];for(let t=0;t<10;t++){e.push({name:`b1_${t}`,min:-3,max:3,step:1});for(let n=0;n<2;n++)e.push({name:`w1_${t}_${n}`,min:-3,max:3,step:1})}e.push({name:"b2",min:-3,max:3,step:1});for(let t=0;t<10;t++)e.push({name:`w2_${t}`,min:-5,max:5,step:1});return e},be={id:"spam_hidden",title:"Phase 5: Deep Learning (Hidden Layer)",description:'Spam-Erkennung mit einem Hidden Layer (10 Neuronen). Das Deep Neural Network kann die nicht-lineare Verteilung ("Spam-Insel") erkennen.',Model:vn,GroundTruth:Qt,CanvasComponent:te,defaultParams:{},getInput:e=>({input:[50,0],text:"Live Input"}),generateData:e=>Ne(),trainingConfig:{params:wn()},networkViz:{formula:"Deep Network",inputLabels:["Worte","Links"],outputLabel:"Spam?",biasLabel:"b"},featuresConfig:Ye,isFinished:e=>e>=50},ve={[ge.id]:ge,[_e.id]:_e,[At.id]:At,[ye.id]:ye,[be.id]:be};function Mn(e){return ve[e]||ve.physics}function kn(){const[e,t]=st(null),n=yt(null),i=yt(null),[a,s]=st(0),[c,d]=st(!1),[u,p]=st([]),[r,f]=st([]),[y,x]=st(-1),[w,P]=st(!1),[S,A]=st("simulation"),[b,L]=st("table"),[B,J]=st("random"),[R,M]=st("Bereit."),h=yt(0);St(()=>{const m=new URLSearchParams(window.location.search).get("sim")||"physics";if(m==="gallery"){t({id:"gallery",type:"gallery"});return}const o=Mn(m);if(!o){M("Fehler: Simulation nicht gefunden.");return}try{if(n.current=new o.GroundTruth(...o.groundTruthDefaults||[]),i.current=new o.Model,o.defaultParams&&(o.defaultParams.weight!==void 0&&i.current.setWeight(o.defaultParams.weight),o.defaultParams.weights!==void 0&&i.current.setWeights&&i.current.setWeights(o.defaultParams.weights),o.defaultParams.bias!==void 0&&i.current.setBias(o.defaultParams.bias)),t(o),n.current)try{const F=o.generateData(n.current);p(F)}catch(F){console.error("Auto-generate data error:",F)}}catch(F){console.error("Initialization Error:",F),M(`Init Fehler: ${F.message}`)}},[]),St(()=>{let W;const m=o=>{if(!c)return;h.current===0&&(h.current=o);const F=(o-h.current)/1e3;h.current=o;const z=Math.min(F,.1);s(Q=>{const Z=Q+z*3;return e&&e.isFinished&&e.isFinished(Z)&&(d(!1),M("Simulation beendet.")),Z}),W=requestAnimationFrame(m)};return c&&(h.current=0,W=requestAnimationFrame(m)),()=>cancelAnimationFrame(W)},[c,e]);const I=async()=>{try{if(u.length===0||!e)return;P(!0),x(0),f([]),M("Suche optimales Gewicht und Bias (Live Visualisierung)..."),A("training");const W=new ln(i.current),m=(F,z)=>{if(f(Q=>{const q=[...Q,...F];return x(q.length-1),q}),(z&&z.message||z&&z.message)&&M(z.message),z&&z.bestParams){if(i.current.setParams)i.current.setParams(z.bestParams);else if(i.current.setWeights){const{weights:Q,bias:q}=z.bestParams;i.current.setWeights(Q),i.current.setBias(q)}}else z&&z.bestWeight!==void 0&&(i.current.setWeight(z.bestWeight),i.current.setBias(z.bestBias))};let o;B==="random"?(M("Suche optimales Gewicht und Bias (Random Search)..."),o=await W.trainRandomAsync(u,e.trainingConfig.params,m)):e.trainingConfig.params?o=await W.trainAsync(u,e.trainingConfig.params,m):o=await W.trainAsync(u,e.trainingConfig.weightRange,e.trainingConfig.biasRange,m),M(`Training fertig! Min Error: ${o.minError.toFixed(5)}`),P(!1)}catch(W){console.error("Training Error:",W),P(!1),M(`Fehler beim Training: ${W.message}`)}},_=()=>{s(0),d(!0),M("Simulation läuft..."),A("simulation")},g=()=>{d(!1),s(0),p([]),f([]),x(-1);try{i.current&&e?.defaultParams&&(e.defaultParams.weight!==void 0&&i.current.setWeight(e.defaultParams.weight),e.defaultParams.weights!==void 0&&i.current.setWeights&&i.current.setWeights(e.defaultParams.weights),e.defaultParams.bias!==void 0&&i.current.setBias(e.defaultParams.bias))}catch(W){console.error("Reset Error:",W)}M("Reset durchgeführt.")};if(!e)return l("div",{children:"Lade Simulation..."});if(e.type==="gallery")return l("div",{className:"container",children:[l("header",{children:[l("h1",{children:"Neural Network Demonstrator"}),l("p",{children:"Architecture Gallery (Debug)"}),l("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:l("a",{href:"?sim=physics",style:{marginRight:"10px"},children:"Back to App"})})]}),l("main",{children:l(fn,{})})]});const v=e.CanvasComponent,T=e.networkViz||{},H=e.getInput?e.getInput(a):a,[E,O]=st(null),D=W=>{O(m=>m===W?null:W)},j={position:"absolute",top:"10px",right:"10px",zIndex:10,background:"rgba(255, 255, 255, 0.9)",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"0px"},$="all 0.4s cubic-bezier(0.4, 0, 0.2, 1)";return l("div",{className:"container",children:[l("header",{children:[l("h1",{children:"Neural Network Demonstrator"}),l("p",{children:e.title}),l("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:[l("a",{href:"?sim=physics",style:{marginRight:"10px",fontWeight:e.id==="physics"?"bold":"normal"},children:"Phase 1 (Physik)"}),l("a",{href:"?sim=spam",style:{marginRight:"10px",fontWeight:e.id==="spam"?"bold":"normal"},children:"Phase 2 (Spam)"}),l("a",{href:"?sim=spam_advanced",style:{marginRight:"10px",fontWeight:e.id==="spam_advanced"?"bold":"normal"},children:"Phase 3 (Spam Extended)"}),l("a",{href:"?sim=spam_nonlinear",style:{marginRight:"10px",fontWeight:e.id==="spam_nonlinear"?"bold":"normal"},children:"Phase 4 (Nonlinear)"}),l("a",{href:"?sim=spam_hidden",style:{fontWeight:e.id==="spam_hidden"?"bold":"normal"},children:"Phase 5 (Deep)"})]})]}),l("main",{children:[l("div",{className:"top-section",style:{display:"flex",gap:E?"0px":"20px",flexWrap:"nowrap",alignItems:"stretch",height:E?"calc(100vh - 200px)":"auto",minHeight:"500px",transition:$},children:[l("div",{className:"simulation-wrapper",style:{flex:E==="simulation"?"1 0 100%":E==="network"?"0 0 0%":"1 1 500px",opacity:E==="network"?0:1,overflow:"hidden",maxWidth:E==="network"?"0px":"100%",transition:$,position:"relative",display:"flex",flexDirection:"column"},children:[l("button",{onClick:()=>D("simulation"),style:j,title:E==="simulation"?"Originalgröße":"Maximieren",children:E==="simulation"?l(vt,{children:l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M4 14h6v6"}),l("path",{d:"M20 10h-6V4"}),l("path",{d:"M14 10l7-7"}),l("path",{d:"M3 21l7-7"})]})}):l(vt,{children:l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M15 3h6v6"}),l("path",{d:"M9 21H3v-6"}),l("path",{d:"M21 3l-7 7"}),l("path",{d:"M3 21l7-7"})]})})}),l("div",{className:"simulation-section",style:{height:"100%",display:"flex",flexDirection:"column"},children:[l("div",{className:"tabs",style:{paddingRight:"120px"},children:[l("button",{className:`tab-button ${S==="simulation"?"active":""}`,onClick:()=>A("simulation"),children:"Simulation"}),l("button",{className:`tab-button ${S==="data"?"active":""}`,onClick:()=>A("data"),children:"Daten"}),l("button",{className:`tab-button ${S==="training"?"active":""}`,onClick:()=>A("training"),children:"Training"})]}),l("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[" ",S==="simulation"&&l(vt,{children:[e.id==="spam"?l("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",border:"2px dashed #ddd",borderRadius:"8px",minHeight:"300px"},children:l("p",{style:{color:"#999"},children:'Daten-Visualisierung jetzt im "Daten" Tab'})}):(()=>{let W=0;try{i.current&&(W=i.current.predict(H))}catch(o){console.error("Predict Error",o)}const m={};return["spam_advanced","spam_hidden","spam_nonlinear"].includes(e.id)&&(m.allowedModes=["text"],m.hideControls=!0),e.featuresConfig&&(m.features=e.featuresConfig),l("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:l(v,{time:a,data:u,currentInput:H,currentPrediction:W,groundTruth:n.current,neuralNet:i.current,...m})})})(),l("div",{className:"stats",style:{marginTop:"auto",paddingTop:"10px"},children:[l("p",{children:e.description}),l("p",{style:{color:"#646cff",fontWeight:"bold"},children:["Status: ",R]})]})]}),S==="data"&&l("div",{className:"data-content",style:{flex:1,overflowY:"auto"},children:[(()=>{const W=l("div",{style:{display:"flex",justifyContent:"center"},children:l("div",{style:{background:"#eee",borderRadius:"4px",padding:"2px",display:"flex",gap:"2px"},children:[l("button",{onClick:()=>L("table"),style:{background:b==="table"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:b==="table"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:b==="table"?"bold":"normal",color:b==="table"?"#333":"#666"},children:"Tabelle"}),l("button",{onClick:()=>L("plot"),style:{background:b==="plot"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:b==="plot"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:b==="plot"?"bold":"normal",color:b==="plot"?"#333":"#666"},children:"Graph"})]})}),m=["spam_advanced","spam_hidden","spam_nonlinear"].includes(e.id);return l(vt,{children:[(!m||b==="table")&&l("div",{style:{marginBottom:"15px"},children:W}),(u.length>0||e.id!=="physics")&&b==="plot"&&l("div",{style:{marginBottom:"20px"},children:e.id==="physics"?l(hn,{data:u,groundTruth:n.current,neuralNet:r.length>0?i.current:null}):(()=>{const o={};return m?(o.allowedModes=["scatter","3d","features"],o.showModel=r.length>0,o.additionalControls=W):(o.staticMode=!0,o.showGroundTruth=!0,o.showModel=r.length>0),e.featuresConfig&&(o.features=e.featuresConfig),l(v,{time:0,data:u,groundTruth:n.current,neuralNet:i.current,...o})})()})]})})(),b==="table"&&l(vt,{children:u.length>0?l("div",{style:{maxHeight:E?"calc(100vh - 350px)":"400px",overflowY:"auto"},children:l("table",{style:{width:"100%",textAlign:"left",borderCollapse:"collapse",fontSize:"0.9rem"},children:[l("thead",{children:l("tr",{style:{background:"#eee",borderBottom:"2px solid #ddd"},children:[Array.isArray(T.inputLabels)?T.inputLabels.map((W,m)=>l("th",{style:{padding:"8px"},children:W},m)):l("th",{style:{padding:"8px"},children:["Input (",T.inputLabel,")"]}),l("th",{style:{padding:"8px"},children:"Target"}),u.length>0&&u[0].text&&l("th",{style:{padding:"8px"},children:"E-Mail Text"})]})}),l("tbody",{children:u.map((W,m)=>{const o=["spam","spam_advanced"].includes(e.id);let F="transparent",z=W.target,Q={padding:"8px"};if(o){const q=W.target===1;F=q?"#ffebee":"#e8f5e9",z=q?"SPAM":"HAM",Q={...Q,fontWeight:"bold",color:q?"#c0392b":"#27ae60"}}else z=typeof W.target=="number"?W.target.toFixed(2):W.target;return l("tr",{style:{background:F,borderBottom:"1px solid #ddd"},children:[Array.isArray(W.input)?W.input.map((q,Z)=>l("td",{style:{padding:"8px"},children:q.toFixed(0)},Z)):l("td",{style:{padding:"8px"},children:W.input.toFixed(2)}),l("td",{style:Q,children:z}),W.text&&l("td",{style:{padding:"8px",color:"#555",fontStyle:"italic",maxWidth:"300px"},children:W.text})]},m)})})]})}):l("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Noch keine Trainingsdaten generiert."})})]}),S==="training"&&l("div",{className:"training-content",style:{flex:1},children:r.length>0?l(an,{history:r,currentStepIndex:y,isTraining:w,paramsConfig:e.trainingConfig.params}):l("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Noch kein Training gestartet."})})]})]})]}),l("div",{className:"network-wrapper",style:{flex:E==="network"?"1 0 100%":E==="simulation"?"0 0 0%":`0 0 ${e.id==="spam_hidden"?"500px":"350px"}`,opacity:E==="simulation"?0:1,overflow:"hidden",maxWidth:E==="simulation"?"0px":"100%",transition:$,position:"relative",display:"flex",flexDirection:"column"},children:[l("button",{onClick:()=>D("network"),style:j,title:E==="network"?"Originalgröße":"Maximieren",children:E==="network"?l(vt,{children:l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M4 14h6v6"}),l("path",{d:"M20 10h-6V4"}),l("path",{d:"M14 10l7-7"}),l("path",{d:"M3 21l7-7"})]})}):l(vt,{children:l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M15 3h6v6"}),l("path",{d:"M9 21H3v-6"}),l("path",{d:"M21 3l-7 7"}),l("path",{d:"M3 21l7-7"})]})})}),l("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:l(De,{input:H,weight:i.current?i.current.weights||i.current.weight:0,bias:i.current?i.current.bias:0,output:i.current?i.current.predict(H):0,model:i.current,formula:T.formula,inputLabel:T.inputLabels||T.inputLabel,outputLabel:T.outputLabel,biasLabel:T.biasLabel,decimals:e.id.includes("spam")?0:1})})]})]}),l(dn,{onTrain:I,onRun:_,onReset:g,isTraining:w,trainingStep:y,dataCount:u.length,trainerType:B,onTrainerTypeChange:J})]})]})}Qe(l(kn,{}),document.getElementById("app"));
