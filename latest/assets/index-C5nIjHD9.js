(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();var Ht,ot,Se,Ct,oe,Te,Ae,Pe,Kt,Ut,jt,Rt={},Ce=[],Ke=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Vt=Array.isArray;function Tt(e,t){for(var n in t)e[n]=t[n];return e}function Zt(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Ze(e,t,n){var i,l,o,c={};for(o in t)o=="key"?i=t[o]:o=="ref"?l=t[o]:c[o]=t[o];if(arguments.length>2&&(c.children=arguments.length>3?Ht.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)c[o]===void 0&&(c[o]=e.defaultProps[o]);return Yt(e,c,i,l,null)}function Yt(e,t,n,i,l){var o={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:l??++Se,__i:-1,__u:0};return l==null&&ot.vnode!=null&&ot.vnode(o),o}function vt(e){return e.children}function Dt(e,t){this.props=e,this.context=t}function Lt(e,t){if(t==null)return e.__?Lt(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Lt(e):null}function We(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return We(e)}}function se(e){(!e.__d&&(e.__d=!0)&&Ct.push(e)&&!Nt.__r++||oe!=ot.debounceRendering)&&((oe=ot.debounceRendering)||Te)(Nt)}function Nt(){for(var e,t,n,i,l,o,c,d=1;Ct.length;)Ct.length>d&&Ct.sort(Ae),e=Ct.shift(),d=Ct.length,e.__d&&(n=void 0,i=void 0,l=(i=(t=e).__v).__e,o=[],c=[],t.__P&&((n=Tt({},i)).__v=i.__v+1,ot.vnode&&ot.vnode(n),Jt(t.__P,n,i,t.__n,t.__P.namespaceURI,32&i.__u?[l]:null,o,l??Lt(i),!!(32&i.__u),c),n.__v=i.__v,n.__.__k[n.__i]=n,ze(o,n,c),i.__e=i.__=null,n.__e!=l&&We(n)));Nt.__r=0}function Le(e,t,n,i,l,o,c,d,p,f,s){var h,y,_,b,A,S,C,w=i&&i.__k||Ce,z=t.length;for(p=Je(n,t,w,p,z),h=0;h<z;h++)(_=n.__k[h])!=null&&(y=_.__i==-1?Rt:w[_.__i]||Rt,_.__i=h,S=Jt(e,_,y,l,o,c,d,p,f,s),b=_.__e,_.ref&&y.ref!=_.ref&&(y.ref&&Qt(y.ref,null,_),s.push(_.ref,_.__c||b,_)),A==null&&b!=null&&(A=b),(C=!!(4&_.__u))||y.__k===_.__k?p=Re(_,p,e,C):typeof _.type=="function"&&S!==void 0?p=S:b&&(p=b.nextSibling),_.__u&=-7);return n.__e=A,p}function Je(e,t,n,i,l){var o,c,d,p,f,s=n.length,h=s,y=0;for(e.__k=new Array(l),o=0;o<l;o++)(c=t[o])!=null&&typeof c!="boolean"&&typeof c!="function"?(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?c=e.__k[o]=Yt(null,c,null,null,null):Vt(c)?c=e.__k[o]=Yt(vt,{children:c},null,null,null):c.constructor==null&&c.__b>0?c=e.__k[o]=Yt(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):e.__k[o]=c,p=o+y,c.__=e,c.__b=e.__b+1,d=null,(f=c.__i=Qe(c,n,p,h))!=-1&&(h--,(d=n[f])&&(d.__u|=2)),d==null||d.__v==null?(f==-1&&(l>s?y--:l<s&&y++),typeof c.type!="function"&&(c.__u|=4)):f!=p&&(f==p-1?y--:f==p+1?y++:(f>p?y--:y++,c.__u|=4))):e.__k[o]=null;if(h)for(o=0;o<s;o++)(d=n[o])!=null&&(2&d.__u)==0&&(d.__e==i&&(i=Lt(d)),Ee(d,d));return i}function Re(e,t,n,i){var l,o;if(typeof e.type=="function"){for(l=e.__k,o=0;l&&o<l.length;o++)l[o]&&(l[o].__=e,t=Re(l[o],t,n,i));return t}e.__e!=t&&(i&&(t&&e.type&&!t.parentNode&&(t=Lt(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Qe(e,t,n,i){var l,o,c,d=e.key,p=e.type,f=t[n],s=f!=null&&(2&f.__u)==0;if(f===null&&d==null||s&&d==f.key&&p==f.type)return n;if(i>(s?1:0)){for(l=n-1,o=n+1;l>=0||o<t.length;)if((f=t[c=l>=0?l--:o++])!=null&&(2&f.__u)==0&&d==f.key&&p==f.type)return c}return-1}function ae(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Ke.test(t)?n:n+"px"}function Et(e,t,n,i,l){var o,c;t:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||ae(e.style,t,"");if(n)for(t in n)i&&n[t]==i[t]||ae(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")o=t!=(t=t.replace(Pe,"$1")),c=t.toLowerCase(),t=c in e||t=="onFocusOut"||t=="onFocusIn"?c.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?i?n.u=i.u:(n.u=Kt,e.addEventListener(t,o?jt:Ut,o)):e.removeEventListener(t,o?jt:Ut,o);else{if(l=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function le(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Kt++;else if(t.t<n.u)return;return n(ot.event?ot.event(t):t)}}}function Jt(e,t,n,i,l,o,c,d,p,f){var s,h,y,_,b,A,S,C,w,z,N,q,W,P,u,B,x,g=t.type;if(t.constructor!=null)return null;128&n.__u&&(p=!!(32&n.__u),o=[d=t.__e=n.__e]),(s=ot.__b)&&s(t);t:if(typeof g=="function")try{if(C=t.props,w="prototype"in g&&g.prototype.render,z=(s=g.contextType)&&i[s.__c],N=s?z?z.props.value:s.__:i,n.__c?S=(h=t.__c=n.__c).__=h.__E:(w?t.__c=h=new g(C,N):(t.__c=h=new Dt(C,N),h.constructor=g,h.render=en),z&&z.sub(h),h.state||(h.state={}),h.__n=i,y=h.__d=!0,h.__h=[],h._sb=[]),w&&h.__s==null&&(h.__s=h.state),w&&g.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=Tt({},h.__s)),Tt(h.__s,g.getDerivedStateFromProps(C,h.__s))),_=h.props,b=h.state,h.__v=t,y)w&&g.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),w&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(w&&g.getDerivedStateFromProps==null&&C!==_&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(C,N),t.__v==n.__v||!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(C,h.__s,N)===!1){for(t.__v!=n.__v&&(h.props=C,h.state=h.__s,h.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(v){v&&(v.__=t)}),q=0;q<h._sb.length;q++)h.__h.push(h._sb[q]);h._sb=[],h.__h.length&&c.push(h);break t}h.componentWillUpdate!=null&&h.componentWillUpdate(C,h.__s,N),w&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(_,b,A)})}if(h.context=N,h.props=C,h.__P=e,h.__e=!1,W=ot.__r,P=0,w){for(h.state=h.__s,h.__d=!1,W&&W(t),s=h.render(h.props,h.state,h.context),u=0;u<h._sb.length;u++)h.__h.push(h._sb[u]);h._sb=[]}else do h.__d=!1,W&&W(t),s=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++P<25);h.state=h.__s,h.getChildContext!=null&&(i=Tt(Tt({},i),h.getChildContext())),w&&!y&&h.getSnapshotBeforeUpdate!=null&&(A=h.getSnapshotBeforeUpdate(_,b)),B=s,s!=null&&s.type===vt&&s.key==null&&(B=$e(s.props.children)),d=Le(e,Vt(B)?B:[B],t,n,i,l,o,c,d,p,f),h.base=t.__e,t.__u&=-161,h.__h.length&&c.push(h),S&&(h.__E=h.__=null)}catch(v){if(t.__v=null,p||o!=null)if(v.then){for(t.__u|=p?160:128;d&&d.nodeType==8&&d.nextSibling;)d=d.nextSibling;o[o.indexOf(d)]=null,t.__e=d}else{for(x=o.length;x--;)Zt(o[x]);Ot(t)}else t.__e=n.__e,t.__k=n.__k,v.then||Ot(t);ot.__e(v,t,n)}else o==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):d=t.__e=tn(n.__e,t,n,i,l,o,c,p,f);return(s=ot.diffed)&&s(t),128&t.__u?void 0:d}function Ot(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Ot)}function ze(e,t,n){for(var i=0;i<n.length;i++)Qt(n[i],n[++i],n[++i]);ot.__c&&ot.__c(t,e),e.some(function(l){try{e=l.__h,l.__h=[],e.some(function(o){o.call(l)})}catch(o){ot.__e(o,l.__v)}})}function $e(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Vt(e)?e.map($e):Tt({},e)}function tn(e,t,n,i,l,o,c,d,p){var f,s,h,y,_,b,A,S=n.props||Rt,C=t.props,w=t.type;if(w=="svg"?l="http://www.w3.org/2000/svg":w=="math"?l="http://www.w3.org/1998/Math/MathML":l||(l="http://www.w3.org/1999/xhtml"),o!=null){for(f=0;f<o.length;f++)if((_=o[f])&&"setAttribute"in _==!!w&&(w?_.localName==w:_.nodeType==3)){e=_,o[f]=null;break}}if(e==null){if(w==null)return document.createTextNode(C);e=document.createElementNS(l,w,C.is&&C),d&&(ot.__m&&ot.__m(t,o),d=!1),o=null}if(w==null)S===C||d&&e.data==C||(e.data=C);else{if(o=o&&Ht.call(e.childNodes),!d&&o!=null)for(S={},f=0;f<e.attributes.length;f++)S[(_=e.attributes[f]).name]=_.value;for(f in S)if(_=S[f],f!="children"){if(f=="dangerouslySetInnerHTML")h=_;else if(!(f in C)){if(f=="value"&&"defaultValue"in C||f=="checked"&&"defaultChecked"in C)continue;Et(e,f,null,_,l)}}for(f in C)_=C[f],f=="children"?y=_:f=="dangerouslySetInnerHTML"?s=_:f=="value"?b=_:f=="checked"?A=_:d&&typeof _!="function"||S[f]===_||Et(e,f,_,S[f],l);if(s)d||h&&(s.__html==h.__html||s.__html==e.innerHTML)||(e.innerHTML=s.__html),t.__k=[];else if(h&&(e.innerHTML=""),Le(t.type=="template"?e.content:e,Vt(y)?y:[y],t,n,i,w=="foreignObject"?"http://www.w3.org/1999/xhtml":l,o,c,o?o[0]:n.__k&&Lt(n,0),d,p),o!=null)for(f=o.length;f--;)Zt(o[f]);d||(f="value",w=="progress"&&b==null?e.removeAttribute("value"):b!=null&&(b!==e[f]||w=="progress"&&!b||w=="option"&&b!=S[f])&&Et(e,f,b,S[f],l),f="checked",A!=null&&A!=e[f]&&Et(e,f,A,S[f],l))}return e}function Qt(e,t,n){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&t==null||(e.__u=e(t))}else e.current=t}catch(l){ot.__e(l,n)}}function Ee(e,t,n){var i,l;if(ot.unmount&&ot.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||Qt(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){ot.__e(o,t)}i.base=i.__P=null}if(i=e.__k)for(l=0;l<i.length;l++)i[l]&&Ee(i[l],t,n||typeof e.type!="function");n||Zt(e.__e),e.__c=e.__=e.__e=void 0}function en(e,t,n){return this.constructor(e,n)}function nn(e,t,n){var i,l,o,c;t==document&&(t=document.documentElement),ot.__&&ot.__(e,t),l=(i=!1)?null:t.__k,o=[],c=[],Jt(t,e=t.__k=Ze(vt,null,[e]),l||Rt,Rt,t.namespaceURI,l?null:t.firstChild?Ht.call(t.childNodes):null,o,l?l.__e:t.firstChild,i,c),ze(o,e,c)}Ht=Ce.slice,ot={__e:function(e,t,n,i){for(var l,o,c;t=t.__;)if((l=t.__c)&&!l.__)try{if((o=l.constructor)&&o.getDerivedStateFromError!=null&&(l.setState(o.getDerivedStateFromError(e)),c=l.__d),l.componentDidCatch!=null&&(l.componentDidCatch(e,i||{}),c=l.__d),c)return l.__E=l}catch(d){e=d}throw e}},Se=0,Dt.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Tt({},this.state),typeof e=="function"&&(e=e(Tt({},n),this.props)),e&&Tt(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),se(this))},Dt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),se(this))},Dt.prototype.render=vt,Ct=[],Te=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ae=function(e,t){return e.__v.__b-t.__v.__b},Nt.__r=0,Pe=/(PointerCapture)$|Capture$/i,Kt=0,Ut=le(!1),jt=le(!0);var rn=0;function a(e,t,n,i,l,o){t||(t={});var c,d,p=t;if("ref"in p)for(d in p={},t)d=="ref"?c=t[d]:p[d]=t[d];var f={type:e,props:p,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--rn,__i:-1,__u:0,__source:l,__self:o};if(typeof e=="function"&&(c=e.defaultProps))for(d in c)p[d]===void 0&&(p[d]=c[d]);return ot.vnode&&ot.vnode(f),f}var zt,ht,Xt,ce,Ft=0,Ye=[],ut=ot,he=ut.__b,de=ut.__r,ue=ut.diffed,fe=ut.__c,pe=ut.unmount,ge=ut.__;function te(e,t){ut.__h&&ut.__h(ht,e,Ft||t),Ft=0;var n=ht.__H||(ht.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function lt(e){return Ft=1,on(Ie,e)}function on(e,t,n){var i=te(zt++,2);if(i.t=e,!i.__c&&(i.__=[Ie(void 0,t),function(d){var p=i.__N?i.__N[0]:i.__[0],f=i.t(p,d);p!==f&&(i.__N=[f,i.__[1]],i.__c.setState({}))}],i.__c=ht,!ht.__f)){var l=function(d,p,f){if(!i.__c.__H)return!0;var s=i.__c.__H.__.filter(function(y){return!!y.__c});if(s.every(function(y){return!y.__N}))return!o||o.call(this,d,p,f);var h=i.__c.props!==d;return s.forEach(function(y){if(y.__N){var _=y.__[0];y.__=y.__N,y.__N=void 0,_!==y.__[0]&&(h=!0)}}),o&&o.call(this,d,p,f)||h};ht.__f=!0;var o=ht.shouldComponentUpdate,c=ht.componentWillUpdate;ht.componentWillUpdate=function(d,p,f){if(this.__e){var s=o;o=void 0,l(d,p,f),o=s}c&&c.call(this,d,p,f)},ht.shouldComponentUpdate=l}return i.__N||i.__}function At(e,t){var n=te(zt++,3);!ut.__s&&De(n.__H,t)&&(n.__=e,n.u=t,ht.__H.__h.push(n))}function _t(e){return Ft=5,sn(function(){return{current:e}},[])}function sn(e,t){var n=te(zt++,7);return De(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function an(){for(var e;e=Ye.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(It),e.__H.__h.forEach(qt),e.__H.__h=[]}catch(t){e.__H.__h=[],ut.__e(t,e.__v)}}ut.__b=function(e){ht=null,he&&he(e)},ut.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),ge&&ge(e,t)},ut.__r=function(e){de&&de(e),zt=0;var t=(ht=e.__c).__H;t&&(Xt===ht?(t.__h=[],ht.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(It),t.__h.forEach(qt),t.__h=[],zt=0)),Xt=ht},ut.diffed=function(e){ue&&ue(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ye.push(t)!==1&&ce===ut.requestAnimationFrame||((ce=ut.requestAnimationFrame)||ln)(an)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Xt=ht=null},ut.__c=function(e,t){t.some(function(n){try{n.__h.forEach(It),n.__h=n.__h.filter(function(i){return!i.__||qt(i)})}catch(i){t.some(function(l){l.__h&&(l.__h=[])}),t=[],ut.__e(i,n.__v)}}),fe&&fe(e,t)},ut.unmount=function(e){pe&&pe(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{It(i)}catch(l){t=l}}),n.__H=void 0,t&&ut.__e(t,n.__v))};var me=typeof requestAnimationFrame=="function";function ln(e){var t,n=function(){clearTimeout(i),me&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,35);me&&(t=requestAnimationFrame(n))}function It(e){var t=ht,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),ht=t}function qt(e){var t=ht;e.__c=e.__(),ht=t}function De(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function Ie(e,t){return typeof t=="function"?t(e):t}function cn(e){return function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}class hn{constructor(t){this.model=t}train(t,n,i){if(i!==void 0)return this.trainLegacy(t,n,i);const l=n,o=[];let c=1/0,d={};const p=s=>{const h=[];if(s.step<=0)return[s.min];for(let y=s.min;y<=s.max+1e-4;y+=s.step)h.push(parseFloat(y.toFixed(2)));return h},f=(s,h)=>{if(console.log({paramIndex:s,currentParams:h}),s===l.length){const b=[];let A=0;h.forEach((W,P)=>{l[P].name.toLowerCase().includes("bias")?A=W:b.push(W)}),this.model.setWeights?this.model.setWeights(b):this.model.setWeight&&this.model.setWeight(b[0]),this.model.setBias(A);let S=0,C=0;for(const W of t){const P=this.model.predict(W.input),u=W.target-P;S+=u*u,C+=Math.abs(u)}const w=S/t.length,z=C/t.length;let N=0;for(const W of t)(this.model.predict(W.input)>=.5?1:0)===W.target&&N++;const q=N/t.length;w<c&&(c=w,d={weights:[...b],bias:A}),o.push({params:[...h],error:w,mae:z,accuracy:q});return}const y=l[s],_=p(y);for(const b of _)h[s]=b,f(s+1,h)};return f(0,new Array(l.length)),{bestParams:d,history:o,minError:c}}trainLegacy(t,n,i){const l=[];let o=n.min,c=i.min,d=1/0;for(let p=n.min;p<=n.max;p+=n.step)for(let f=i.min;f<=i.max;f+=i.step){const s=parseFloat(p.toFixed(2)),h=parseFloat(f.toFixed(2));this.model.setWeight(s),this.model.setBias(h);let y=0,_=0;for(const w of t){const z=this.model.predict(w.input),N=w.target-z;y+=N*N,_+=Math.abs(N)}const b=y/t.length,A=_/t.length;let S=0;for(const w of t)(this.model.predict(w.input)>=.5?1:0)===w.target&&S++;const C=S/t.length;b<d&&(d=b,o=s,c=h),l.push({weight:s,bias:h,error:b,mae:A,accuracy:C})}return{bestWeight:o,bestBias:c,history:l}}async trainAsync(t,n,i){if(!Array.isArray(n)){const _=arguments[1],b=arguments[2],A=arguments[3];let S=_.min,C=b.min,w=1/0,z=[];const N=20;let q=0;for(let W=_.min;W<=_.max;W+=_.step)for(let P=b.min;P<=b.max;P+=b.step){const u=parseFloat(W.toFixed(2)),B=parseFloat(P.toFixed(2));this.model.setWeight(u),this.model.setBias(B);let x=0,g=0;for(const Y of t){const K=this.model.predict(Y.input),D=Y.target-K;x+=D*D,g+=Math.abs(D)}const v=x/t.length,T=g/t.length;let X=0;for(const Y of t)(this.model.predict(Y.input)>=.5?1:0)===Y.target&&X++;const L=X/t.length;v<w&&(w=v,S=u,C=B);const Z={weight:u,bias:B,error:v,mae:T,accuracy:L};z.push(Z),q++,q%N===0&&(A&&A(z,{bestWeight:S,bestBias:C,minError:w}),z=[],await new Promise(Y=>setTimeout(Y,0)))}return z.length>0&&A&&A(z,{bestWeight:S,bestBias:C,minError:w}),{bestWeight:S,bestBias:C,minError:w}}let o=1/0,c={},d=0;const p=50;let f=[];const s=_=>{const b=[];if(_.step<=0)return[_.min];for(let A=_.min;A<=_.max+1e-4;A+=_.step)b.push(parseFloat(A.toFixed(2)));return b},h=n.map(s),y=async(_,b)=>{if(_===n.length){const S=[];let C=0;b.forEach((x,g)=>{n[g].name.toLowerCase().includes("bias")?C=x:S.push(x)});let w={};this.model.setParams?(b.forEach((x,g)=>{w[n[g].name]=x}),this.model.setParams(w),C===void 0&&(C=0)):(this.model.setWeights?this.model.setWeights(S):this.model.setWeight&&this.model.setWeight(S[0]),this.model.setBias(C),w={weights:[...S],bias:C});let z=0,N=0;for(const x of t){const g=this.model.predict(x.input),v=x.target-g;z+=v*v,N+=Math.abs(v)}const q=z/t.length,W=N/t.length;let P=0;for(const x of t)(this.model.predict(x.input)>=.5?1:0)===x.target&&P++;const u=P/t.length;q<o&&(o=q,c=w);const B={params:[...b],error:q,mae:W,accuracy:u};f.push(B),d++,d%p===0&&(i&&i(f,{bestParams:c,minError:o}),f=[],await new Promise(x=>setTimeout(x,0)));return}const A=h[_];for(const S of A)b[_]=S,await y(_+1,b)};return await y(0,new Array(n.length)),f.length>0&&i&&i(f,{bestParams:c,minError:o}),{bestParams:c,minError:o}}async trainRandomAsync(t,n,i,l={}){const{patience:o=5e3,seed:c,maxSteps:d=1e4,initialRadius:p=.8,phase1Ratio:f=.8}=l,s=d,h=p,y=.999,_=f;let b=1/0,A={},S=c;S==null?(S=Math.floor(Math.random()*2147483647),console.log(`[AdaptiveRandom] Generated Seed: ${S}`)):console.log(`[AdaptiveRandom] Using Seed: ${S}`);const C=cn(S);let w=n.map(g=>({min:g.min,max:g.max,span:g.max-g.min})),z=w.map(g=>g.min+C()*g.span);const N=g=>{const v=[];let T=0;g.forEach((D,k)=>{n[k].name.toLowerCase().includes("bias")?T=D:v.push(D)});let X={};this.model.setParams?(g.forEach((D,k)=>{X[n[k].name]=D}),this.model.setParams(X)):(this.model.setWeights?this.model.setWeights(v):this.model.setWeight&&this.model.setWeight(v[0]),this.model.setBias(T),X={weights:v,bias:T});let L=0,Z=0;for(const D of t){const k=this.model.predict(D.input),m=D.target-k;L+=m*m,Z+=Math.abs(m)}let Y=0;for(const D of t)(this.model.predict(D.input)>=.5?1:0)===D.target&&Y++;const K=Y/t.length;return{mse:L/t.length,mae:Z/t.length,accuracy:K,decodedParams:X,weights:v,bias:T}};let q=N(z);b=q.mse,A=q.decodedParams?{...q.decodedParams,_array:[...z]}:{weights:q.weights,bias:q.bias,_array:[...z]},i&&i([{params:[...z],error:b,mae:q.mae,accuracy:q.accuracy}],{bestParams:A,minError:b}),await new Promise(g=>setTimeout(g,0));let W=[];const P=10;let u=b,B=[...z],x=0;for(let g=0;g<s;g++){const v=g<s*_;let T;if(v){const k=g/(s*_);T=h*(1-k*.5)}else T=h*.5*Math.pow(y,g-s*_);let X=!1;const L=[...B];let Z=!1;for(;!Z;)L.forEach((k,m)=>{if(C()<.4)return;Z=!0;const r=w[m];let I=!1;if(v){const st=r.span*.3,$=A._array&&Math.abs(k-A._array[m])<1e-9;$&&k<r.min+st&&(r.min-=r.span*.4,r.span=r.max-r.min,I=!0),$&&k>r.max-st&&(r.max+=r.span*.4,r.span=r.max-r.min,I=!0),I&&(X=!0)}let V=r.span*T;I&&(V=Math.max(V,r.span*.25));const O=V;let Q=k+(C()-.5)*2*O;Q<r.min&&(Q=r.min),Q>r.max&&(Q=r.max),L[m]=Q});const Y=N(L),K=Y.mse-u;let D=!1;if(K<0&&(D=!0),D&&(B=L,u=Y.mse),Y.mse<b?(b=Y.mse,A=Y.decodedParams?{...Y.decodedParams,_array:[...L]}:{weights:Y.weights,bias:Y.bias,_array:[...L]},x=0):x++,x>=o&&!v)break;if(W.push({params:[...L],error:Y.mse,mae:Y.mae,accuracy:Y.accuracy}),W.length>=P){let k;X&&(k="Grenzen dynamisch erweitert..."),i&&i(W,{bestParams:A,minError:b,message:k}),W=[],await new Promise(m=>setTimeout(m,0))}}return W.length>0&&i&&i(W,{bestParams:A,minError:b}),{bestParams:A,minError:b}}}function dn({history:e,currentStepIndex:t,isTraining:n,paramsConfig:i}){const l=_t(null),[o,c]=lt(0),d=6;At(()=>{c(0)},[i]),At(()=>{const f=l.current;if(!f||!e||e.length===0)return;const s=f.getContext("2d"),h=f.width,y=f.height;s.clearRect(0,0,h,y),s.fillStyle="#fff",s.fillRect(0,0,h,y);const _=Math.max(...e.map(W=>W.error)),A=!n&&e.length>0?e.length-1:t!==null&&t>=0?Math.min(t,e.length-1):-1;let S=-1,C=1/0;for(let W=0;W<=A;W++)e[W].error<C&&(C=e[W].error,S=W);let w=[];if(i){const W=1+i.length,P=o*d,u=Math.min(P+d,W),B=3,x=2,g=h/B,v=y/x;for(let T=P;T<u;T++){const X=T-P,L=X%B,Z=Math.floor(X/B),Y=L*g,K=Z*v;if(T===0){const D=Math.max(10,e.length-1);w.push({type:"accuracy_step",xLabel:"Training Step",xMin:0,xMax:D,yMode:"accuracy",getValue:(k,m)=>m,getYValue:k=>k.accuracy||0,offsetX:Y,offsetY:K,w:g,h:v,showYAxis:!0})}else if(T===1){const D=Math.max(10,e.length-1);w.push({type:"error_step",xLabel:"Training Step",xMin:0,xMax:D,yMode:"error_log",getValue:(k,m)=>m,getYValue:k=>k.error,offsetX:Y,offsetY:K,w:g,h:v,showYAxis:!0})}else{const D=T-2,k=i[D],m=e.map(V=>V.params[D]),r=Math.min(...m),I=Math.max(...m);w.push({type:"param_error",xLabel:k.name,xMin:r,xMax:I,yMode:"error_log",getValue:V=>V.params[D],getYValue:V=>V.error,offsetX:Y,offsetY:K,w:g,h:v})}}}else{const W=h/2,P=y/2,u=e.map(g=>g.weight),B=e.map(g=>g.bias),x=Math.max(10,e.length-1);w=[{type:"accuracy_step",xLabel:"Accuracy",xMin:0,xMax:x,yMode:"accuracy",getValue:(g,v)=>v,getYValue:g=>g.accuracy||0,offsetX:0,offsetY:0,w:W,h:P,showYAxis:!0},{type:"error_step",xLabel:"Step",xMin:0,xMax:x,yMode:"error_log",getValue:(g,v)=>v,getYValue:g=>g.error,offsetX:W,offsetY:0,w:W,h:P,showYAxis:!0},{xLabel:"Weight",xMin:Math.min(...u),xMax:Math.max(...u),yMode:"error_log",getValue:g=>g.weight,getYValue:g=>g.error,offsetX:0,offsetY:P,w:W,h:P},{xLabel:"Bias",xMin:Math.min(...B),xMax:Math.max(...B),yMode:"error_log",getValue:g=>g.bias,getYValue:g=>g.error,offsetX:W,offsetY:P,w:W,h:P}]}const z=50;w.forEach(W=>{const{xLabel:P,xMin:u,xMax:B,getValue:x,getYValue:g,offsetX:v,offsetY:T,w:X,h:L,yMode:Z,showYAxis:Y}=W,K=m=>v+z+(m-u)/(B-u||1)*(X-2*z);let D;if(Z==="accuracy")D=m=>T+L-z-m*(L-2*z);else{const r=_||1;D=I=>{const V=(I-0)/(r-0);return T+L-z-V*(L-2*z)}}s.strokeStyle="#eee",s.lineWidth=2,s.strokeRect(v,T,X,L),s.beginPath(),s.strokeStyle="#333",s.lineWidth=2,s.moveTo(v+z,T+z),s.lineTo(v+z,T+L-z),s.lineTo(v+X-z,T+L-z),s.stroke(),s.fillStyle="#333",s.font="22px sans-serif",s.textAlign="center";let k=P;if(k.length>20&&(k=k.substring(0,18)+"..."),s.fillText(k,v+X/2,T+L-15),v===0||Y)if(s.save(),s.translate(v+15,T+L/2),s.rotate(-Math.PI/2),Z==="accuracy")s.fillText("Accuracy",0,0),s.restore(),s.textAlign="right",s.fillStyle="#666",s.font="18px sans-serif",[0,.25,.5,.75,1].forEach(m=>{const r=D(m);s.fillText(m.toFixed(2),v+z-8,r+6),s.beginPath(),s.lineWidth=1,s.strokeStyle="#f0f0f0",s.moveTo(v+z,r),s.lineTo(v+X-z,r),s.stroke()});else{s.fillText("Error",0,0),s.restore(),s.textAlign="right",s.fillStyle="#666",s.font="18px sans-serif";const m=5;for(let r=0;r<=m;r++){const I=r/m*_,V=D(I);s.fillText(I.toFixed(2),v+z-8,V+6),r>0&&(s.beginPath(),s.lineWidth=1,s.strokeStyle="#f0f0f0",s.moveTo(v+z,V),s.lineTo(v+X-z,V),s.stroke())}}s.fillStyle="#666",s.font="18px sans-serif",s.textAlign="center",s.fillText(u.toFixed(1),v+z,T+L-z+25),s.fillText(B.toFixed(1),v+X-z,T+L-z+25),s.fillStyle=Z==="accuracy"?"rgba(155, 89, 182, 0.4)":"rgba(52, 152, 219, 0.4)";for(let m=0;m<=A;m++){const r=x(e[m],m),I=g(e[m]),V=K(r),O=D(I);s.fillRect(V,O,4,4)}if(S>=0){const m=x(e[S],S),r=g(e[S]),I=K(m),V=D(r);s.beginPath(),s.fillStyle="#2ecc71",s.strokeStyle="#27ae60",s.lineWidth=2,s.arc(I,V,10,0,Math.PI*2),s.fill(),s.stroke()}if(n&&t!==null&&t>=0&&t<=A){const m=x(e[t],t),r=g(e[t]),I=K(m),V=D(r);s.beginPath(),s.fillStyle="#e74c3c",s.strokeStyle="#c0392b",s.lineWidth=2,s.arc(I,V,8,0,Math.PI*2),s.fill(),s.stroke()}});const N=h-150,q=20;s.fillStyle="rgba(255,255,255,0.9)",s.fillRect(N,q,140,70),s.strokeStyle="#ccc",s.lineWidth=1,s.strokeRect(N,q,140,70),s.textAlign="left",s.font="16px sans-serif",s.beginPath(),s.fillStyle="#e74c3c",s.arc(N+15,q+20,6,0,Math.PI*2),s.fill(),s.fillStyle="#333",s.fillText("Current Scan",N+30,q+25),s.beginPath(),s.fillStyle="#2ecc71",s.arc(N+15,q+50,6,0,Math.PI*2),s.fill(),s.fillStyle="#333",s.fillText("Best So Far",N+30,q+55),!n&&S>=0&&(s.fillStyle="#333",s.font="bold 18px sans-serif",s.textAlign="right",s.fillText(`Min Error: ${C.toFixed(5)}`,h-20,y-20))},[e,t,n,i,o]);const p=i?Math.ceil((i.length+1)/d):1;return a("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff"},children:[a("canvas",{ref:l,width:1600,height:800,style:{width:"100%",height:"auto"}}),p>1&&a("div",{style:{display:"flex",justifyContent:"center",marginTop:"10px",gap:"10px"},children:[a("button",{onClick:()=>c(f=>Math.max(0,f-1)),disabled:o===0,children:"Previous"}),a("span",{style:{alignSelf:"center"},children:["Page ",o+1," of ",p]}),a("button",{onClick:()=>c(f=>Math.min(p-1,f+1)),disabled:o===p-1,children:"Next"})]})]})}function un({model:e,inputs:t,inputLabels:n,output:i,outputLabel:l}){if(!e||!e.getTopology)return null;const{inputCount:o,hiddenCounts:c,outputCount:d,weights1:p,biases1:f,weights2:s}=e.getTopology();let h={hidden:[],output:[]};e.getActivations&&(h=e.getActivations(t));const y=600,_=400,b=_/2,A=y/2,S=350,C=280,w=A-S/2,z=A+S/2,N=[{count:o,x:w,labels:n,values:t},{count:c[0],x:A,values:h.hidden},{count:d,x:z,labels:[l],values:h.output}],q=Math.max(...N.map(x=>x.count)),W=Math.min(50,C/q),P=(x,g)=>{const T=(N[x].count-1)*W;return b-T/2+g*W},u=x=>{const g=Math.max(.2,Math.min(.8,Math.abs(x)/2));return x>0?`rgba(46, 204, 113, ${g})`:`rgba(231, 76, 60, ${g})`},B=x=>{const g=Math.max(0,Math.min(1,x)),v=Math.round(255+-203*g),T=Math.round(255+-103*g),X=Math.round(255+-36*g);return`rgb(${v},${T},${X})`};return a("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center"},children:[a("h3",{style:{marginBottom:"10px",fontSize:"1rem",color:"#555"},children:"Neural Network Activity"}),a("svg",{width:y,height:_,style:{overflow:"visible"},children:[a("rect",{x:w,y:b-C/2,width:S,height:C,rx:"15",fill:"none",stroke:"#333",strokeWidth:"3",strokeDasharray:"5,5"}),a("text",{x:A,y:b-C/2+20,textAnchor:"middle",fill:"#777",fontSize:"12",fontWeight:"bold",children:"NEURAL NETWORK"}),p.map((x,g)=>x.map((v,T)=>a("line",{x1:N[0].x,y1:P(0,T),x2:N[1].x,y2:P(1,g),stroke:u(v),strokeWidth:Math.max(1,Math.min(4,Math.abs(v)))},`L0-${T}-${g}`))),s.map((x,g)=>a("line",{x1:N[1].x,y1:P(1,g),x2:N[2].x,y2:P(2,0),stroke:u(x),strokeWidth:Math.max(1,Math.min(4,Math.abs(x)))},`L1-${g}-0`)),N.map((x,g)=>a("g",{children:Array.from({length:x.count}).map((v,T)=>{const X=x.x,L=P(g,T),Z=x.values&&x.values[T]!==void 0?x.values[T]:0;return a("g",{children:[a("circle",{cx:X,cy:L,r:12,fill:B(Z),stroke:"#333",strokeWidth:"1.5"}),x.labels&&a("text",{x:g===0?X-30:X+30,y:L,textAnchor:g===0?"end":"start",dominantBaseline:"middle",fontSize:"13",fontWeight:"bold",fill:"#333",children:x.labels[T]||""}),a("title",{children:Z.toFixed(3)})]},`n-${g}-${T}`)})},`layer-${g}`)),a("g",{transform:`translate(${y-100}, ${_-50})`,children:[a("rect",{width:"90",height:"40",fill:"white",stroke:"#ccc",rx:"4"}),a("line",{x1:"10",y1:"10",x2:"30",y2:"10",stroke:"#2ecc71",strokeWidth:"3"}),a("text",{x:"35",y:"14",fontSize:"10",children:"Positive"}),a("line",{x1:"10",y1:"28",x2:"30",y2:"28",stroke:"#e74c3c",strokeWidth:"3"}),a("text",{x:"35",y:"32",fontSize:"10",children:"Negative"})]})]})]})}function Ne({input:e,weight:t,bias:n,output:i,formula:l="y = w * x + b",inputLabel:o="Input",outputLabel:c="Output",biasLabel:d="b",decimals:p=1,model:f=null}){if(f&&f.getTopology){let Y=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(Y=e.input);const K=Array.isArray(Y)?Y:[Y],D=Array.isArray(o)?o:[o];return a(un,{model:f,inputs:K,inputLabels:D,output:i,outputLabel:c})}let s=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(s=e.input);const h=Array.isArray(s)?s:[s],y=Array.isArray(t)?t:[t],_=Array.isArray(o)?o:[o],b=Number(n)||0,A=Number(i)||0,S=h.length,C=24,w=90,z=300,N=60,q=60,W=Math.max(1,S-1)*w,P=Math.max(150,W+N+q),u=P+60,B=600,x=B/2,g=x-z/2,v=x+z/2,T=P/2+20,X=T-W/2,L=v-50,Z=L-60;return a("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[a("h3",{style:{marginBottom:"10px"},children:"Modell Architektur"}),a("svg",{width:B,height:u,style:{overflow:"visible"},children:[a("defs",{children:a("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"27",refY:"3.5",orient:"auto",children:a("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#333"})})}),a("rect",{x:g,y:20,width:z,height:P,rx:"15",fill:"none",stroke:"#333",strokeWidth:"3",strokeDasharray:"5,5"}),a("text",{x,y:40,textAnchor:"middle",fill:"#777",fontSize:"12",fontWeight:"bold",children:"NEURAL NETWORK"}),(()=>{const Y=T-50;return a(vt,{children:[h.map((K,D)=>{const k=S>1?X+D*w:T,m=Number(y[D])||0,r=_[D]||`x${D+1}`,I=Number(K)||0;return a("g",{children:[a("line",{x1:g,y1:k,x2:Z,y2:T,stroke:"#999",strokeWidth:"1"}),a("g",{transform:`translate(${(g+Z)/2+(D-(S-1)/2)*5}, ${(k+T)/2})`,children:[a("rect",{x:"-24",y:"-9",width:"50",height:"18",fill:"#fff",rx:"4",stroke:"#e0e0e0"}),a("text",{x:"0",y:"4",textAnchor:"middle",fill:"#e74c3c",fontSize:"10",fontWeight:"bold",children:m.toFixed(1)})]}),a("circle",{cx:g,cy:k,r:C,fill:"#fff",stroke:"#333",strokeWidth:"2"}),a("text",{x:g-40,y:k,textAnchor:"end",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",children:r}),a("text",{x:g,y:k,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fill:"#333",children:I.toFixed(p)})]},D)}),a("line",{x1:Z,y1:T,x2:L,y2:T,stroke:"#333",strokeWidth:"2"}),a("g",{transform:`translate(${L}, ${T})`,children:[a("rect",{x:"-18",y:"-18",width:"36",height:"36",rx:"6",fill:"#fff",stroke:"#333",strokeWidth:"2"}),a("path",{d:"M -10 8 C -4 8, -4 -8, 10 -8",stroke:"#333",strokeWidth:"2",fill:"none"})]}),a("line",{x1:L+18,y1:T,x2:v-C,y2:T,stroke:"#333",strokeWidth:"2"}),a("path",{d:`M ${L-20} ${Y} Q ${L-20} ${T} ${Z+10} ${T}`,fill:"none",stroke:"#f39c12",strokeWidth:"1",markerEnd:"url(#arrowhead)"}),a("circle",{cx:L-20,cy:Y,r:12,fill:"#f1c40f",stroke:"#f39c12"}),a("text",{x:L-23,y:Y+5,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fontWeight:"bold",fill:"#fff",children:"b"}),a("text",{x:L-5,y:Y+5,textAnchor:"start",dominantBaseline:"middle",fontSize:"12",fill:"#f39c12",fontWeight:"bold",children:b.toFixed(2)})]})})(),a("circle",{cx:v,cy:T,r:C,fill:"#fff",stroke:"#333",strokeWidth:"2"}),a("text",{x:v-14,y:T+4,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",fontSize:"12",children:A.toFixed(2)}),a("text",{x:v+40,y:T+4,textAnchor:"start",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:c}),a("text",{x,y:u-15,textAnchor:"middle",fontSize:"12",fontStyle:"italic",fill:"#777",children:l})]})]})}function fn({data:e,groundTruth:t,neuralNet:n}){const i=_t(null);return At(()=>{const l=i.current;if(!l)return;const o=l.getContext("2d"),c=l.width,d=l.height;if(o.clearRect(0,0,c,d),!e||e.length===0){o.fillStyle="#999",o.textAlign="center",o.fillText("Keine Daten vorhanden",c/2,d/2);return}const p=40,f=c-2*p,s=d-2*p,h=Math.max(...e.map(A=>A.input))||10,y=Math.max(...e.map(A=>A.target))||100,_=A=>p+A/h*f,b=A=>d-p-A/y*s;if(o.beginPath(),o.strokeStyle="#333",o.moveTo(p,p),o.lineTo(p,d-p),o.lineTo(c-p,d-p),o.stroke(),o.fillStyle="#333",o.textAlign="center",o.fillText("Zeit (t)",c/2,d-10),o.save(),o.translate(15,d/2),o.rotate(-Math.PI/2),o.fillText("Position (s)",0,0),o.restore(),e.forEach(A=>{const S=_(A.input),C=b(A.target);o.beginPath(),o.arc(S,C,3,0,Math.PI*2),o.fillStyle="#2ecc71",o.fill()}),n){o.beginPath(),o.strokeStyle="#e74c3c",o.lineWidth=2;for(let A=0;A<=h;A+=.1){const S=n.predict(A),C=_(A),w=b(S);A===0?o.moveTo(C,w):o.lineTo(C,w)}o.stroke()}},[e,t,n]),a("div",{style:{border:"1px solid #ccc",margin:"10px 0",borderRadius:"4px"},children:a("canvas",{ref:i,width:600,height:300,style:{width:"100%",display:"block"}})})}function pn({onTrain:e,onRun:t,onReset:n,isTraining:i,trainingStep:l,dataCount:o,trainerType:c,onTrainerTypeChange:d}){return a("div",{role:"region","aria-label":"Steuerung",style:{padding:"20px",background:"#eee",borderRadius:"8px",display:"flex",gap:"10px",flexWrap:"wrap",alignItems:"center"},children:[a("span",{"aria-live":"polite",children:["Datenpunkte: ",o]}),a("div",{style:{borderLeft:"1px solid #ccc",paddingLeft:"10px",marginLeft:"10px",display:"flex",gap:"5px",alignItems:"center"},children:[a("select",{value:c,onChange:p=>d(p.target.value),disabled:i,style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[a("option",{value:"exhaustive",children:"Grid Search "}),a("option",{value:"random",children:"Adaptive Random "})]}),a("button",{onClick:e,disabled:i||o===0,"aria-busy":i,children:i?"Suche läuft...":"2. Trainieren"})]}),a("button",{onClick:t,disabled:i,children:"3. Simulation Starten"}),a("button",{onClick:n,style:{marginLeft:"auto",background:"#e74c3c",color:"white"},"aria-label":"Simulation zurücksetzen",children:"Reset"})]})}function gn(){const[e,t]=lt(0),n=[{name:"Simple Perceptron",input:.5,weight:.8,bias:.2,output:.6,inputLabel:"Input",formula:"y = w * x + b"},{name:"Spam Filter (2 Inputs)",input:[1,0],weight:[.5,-.2],bias:.1,output:.8,inputLabel:["Spam Word","Suspicious Link"],formula:"y = w1*x1 + w2*x2 + b"},{name:"Complex Model (5 Inputs)",input:[1,.5,-1,0,.2],weight:[.1,.2,.3,.4,.5],bias:-.5,output:.1,inputLabel:["F1","F2","F3","F4","F5"],formula:"y = Σ(wi*xi) + b"},{name:"Many Inputs (8 Inputs)",input:[1,0,1,0,1,0,1,0],weight:[.1,-.1,.1,-.1,.1,-.1,.1,-.1],bias:0,output:.5,inputLabel:["I1","I2","I3","I4","I5","I6","I7","I8"],formula:"y = ... "}],i=n[e];return a("div",{style:{padding:"20px"},children:[a("h2",{children:"Architecture Gallery"}),a("div",{style:{marginBottom:"20px"},children:[a("button",{onClick:()=>t((e-1+n.length)%n.length),children:"Previous"}),a("span",{style:{margin:"0 10px"},children:[i.name," (",e+1,"/",n.length,")"]}),a("button",{onClick:()=>t((e+1)%n.length),children:"Next"})]}),a("div",{style:{width:"400px",border:"1px dashed #ccc",padding:"10px"},children:a(Ne,{input:i.input,weight:i.weight,bias:i.bias,output:i.output,formula:i.formula,inputLabel:i.inputLabel})})]})}class mn{constructor(t=30,n=50){this.velocity=t,this.initialPosition=n}getPosition(t){return this.velocity*t+this.initialPosition}}class xn{constructor(){this.weight=0,this.bias=0}predict(t){return this.weight*t+this.bias}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function _n({time:e,groundTruth:t,neuralNet:n,maxDistance:i=300}){const l=_t(null);At(()=>{const c=l.current;if(!c)return;const d=c.getContext("2d"),p=c.width,f=c.height,s=50,h=p-2*s;d.clearRect(0,0,p,f);const y=t.getPosition(e),_=n.predict(e),b=s+y%i/i*h,A=s+_%i/i*h;d.fillStyle="#f0f0f0",d.fillRect(0,0,p,f/2),d.fillStyle="#e0e0e0",d.fillRect(0,f/2,p,f/2),d.beginPath(),d.strokeStyle="#fff",d.setLineDash([20,20]),d.moveTo(0,f/4),d.lineTo(p,f/4),d.moveTo(0,f*3/4),d.lineTo(p,f*3/4),d.stroke(),d.beginPath(),d.strokeStyle="#ccc",d.setLineDash([]),d.moveTo(s,0),d.lineTo(s,f),d.moveTo(p-s,0),d.lineTo(p-s,f),d.stroke(),o(d,b,f/4,"#2ecc71","Ground Truth"),o(d,A,f*3/4,"#e74c3c","Neural Net"),d.fillStyle="#333",d.font="14px monospace",d.fillText(`Zeit: ${e.toFixed(1)}s`,10,20),d.fillText(`Pos GT: ${y.toFixed(1)}m`,10,40),d.fillText(`Pos NN: ${_.toFixed(1)}m`,10,f/2+40)},[e,t,n,i]);function o(c,d,p,f,s){c.save(),c.translate(d,p),c.fillStyle=f,c.fillRect(-20,-10,40,20),c.fillStyle="#000",c.fillRect(-15,-15,10,5),c.fillRect(5,-15,10,5),c.fillRect(-15,10,10,5),c.fillRect(5,10,10,5),c.fillStyle="#000",c.font="10px sans-serif",c.textAlign="center",c.fillText(s,0,-20),c.restore()}return a("div",{style:{border:"2px solid #333",borderRadius:"8px",overflow:"hidden"},children:a("canvas",{ref:l,width:800,height:300,style:{width:"100%",display:"block"}})})}const xe={id:"physics",title:"Phase 1: Lineare Regression (Exhaustive Search 2D)",description:"Physiksimulation: Weg-Zeit-Gesetz (s = v*t + s0)",Model:xn,GroundTruth:mn,CanvasComponent:_n,defaultParams:{weight:0,bias:0},groundTruthDefaults:[30,50],getInput:e=>e,generateData:e=>Array.from({length:20},(n,i)=>i*.5).map(n=>({input:n,target:e.getPosition(n)})),trainingConfig:{maxSteps:2e3,params:[{name:"weight",min:0,max:60,step:1},{name:"bias",min:0,max:100,step:2}]},networkViz:{formula:"pos = w * t + b",inputLabel:"Zeit (t)",outputLabel:"Pos (m)",biasLabel:"b"}};class yn{constructor(t=.5,n=-5){this.weight=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){const n=this.sigmoid(this.weight*t+this.bias);return Math.random()<n?1:0}getProbability(t){return this.sigmoid(this.weight*t+this.bias)}}class bn{constructor(){this.weight=0,this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=this.weight*t+this.bias;return this.sigmoid(n)}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function Bt(e,t,n=10){if(e===t)return[e];const i=_e(t-e,!1),l=_e(i/(n-1),!0),o=Math.floor(e/l)*l,c=Math.ceil(t/l)*l,d=[],p=l/1e3;for(let f=o;f<c+l/2;f+=l)f>=e-p&&f<=t+p&&d.push(Number(f.toPrecision(12)));return d}function _e(e,t){const n=Math.floor(Math.log10(e)),i=e/Math.pow(10,n);let l;return t?i<1.5?l=1:i<3?l=2:i<7?l=5:l=10:i<=1?l=1:i<=2?l=2:i<=5?l=5:l=10,l*Math.pow(10,n)}function vn({time:e,groundTruth:t,neuralNet:n,data:i,staticMode:l=!1,showModel:o=!0,showGroundTruth:c=!0}){const d=_t(null),[p,f]=lt({k:1,x:0,y:0}),[s,h]=lt(!1),y=_t({x:0,y:0}),[_,b]=lt(null),A=_t([]),S=P=>{P.preventDefault();const B=-P.deltaY*.001,x=p.k;let g=x*(1+B);g=Math.max(.5,Math.min(g,10));const v=d.current.getBoundingClientRect(),T=d.current.width/v.width,X=d.current.height/v.height,L=(P.clientX-v.left)*T,Z=(P.clientY-v.top)*X,Y=40,K=(L-Y-p.x)/x,D=(Z-(300-Y)-p.y)/x,k=L-Y-K*g,m=Z-(300-Y)-D*g;f({k:g,x:k,y:m})},C=P=>{h(!0),y.current={x:P.clientX,y:P.clientY}},w=P=>{const u=d.current;if(!u)return;const B=u.getBoundingClientRect(),x=u.width/B.width,g=u.height/B.height;if(s){const v=(P.clientX-y.current.x)*x,T=(P.clientY-y.current.y)*g;y.current={x:P.clientX,y:P.clientY},f(X=>({...X,x:X.x+v,y:X.y+T})),b(null)}else{const v=(P.clientX-B.left)*x,T=(P.clientY-B.top)*g;let X=null,L=15;const Z=A.current;for(let Y=Z.length-1;Y>=0;Y--){const K=Z[Y],D=Math.sqrt(Math.pow(K.x-v,2)+Math.pow(K.y-T,2));D<L&&(L=D,X=K.info)}b(X)}},z=()=>h(!1),N=()=>{h(!1),b(null)},q=_t(0),W=()=>{const P=Date.now();P-q.current<300&&b(null),q.current=P};return At(()=>{const P=d.current;if(!P)return;const u=P.getContext("2d"),B=P.width,x=P.height;u.clearRect(0,0,B,x),A.current=[];const g=40,v=B-2*g,T=x-2*g,X=0,L=20,Z=1,Y=$=>g+$/L*v*p.k+p.x,K=$=>x-g-$/Z*T*p.k+p.y,D=$=>($-g-p.x)/(v*p.k)*L,k=$=>-(($-(x-g)-p.y)/(T*p.k))*Z,m=D(g),r=D(B-g),I=k(x-g),V=k(g),O=Bt(m,r,10),Q=Bt(I,V,5);u.beginPath(),u.strokeStyle="#eee",u.lineWidth=1,u.fillStyle="#333",u.textAlign="center",u.textBaseline="top",u.font="10px sans-serif",O.forEach($=>{const U=Y($);U<g||U>B-g||(u.moveTo(U,g),u.lineTo(U,x-g),u.fillText(Number($.toFixed(2)),U,x-g+5))}),u.textAlign="right",u.textBaseline="middle",Q.forEach($=>{const U=K($);U<g||U>x-g||(u.moveTo(g,U),u.lineTo(B-g,U),u.fillText(Number($.toFixed(2)),g-5,U))}),u.stroke(),u.beginPath(),u.strokeStyle="#333",u.lineWidth=1,u.rect(g,g,v,T),u.stroke(),u.fillStyle="#333",u.textAlign="center",u.textBaseline="alphabetic",u.fillText("Anzahl 'Spam' Wörter",B/2,x-10),u.save(),u.translate(15,x/2),u.rotate(-Math.PI/2),u.textAlign="center",u.fillText("Spam Wahrscheinlichkeit",0,0),u.restore(),u.save(),u.beginPath(),u.rect(g,g,v,T),u.clip();const st=($,U,E=[])=>{u.beginPath(),u.strokeStyle=U,u.setLineDash(E),u.lineWidth=2;const G=Math.max(X,m),R=Math.min(L,r);if(R<G)return;const M=(R-G)/100,F=Math.max(M,.05);let tt=!1;for(let J=G;J<=R+F;J+=F){const it=Math.min(Math.max(J,X),L);let mt=0;typeof $.getProbability=="function"?mt=$.getProbability(it):typeof $.predict=="function"&&(mt=$.predict(it));const pt=Y(it),at=K(mt);tt?u.lineTo(pt,at):(u.moveTo(pt,at),tt=!0)}u.stroke(),u.setLineDash([])};if(c&&t&&st(t,"#ccc",[5,5]),o&&n&&st(n,"#e74c3c"),l&&i)i.forEach($=>{if($.input<m-5||$.input>r+5)return;const U=Y($.input),E=K($.target);A.current.push({x:U,y:E,info:{x:U,y:E,input:$.input,target:$.target}});let G=null;if(n&&o)try{G=n.predict($.input)>.5?"#e74c3c":"#2ecc71"}catch{}const R=Math.sin($.input*123)*5,M=Math.cos($.input*321)*5;G&&(u.beginPath(),u.arc(U+R,E+M,8,0,Math.PI*2),u.strokeStyle=G,u.lineWidth=2,u.stroke()),u.beginPath(),u.arc(U+R,E+M,5,0,Math.PI*2),u.fillStyle=$.target===1?"#e74c3c":"#2ecc71",u.fill(),u.strokeStyle="#fff",u.lineWidth=1,u.stroke()});else if(!l){const U=Math.floor(e*2),E=50,G=M=>{const F=Math.sin(M*123.456)*1e4;return F-Math.floor(F)},R=Math.min(U,E);for(let M=0;M<R;M++){const F=G(M+1),tt=Math.floor(F*21),J=t?t.getProbability(tt):0,it=G(M+999)<J?1:0;if(tt<m-5||tt>r+5)continue;const mt=Y(tt),pt=K(it);let at=null;if(n&&o)try{at=n.predict(tt)>.5?"#e74c3c":"#2ecc71"}catch{}const gt=(G(M+333)-.5)*10,wt=(G(M+444)-.5)*10,H=mt+gt,ft=pt+wt;A.current.push({x:H,y:ft,info:{x:H,y:ft,input:tt,target:it}}),at&&(u.beginPath(),u.arc(H,ft,8,0,Math.PI*2),u.strokeStyle=at,u.lineWidth=2,u.stroke()),u.beginPath(),u.arc(H,ft,5,0,Math.PI*2),u.fillStyle=it?"#e74c3c":"#2ecc71",u.fill(),u.strokeStyle="#fff",u.lineWidth=1,u.stroke()}if(R>0&&R<=E){const M=R-1,F=G(M+1),tt=Math.floor(F*21),J=t.getProbability(tt),it=G(M+999)<J?1:0,mt=(G(M+333)-.5)*10,pt=(G(M+444)-.5)*10,at=Y(tt)+mt,gt=K(it)+pt;at>g&&at<B-g&&gt>g&&gt<x-g&&(u.beginPath(),u.arc(at,gt,8,0,Math.PI*2),u.strokeStyle="#333",u.stroke(),u.fillStyle="#333",u.font="10px sans-serif",u.fillText(`${tt}`,at,gt-12))}}if(u.restore(),_){u.save(),u.fillStyle="rgba(0,0,0,0.8)",u.strokeStyle="#fff";const $=_.target===1?"SPAM":"HAM",U=`Words: ${_.input}`,E=100,G=40;let R=_.x+10,M=_.y-10;R+E>B&&(R=_.x-E-10),M+G>x&&(M=_.y-G-10),M<0&&(M=_.y+10),u.beginPath(),u.roundRect(R,M,E,G,4),u.fill(),u.lineWidth=1,u.stroke(),u.textBaseline="top",u.textAlign="left",u.font="bold 11px sans-serif",u.fillStyle=_.target===1?"#e74c3c":"#2ecc71",u.fillText($,R+8,M+6),u.fillStyle="#ddd",u.font="10px sans-serif",u.fillText(U,R+8,M+20),u.restore()}},[e,t,n,i,l,o,c,p,_]),a("div",{className:"canvas-container",children:a("canvas",{ref:d,width:600,height:300,style:{width:"100%",border:"1px solid #ccc",background:"#fff",cursor:_?"pointer":s?"grabbing":"grab"},onWheel:S,onMouseDown:C,onMouseMove:w,onMouseUp:z,onMouseLeave:N,onClick:W})})}const wn=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},ye={id:"spam",title:"Phase 2: Logistische Regression (Spam Filter)",description:"Spam-Erkennung: Wahrscheinlichkeit p = σ(w*x + b)",Model:bn,GroundTruth:yn,CanvasComponent:vn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[.5,-5],getInput:e=>{const t=Math.floor(e);return Math.floor(wn(t)*20)},generateData:e=>{const t=[];for(let n=0;n<50;n++){const i=Math.floor(Math.random()*21),l=e.classify(i);t.push({input:i,target:l})}return t.sort((n,i)=>n.input-i.input)},trainingConfig:{maxSteps:3e3,params:[{name:"weight",min:0,max:2,step:.1},{name:"bias",min:-10,max:5,step:.5}]},networkViz:{formula:"p = σ(w * x + b)",inputLabel:"Wörter (x)",outputLabel:"Spam? (p)",biasLabel:"b"},isFinished:e=>e>=25};class ee{constructor(t=[.5,.2,.8,-.1],n=-3){this.weights=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){let n=this.bias;for(let l=0;l<this.weights.length;l++)n+=this.weights[l]*t[l];const i=this.sigmoid(n);return Math.random()<i?1:0}getProbability(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}}class Fe{constructor(t=4){this.weights=new Array(t).fill(0),this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}setWeights(t){this.weights=[...t]}setBias(t){this.bias=t}setWeightAt(t,n){t>=0&&t<this.weights.length&&(this.weights[t]=n)}}const Mn=[{label:"Spam Words",idx:0,max:15},{label:"Großbuchstaben",idx:1,max:25},{label:"Links",idx:2,max:8},{label:"Gesamtworte",idx:3,max:100}];function ne({data:e,currentInput:t,currentPrediction:n,neuralNet:i,allowedModes:l=["features","scatter","3d","text"],hideControls:o=!1,showModel:c=!0,additionalControls:d=null,features:p=Mn}){const f=_t(null),[s,h]=lt(l[0]);At(()=>{l.includes(s)||h(l[0])},[l]);const[y,_]=lt(0),[b,A]=lt(p.length===2?1:3),[S,C]=lt(2),[w,z]=lt(!1),[N,q]=lt({x:-.5,y:.5}),[W,P]=lt({k:1,x:0,y:0}),u=_t(!1),B=_t({x:0,y:0}),[x,g]=lt(null),v=_t([]),T=m=>{if(s!=="scatter")return;m.preventDefault();const I=-m.deltaY*.001,V=W.k;let O=V*(1+I);O=Math.max(.5,Math.min(O,50));const Q=f.current;if(!Q)return;const st=Q.getBoundingClientRect(),$=Q.width/st.width,U=Q.height/st.height,E=(m.clientX-st.left)*$,G=(m.clientY-st.top)*U,R=50,M=Q.height-R,F=(E-R-W.x)/V,tt=(M+W.y-G)/V,J=E-R-F*O,it=G-M+tt*O;P({k:O,x:J,y:it})},X=m=>{s!=="3d"&&s!=="scatter"||(u.current=!0,B.current={x:m.clientX,y:m.clientY})},L=m=>{const r=f.current;if(!r)return;const I=r.getBoundingClientRect(),V=r.width/I.width,O=r.height/I.height;if(u.current){const R=(m.clientX-B.current.x)*V,M=(m.clientY-B.current.y)*O;B.current={x:m.clientX,y:m.clientY},s==="3d"?q(F=>({x:F.x+M*.01,y:F.y+R*.01})):s==="scatter"&&P(F=>({...F,x:F.x+R,y:F.y+M}));return}const Q=(m.clientX-I.left)*V,st=(m.clientY-I.top)*O;let $=null,E=15;const G=v.current;for(let R=G.length-1;R>=0;R--){const M=G[R],F=Math.sqrt((M.x-Q)**2+(M.y-st)**2);F<E&&(E=F,$=M.info)}g($)},Z=()=>{u.current=!1},Y=()=>{g(null),u.current=!1},K=_t(0),D=()=>{const m=Date.now();m-K.current<300&&g(null),K.current=m};At(()=>{const m=f.current;if(!m)return;const r=m.getContext("2d"),I=m.width,V=m.height;r.clearRect(0,0,I,V),r.fillStyle="#fff",r.fillRect(0,0,I,V),v.current=[];const O=$=>{if(!e||e.length===0)return p[$].max;const U=Math.max(...e.map(E=>E.input[$]));return U>0?U:p[$].max},Q=$=>$===2?"#3498db":$===1?"#e74c3c":"#2ecc71",st=$=>$===3?"CLASS 3":$===1?"SPAM":"HAM";if(s==="3d"){const $=O(y),U=O(b),E=O(S),G=I/2,R=V/2,M=150,F=(H,ft,yt)=>{let St=H*Math.cos(N.y)-yt*Math.sin(N.y),j=H*Math.sin(N.y)+yt*Math.cos(N.y),et=ft*Math.cos(N.x)-j*Math.sin(N.x),ct=ft*Math.sin(N.x)+j*Math.cos(N.x);const nt=400/(400-ct);return{x:G+St*nt,y:R+et*nt,z:ct}},J=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]].map(H=>F(H[0]*M,H[1]*M,H[2]*M)),it="#e29301ff",mt="#2980b9",pt="#c00798ff",at=(H,ft)=>{r.beginPath(),r.strokeStyle=ft,r.lineWidth=1,H.forEach(([yt,St])=>{r.moveTo(J[yt].x,J[yt].y),r.lineTo(J[St].x,J[St].y)}),r.stroke()};at([[0,1],[3,2],[4,5],[7,6]],it),at([[0,3],[1,2],[4,7],[5,6]],mt),at([[0,4],[1,5],[2,6],[3,7]],pt),r.font="bold 11px sans-serif",r.fillStyle=it,r.fillText("X: "+p[y].label,J[1].x,J[1].y),r.fillStyle=mt,r.fillText("Y: "+p[b].label,J[3].x,J[3].y),r.fillStyle=pt,r.fillText("Z: "+p[S].label,J[4].x,J[4].y);const gt=[],wt=(H,ft)=>H/ft*2-1;if(c&&i&&i.weights){const H=i.weights[y]||0,ft=i.weights[b]||0,yt=i.weights[S]||0,St=i.bias||0;if(Math.abs(yt)>.001){r.strokeStyle="rgba(142, 68, 173, 0.3)",r.lineWidth=1;const j=(nt,rt)=>{const xt=(nt+1)/2*$,dt=(rt+1)/2*U,Mt=(-H*xt-ft*dt-St)/yt;return wt(Mt,E)},et=(nt,rt)=>{if(Math.abs(nt.z)<=3&&Math.abs(rt.z)<=3){const xt=F(nt.x*M,-nt.y*M,nt.z*M),dt=F(rt.x*M,-rt.y*M,rt.z*M);r.beginPath(),r.moveTo(xt.x,xt.y),r.lineTo(dt.x,dt.y),r.stroke()}},ct=6;for(let nt=0;nt<=ct;nt++){const rt=-1+nt/ct*2,xt=j(-1,rt),dt=j(1,rt);et({x:-1,y:rt,z:xt},{x:1,y:rt,z:dt})}for(let nt=0;nt<=ct;nt++){const rt=-1+nt/ct*2,xt=j(rt,-1),dt=j(rt,1);et({x:rt,y:-1,z:xt},{x:rt,y:1,z:dt})}}}e&&e.forEach(H=>{const ft=wt(H.input[y],$),yt=-wt(H.input[b],U),St=wt(H.input[S],E),j=F(ft*M,yt*M,St*M);let et=null;if(i&&c)try{et=i.predict(H.input)>.5?"#e74c3c":"#2ecc71"}catch{}gt.push({...j,color:Q(H.target),radius:3,haloColor:et,pt:H})}),gt.sort((H,ft)=>H.z-ft.z),gt.forEach(H=>{H.z<3&&v.current.push({x:H.x,y:H.y,info:{x:H.x,y:H.y,text:H.pt.text,target:H.pt.target,isSpam:H.pt.target===1,features:{xLabel:p[y].label,xVal:H.pt.input[y],yLabel:p[b].label,yVal:H.pt.input[b],zLabel:p[S].label,zVal:H.pt.input[S]}}}),H.haloColor&&(r.beginPath(),r.arc(H.x,H.y,H.radius+2,0,Math.PI*2),r.strokeStyle=H.haloColor,r.lineWidth=1.5,r.stroke()),r.beginPath(),r.arc(H.x,H.y,H.radius,0,Math.PI*2),r.fillStyle=H.color,r.fill()})}if(s==="scatter"){const $=O(y),U=O(b),E=50,G=I-2*E,R=V-2*E,M=V-E,F="#c0392b",tt="#2980b9",J=j=>E+j/$*G*W.k+W.x,it=j=>M-j/U*R*W.k+W.y;r.save(),r.beginPath(),r.rect(E,E,G,R),r.clip(),r.restore();const mt=j=>(j-E-W.x)/(G*W.k)*$,pt=j=>(M+W.y-j)/(R*W.k)*U,at=mt(E),gt=mt(E+G),wt=pt(M),H=pt(E),ft=Bt(Math.min(at,gt),Math.max(at,gt),8),yt=Bt(Math.min(wt,H),Math.max(wt,H),6);if(r.lineWidth=1,r.strokeStyle="#eee",r.fillStyle="#666",r.font="10px sans-serif",r.textAlign="center",r.textBaseline="top",ft.forEach(j=>{const et=J(j);et<E||et>E+G||(r.beginPath(),r.moveTo(et,E),r.lineTo(et,M),r.stroke(),r.fillText(Number(j.toFixed(2)),et,M+5))}),r.textAlign="right",r.textBaseline="middle",yt.forEach(j=>{const et=it(j);et<E||et>M||(r.beginPath(),r.moveTo(E,et),r.lineTo(E+G,et),r.stroke(),r.fillText(Number(j.toFixed(2)),E-5,et))}),r.strokeStyle="#ccc",r.lineWidth=2,r.strokeRect(E,E,G,R),r.textAlign="center",r.font="bold 12px sans-serif",r.fillStyle=F,r.fillText(`${p[y].label}`,E+G/2,M+30),r.save(),r.translate(15,M-R/2),r.rotate(-Math.PI/2),r.fillStyle=tt,r.fillText(`${p[b].label}`,0,0),r.restore(),r.save(),r.beginPath(),r.rect(E,E,G,R),r.clip(),w&&i&&p.length===2){const et=Math.floor(at/.5)*.5,ct=Math.ceil(gt/.5)*.5,nt=Math.floor(wt/.5)*.5,rt=Math.ceil(H/.5)*.5;if((ct-et)/.5*((rt-nt)/.5)<5e4)for(let dt=et;dt<=ct;dt+=.5)for(let Mt=nt;Mt<=rt;Mt+=.5)try{const kt=[0,0];y<2&&(kt[y]=dt),b<2&&(kt[b]=Mt);const bt=i.predict(kt),Pt=J(dt),$t=it(Mt),ie=J(dt+.5),re=it(Mt+.5),Ve=Math.abs(ie-Pt),Xe=Math.abs($t-re),Ge=Math.min(Pt,ie),Ue=Math.min($t,re),je=Math.round(46*(1-bt)+231*bt),Oe=Math.round(204*(1-bt)+76*bt),qe=Math.round(113*(1-bt)+60*bt);r.fillStyle=`rgba(${je}, ${Oe}, ${qe}, 0.2)`,r.fillRect(Ge,Ue,Ve+.5,Xe+.5)}catch{}}const St=(j,et,ct,nt,rt)=>{const xt=J(j[y]),dt=it(j[b]);rt&&(r.beginPath(),r.arc(xt,dt,ct+3,0,2*Math.PI),r.strokeStyle=rt,r.lineWidth=2,r.stroke()),r.beginPath(),r.arc(xt,dt,ct,0,2*Math.PI),r.fillStyle=et,r.fill(),nt&&(r.strokeStyle=nt,r.lineWidth=2,r.stroke())};if(e&&e.forEach(j=>{const et=J(j.input[y]),ct=it(j.input[b]);if(et<E||et>E+G||ct<E||ct>M)return;v.current.push({x:et,y:ct,info:{x:et,y:ct,text:j.text,target:j.target,isSpam:j.target===1,features:{xLabel:p[y].label,xVal:j.input[y],yLabel:p[b].label,yVal:j.input[b]}}});let nt=null;if(i&&c)try{nt=i.predict(j.input)>.5?"#e74c3c":"#2ecc71"}catch{}St(j.input,Q(j.target),5,"#fff",nt)}),c&&i){let j=i.weights;const et=i.bias||0;if(j){const ct=j[y]||0,nt=j[b]||0,rt=et;r.beginPath(),r.strokeStyle="rgba(142, 68, 173, 0.8)",r.lineWidth=2,r.setLineDash([10,5]);const xt=at-(gt-at),dt=gt+(gt-at),Mt=(kt,bt)=>({x:J(kt),y:it(bt)});if(Math.abs(nt)>.001){const kt=$t=>(-ct*$t-rt)/nt,bt=Mt(xt,kt(xt)),Pt=Mt(dt,kt(dt));r.moveTo(bt.x,bt.y),r.lineTo(Pt.x,Pt.y)}else if(Math.abs(ct)>.001){const kt=-rt/ct,bt=Mt(kt,wt-100),Pt=Mt(kt,H+100);r.moveTo(bt.x,bt.y),r.lineTo(Pt.x,Pt.y)}r.stroke(),r.setLineDash([])}}t&&St(t,"#3498db",8,"#2980b9"),r.restore(),r.fillStyle="#666",r.textAlign="right",r.font="11px sans-serif",r.fillText("Rot=Spam, Grün=OK",I-10,20)}if(s==="text"){if(r.textAlign="center",r.textBaseline="middle",!t||!t.text){r.fillStyle="#999",r.font="20px sans-serif",r.fillText("Kein Text verfügbar",I/2,V/2);return}const $=n>.5,U=$?"#feeff0":"#effaf0";r.fillStyle=U,r.fillRect(0,0,I,V);const E=t.text;r.fillStyle="#333",r.font="24px serif";const G=E.split(" ");let R="";const M=35,F=I/2;let tt=V/3;const J=I-100;for(let pt=0;pt<G.length;pt++){const at=R+G[pt]+" ";r.measureText(at).width>J&&pt>0?(r.fillText(R,F,tt),R=G[pt]+" ",tt+=M):R=at}r.fillText(R,F,tt),tt+=60;const it=t.groundTruth===1;r.font="bold 16px sans-serif",r.fillStyle="#555",r.fillText(`Wahrheit: ${it?"SPAM":"HAM"}`,F,tt),tt+=30;const mt=(n*100).toFixed(1);r.font="bold 20px sans-serif",r.fillStyle=$?"#c0392b":"#27ae60",r.fillText(`Vorhersage: ${$?"SPAM":"HAM"} (${mt}%)`,F,tt);return}if(s==="features"){const U=(I-90)/2,E=(V-90)/2;[{x:30,y:30,...p[0]},{x:30+U+30,y:30,...p[1]},{x:30,y:30+E+30,...p[2]},{x:30+U+30,y:30+E+30,...p[3]}].forEach(R=>{if(r.strokeStyle="#ccc",r.strokeRect(R.x,R.y,U,E),r.fillStyle="#333",r.font="12px Arial",r.textAlign="center",r.fillText(R.label,R.x+U/2,R.y-5),e&&e.forEach(M=>{const F=M.input[R.idx],tt=R.x+F/R.max*U,J=R.y+E-M.target*(E-20)-10;v.current.push({x:tt,y:J,info:{x:tt,y:J,text:M.text,target:M.target,isSpam:M.target===1,features:{valLabel:R.label,val:F}}});let it=null;if(i&&c)try{it=i.predict(M.input)>.5?"#e74c3c":"#2ecc71"}catch{}it&&(r.beginPath(),r.arc(tt,J,4.5,0,2*Math.PI),r.strokeStyle=it,r.lineWidth=1,r.stroke()),r.beginPath(),r.arc(tt,J,3,0,2*Math.PI),r.fillStyle=Q(M.target),r.globalAlpha=.6,r.fill(),r.globalAlpha=1}),t){const M=t[R.idx],F=R.x+M/R.max*U;r.beginPath(),r.moveTo(F,R.y),r.lineTo(F,R.y+E),r.strokeStyle="#3498db",r.setLineDash([5,5]),r.stroke(),r.setLineDash([])}})}if(x&&(s==="features"||s==="scatter"||s==="3d")){r.save(),r.fillStyle="rgba(0,0,0,0.85)",r.strokeStyle="#fff";const $=x.text||"No Text",U=st(x.target!==void 0?x.target:x.isSpam?1:0),E=r.measureText($),G=Math.max(E.width,140)+20;let R=70;x.features&&(x.features.zLabel?R=90:x.features.yLabel?R=85:R=60);let M=x.x+15,F=x.y-15;M+G>I&&(M=x.x-G-10),F+R>V&&(F=x.y-R-10),F<0&&(F=x.y+20),r.beginPath(),r.roundRect(M,F,G,R,5),r.fill(),r.lineWidth=1,r.stroke(),r.textBaseline="top",r.textAlign="left",r.font="bold 12px sans-serif",r.fillStyle=Q(x.target!==void 0?x.target:x.isSpam?1:0),r.fillText(U,M+10,F+10),r.fillStyle="#ddd",r.font="italic 11px sans-serif",r.fillText($,M+10,F+28),x.features&&(r.fillStyle="#fff",r.font="11px monospace",x.features.xLabel?(r.fillText(`${x.features.xLabel}: ${x.features.xVal}`,M+10,F+46),r.fillText(`${x.features.yLabel}: ${x.features.yVal}`,M+10,F+60),x.features.zLabel&&r.fillText(`${x.features.zLabel}: ${x.features.zVal}`,M+10,F+74)):x.features.valLabel&&r.fillText(`${x.features.valLabel}: ${x.features.val}`,M+10,F+46)),r.restore()}},[e,t,n,i,s,y,b,S,N,c,W,w]);const k={features:"Alle Features",scatter:"2D Plot","3d":"3D Plot",text:"Text Mode"};return a("div",{style:{textAlign:"center"},children:[!o&&a("div",{style:{marginBottom:"10px",display:"flex",gap:"5px",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",fontSize:"0.9rem"},children:[a("div",{children:d}),a("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[a("select",{value:s,onChange:m=>h(m.target.value),style:{padding:"4px"},children:l.map(m=>a("option",{value:m,children:k[m]},m))}),(s==="scatter"||s==="3d")&&a(vt,{children:[a("span",{children:"X:"}),a("select",{value:y,onChange:m=>_(parseInt(m.target.value)),style:{padding:"4px"},children:p.map(m=>a("option",{value:m.idx,children:m.label},m.idx))}),a("span",{children:"Y:"}),a("select",{value:b,onChange:m=>A(parseInt(m.target.value)),style:{padding:"4px"},children:p.map(m=>a("option",{value:m.idx,children:m.label},m.idx))})]}),s==="scatter"&&p.length===2&&a("label",{style:{display:"flex",alignItems:"center",gap:"3px",marginLeft:"5px",fontSize:"0.8rem",cursor:"pointer",background:"#f5f5f5",padding:"2px 5px",borderRadius:"3px",border:"1px solid #ddd"},children:[a("input",{type:"checkbox",checked:w,onChange:m=>z(m.target.checked)}),"Show Grid"]}),s==="3d"&&a(vt,{children:[a("span",{children:"Z:"}),a("select",{value:S,onChange:m=>C(parseInt(m.target.value)),style:{padding:"4px"},children:p.map(m=>a("option",{value:m.idx,children:m.label},m.idx))})]})]})]}),a("canvas",{ref:f,width:600,height:400,style:{border:"1px solid #eee",maxWidth:"100%",borderRadius:"4px",cursor:x?"pointer":s==="3d"||s==="scatter"?u.current?"grabbing":"grab":"default"},onWheel:T,onMouseDown:X,onMouseMove:L,onMouseUp:Z,onMouseLeave:Z,onMouseOut:Y,onClick:D}),!o&&a("div",{style:{fontSize:"0.8rem",color:"#666",marginTop:"5px"},children:s==="3d"?"Drag to rotate 3D view":s==="scatter"?"Drag to Pan, Scroll to Zoom":"Wähle Achsen für die Visualisierung"})]})}const be=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Gt=e=>{const t=["winner","won","gift card","urgent","rolex","viagra","cash","prize","singles","marketing","buy","free","money","security alert","click","claim","fake","verification"],n=e.toLowerCase();let i=0;t.forEach(d=>{n.includes(d)&&(i+=1)}),i>10&&(i=10);const l=(e.match(/[A-Z]/g)||[]).length,o=(e.match(/http/g)||[]).length,c=e.split(/\s+/).length;return[i,l,o,c]},Wt={id:"spam_advanced",title:"Phase 3: Erweiterter Spam-Filter (4 Eingaben)",description:"Spam-Erkennung mit 4 Merkmalen: Spam-Worte, Großbuchstaben, Links, Gesamtworte.",Model:Fe,GroundTruth:ee,CanvasComponent:ne,defaultParams:{weights:[0,0,0,0],bias:0},groundTruthDefaults:[[1.5,.5,2,-.5],-5],getInput:e=>{const t=Math.floor(e*.3),n=be(t)>.5,i=n?Wt.examples.spam:Wt.examples.ham,l=Math.floor(be(t+99)*i.length),o=i[l],c=Gt(o);return c.text=o,c.groundTruth=n?1:0,c},examples:{spam:["WINNER! Won $1000 Gift Card! Claim at http://prize-giveaway.net","URGENT: Verify account at http://secure-bank-login.com/fraud","Cheap Rolex watches! 50% OFF at www.fake-watches.cn","Lose weight fast! Buy pills: http://diet-miracle.com","CONGRATS! Cash prize waiting: http://claim-money.org","HOT singles waiting! Chat now: http://local-dating.xyz","Refinance 1% APR. Apply: http://easy-loans.biz","Buy 1 get 1 FREE Viagra. http://meds-direct.com","Meet rich men. Signup: http://millionaire-match.com","SECURITY ALERT: Suspicious activity. Check http://account-security-check.com"],ham:["Meeting agenda for tomorrow's team sync","Hey, are we still on for lunch?","Invoice #12345 from AWS Services","Project deadline extended to Friday","Happy Birthday! Hope you have a great day.","Can you review this pull request?","Your Amazon order has shipped.","Fwd: Tickets for the concert","Question about the quarterly report","Let's catch up sometime next week."]},generateData:e=>{const t=[];Wt.examples.spam.forEach(n=>{const i=Gt(n),l=()=>(Math.random()-.5)*.1,o=i.map(c=>Math.max(0,c+l()));t.push({input:o,target:1,text:n})}),Wt.examples.ham.forEach(n=>{const l=Gt(n).map(o=>Math.max(0,o+(Math.random()-.5)*.1));t.push({input:l,target:0,text:n})});for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t},trainingConfig:{maxSteps:3e3,params:[{name:"w1 (Spam-Worte)",min:1,max:4,step:.5},{name:"w2 (Großbuchst.)",min:0,max:2,step:.5},{name:"w3 (Links)",min:0,max:3,step:.5},{name:"w4 (Gesamtworte)",min:-2,max:2,step:.5},{name:"bias",min:-8,max:8,step:2}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + w₃x₃ + w₄x₄ + b)",inputLabels:["Spam-Worte","Großbuchst.","Links","Gesamtworte"],outputLabel:"Spam? (p)",biasLabel:"b"},isFinished:e=>e>=50};class kn{constructor(t=2,n=10){this.inputCount=t,this.hiddenCount=n;const i=Math.sqrt(6/(t+n));this.weights1=Array(n).fill(0).map(()=>Array.from({length:t},()=>Math.random()*2*i-i)),this.biases1=Array(n).fill(0);const l=Math.sqrt(6/(n+1));this.weights2=Array.from({length:n},()=>Math.random()*2*l-l),this.bias2=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=[];for(let o=0;o<this.hiddenCount;o++){let c=this.biases1[o];for(let d=0;d<this.inputCount;d++)c+=this.weights1[o][d]*t[d];n.push(this.sigmoid(c))}let i=this.bias2;for(let o=0;o<this.hiddenCount;o++)i+=this.weights2[o]*n[o];return this.sigmoid(i)}getActivations(t){const n=[];for(let o=0;o<this.hiddenCount;o++){let c=this.biases1[o];for(let d=0;d<this.inputCount;d++)c+=this.weights1[o][d]*t[d];n.push(this.sigmoid(c))}let i=this.bias2;for(let o=0;o<this.hiddenCount;o++)i+=this.weights2[o]*n[o];const l=this.sigmoid(i);return{hidden:n,output:[l]}}setParams(t){for(let i=0;i<this.hiddenCount;i++){const l=`b1_${i}`;t[l]!==void 0&&(this.biases1[i]=t[l]);for(let o=0;o<this.inputCount;o++){const c=`w1_${i}_${o}`;t[c]!==void 0&&(this.weights1[i][o]=t[c])}}const n="b2";t[n]!==void 0&&(this.bias2=t[n]);for(let i=0;i<this.hiddenCount;i++){const l=`w2_${i}`;t[l]!==void 0&&(this.weights2[i]=t[l])}}getTopology(){return{inputCount:this.inputCount,hiddenCounts:[this.hiddenCount],outputCount:1,weights1:this.weights1,biases1:this.biases1,weights2:this.weights2,bias2:this.bias2}}}const Be=[{label:"Gesamtworte",idx:0,max:400},{label:"Links",idx:1,max:10}],ve=[{input:[367,5],target:0,text:"Attached is the quarterly report found at..."},{input:[365,2],target:0,text:"Attached is the quarterly report found at..."},{input:[364,6],target:0,text:"Attached is the quarterly report found at..."},{input:[327,7],target:0,text:"Attached is the quarterly report found at..."},{input:[302,5],target:0,text:"Attached is the quarterly report found at..."},{input:[314,3],target:0,text:"Attached is the quarterly report found at..."},{input:[345,4],target:0,text:"Attached is the quarterly report found at..."},{input:[265,5],target:0,text:"Attached is the quarterly report found at..."},{input:[287,4],target:0,text:"Attached is the quarterly report found at..."},{input:[311,1],target:0,text:"Attached is the quarterly report found at..."},{input:[268,2],target:0,text:"Attached is the quarterly report found at..."},{input:[283,0],target:0,text:"Attached is the quarterly report found at..."},{input:[261,3],target:0,text:"Attached is the quarterly report found at..."},{input:[197,0],target:0,text:"Just a normal short message."},{input:[150,0],target:0,text:"Just a normal short message."},{input:[124,0],target:0,text:"Just a normal short message."},{input:[65,1],target:0,text:"Just a normal short message."},{input:[85,0],target:0,text:"Just a normal short message."},{input:[58,0],target:0,text:"Just a normal short message."},{input:[45,0],target:0,text:"Security Alert: Login Code 2542"},{input:[36,0],target:0,text:"Security Alert: Login Code 5607"},{input:[38,1],target:0,text:"Security Alert: Login Code 909"},{input:[24,1],target:0,text:"Security Alert: Login Code 8385"},{input:[17,1],target:0,text:"Security Alert: Login Code 2083"},{input:[215,1],target:1,text:"You won a prize! Click here."},{input:[230,3],target:1,text:"You won a prize! Click here."},{input:[234,5],target:1,text:"You won a prize! Click here."},{input:[221,2],target:1,text:"You won a prize! Click here."},{input:[215,4],target:1,text:"You won a prize! Click here."},{input:[153,3],target:1,text:"You won a prize! Click here."},{input:[152,1],target:1,text:"You won a prize! Click here."},{input:[137,2],target:1,text:"You won a prize! Click here."},{input:[124,4],target:1,text:"You won a prize! Click here."},{input:[120,2],target:1,text:"You won a prize! Click here."},{input:[92,3],target:1,text:"You won a prize! Click here."},{input:[93,5],target:1,text:"You won a prize! Click here."},{input:[86,5],target:1,text:"You won a prize! Click here."},{input:[84,3],target:1,text:"You won a prize! Click here."},{input:[53,4],target:1,text:"You won a prize! Click here."},{input:[55,3],target:1,text:"You won a prize! Click here."}],He=()=>(console.log("Using prepared data with length "+ve.length),ve),we={id:"spam_nonlinear",title:"Phase 4: Nicht-lineare Daten",description:"Spam-Erkennung mit nur 2 Merkmalen, aber komplexer Verteilung. Ein einfacher linearer Klassifikator (Perzeptron) wird hier scheitern.",Model:Fe,GroundTruth:ee,CanvasComponent:ne,defaultParams:{weights:[0,0],bias:0},getInput:e=>{const t=[50,0];return t.text="Live Input",t},generateData:e=>He(),trainingConfig:{maxSteps:4e3,params:[{name:"w1 (Worte)",min:-5,max:5,step:.5},{name:"w2 (Links)",min:-5,max:5,step:.5},{name:"bias",min:-10,max:10,step:1}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + b)",inputLabels:["Worte","Links"],outputLabel:"Spam?",biasLabel:"b"},featuresConfig:Be,isFinished:e=>!1},Sn=()=>{const e=[];for(let t=0;t<10;t++){e.push({name:`b1_${t}`,min:-30,max:30,step:1});for(let n=0;n<2;n++)e.push({name:`w1_${t}_${n}`,min:-30,max:30,step:1})}e.push({name:"b2",min:-3,max:3,step:1});for(let t=0;t<10;t++)e.push({name:`w2_${t}`,min:-50,max:50,step:1});return e},Me={id:"spam_hidden",title:"Phase 5: Deep Learning (Hidden Layer)",description:'Spam-Erkennung mit einem Hidden Layer (10 Neuronen). Das Deep Neural Network kann die nicht-lineare Verteilung ("Spam-Insel") erkennen.',Model:kn,GroundTruth:ee,CanvasComponent:ne,defaultParams:{},getInput:e=>({input:[50,0],text:"Live Input"}),generateData:e=>He(),trainingConfig:{seed:1319434789,maxSteps:1e4,params:Sn()},networkViz:{formula:"Deep Network",inputLabels:["Worte","Links"],outputLabel:"Spam?",biasLabel:"b"},featuresConfig:Be,isFinished:e=>e>=50},ke={[xe.id]:xe,[ye.id]:ye,[Wt.id]:Wt,[we.id]:we,[Me.id]:Me};function Tn(e){return ke[e]||ke.physics}function An(){const[e,t]=lt(null),n=_t(null),i=_t(null),[l,o]=lt(0),[c,d]=lt(!1),[p,f]=lt([]),[s,h]=lt([]),[y,_]=lt(-1),[b,A]=lt(!1),[S,C]=lt("simulation"),[w,z]=lt("table"),[N,q]=lt("random"),[W,P]=lt("Bereit."),u=_t(0);At(()=>{const m=new URLSearchParams(window.location.search).get("sim")||"physics";if(m==="gallery"){t({id:"gallery",type:"gallery"});return}const r=Tn(m);if(!r){P("Fehler: Simulation nicht gefunden.");return}try{if(n.current=new r.GroundTruth(...r.groundTruthDefaults||[]),i.current=new r.Model,r.defaultParams&&(r.defaultParams.weight!==void 0&&i.current.setWeight(r.defaultParams.weight),r.defaultParams.weights!==void 0&&i.current.setWeights&&i.current.setWeights(r.defaultParams.weights),r.defaultParams.bias!==void 0&&i.current.setBias(r.defaultParams.bias)),t(r),n.current)try{const I=r.generateData(n.current);f(I)}catch(I){console.error("Auto-generate data error:",I)}}catch(I){console.error("Initialization Error:",I),P(`Init Fehler: ${I.message}`)}},[]),At(()=>{let k;const m=r=>{if(!c)return;u.current===0&&(u.current=r);const I=(r-u.current)/1e3;u.current=r;const V=Math.min(I,.1);o(O=>{const st=O+V*3;return e&&e.isFinished&&e.isFinished(st)&&(d(!1),P("Simulation beendet.")),st}),k=requestAnimationFrame(m)};return c&&(u.current=0,k=requestAnimationFrame(m)),()=>cancelAnimationFrame(k)},[c,e]);const B=async()=>{try{if(p.length===0||!e)return;A(!0),_(0),h([]),P("Suche optimales Gewicht und Bias (Live Visualisierung)..."),C("training");const k=new e.Model,m=new hn(k),r=(V,O)=>{if(h(Q=>{const st=[...Q,...V];return _(st.length-1),st}),(O&&O.message||O&&O.message)&&P(O.message),O&&O.bestParams){if(i.current.setParams)i.current.setParams(O.bestParams);else if(i.current.setWeights){const{weights:Q,bias:st}=O.bestParams;i.current.setWeights(Q),i.current.setBias(st)}}else O&&O.bestWeight!==void 0&&(i.current.setWeight(O.bestWeight),i.current.setBias(O.bestBias))};let I;if(N==="random"){P("Suche optimales Gewicht und Bias (Random Search)...");const V={seed:e.trainingConfig.seed,maxSteps:e.trainingConfig.maxSteps,initialRadius:e.trainingConfig.initialRadius,phase1Ratio:e.trainingConfig.phase1Ratio};I=await m.trainRandomAsync(p,e.trainingConfig.params,r,V)}else e.trainingConfig.params?I=await m.trainAsync(p,e.trainingConfig.params,r):I=await m.trainAsync(p,e.trainingConfig.weightRange,e.trainingConfig.biasRange,r);P(`Training fertig! Min Error: ${I.minError.toFixed(5)}`),A(!1)}catch(k){console.error("Training Error:",k),A(!1),P(`Fehler beim Training: ${k.message}`)}},x=()=>{o(0),d(!0),P("Simulation läuft..."),C("simulation")},g=()=>{if(d(!1),o(0),h([]),_(-1),e&&e.generateData&&n.current)try{const k=e.generateData(n.current);f(k),P("Reset durchgeführt & Daten neu generiert.")}catch(k){console.error("Regenerate Data Error:",k),f([])}else f([]),P("Reset durchgeführt.");try{i.current&&e?.defaultParams&&(e.defaultParams.weight!==void 0&&i.current.setWeight(e.defaultParams.weight),e.defaultParams.weights!==void 0&&i.current.setWeights&&i.current.setWeights(e.defaultParams.weights),e.defaultParams.bias!==void 0&&i.current.setBias(e.defaultParams.bias))}catch(k){console.error("Reset Error:",k)}};if(!e)return a("div",{children:"Lade Simulation..."});if(e.type==="gallery")return a("div",{className:"container",children:[a("header",{children:[a("h1",{children:"Neural Network Demonstrator"}),a("p",{children:"Architecture Gallery (Debug)"}),a("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:a("a",{href:"?sim=physics",style:{marginRight:"10px"},children:"Back to App"})})]}),a("main",{children:a(gn,{})})]});const v=e.CanvasComponent,T=e.networkViz||{},X=e.getInput?e.getInput(l):l,[L,Z]=lt(null),Y=k=>{Z(m=>m===k?null:k)},K={position:"absolute",top:"10px",right:"10px",zIndex:10,background:"rgba(255, 255, 255, 0.9)",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"0px"},D="all 0.4s cubic-bezier(0.4, 0, 0.2, 1)";return a("div",{className:"container",children:[a("header",{children:[a("h1",{children:"Neural Network Demonstrator"}),a("p",{children:e.title}),a("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:[a("a",{href:"?sim=physics",style:{marginRight:"10px",fontWeight:e.id==="physics"?"bold":"normal"},children:"Phase 1 (Physik)"}),a("a",{href:"?sim=spam",style:{marginRight:"10px",fontWeight:e.id==="spam"?"bold":"normal"},children:"Phase 2 (Spam)"}),a("a",{href:"?sim=spam_advanced",style:{marginRight:"10px",fontWeight:e.id==="spam_advanced"?"bold":"normal"},children:"Phase 3 (Spam Extended)"}),a("a",{href:"?sim=spam_nonlinear",style:{marginRight:"10px",fontWeight:e.id==="spam_nonlinear"?"bold":"normal"},children:"Phase 4 (Nonlinear)"}),a("a",{href:"?sim=spam_hidden",style:{fontWeight:e.id==="spam_hidden"?"bold":"normal"},children:"Phase 5 (Deep)"})]})]}),a("main",{children:[a("div",{className:"top-section",style:{display:"flex",gap:L?"0px":"20px",flexWrap:"nowrap",alignItems:"stretch",height:L?"calc(100vh - 200px)":"auto",minHeight:"500px",transition:D},children:[a("div",{className:"simulation-wrapper",style:{flex:L==="simulation"?"1 0 100%":L==="network"?"0 0 0%":"1 1 500px",opacity:L==="network"?0:1,overflow:"hidden",maxWidth:L==="network"?"0px":"100%",transition:D,position:"relative",display:"flex",flexDirection:"column"},children:[a("button",{onClick:()=>Y("simulation"),style:K,title:L==="simulation"?"Originalgröße":"Maximieren",children:L==="simulation"?a(vt,{children:a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a("path",{d:"M4 14h6v6"}),a("path",{d:"M20 10h-6V4"}),a("path",{d:"M14 10l7-7"}),a("path",{d:"M3 21l7-7"})]})}):a(vt,{children:a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a("path",{d:"M15 3h6v6"}),a("path",{d:"M9 21H3v-6"}),a("path",{d:"M21 3l-7 7"}),a("path",{d:"M3 21l7-7"})]})})}),a("div",{className:"simulation-section",style:{height:"100%",display:"flex",flexDirection:"column"},children:[a("div",{className:"tabs",style:{paddingRight:"120px"},children:[a("button",{className:`tab-button ${S==="simulation"?"active":""}`,onClick:()=>C("simulation"),children:"Simulation"}),a("button",{className:`tab-button ${S==="data"?"active":""}`,onClick:()=>C("data"),children:"Daten"}),a("button",{className:`tab-button ${S==="training"?"active":""}`,onClick:()=>C("training"),children:"Training"})]}),a("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[" ",S==="simulation"&&a(vt,{children:[e.id==="spam"?a("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",border:"2px dashed #ddd",borderRadius:"8px",minHeight:"300px"},children:a("p",{style:{color:"#999"},children:'Daten-Visualisierung jetzt im "Daten" Tab'})}):(()=>{let k=0;try{i.current&&(k=i.current.predict(X))}catch(r){console.error("Predict Error",r)}const m={};return["spam_advanced","spam_hidden","spam_nonlinear"].includes(e.id)&&(m.allowedModes=["text"],m.hideControls=!0),e.featuresConfig&&(m.features=e.featuresConfig),a("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:a(v,{time:l,data:p,currentInput:X,currentPrediction:k,groundTruth:n.current,neuralNet:i.current,...m})})})(),a("div",{className:"stats",style:{marginTop:"auto",paddingTop:"10px"},children:[a("p",{children:e.description}),a("p",{style:{color:"#646cff",fontWeight:"bold"},children:["Status: ",W]})]})]}),S==="data"&&a("div",{className:"data-content",style:{flex:1,overflowY:"auto"},children:[(()=>{const k=a("div",{style:{display:"flex",justifyContent:"center"},children:a("div",{style:{background:"#eee",borderRadius:"4px",padding:"2px",display:"flex",gap:"2px"},children:[a("button",{onClick:()=>z("table"),style:{background:w==="table"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:w==="table"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:w==="table"?"bold":"normal",color:w==="table"?"#333":"#666"},children:"Tabelle"}),a("button",{onClick:()=>z("plot"),style:{background:w==="plot"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:w==="plot"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:w==="plot"?"bold":"normal",color:w==="plot"?"#333":"#666"},children:"Graph"})]})}),m=["spam_advanced","spam_hidden","spam_nonlinear"].includes(e.id);return a(vt,{children:[(!m||w==="table")&&a("div",{style:{marginBottom:"15px"},children:k}),(p.length>0||e.id!=="physics")&&w==="plot"&&a("div",{style:{marginBottom:"20px"},children:e.id==="physics"?a(fn,{data:p,groundTruth:n.current,neuralNet:s.length>0?i.current:null}):(()=>{const r={};return m?(r.allowedModes=["scatter","3d","features"],r.showModel=s.length>0,r.additionalControls=k):(r.staticMode=!0,r.showGroundTruth=!0,r.showModel=s.length>0),e.featuresConfig&&(r.features=e.featuresConfig),a(v,{time:0,data:p,groundTruth:n.current,neuralNet:i.current,...r})})()})]})})(),w==="table"&&a(vt,{children:p.length>0?a("div",{style:{maxHeight:L?"calc(100vh - 350px)":"400px",overflowY:"auto"},children:a("table",{style:{width:"100%",textAlign:"left",borderCollapse:"collapse",fontSize:"0.9rem"},children:[a("thead",{children:a("tr",{style:{background:"#eee",borderBottom:"2px solid #ddd"},children:[Array.isArray(T.inputLabels)?T.inputLabels.map((k,m)=>a("th",{style:{padding:"8px"},children:k},m)):a("th",{style:{padding:"8px"},children:["Input (",T.inputLabel,")"]}),a("th",{style:{padding:"8px"},children:"Target"}),p.length>0&&p[0].text&&a("th",{style:{padding:"8px"},children:"E-Mail Text"})]})}),a("tbody",{children:p.map((k,m)=>{const r=["spam","spam_advanced"].includes(e.id);let I="transparent",V=k.target,O={padding:"8px"};if(r){const Q=k.target===1;I=Q?"#ffebee":"#e8f5e9",V=Q?"SPAM":"HAM",O={...O,fontWeight:"bold",color:Q?"#c0392b":"#27ae60"}}else V=typeof k.target=="number"?k.target.toFixed(2):k.target;return a("tr",{style:{background:I,borderBottom:"1px solid #ddd"},children:[Array.isArray(k.input)?k.input.map((Q,st)=>a("td",{style:{padding:"8px"},children:Q.toFixed(0)},st)):a("td",{style:{padding:"8px"},children:k.input.toFixed(2)}),a("td",{style:O,children:V}),k.text&&a("td",{style:{padding:"8px",color:"#555",fontStyle:"italic",maxWidth:"300px"},children:k.text})]},m)})})]})}):a("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Noch keine Trainingsdaten generiert."})})]}),S==="training"&&a("div",{className:"training-content",style:{flex:1},children:s.length>0?a(dn,{history:s,currentStepIndex:y,isTraining:b,paramsConfig:e.trainingConfig.params}):a("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Noch kein Training gestartet."})})]})]})]}),a("div",{className:"network-wrapper",style:{flex:L==="network"?"1 0 100%":L==="simulation"?"0 0 0%":`0 0 ${e.id==="spam_hidden"?"500px":"350px"}`,opacity:L==="simulation"?0:1,overflow:"hidden",maxWidth:L==="simulation"?"0px":"100%",transition:D,position:"relative",display:"flex",flexDirection:"column"},children:[a("button",{onClick:()=>Y("network"),style:K,title:L==="network"?"Originalgröße":"Maximieren",children:L==="network"?a(vt,{children:a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a("path",{d:"M4 14h6v6"}),a("path",{d:"M20 10h-6V4"}),a("path",{d:"M14 10l7-7"}),a("path",{d:"M3 21l7-7"})]})}):a(vt,{children:a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a("path",{d:"M15 3h6v6"}),a("path",{d:"M9 21H3v-6"}),a("path",{d:"M21 3l-7 7"}),a("path",{d:"M3 21l7-7"})]})})}),a("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:a(Ne,{input:X,weight:i.current?i.current.weights||i.current.weight:0,bias:i.current?i.current.bias:0,output:i.current?i.current.predict(X):0,model:i.current,formula:T.formula,inputLabel:T.inputLabels||T.inputLabel,outputLabel:T.outputLabel,biasLabel:T.biasLabel,decimals:e.id.includes("spam")?0:1})})]})]}),a(pn,{onTrain:B,onRun:x,onReset:g,isTraining:b,trainingStep:y,dataCount:p.length,trainerType:N,onTrainerTypeChange:q})]})]})}nn(a(An,{}),document.getElementById("app"));
