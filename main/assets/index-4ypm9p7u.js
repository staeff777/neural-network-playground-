(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();var Dt,tt,_e,Mt,Jt,xe,ye,be,Gt,Yt,Bt,At={},ve=[],Ie=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Nt=Array.isArray;function yt(e,t){for(var n in t)e[n]=t[n];return e}function Ut(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function De(e,t,n){var i,o,s,c={};for(s in t)s=="key"?i=t[s]:s=="ref"?o=t[s]:c[s]=t[s];if(arguments.length>2&&(c.children=arguments.length>3?Dt.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)c[s]===void 0&&(c[s]=e.defaultProps[s]);return Lt(e,c,i,o,null)}function Lt(e,t,n,i,o){var s={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++_e,__i:-1,__u:0};return o==null&&tt.vnode!=null&&tt.vnode(s),s}function xt(e){return e.children}function Rt(e,t){this.props=e,this.context=t}function Tt(e,t){if(t==null)return e.__?Tt(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Tt(e):null}function we(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return we(e)}}function Qt(e){(!e.__d&&(e.__d=!0)&&Mt.push(e)&&!$t.__r++||Jt!=tt.debounceRendering)&&((Jt=tt.debounceRendering)||xe)($t)}function $t(){for(var e,t,n,i,o,s,c,f=1;Mt.length;)Mt.length>f&&Mt.sort(ye),e=Mt.shift(),f=Mt.length,e.__d&&(n=void 0,i=void 0,o=(i=(t=e).__v).__e,s=[],c=[],t.__P&&((n=yt({},i)).__v=i.__v+1,tt.vnode&&tt.vnode(n),Ot(t.__P,n,i,t.__n,t.__P.namespaceURI,32&i.__u?[o]:null,s,o??Tt(i),!!(32&i.__u),c),n.__v=i.__v,n.__.__k[n.__i]=n,Se(s,n,c),i.__e=i.__=null,n.__e!=o&&we(n)));$t.__r=0}function Me(e,t,n,i,o,s,c,f,u,p,a){var d,x,m,v,A,k,y,b=i&&i.__k||ve,I=t.length;for(u=Ne(n,t,b,u,I),d=0;d<I;d++)(m=n.__k[d])!=null&&(x=m.__i==-1?At:b[m.__i]||At,m.__i=d,k=Ot(e,m,x,o,s,c,f,u,p,a),v=m.__e,m.ref&&x.ref!=m.ref&&(x.ref&&jt(x.ref,null,m),a.push(m.ref,m.__c||v,m)),A==null&&v!=null&&(A=v),(y=!!(4&m.__u))||x.__k===m.__k?u=ke(m,u,e,y):typeof m.type=="function"&&k!==void 0?u=k:v&&(u=v.nextSibling),m.__u&=-7);return n.__e=A,u}function Ne(e,t,n,i,o){var s,c,f,u,p,a=n.length,d=a,x=0;for(e.__k=new Array(o),s=0;s<o;s++)(c=t[s])!=null&&typeof c!="boolean"&&typeof c!="function"?(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?c=e.__k[s]=Lt(null,c,null,null,null):Nt(c)?c=e.__k[s]=Lt(xt,{children:c},null,null,null):c.constructor==null&&c.__b>0?c=e.__k[s]=Lt(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):e.__k[s]=c,u=s+x,c.__=e,c.__b=e.__b+1,f=null,(p=c.__i=Fe(c,n,u,d))!=-1&&(d--,(f=n[p])&&(f.__u|=2)),f==null||f.__v==null?(p==-1&&(o>a?x--:o<a&&x++),typeof c.type!="function"&&(c.__u|=4)):p!=u&&(p==u-1?x--:p==u+1?x++:(p>u?x--:x++,c.__u|=4))):e.__k[s]=null;if(d)for(s=0;s<a;s++)(f=n[s])!=null&&(2&f.__u)==0&&(f.__e==i&&(i=Tt(f)),Pe(f,f));return i}function ke(e,t,n,i){var o,s;if(typeof e.type=="function"){for(o=e.__k,s=0;o&&s<o.length;s++)o[s]&&(o[s].__=e,t=ke(o[s],t,n,i));return t}e.__e!=t&&(i&&(t&&e.type&&!t.parentNode&&(t=Tt(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Fe(e,t,n,i){var o,s,c,f=e.key,u=e.type,p=t[n],a=p!=null&&(2&p.__u)==0;if(p===null&&f==null||a&&f==p.key&&u==p.type)return n;if(i>(a?1:0)){for(o=n-1,s=n+1;o>=0||s<t.length;)if((p=t[c=o>=0?o--:s++])!=null&&(2&p.__u)==0&&f==p.key&&u==p.type)return c}return-1}function te(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Ie.test(t)?n:n+"px"}function Wt(e,t,n,i,o){var s,c;t:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||te(e.style,t,"");if(n)for(t in n)i&&n[t]==i[t]||te(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")s=t!=(t=t.replace(be,"$1")),c=t.toLowerCase(),t=c in e||t=="onFocusOut"||t=="onFocusIn"?c.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?i?n.u=i.u:(n.u=Gt,e.addEventListener(t,s?Bt:Yt,s)):e.removeEventListener(t,s?Bt:Yt,s);else{if(o=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function ee(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Gt++;else if(t.t<n.u)return;return n(tt.event?tt.event(t):t)}}}function Ot(e,t,n,i,o,s,c,f,u,p){var a,d,x,m,v,A,k,y,b,I,$,O,z,w,l,W,S,g=t.type;if(t.constructor!=null)return null;128&n.__u&&(u=!!(32&n.__u),s=[f=t.__e=n.__e]),(a=tt.__b)&&a(t);t:if(typeof g=="function")try{if(y=t.props,b="prototype"in g&&g.prototype.render,I=(a=g.contextType)&&i[a.__c],$=a?I?I.props.value:a.__:i,n.__c?k=(d=t.__c=n.__c).__=d.__E:(b?t.__c=d=new g(y,$):(t.__c=d=new Rt(y,$),d.constructor=g,d.render=Ye),I&&I.sub(d),d.state||(d.state={}),d.__n=i,x=d.__d=!0,d.__h=[],d._sb=[]),b&&d.__s==null&&(d.__s=d.state),b&&g.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=yt({},d.__s)),yt(d.__s,g.getDerivedStateFromProps(y,d.__s))),m=d.props,v=d.state,d.__v=t,x)b&&g.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),b&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(b&&g.getDerivedStateFromProps==null&&y!==m&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(y,$),t.__v==n.__v||!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(y,d.__s,$)===!1){for(t.__v!=n.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(L){L&&(L.__=t)}),O=0;O<d._sb.length;O++)d.__h.push(d._sb[O]);d._sb=[],d.__h.length&&c.push(d);break t}d.componentWillUpdate!=null&&d.componentWillUpdate(y,d.__s,$),b&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(m,v,A)})}if(d.context=$,d.props=y,d.__P=e,d.__e=!1,z=tt.__r,w=0,b){for(d.state=d.__s,d.__d=!1,z&&z(t),a=d.render(d.props,d.state,d.context),l=0;l<d._sb.length;l++)d.__h.push(d._sb[l]);d._sb=[]}else do d.__d=!1,z&&z(t),a=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++w<25);d.state=d.__s,d.getChildContext!=null&&(i=yt(yt({},i),d.getChildContext())),b&&!x&&d.getSnapshotBeforeUpdate!=null&&(A=d.getSnapshotBeforeUpdate(m,v)),W=a,a!=null&&a.type===xt&&a.key==null&&(W=Te(a.props.children)),f=Me(e,Nt(W)?W:[W],t,n,i,o,s,c,f,u,p),d.base=t.__e,t.__u&=-161,d.__h.length&&c.push(d),k&&(d.__E=d.__=null)}catch(L){if(t.__v=null,u||s!=null)if(L.then){for(t.__u|=u?160:128;f&&f.nodeType==8&&f.nextSibling;)f=f.nextSibling;s[s.indexOf(f)]=null,t.__e=f}else{for(S=s.length;S--;)Ut(s[S]);Xt(t)}else t.__e=n.__e,t.__k=n.__k,L.then||Xt(t);tt.__e(L,t,n)}else s==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):f=t.__e=He(n.__e,t,n,i,o,s,c,u,p);return(a=tt.diffed)&&a(t),128&t.__u?void 0:f}function Xt(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Xt)}function Se(e,t,n){for(var i=0;i<n.length;i++)jt(n[i],n[++i],n[++i]);tt.__c&&tt.__c(t,e),e.some(function(o){try{e=o.__h,o.__h=[],e.some(function(s){s.call(o)})}catch(s){tt.__e(s,o.__v)}})}function Te(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Nt(e)?e.map(Te):yt({},e)}function He(e,t,n,i,o,s,c,f,u){var p,a,d,x,m,v,A,k=n.props||At,y=t.props,b=t.type;if(b=="svg"?o="http://www.w3.org/2000/svg":b=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),s!=null){for(p=0;p<s.length;p++)if((m=s[p])&&"setAttribute"in m==!!b&&(b?m.localName==b:m.nodeType==3)){e=m,s[p]=null;break}}if(e==null){if(b==null)return document.createTextNode(y);e=document.createElementNS(o,b,y.is&&y),f&&(tt.__m&&tt.__m(t,s),f=!1),s=null}if(b==null)k===y||f&&e.data==y||(e.data=y);else{if(s=s&&Dt.call(e.childNodes),!f&&s!=null)for(k={},p=0;p<e.attributes.length;p++)k[(m=e.attributes[p]).name]=m.value;for(p in k)if(m=k[p],p!="children"){if(p=="dangerouslySetInnerHTML")d=m;else if(!(p in y)){if(p=="value"&&"defaultValue"in y||p=="checked"&&"defaultChecked"in y)continue;Wt(e,p,null,m,o)}}for(p in y)m=y[p],p=="children"?x=m:p=="dangerouslySetInnerHTML"?a=m:p=="value"?v=m:p=="checked"?A=m:f&&typeof m!="function"||k[p]===m||Wt(e,p,m,k[p],o);if(a)f||d&&(a.__html==d.__html||a.__html==e.innerHTML)||(e.innerHTML=a.__html),t.__k=[];else if(d&&(e.innerHTML=""),Me(t.type=="template"?e.content:e,Nt(x)?x:[x],t,n,i,b=="foreignObject"?"http://www.w3.org/1999/xhtml":o,s,c,s?s[0]:n.__k&&Tt(n,0),f,u),s!=null)for(p=s.length;p--;)Ut(s[p]);f||(p="value",b=="progress"&&v==null?e.removeAttribute("value"):v!=null&&(v!==e[p]||b=="progress"&&!v||b=="option"&&v!=k[p])&&Wt(e,p,v,k[p],o),p="checked",A!=null&&A!=e[p]&&Wt(e,p,A,k[p],o))}return e}function jt(e,t,n){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&t==null||(e.__u=e(t))}else e.current=t}catch(o){tt.__e(o,n)}}function Pe(e,t,n){var i,o;if(tt.unmount&&tt.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||jt(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){tt.__e(s,t)}i.base=i.__P=null}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&Pe(i[o],t,n||typeof e.type!="function");n||Ut(e.__e),e.__c=e.__=e.__e=void 0}function Ye(e,t,n){return this.constructor(e,n)}function Be(e,t,n){var i,o,s,c;t==document&&(t=document.documentElement),tt.__&&tt.__(e,t),o=(i=!1)?null:t.__k,s=[],c=[],Ot(t,e=t.__k=De(xt,null,[e]),o||At,At,t.namespaceURI,o?null:t.firstChild?Dt.call(t.childNodes):null,s,o?o.__e:t.firstChild,i,c),Se(s,e,c)}Dt=ve.slice,tt={__e:function(e,t,n,i){for(var o,s,c;t=t.__;)if((o=t.__c)&&!o.__)try{if((s=o.constructor)&&s.getDerivedStateFromError!=null&&(o.setState(s.getDerivedStateFromError(e)),c=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,i||{}),c=o.__d),c)return o.__E=o}catch(f){e=f}throw e}},_e=0,Rt.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=yt({},this.state),typeof e=="function"&&(e=e(yt({},n),this.props)),e&&yt(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),Qt(this))},Rt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Qt(this))},Rt.prototype.render=xt,Mt=[],xe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ye=function(e,t){return e.__v.__b-t.__v.__b},$t.__r=0,be=/(PointerCapture)$|Capture$/i,Gt=0,Yt=ee(!1),Bt=ee(!0);var Xe=0;function h(e,t,n,i,o,s){t||(t={});var c,f,u=t;if("ref"in u)for(f in u={},t)f=="ref"?c=t[f]:u[f]=t[f];var p={type:e,props:u,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Xe,__i:-1,__u:0,__source:o,__self:s};if(typeof e=="function"&&(c=e.defaultProps))for(f in c)u[f]===void 0&&(u[f]=c[f]);return tt.vnode&&tt.vnode(p),p}var Ct,at,Ft,ne,zt=0,Ae=[],ht=tt,ie=ht.__b,se=ht.__r,oe=ht.diffed,re=ht.__c,ae=ht.unmount,le=ht.__;function Kt(e,t){ht.__h&&ht.__h(at,e,zt||t),zt=0;var n=at.__H||(at.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function rt(e){return zt=1,Ve(We,e)}function Ve(e,t,n){var i=Kt(Ct++,2);if(i.t=e,!i.__c&&(i.__=[We(void 0,t),function(f){var u=i.__N?i.__N[0]:i.__[0],p=i.t(u,f);u!==p&&(i.__N=[p,i.__[1]],i.__c.setState({}))}],i.__c=at,!at.__f)){var o=function(f,u,p){if(!i.__c.__H)return!0;var a=i.__c.__H.__.filter(function(x){return!!x.__c});if(a.every(function(x){return!x.__N}))return!s||s.call(this,f,u,p);var d=i.__c.props!==f;return a.forEach(function(x){if(x.__N){var m=x.__[0];x.__=x.__N,x.__N=void 0,m!==x.__[0]&&(d=!0)}}),s&&s.call(this,f,u,p)||d};at.__f=!0;var s=at.shouldComponentUpdate,c=at.componentWillUpdate;at.componentWillUpdate=function(f,u,p){if(this.__e){var a=s;s=void 0,o(f,u,p),s=a}c&&c.call(this,f,u,p)},at.shouldComponentUpdate=o}return i.__N||i.__}function bt(e,t){var n=Kt(Ct++,3);!ht.__s&&Ce(n.__H,t)&&(n.__=e,n.u=t,at.__H.__h.push(n))}function pt(e){return zt=5,Ge(function(){return{current:e}},[])}function Ge(e,t){var n=Kt(Ct++,7);return Ce(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Ue(){for(var e;e=Ae.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Et),e.__H.__h.forEach(Vt),e.__H.__h=[]}catch(t){e.__H.__h=[],ht.__e(t,e.__v)}}ht.__b=function(e){at=null,ie&&ie(e)},ht.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),le&&le(e,t)},ht.__r=function(e){se&&se(e),Ct=0;var t=(at=e.__c).__H;t&&(Ft===at?(t.__h=[],at.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(Et),t.__h.forEach(Vt),t.__h=[],Ct=0)),Ft=at},ht.diffed=function(e){oe&&oe(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ae.push(t)!==1&&ne===ht.requestAnimationFrame||((ne=ht.requestAnimationFrame)||Oe)(Ue)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Ft=at=null},ht.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Et),n.__h=n.__h.filter(function(i){return!i.__||Vt(i)})}catch(i){t.some(function(o){o.__h&&(o.__h=[])}),t=[],ht.__e(i,n.__v)}}),re&&re(e,t)},ht.unmount=function(e){ae&&ae(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{Et(i)}catch(o){t=o}}),n.__H=void 0,t&&ht.__e(t,n.__v))};var ce=typeof requestAnimationFrame=="function";function Oe(e){var t,n=function(){clearTimeout(i),ce&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,35);ce&&(t=requestAnimationFrame(n))}function Et(e){var t=at,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),at=t}function Vt(e){var t=at;e.__c=e.__(),at=t}function Ce(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function We(e,t){return typeof t=="function"?t(e):t}class je{constructor(t){this.model=t}train(t,n,i){if(i!==void 0)return this.trainLegacy(t,n,i);const o=n,s=[];let c=1/0,f={};const u=a=>{const d=[];if(a.step<=0)return[a.min];for(let x=a.min;x<=a.max+1e-4;x+=a.step)d.push(parseFloat(x.toFixed(2)));return d},p=(a,d)=>{if(console.log({paramIndex:a,currentParams:d}),a===o.length){const v=[];let A=0;d.forEach(($,O)=>{o[O].name.toLowerCase().includes("bias")?A=$:v.push($)}),this.model.setWeights?this.model.setWeights(v):this.model.setWeight&&this.model.setWeight(v[0]),this.model.setBias(A);let k=0,y=0;for(const $ of t){const O=this.model.predict($.input),z=$.target-O;k+=z*z,y+=Math.abs(z)}const b=k/t.length,I=y/t.length;b<c&&(c=b,f={weights:[...v],bias:A}),s.push({params:[...d],error:b,mae:I});return}const x=o[a],m=u(x);for(const v of m)d[a]=v,p(a+1,d)};return p(0,new Array(o.length)),{bestParams:f,history:s,minError:c}}trainLegacy(t,n,i){const o=[];let s=n.min,c=i.min,f=1/0;for(let u=n.min;u<=n.max;u+=n.step)for(let p=i.min;p<=i.max;p+=i.step){const a=parseFloat(u.toFixed(2)),d=parseFloat(p.toFixed(2));this.model.setWeight(a),this.model.setBias(d);let x=0,m=0;for(const k of t){const y=this.model.predict(k.input),b=k.target-y;x+=b*b,m+=Math.abs(b)}const v=x/t.length,A=m/t.length;v<f&&(f=v,s=a,c=d),o.push({weight:a,bias:d,error:v,mae:A})}return{bestWeight:s,bestBias:c,history:o}}async trainAsync(t,n,i){if(!Array.isArray(n)){const m=arguments[1],v=arguments[2],A=arguments[3];let k=m.min,y=v.min,b=1/0,I=[];const $=20;let O=0;for(let z=m.min;z<=m.max;z+=m.step)for(let w=v.min;w<=v.max;w+=v.step){const l=parseFloat(z.toFixed(2)),W=parseFloat(w.toFixed(2));this.model.setWeight(l),this.model.setBias(W);let S=0,g=0;for(const T of t){const D=this.model.predict(T.input),P=T.target-D;S+=P*P,g+=Math.abs(P)}const L=S/t.length,R=g/t.length;L<b&&(b=L,k=l,y=W);const E={weight:l,bias:W,error:L,mae:R};I.push(E),O++,O%$===0&&(A&&A(I,{bestWeight:k,bestBias:y,minError:b}),I=[],await new Promise(T=>setTimeout(T,0)))}return I.length>0&&A&&A(I,{bestWeight:k,bestBias:y,minError:b}),{bestWeight:k,bestBias:y,minError:b}}let s=1/0,c={},f=0;const u=50;let p=[];const a=m=>{const v=[];if(m.step<=0)return[m.min];for(let A=m.min;A<=m.max+1e-4;A+=m.step)v.push(parseFloat(A.toFixed(2)));return v},d=n.map(a),x=async(m,v)=>{if(m===n.length){const k=[];let y=0;v.forEach((l,W)=>{n[W].name.toLowerCase().includes("bias")?y=l:k.push(l)});let b={};this.model.setParams?(v.forEach((l,W)=>{b[n[W].name]=l}),this.model.setParams(b),y===void 0&&(y=0)):(this.model.setWeights?this.model.setWeights(k):this.model.setWeight&&this.model.setWeight(k[0]),this.model.setBias(y),b={weights:[...k],bias:y});let I=0,$=0;for(const l of t){const W=this.model.predict(l.input),S=l.target-W;I+=S*S,$+=Math.abs(S)}const O=I/t.length,z=$/t.length;O<s&&(s=O,c=b);const w={params:[...v],error:O,mae:z};p.push(w),f++,f%u===0&&(i&&i(p,{bestParams:c,minError:s}),p=[],await new Promise(l=>setTimeout(l,0)));return}const A=d[m];for(const k of A)v[m]=k,await x(m+1,v)};return await x(0,new Array(n.length)),p.length>0&&i&&i(p,{bestParams:c,minError:s}),{bestParams:c,minError:s}}async trainRandomAsync(t,n,i){let f=1/0,u={},p=n.map(y=>({min:y.min,max:y.max,span:y.max-y.min})),a=p.map(y=>y.min+Math.random()*y.span);const d=y=>{const b=[];let I=0;y.forEach((w,l)=>{n[l].name.toLowerCase().includes("bias")?I=w:b.push(w)});let $={};this.model.setParams?(y.forEach((w,l)=>{$[n[l].name]=w}),this.model.setParams($)):(this.model.setWeights?this.model.setWeights(b):this.model.setWeight&&this.model.setWeight(b[0]),this.model.setBias(I),$={weights:b,bias:I});let O=0,z=0;for(const w of t){const l=this.model.predict(w.input),W=w.target-l;O+=W*W,z+=Math.abs(W)}return{mse:O/t.length,mae:z/t.length,decodedParams:$,weights:b,bias:I}};let x=d(a);f=x.mse,u=x.decodedParams||{weights:x.weights,bias:x.bias,_array:[...a]},i&&i([{params:[...a],error:f,mae:x.mae}],{bestParams:u,minError:f}),await new Promise(y=>setTimeout(y,0));let m=[];const v=10;let A=f,k=[...a];for(let y=0;y<1e4;y++){const I=y<9e3;let $,O;if(I){const L=y/9e3;$=.2*(1-L*.5),O=.5*(1-L*.5)}else $=.1*(1-(y-9e3)/999.9999999999998),O=.5*.5*Math.pow(.992,y-1e4*.9);let z=!1;const w=[...k];let l=!1;for(;!l;)w.forEach((L,R)=>{if(Math.random()<.4)return;l=!0;const E=p[R];let T=!1;if(I){const _=E.span*.15;L<E.min+_&&(E.min-=E.span*.8,E.span=E.max-E.min,T=!0),L>E.max-_&&(E.max+=E.span*.8,E.span=E.max-E.min,T=!0),T&&(z=!0)}let D=E.span*O;T&&(D=Math.max(D,E.span*.25));const P=D;let F=L+(Math.random()-.5)*2*P;F<E.min&&(F=E.min),F>E.max&&(F=E.max),w[R]=F});const W=d(w),S=W.mse-A;let g=!1;if(S<0)g=!0;else{const L=Math.exp(-S/($+1e-9));Math.random()<L&&(g=!0)}if(g&&(k=w,A=W.mse),W.mse<f&&(f=W.mse,u={weights:W.weights,bias:W.bias,_array:[...w]}),m.push({params:[...w],error:W.mse,mae:W.mae}),m.length>=v){let L;z&&(L="Grenzen dynamisch erweitert..."),i&&i(m,{bestParams:u,minError:f,message:L}),m=[],await new Promise(R=>setTimeout(R,0))}}return m.length>0&&i&&i(m,{bestParams:u,minError:f}),{bestParams:u,minError:f}}}function Ke({history:e,currentStepIndex:t,isTraining:n,paramsConfig:i}){const o=pt(null),[s,c]=rt(0),f=6;bt(()=>{c(0)},[i]),bt(()=>{const p=o.current;if(!p||!e||e.length===0)return;const a=p.getContext("2d"),d=p.width,x=p.height;a.clearRect(0,0,d,x),a.fillStyle="#fff",a.fillRect(0,0,d,x);const m=Math.max(...e.map(z=>z.error)),A=!n&&e.length>0?e.length-1:t!==null&&t>=0?Math.min(t,e.length-1):-1;let k=-1,y=1/0;for(let z=0;z<=A;z++)e[z].error<y&&(y=e[z].error,k=z);let b=[];if(i){const z=s*f,w=Math.min(z+f,i.length),l=i.slice(z,w);l.length;const W=3,S=2,g=d/W,L=x/S;b=l.map((R,E)=>{const T=z+E,D=e.map(V=>V.params[T]),P=Math.min(...D),F=Math.max(...D),_=E%W,r=Math.floor(E/W);return{xLabel:R.name,xMin:P,xMax:F,getValue:(V,K)=>V.params[T],offsetX:_*g,offsetY:r*L,w:g,h:L}})}else{const z=d/2,w=e.map(W=>W.weight),l=e.map(W=>W.bias);b=[{xLabel:"Weight",xMin:Math.min(...w),xMax:Math.max(...w),getValue:W=>W.weight,offsetX:0,offsetY:0,w:z,h:x},{xLabel:"Bias",xMin:Math.min(...l),xMax:Math.max(...l),getValue:W=>W.bias,offsetX:z,offsetY:0,w:z,h:x}]}const I=35;b.forEach(z=>{const{xLabel:w,xMin:l,xMax:W,getValue:S,offsetX:g,offsetY:L,w:R,h:E}=z,T=F=>L+E-I-F/(m||1)*(E-2*I),D=F=>g+I+(F-l)/(W-l||1)*(R-2*I);a.strokeStyle="#eee",a.strokeRect(g,L,R,E),a.beginPath(),a.strokeStyle="#333",a.lineWidth=1,a.moveTo(g+I,L+I),a.lineTo(g+I,L+E-I),a.lineTo(g+R-I,L+E-I),a.stroke(),a.fillStyle="#333",a.font="11px sans-serif",a.textAlign="center";let P=w;P.length>20&&(P=P.substring(0,18)+"..."),a.fillText(P,g+R/2,L+E-10),g===0&&(a.save(),a.translate(g+10,L+E/2),a.rotate(-Math.PI/2),a.fillText("Error",0,0),a.restore()),a.fillStyle="#666",a.font="9px sans-serif",a.fillText(l.toFixed(1),g+I,L+E-I+12),a.fillText(W.toFixed(1),g+R-I,L+E-I+12),a.fillStyle="rgba(52, 152, 219, 0.4)";for(let F=0;F<=A;F++){const _=S(e[F],F),r=D(_),V=T(e[F].error);a.fillRect(r,V,2,2)}if(k>=0){const F=S(e[k],k),_=D(F),r=T(e[k].error);a.beginPath(),a.fillStyle="#2ecc71",a.strokeStyle="#27ae60",a.arc(_,r,6,0,Math.PI*2),a.fill(),a.stroke()}if(n&&t!==null&&t>=0&&t<=A){const F=S(e[t],t),_=D(F),r=T(e[t].error);a.beginPath(),a.fillStyle="#e74c3c",a.strokeStyle="#c0392b",a.arc(_,r,5,0,Math.PI*2),a.fill(),a.stroke()}});const $=d-120,O=10;a.fillStyle="rgba(255,255,255,0.8)",a.fillRect($,O,110,50),a.strokeStyle="#ccc",a.strokeRect($,O,110,50),a.textAlign="left",a.font="10px sans-serif",a.beginPath(),a.fillStyle="#e74c3c",a.arc($+10,O+15,4,0,Math.PI*2),a.fill(),a.fillStyle="#333",a.fillText("Current Scan",$+20,O+18),a.beginPath(),a.fillStyle="#2ecc71",a.arc($+10,O+35,4,0,Math.PI*2),a.fill(),a.fillStyle="#333",a.fillText("Best So Far",$+20,O+38),!n&&k>=0&&(a.fillStyle="#333",a.font="bold 12px sans-serif",a.textAlign="right",a.fillText(`Min Error: ${y.toFixed(5)}`,d-10,x-10))},[e,t,n,i,s]);const u=i?Math.ceil(i.length/f):1;return h("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff"},children:[h("canvas",{ref:o,width:800,height:400,style:{width:"100%",height:"auto"}}),u>1&&h("div",{style:{display:"flex",justifyContent:"center",marginTop:"10px",gap:"10px"},children:[h("button",{onClick:()=>c(p=>Math.max(0,p-1)),disabled:s===0,children:"Previous"}),h("span",{style:{alignSelf:"center"},children:["Page ",s+1," of ",u]}),h("button",{onClick:()=>c(p=>Math.min(u-1,p+1)),disabled:s===u-1,children:"Next"})]})]})}function qe({model:e,inputs:t,inputLabels:n,output:i,outputLabel:o}){if(!e||!e.getTopology)return null;const{inputCount:s,hiddenCounts:c,outputCount:f,weights1:u,biases1:p,weights2:a}=e.getTopology();let d={hidden:[],output:[]};e.getActivations&&(d=e.getActivations(t));const x=600,m=400,v=m/2,A=x/2,k=350,y=280,b=A-k/2,I=A+k/2,$=[{count:s,x:b,labels:n,values:t},{count:c[0],x:A,values:d.hidden},{count:f,x:I,labels:[o],values:d.output}],O=Math.max(...$.map(S=>S.count)),z=Math.min(50,y/O),w=(S,g)=>{const R=($[S].count-1)*z;return v-R/2+g*z},l=S=>{const g=Math.max(.2,Math.min(.8,Math.abs(S)/2));return S>0?`rgba(46, 204, 113, ${g})`:`rgba(231, 76, 60, ${g})`},W=S=>{const g=Math.max(0,Math.min(1,S)),L=Math.round(255+-203*g),R=Math.round(255+-103*g),E=Math.round(255+-36*g);return`rgb(${L},${R},${E})`};return h("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center"},children:[h("h3",{style:{marginBottom:"10px",fontSize:"1rem",color:"#555"},children:"Neural Network Activity"}),h("svg",{width:x,height:m,style:{overflow:"visible"},children:[h("rect",{x:b,y:v-y/2,width:k,height:y,rx:"15",fill:"none",stroke:"#333",strokeWidth:"3",strokeDasharray:"5,5"}),h("text",{x:A,y:v-y/2+20,textAnchor:"middle",fill:"#777",fontSize:"12",fontWeight:"bold",children:"NEURAL NETWORK"}),u.map((S,g)=>S.map((L,R)=>h("line",{x1:$[0].x,y1:w(0,R),x2:$[1].x,y2:w(1,g),stroke:l(L),strokeWidth:Math.max(1,Math.min(4,Math.abs(L)))},`L0-${R}-${g}`))),a.map((S,g)=>h("line",{x1:$[1].x,y1:w(1,g),x2:$[2].x,y2:w(2,0),stroke:l(S),strokeWidth:Math.max(1,Math.min(4,Math.abs(S)))},`L1-${g}-0`)),$.map((S,g)=>h("g",{children:Array.from({length:S.count}).map((L,R)=>{const E=S.x,T=w(g,R),D=S.values&&S.values[R]!==void 0?S.values[R]:0;return h("g",{children:[h("circle",{cx:E,cy:T,r:12,fill:W(D),stroke:"#333",strokeWidth:"1.5"}),S.labels&&h("text",{x:g===0?E-30:E+30,y:T,textAnchor:g===0?"end":"start",dominantBaseline:"middle",fontSize:"13",fontWeight:"bold",fill:"#333",children:S.labels[R]||""}),h("title",{children:D.toFixed(3)})]},`n-${g}-${R}`)})},`layer-${g}`)),h("g",{transform:`translate(${x-100}, ${m-50})`,children:[h("rect",{width:"90",height:"40",fill:"white",stroke:"#ccc",rx:"4"}),h("line",{x1:"10",y1:"10",x2:"30",y2:"10",stroke:"#2ecc71",strokeWidth:"3"}),h("text",{x:"35",y:"14",fontSize:"10",children:"Positive"}),h("line",{x1:"10",y1:"28",x2:"30",y2:"28",stroke:"#e74c3c",strokeWidth:"3"}),h("text",{x:"35",y:"32",fontSize:"10",children:"Negative"})]})]})]})}function Le({input:e,weight:t,bias:n,output:i,formula:o="y = w * x + b",inputLabel:s="Input",outputLabel:c="Output",biasLabel:f="b",decimals:u=1,model:p=null}){if(p&&p.getTopology){let P=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(P=e.input);const F=Array.isArray(P)?P:[P],_=Array.isArray(s)?s:[s];return h(qe,{model:p,inputs:F,inputLabels:_,output:i,outputLabel:c})}let a=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(a=e.input);const d=Array.isArray(a)?a:[a],x=Array.isArray(t)?t:[t],m=Array.isArray(s)?s:[s],v=Number(n)||0,A=Number(i)||0,k=d.length,y=24,b=90,I=300,$=60,O=60,z=Math.max(1,k-1)*b,w=Math.max(150,z+$+O),l=w+60,W=600,S=W/2,g=S-I/2,L=S+I/2,R=w/2+20,E=R-z/2,T=L-50,D=T-60;return h("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center"},children:[h("h3",{style:{marginBottom:"10px"},children:"Modell Architektur"}),h("svg",{width:W,height:l,style:{overflow:"visible"},children:[h("defs",{children:h("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"27",refY:"3.5",orient:"auto",children:h("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#333"})})}),h("rect",{x:g,y:20,width:I,height:w,rx:"15",fill:"none",stroke:"#333",strokeWidth:"3",strokeDasharray:"5,5"}),h("text",{x:S,y:40,textAnchor:"middle",fill:"#777",fontSize:"12",fontWeight:"bold",children:"NEURAL NETWORK"}),(()=>{const P=R-50;return h(xt,{children:[d.map((F,_)=>{const r=k>1?E+_*b:R,V=Number(x[_])||0,K=m[_]||`x${_+1}`,dt=Number(F)||0;return h("g",{children:[h("line",{x1:g,y1:r,x2:D,y2:R,stroke:"#999",strokeWidth:"1"}),h("g",{transform:`translate(${(g+D)/2+(_-(k-1)/2)*5}, ${(r+R)/2})`,children:[h("rect",{x:"-24",y:"-9",width:"50",height:"18",fill:"#fff",rx:"4",stroke:"#e0e0e0"}),h("text",{x:"0",y:"4",textAnchor:"middle",fill:"#e74c3c",fontSize:"10",fontWeight:"bold",children:V.toFixed(1)})]}),h("circle",{cx:g,cy:r,r:y,fill:"#fff",stroke:"#333",strokeWidth:"2"}),h("text",{x:g-40,y:r,textAnchor:"end",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",children:K}),h("text",{x:g,y:r,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fill:"#333",children:dt.toFixed(u)})]},_)}),h("line",{x1:D,y1:R,x2:T,y2:R,stroke:"#333",strokeWidth:"2"}),h("g",{transform:`translate(${T}, ${R})`,children:[h("rect",{x:"-18",y:"-18",width:"36",height:"36",rx:"6",fill:"#fff",stroke:"#333",strokeWidth:"2"}),h("path",{d:"M -10 8 C -4 8, -4 -8, 10 -8",stroke:"#333",strokeWidth:"2",fill:"none"})]}),h("line",{x1:T+18,y1:R,x2:L-y,y2:R,stroke:"#333",strokeWidth:"2"}),h("path",{d:`M ${T-20} ${P} Q ${T-20} ${R} ${D+10} ${R}`,fill:"none",stroke:"#f39c12",strokeWidth:"1",markerEnd:"url(#arrowhead)"}),h("circle",{cx:T-20,cy:P,r:12,fill:"#f1c40f",stroke:"#f39c12"}),h("text",{x:T-23,y:P+5,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fontWeight:"bold",fill:"#fff",children:"b"}),h("text",{x:T-5,y:P+5,textAnchor:"start",dominantBaseline:"middle",fontSize:"12",fill:"#f39c12",fontWeight:"bold",children:v.toFixed(2)})]})})(),h("circle",{cx:L,cy:R,r:y,fill:"#fff",stroke:"#333",strokeWidth:"2"}),h("text",{x:L-14,y:R+4,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",fontSize:"12",children:A.toFixed(2)}),h("text",{x:L+40,y:R+4,textAnchor:"start",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:c}),h("text",{x:S,y:l-15,textAnchor:"middle",fontSize:"12",fontStyle:"italic",fill:"#777",children:o})]})]})}function Ze({data:e,groundTruth:t,neuralNet:n}){const i=pt(null);return bt(()=>{const o=i.current;if(!o)return;const s=o.getContext("2d"),c=o.width,f=o.height;if(s.clearRect(0,0,c,f),!e||e.length===0){s.fillStyle="#999",s.textAlign="center",s.fillText("Keine Daten vorhanden",c/2,f/2);return}const u=40,p=c-2*u,a=f-2*u,d=Math.max(...e.map(A=>A.input))||10,x=Math.max(...e.map(A=>A.target))||100,m=A=>u+A/d*p,v=A=>f-u-A/x*a;if(s.beginPath(),s.strokeStyle="#333",s.moveTo(u,u),s.lineTo(u,f-u),s.lineTo(c-u,f-u),s.stroke(),s.fillStyle="#333",s.textAlign="center",s.fillText("Zeit (t)",c/2,f-10),s.save(),s.translate(15,f/2),s.rotate(-Math.PI/2),s.fillText("Position (s)",0,0),s.restore(),e.forEach(A=>{const k=m(A.input),y=v(A.target);s.beginPath(),s.arc(k,y,3,0,Math.PI*2),s.fillStyle="#2ecc71",s.fill()}),n){s.beginPath(),s.strokeStyle="#e74c3c",s.lineWidth=2;for(let A=0;A<=d;A+=.1){const k=n.predict(A),y=m(A),b=v(k);A===0?s.moveTo(y,b):s.lineTo(y,b)}s.stroke()}},[e,t,n]),h("div",{style:{border:"1px solid #ccc",margin:"10px 0",borderRadius:"4px"},children:h("canvas",{ref:i,width:600,height:300,style:{width:"100%",display:"block"}})})}function Je({onTrain:e,onRun:t,onReset:n,isTraining:i,trainingStep:o,dataCount:s,trainerType:c,onTrainerTypeChange:f}){return h("div",{role:"region","aria-label":"Steuerung",style:{padding:"20px",background:"#eee",borderRadius:"8px",display:"flex",gap:"10px",flexWrap:"wrap",alignItems:"center"},children:[h("span",{"aria-live":"polite",children:["Datenpunkte: ",s]}),h("div",{style:{borderLeft:"1px solid #ccc",paddingLeft:"10px",marginLeft:"10px",display:"flex",gap:"5px",alignItems:"center"},children:[h("select",{value:c,onChange:u=>f(u.target.value),disabled:i,style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[h("option",{value:"exhaustive",children:"Grid Search (Genau)"}),h("option",{value:"random",children:"Adaptive Random (Schnell)"})]}),h("button",{onClick:e,disabled:i||s===0,"aria-busy":i,children:i?"Suche läuft...":"2. Trainieren"})]}),h("button",{onClick:t,disabled:i,children:"3. Simulation Starten"}),h("button",{onClick:n,style:{marginLeft:"auto",background:"#e74c3c",color:"white"},"aria-label":"Simulation zurücksetzen",children:"Reset"})]})}function Qe(){const[e,t]=rt(0),n=[{name:"Simple Perceptron",input:.5,weight:.8,bias:.2,output:.6,inputLabel:"Input",formula:"y = w * x + b"},{name:"Spam Filter (2 Inputs)",input:[1,0],weight:[.5,-.2],bias:.1,output:.8,inputLabel:["Spam Word","Suspicious Link"],formula:"y = w1*x1 + w2*x2 + b"},{name:"Complex Model (5 Inputs)",input:[1,.5,-1,0,.2],weight:[.1,.2,.3,.4,.5],bias:-.5,output:.1,inputLabel:["F1","F2","F3","F4","F5"],formula:"y = Σ(wi*xi) + b"},{name:"Many Inputs (8 Inputs)",input:[1,0,1,0,1,0,1,0],weight:[.1,-.1,.1,-.1,.1,-.1,.1,-.1],bias:0,output:.5,inputLabel:["I1","I2","I3","I4","I5","I6","I7","I8"],formula:"y = ... "}],i=n[e];return h("div",{style:{padding:"20px"},children:[h("h2",{children:"Architecture Gallery"}),h("div",{style:{marginBottom:"20px"},children:[h("button",{onClick:()=>t((e-1+n.length)%n.length),children:"Previous"}),h("span",{style:{margin:"0 10px"},children:[i.name," (",e+1,"/",n.length,")"]}),h("button",{onClick:()=>t((e+1)%n.length),children:"Next"})]}),h("div",{style:{width:"400px",border:"1px dashed #ccc",padding:"10px"},children:h(Le,{input:i.input,weight:i.weight,bias:i.bias,output:i.output,formula:i.formula,inputLabel:i.inputLabel})})]})}class tn{constructor(t=30,n=50){this.velocity=t,this.initialPosition=n}getPosition(t){return this.velocity*t+this.initialPosition}}class en{constructor(){this.weight=0,this.bias=0}predict(t){return this.weight*t+this.bias}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function nn({time:e,groundTruth:t,neuralNet:n,maxDistance:i=300}){const o=pt(null);bt(()=>{const c=o.current;if(!c)return;const f=c.getContext("2d"),u=c.width,p=c.height,a=50,d=u-2*a;f.clearRect(0,0,u,p);const x=t.getPosition(e),m=n.predict(e),v=a+x%i/i*d,A=a+m%i/i*d;f.fillStyle="#f0f0f0",f.fillRect(0,0,u,p/2),f.fillStyle="#e0e0e0",f.fillRect(0,p/2,u,p/2),f.beginPath(),f.strokeStyle="#fff",f.setLineDash([20,20]),f.moveTo(0,p/4),f.lineTo(u,p/4),f.moveTo(0,p*3/4),f.lineTo(u,p*3/4),f.stroke(),f.beginPath(),f.strokeStyle="#ccc",f.setLineDash([]),f.moveTo(a,0),f.lineTo(a,p),f.moveTo(u-a,0),f.lineTo(u-a,p),f.stroke(),s(f,v,p/4,"#2ecc71","Ground Truth"),s(f,A,p*3/4,"#e74c3c","Neural Net"),f.fillStyle="#333",f.font="14px monospace",f.fillText(`Zeit: ${e.toFixed(1)}s`,10,20),f.fillText(`Pos GT: ${x.toFixed(1)}m`,10,40),f.fillText(`Pos NN: ${m.toFixed(1)}m`,10,p/2+40)},[e,t,n,i]);function s(c,f,u,p,a){c.save(),c.translate(f,u),c.fillStyle=p,c.fillRect(-20,-10,40,20),c.fillStyle="#000",c.fillRect(-15,-15,10,5),c.fillRect(5,-15,10,5),c.fillRect(-15,10,10,5),c.fillRect(5,10,10,5),c.fillStyle="#000",c.font="10px sans-serif",c.textAlign="center",c.fillText(a,0,-20),c.restore()}return h("div",{style:{border:"2px solid #333",borderRadius:"8px",overflow:"hidden"},children:h("canvas",{ref:o,width:800,height:300,style:{width:"100%",display:"block"}})})}const he={id:"physics",title:"Phase 1: Lineare Regression (Exhaustive Search 2D)",description:"Physiksimulation: Weg-Zeit-Gesetz (s = v*t + s0)",Model:en,GroundTruth:tn,CanvasComponent:nn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[30,50],getInput:e=>e,generateData:e=>Array.from({length:20},(n,i)=>i*.5).map(n=>({input:n,target:e.getPosition(n)})),trainingConfig:{weightRange:{min:0,max:60,step:1},biasRange:{min:0,max:100,step:2}},networkViz:{formula:"pos = w * t + b",inputLabel:"Zeit (t)",outputLabel:"Pos (m)",biasLabel:"b"}};class sn{constructor(t=.5,n=-5){this.weight=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){const n=this.sigmoid(this.weight*t+this.bias);return Math.random()<n?1:0}getProbability(t){return this.sigmoid(this.weight*t+this.bias)}}class on{constructor(){this.weight=0,this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=this.weight*t+this.bias;return this.sigmoid(n)}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function It(e,t,n=10){if(e===t)return[e];const i=fe(t-e,!1),o=fe(i/(n-1),!0),s=Math.floor(e/o)*o,c=Math.ceil(t/o)*o,f=[],u=o/1e3;for(let p=s;p<c+o/2;p+=o)p>=e-u&&p<=t+u&&f.push(Number(p.toPrecision(12)));return f}function fe(e,t){const n=Math.floor(Math.log10(e)),i=e/Math.pow(10,n);let o;return t?i<1.5?o=1:i<3?o=2:i<7?o=5:o=10:i<=1?o=1:i<=2?o=2:i<=5?o=5:o=10,o*Math.pow(10,n)}function rn({time:e,groundTruth:t,neuralNet:n,data:i,staticMode:o=!1,showModel:s=!0,showGroundTruth:c=!0}){const f=pt(null),[u,p]=rt({k:1,x:0,y:0}),[a,d]=rt(!1),x=pt({x:0,y:0}),[m,v]=rt(null),A=pt([]),k=w=>{w.preventDefault();const W=-w.deltaY*.001,S=u.k;let g=S*(1+W);g=Math.max(.5,Math.min(g,10));const L=f.current.getBoundingClientRect(),R=f.current.width/L.width,E=f.current.height/L.height,T=(w.clientX-L.left)*R,D=(w.clientY-L.top)*E,P=40,F=(T-P-u.x)/S,_=(D-(300-P)-u.y)/S,r=T-P-F*g,V=D-(300-P)-_*g;p({k:g,x:r,y:V})},y=w=>{d(!0),x.current={x:w.clientX,y:w.clientY}},b=w=>{const l=f.current;if(!l)return;const W=l.getBoundingClientRect(),S=l.width/W.width,g=l.height/W.height;if(a){const L=(w.clientX-x.current.x)*S,R=(w.clientY-x.current.y)*g;x.current={x:w.clientX,y:w.clientY},p(E=>({...E,x:E.x+L,y:E.y+R})),v(null)}else{const L=(w.clientX-W.left)*S,R=(w.clientY-W.top)*g;let E=null,T=15;const D=A.current;for(let P=D.length-1;P>=0;P--){const F=D[P],_=Math.sqrt(Math.pow(F.x-L,2)+Math.pow(F.y-R,2));_<T&&(T=_,E=F.info)}v(E)}},I=()=>d(!1),$=()=>{d(!1),v(null)},O=pt(0),z=()=>{const w=Date.now();w-O.current<300&&v(null),O.current=w};return bt(()=>{const w=f.current;if(!w)return;const l=w.getContext("2d"),W=w.width,S=w.height;l.clearRect(0,0,W,S),A.current=[];const g=40,L=W-2*g,R=S-2*g,E=0,T=20,D=1,P=M=>g+M/T*L*u.k+u.x,F=M=>S-g-M/D*R*u.k+u.y,_=M=>(M-g-u.x)/(L*u.k)*T,r=M=>-((M-(S-g)-u.y)/(R*u.k))*D,V=_(g),K=_(W-g),dt=r(S-g),Z=r(g),q=It(V,K,10),B=It(dt,Z,5);l.beginPath(),l.strokeStyle="#eee",l.lineWidth=1,l.fillStyle="#333",l.textAlign="center",l.textBaseline="top",l.font="10px sans-serif",q.forEach(M=>{const C=P(M);C<g||C>W-g||(l.moveTo(C,g),l.lineTo(C,S-g),l.fillText(Number(M.toFixed(2)),C,S-g+5))}),l.textAlign="right",l.textBaseline="middle",B.forEach(M=>{const C=F(M);C<g||C>S-g||(l.moveTo(g,C),l.lineTo(W-g,C),l.fillText(Number(M.toFixed(2)),g-5,C))}),l.stroke(),l.beginPath(),l.strokeStyle="#333",l.lineWidth=1,l.rect(g,g,L,R),l.stroke(),l.fillStyle="#333",l.textAlign="center",l.textBaseline="alphabetic",l.fillText("Anzahl 'Spam' Wörter",W/2,S-10),l.save(),l.translate(15,S/2),l.rotate(-Math.PI/2),l.textAlign="center",l.fillText("Spam Wahrscheinlichkeit",0,0),l.restore(),l.save(),l.beginPath(),l.rect(g,g,L,R),l.clip();const J=(M,C,N=[])=>{l.beginPath(),l.strokeStyle=C,l.setLineDash(N),l.lineWidth=2;const X=Math.max(E,V),H=Math.min(T,K);if(H<X)return;const U=(H-X)/100,st=Math.max(U,.05);let Q=!1;for(let lt=X;lt<=H+st;lt+=st){const ct=Math.min(Math.max(lt,E),T);let ut=0;typeof M.getProbability=="function"?ut=M.getProbability(ct):typeof M.predict=="function"&&(ut=M.predict(ct));const Y=P(ct),et=F(ut);Q?l.lineTo(Y,et):(l.moveTo(Y,et),Q=!0)}l.stroke(),l.setLineDash([])};if(c&&t&&J(t,"#ccc",[5,5]),s&&n&&J(n,"#e74c3c"),o&&i)i.forEach(M=>{if(M.input<V-5||M.input>K+5)return;const C=P(M.input),N=F(M.target);A.current.push({x:C,y:N,info:{x:C,y:N,input:M.input,target:M.target}});let X=null;if(n&&s)try{X=n.predict(M.input)>.5?"#e74c3c":"#2ecc71"}catch{}const H=Math.sin(M.input*123)*5,U=Math.cos(M.input*321)*5;X&&(l.beginPath(),l.arc(C+H,N+U,8,0,Math.PI*2),l.strokeStyle=X,l.lineWidth=2,l.stroke()),l.beginPath(),l.arc(C+H,N+U,5,0,Math.PI*2),l.fillStyle=M.target===1?"#e74c3c":"#2ecc71",l.fill(),l.strokeStyle="#fff",l.lineWidth=1,l.stroke()});else if(!o){const C=Math.floor(e*2),N=50,X=U=>{const st=Math.sin(U*123.456)*1e4;return st-Math.floor(st)},H=Math.min(C,N);for(let U=0;U<H;U++){const st=X(U+1),Q=Math.floor(st*21),lt=t?t.getProbability(Q):0,ct=X(U+999)<lt?1:0;if(Q<V-5||Q>K+5)continue;const ut=P(Q),Y=F(ct);let et=null;if(n&&s)try{et=n.predict(Q)>.5?"#e74c3c":"#2ecc71"}catch{}const ft=(X(U+333)-.5)*10,_t=(X(U+444)-.5)*10,G=ut+ft,j=Y+_t;A.current.push({x:G,y:j,info:{x:G,y:j,input:Q,target:ct}}),et&&(l.beginPath(),l.arc(G,j,8,0,Math.PI*2),l.strokeStyle=et,l.lineWidth=2,l.stroke()),l.beginPath(),l.arc(G,j,5,0,Math.PI*2),l.fillStyle=ct?"#e74c3c":"#2ecc71",l.fill(),l.strokeStyle="#fff",l.lineWidth=1,l.stroke()}if(H>0&&H<=N){const U=H-1,st=X(U+1),Q=Math.floor(st*21),lt=t.getProbability(Q),ct=X(U+999)<lt?1:0,ut=(X(U+333)-.5)*10,Y=(X(U+444)-.5)*10,et=P(Q)+ut,ft=F(ct)+Y;et>g&&et<W-g&&ft>g&&ft<S-g&&(l.beginPath(),l.arc(et,ft,8,0,Math.PI*2),l.strokeStyle="#333",l.stroke(),l.fillStyle="#333",l.font="10px sans-serif",l.fillText(`${Q}`,et,ft-12))}}if(l.restore(),m){l.save(),l.fillStyle="rgba(0,0,0,0.8)",l.strokeStyle="#fff";const M=m.target===1?"SPAM":"HAM",C=`Words: ${m.input}`,N=100,X=40;let H=m.x+10,U=m.y-10;H+N>W&&(H=m.x-N-10),U+X>S&&(U=m.y-X-10),U<0&&(U=m.y+10),l.beginPath(),l.roundRect(H,U,N,X,4),l.fill(),l.lineWidth=1,l.stroke(),l.textBaseline="top",l.textAlign="left",l.font="bold 11px sans-serif",l.fillStyle=m.target===1?"#e74c3c":"#2ecc71",l.fillText(M,H+8,U+6),l.fillStyle="#ddd",l.font="10px sans-serif",l.fillText(C,H+8,U+20),l.restore()}},[e,t,n,i,o,s,c,u,m]),h("div",{className:"canvas-container",children:h("canvas",{ref:f,width:600,height:300,style:{width:"100%",border:"1px solid #ccc",background:"#fff",cursor:m?"pointer":a?"grabbing":"grab"},onWheel:k,onMouseDown:y,onMouseMove:b,onMouseUp:I,onMouseLeave:$,onClick:z})})}const an=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},de={id:"spam",title:"Phase 2: Logistische Regression (Spam Filter)",description:"Spam-Erkennung: Wahrscheinlichkeit p = σ(w*x + b)",Model:on,GroundTruth:sn,CanvasComponent:rn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[.5,-5],getInput:e=>{const t=Math.floor(e);return Math.floor(an(t)*20)},generateData:e=>{const t=[];for(let n=0;n<50;n++){const i=Math.floor(Math.random()*21),o=e.classify(i);t.push({input:i,target:o})}return t.sort((n,i)=>n.input-i.input)},trainingConfig:{weightRange:{min:0,max:2,step:.1},biasRange:{min:-10,max:5,step:.5}},networkViz:{formula:"p = σ(w * x + b)",inputLabel:"Wörter (x)",outputLabel:"Spam? (p)",biasLabel:"b"},isFinished:e=>e>=25};class qt{constructor(t=[.5,.2,.8,-.1],n=-3){this.weights=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){let n=this.bias;for(let o=0;o<this.weights.length;o++)n+=this.weights[o]*t[o];const i=this.sigmoid(n);return Math.random()<i?1:0}getProbability(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}}class Re{constructor(t=4){this.weights=new Array(t).fill(0),this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}setWeights(t){this.weights=[...t]}setBias(t){this.bias=t}setWeightAt(t,n){t>=0&&t<this.weights.length&&(this.weights[t]=n)}}const ln=[{label:"Spam Words",idx:0,max:15},{label:"Großbuchstaben",idx:1,max:25},{label:"Links",idx:2,max:8},{label:"Gesamtworte",idx:3,max:100}];function Zt({data:e,currentInput:t,currentPrediction:n,neuralNet:i,allowedModes:o=["features","scatter","3d","text"],hideControls:s=!1,showModel:c=!0,additionalControls:f=null,features:u=ln}){const p=pt(null),[a,d]=rt(o[0]);bt(()=>{o.includes(a)||d(o[0])},[o]);const[x,m]=rt(0),[v,A]=rt(3),[k,y]=rt(2),[b,I]=rt({x:-.5,y:.5}),[$,O]=rt({k:1,x:0,y:0}),z=pt(!1),w=pt({x:0,y:0}),[l,W]=rt(null),S=pt([]),g=_=>{if(a!=="scatter")return;_.preventDefault();const V=-_.deltaY*.001,K=$.k;let dt=K*(1+V);dt=Math.max(.5,Math.min(dt,50));const Z=p.current;if(!Z)return;const q=Z.getBoundingClientRect(),B=Z.width/q.width,J=Z.height/q.height,M=(_.clientX-q.left)*B,C=(_.clientY-q.top)*J,N=50,X=Z.height-N,H=(M-N-$.x)/K,U=(X+$.y-C)/K,st=M-N-H*dt,Q=C-X+U*dt;O({k:dt,x:st,y:Q})},L=_=>{a!=="3d"&&a!=="scatter"||(z.current=!0,w.current={x:_.clientX,y:_.clientY})},R=_=>{const r=p.current;if(!r)return;const V=r.getBoundingClientRect(),K=r.width/V.width,dt=r.height/V.height;if(z.current){const N=(_.clientX-w.current.x)*K,X=(_.clientY-w.current.y)*dt;w.current={x:_.clientX,y:_.clientY},a==="3d"?I(H=>({x:H.x+X*.01,y:H.y+N*.01})):a==="scatter"&&O(H=>({...H,x:H.x+N,y:H.y+X}));return}const Z=(_.clientX-V.left)*K,q=(_.clientY-V.top)*dt;let B=null,M=15;const C=S.current;for(let N=C.length-1;N>=0;N--){const X=C[N],H=Math.sqrt((X.x-Z)**2+(X.y-q)**2);H<M&&(M=H,B=X.info)}W(B)},E=()=>{z.current=!1},T=()=>{W(null),z.current=!1},D=pt(0),P=()=>{const _=Date.now();_-D.current<300&&W(null),D.current=_};bt(()=>{const _=p.current;if(!_)return;const r=_.getContext("2d"),V=_.width,K=_.height;r.clearRect(0,0,V,K),r.fillStyle="#fff",r.fillRect(0,0,V,K),S.current=[];const dt=Z=>{if(!e||e.length===0)return u[Z].max;const q=Math.max(...e.map(B=>B.input[Z]));return q>0?q:u[Z].max};if(a==="3d"){const Z=dt(x),q=dt(v),B=dt(k),J=V/2,M=K/2,C=150,N=(Y,et,ft)=>{let _t=Y*Math.cos(b.y)-ft*Math.sin(b.y),G=Y*Math.sin(b.y)+ft*Math.cos(b.y),j=et*Math.cos(b.x)-G*Math.sin(b.x),ot=et*Math.sin(b.x)+G*Math.cos(b.x);const nt=400/(400-ot);return{x:J+_t*nt,y:M+j*nt,z:ot}},H=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]].map(Y=>N(Y[0]*C,Y[1]*C,Y[2]*C)),U="#e29301ff",st="#2980b9",Q="#c00798ff",lt=(Y,et)=>{r.beginPath(),r.strokeStyle=et,r.lineWidth=1,Y.forEach(([ft,_t])=>{r.moveTo(H[ft].x,H[ft].y),r.lineTo(H[_t].x,H[_t].y)}),r.stroke()};lt([[0,1],[3,2],[4,5],[7,6]],U),lt([[0,3],[1,2],[4,7],[5,6]],st),lt([[0,4],[1,5],[2,6],[3,7]],Q),r.font="bold 11px sans-serif",r.fillStyle=U,r.fillText("X: "+u[x].label,H[1].x,H[1].y),r.fillStyle=st,r.fillText("Y: "+u[v].label,H[3].x,H[3].y),r.fillStyle=Q,r.fillText("Z: "+u[k].label,H[4].x,H[4].y);const ct=[],ut=(Y,et)=>Y/et*2-1;if(c&&i&&i.weights){const Y=i.weights[x]||0,et=i.weights[v]||0,ft=i.weights[k]||0,_t=i.bias||0;if(Math.abs(ft)>.001){r.strokeStyle="rgba(142, 68, 173, 0.3)",r.lineWidth=1;const G=(nt,it)=>{const mt=(nt+1)/2*Z,gt=(it+1)/2*q,kt=(-Y*mt-et*gt-_t)/ft;return ut(kt,B)},j=(nt,it)=>{if(Math.abs(nt.z)<=3&&Math.abs(it.z)<=3){const mt=N(nt.x*C,-nt.y*C,nt.z*C),gt=N(it.x*C,-it.y*C,it.z*C);r.beginPath(),r.moveTo(mt.x,mt.y),r.lineTo(gt.x,gt.y),r.stroke()}},ot=6;for(let nt=0;nt<=ot;nt++){const it=-1+nt/ot*2,mt=G(-1,it),gt=G(1,it);j({x:-1,y:it,z:mt},{x:1,y:it,z:gt})}for(let nt=0;nt<=ot;nt++){const it=-1+nt/ot*2,mt=G(it,-1),gt=G(it,1);j({x:it,y:-1,z:mt},{x:it,y:1,z:gt})}}}e&&e.forEach(Y=>{const et=ut(Y.input[x],Z),ft=-ut(Y.input[v],q),_t=ut(Y.input[k],B),G=N(et*C,ft*C,_t*C);let j=null;if(i&&c)try{j=i.predict(Y.input)>.5?"#e74c3c":"#2ecc71"}catch{}ct.push({...G,color:Y.target===1?"#e74c3c":"#2ecc71",radius:3,haloColor:j,pt:Y})}),ct.sort((Y,et)=>Y.z-et.z),ct.forEach(Y=>{Y.z<3&&S.current.push({x:Y.x,y:Y.y,info:{x:Y.x,y:Y.y,text:Y.pt.text,isSpam:Y.pt.target===1,features:{xLabel:u[x].label,xVal:Y.pt.input[x],yLabel:u[v].label,yVal:Y.pt.input[v],zLabel:u[k].label,zVal:Y.pt.input[k]}}}),Y.haloColor&&(r.beginPath(),r.arc(Y.x,Y.y,Y.radius+2,0,Math.PI*2),r.strokeStyle=Y.haloColor,r.lineWidth=1.5,r.stroke()),r.beginPath(),r.arc(Y.x,Y.y,Y.radius,0,Math.PI*2),r.fillStyle=Y.color,r.fill()})}if(a==="scatter"){const Z=dt(x),q=dt(v),B=50,J=V-2*B,M=K-2*B,C=K-B,N="#c0392b",X="#2980b9",H=G=>B+G/Z*J*$.k+$.x,U=G=>C-G/q*M*$.k+$.y;r.save(),r.beginPath(),r.rect(B,B,J,M),r.clip(),r.restore();const st=G=>(G-B-$.x)/(J*$.k)*Z,Q=G=>(C+$.y-G)/(M*$.k)*q,lt=st(B),ct=st(B+J),ut=Q(C),Y=Q(B),et=It(Math.min(lt,ct),Math.max(lt,ct),8),ft=It(Math.min(ut,Y),Math.max(ut,Y),6);r.lineWidth=1,r.strokeStyle="#eee",r.fillStyle="#666",r.font="10px sans-serif",r.textAlign="center",r.textBaseline="top",et.forEach(G=>{const j=H(G);j<B||j>B+J||(r.beginPath(),r.moveTo(j,B),r.lineTo(j,C),r.stroke(),r.fillText(Number(G.toFixed(2)),j,C+5))}),r.textAlign="right",r.textBaseline="middle",ft.forEach(G=>{const j=U(G);j<B||j>C||(r.beginPath(),r.moveTo(B,j),r.lineTo(B+J,j),r.stroke(),r.fillText(Number(G.toFixed(2)),B-5,j))}),r.strokeStyle="#ccc",r.lineWidth=2,r.strokeRect(B,B,J,M),r.textAlign="center",r.font="bold 12px sans-serif",r.fillStyle=N,r.fillText(`${u[x].label}`,B+J/2,C+30),r.save(),r.translate(15,C-M/2),r.rotate(-Math.PI/2),r.fillStyle=X,r.fillText(`${u[v].label}`,0,0),r.restore(),r.save(),r.beginPath(),r.rect(B,B,J,M),r.clip();const _t=(G,j,ot,nt,it)=>{const mt=H(G[x]),gt=U(G[v]);it&&(r.beginPath(),r.arc(mt,gt,ot+3,0,2*Math.PI),r.strokeStyle=it,r.lineWidth=2,r.stroke()),r.beginPath(),r.arc(mt,gt,ot,0,2*Math.PI),r.fillStyle=j,r.fill(),nt&&(r.strokeStyle=nt,r.lineWidth=2,r.stroke())};if(e&&e.forEach(G=>{const j=H(G.input[x]),ot=U(G.input[v]);if(j<B||j>B+J||ot<B||ot>C)return;S.current.push({x:j,y:ot,info:{x:j,y:ot,text:G.text,isSpam:G.target===1,features:{xLabel:u[x].label,xVal:G.input[x],yLabel:u[v].label,yVal:G.input[v]}}});let nt=null;if(i&&c)try{nt=i.predict(G.input)>.5?"#e74c3c":"#2ecc71"}catch{}_t(G.input,G.target===1?"#e74c3c":"#2ecc71",5,"#fff",nt)}),c&&i){let G=i.weights;const j=i.bias||0;if(G){const ot=G[x]||0,nt=G[v]||0,it=j;r.beginPath(),r.strokeStyle="rgba(142, 68, 173, 0.8)",r.lineWidth=2,r.setLineDash([10,5]);const mt=lt-(ct-lt),gt=ct+(ct-lt),kt=(vt,wt)=>({x:H(vt),y:U(wt)});if(Math.abs(nt)>.001){const vt=ze=>(-ot*ze-it)/nt,wt=kt(mt,vt(mt)),Pt=kt(gt,vt(gt));r.moveTo(wt.x,wt.y),r.lineTo(Pt.x,Pt.y)}else if(Math.abs(ot)>.001){const vt=-it/ot,wt=kt(vt,ut-100),Pt=kt(vt,Y+100);r.moveTo(wt.x,wt.y),r.lineTo(Pt.x,Pt.y)}r.stroke(),r.setLineDash([])}}t&&_t(t,"#3498db",8,"#2980b9"),r.restore(),r.fillStyle="#666",r.textAlign="right",r.font="11px sans-serif",r.fillText("Rot=Spam, Grün=OK",V-10,20)}if(a==="text"){if(r.textAlign="center",r.textBaseline="middle",!t||!t.text){r.fillStyle="#999",r.font="20px sans-serif",r.fillText("Kein Text verfügbar",V/2,K/2);return}const Z=n>.5,q=Z?"#feeff0":"#effaf0";r.fillStyle=q,r.fillRect(0,0,V,K);const B=t.text;r.fillStyle="#333",r.font="24px serif";const J=B.split(" ");let M="";const C=35,N=V/2;let X=K/3;const H=V-100;for(let Q=0;Q<J.length;Q++){const lt=M+J[Q]+" ";r.measureText(lt).width>H&&Q>0?(r.fillText(M,N,X),M=J[Q]+" ",X+=C):M=lt}r.fillText(M,N,X),X+=60;const U=t.groundTruth===1;r.font="bold 16px sans-serif",r.fillStyle="#555",r.fillText(`Wahrheit: ${U?"SPAM":"HAM"}`,N,X),X+=30;const st=(n*100).toFixed(1);r.font="bold 20px sans-serif",r.fillStyle=Z?"#c0392b":"#27ae60",r.fillText(`Vorhersage: ${Z?"SPAM":"HAM"} (${st}%)`,N,X);return}if(a==="features"){const q=(V-90)/2,B=(K-90)/2;[{x:30,y:30,...u[0]},{x:30+q+30,y:30,...u[1]},{x:30,y:30+B+30,...u[2]},{x:30+q+30,y:30+B+30,...u[3]}].forEach(M=>{if(r.strokeStyle="#ccc",r.strokeRect(M.x,M.y,q,B),r.fillStyle="#333",r.font="12px Arial",r.textAlign="center",r.fillText(M.label,M.x+q/2,M.y-5),e&&e.forEach(C=>{const N=C.input[M.idx],X=M.x+N/M.max*q,H=M.y+B-C.target*(B-20)-10;S.current.push({x:X,y:H,info:{x:X,y:H,text:C.text,isSpam:C.target===1,features:{valLabel:M.label,val:N}}});let U=null;if(i&&c)try{U=i.predict(C.input)>.5?"#e74c3c":"#2ecc71"}catch{}U&&(r.beginPath(),r.arc(X,H,4.5,0,2*Math.PI),r.strokeStyle=U,r.lineWidth=1,r.stroke()),r.beginPath(),r.arc(X,H,3,0,2*Math.PI),r.fillStyle=C.target?"rgba(231, 76, 60, 0.6)":"rgba(46, 204, 113, 0.6)",r.fill()}),t){const C=t[M.idx],N=M.x+C/M.max*q;r.beginPath(),r.moveTo(N,M.y),r.lineTo(N,M.y+B),r.strokeStyle="#3498db",r.setLineDash([5,5]),r.stroke(),r.setLineDash([])}})}if(l&&(a==="features"||a==="scatter"||a==="3d")){r.save(),r.fillStyle="rgba(0,0,0,0.85)",r.strokeStyle="#fff";const Z=l.text||"No Text",q=l.isSpam?"SPAM":"HAM",B=r.measureText(Z),J=Math.max(B.width,140)+20;let M=70;l.features&&(l.features.zLabel?M=90:l.features.yLabel?M=85:M=60);let C=l.x+15,N=l.y-15;C+J>V&&(C=l.x-J-10),N+M>K&&(N=l.y-M-10),N<0&&(N=l.y+20),r.beginPath(),r.roundRect(C,N,J,M,5),r.fill(),r.lineWidth=1,r.stroke(),r.textBaseline="top",r.textAlign="left",r.font="bold 12px sans-serif",r.fillStyle=l.isSpam?"#e74c3c":"#2ecc71",r.fillText(q,C+10,N+10),r.fillStyle="#ddd",r.font="italic 11px sans-serif",r.fillText(Z,C+10,N+28),l.features&&(r.fillStyle="#fff",r.font="11px monospace",l.features.xLabel?(r.fillText(`${l.features.xLabel}: ${l.features.xVal}`,C+10,N+46),r.fillText(`${l.features.yLabel}: ${l.features.yVal}`,C+10,N+60),l.features.zLabel&&r.fillText(`${l.features.zLabel}: ${l.features.zVal}`,C+10,N+74)):l.features.valLabel&&r.fillText(`${l.features.valLabel}: ${l.features.val}`,C+10,N+46)),r.restore()}},[e,t,n,i,a,x,v,k,b,c,$]);const F={features:"Alle Features",scatter:"2D Plot","3d":"3D Plot",text:"Text Mode"};return h("div",{style:{textAlign:"center"},children:[!s&&h("div",{style:{marginBottom:"10px",display:"flex",gap:"5px",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",fontSize:"0.9rem"},children:[h("div",{children:f}),h("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[h("select",{value:a,onChange:_=>d(_.target.value),style:{padding:"4px"},children:o.map(_=>h("option",{value:_,children:F[_]},_))}),(a==="scatter"||a==="3d")&&h(xt,{children:[h("span",{children:"X:"}),h("select",{value:x,onChange:_=>m(parseInt(_.target.value)),style:{padding:"4px"},children:u.map(_=>h("option",{value:_.idx,children:_.label},_.idx))}),h("span",{children:"Y:"}),h("select",{value:v,onChange:_=>A(parseInt(_.target.value)),style:{padding:"4px"},children:u.map(_=>h("option",{value:_.idx,children:_.label},_.idx))})]}),a==="3d"&&h(xt,{children:[h("span",{children:"Z:"}),h("select",{value:k,onChange:_=>y(parseInt(_.target.value)),style:{padding:"4px"},children:u.map(_=>h("option",{value:_.idx,children:_.label},_.idx))})]})]})]}),h("canvas",{ref:p,width:600,height:400,style:{border:"1px solid #eee",maxWidth:"100%",borderRadius:"4px",cursor:l?"pointer":a==="3d"||a==="scatter"?z.current?"grabbing":"grab":"default"},onWheel:g,onMouseDown:L,onMouseMove:R,onMouseUp:E,onMouseLeave:E,onMouseOut:T,onClick:P}),!s&&h("div",{style:{fontSize:"0.8rem",color:"#666",marginTop:"5px"},children:a==="3d"?"Drag to rotate 3D view":a==="scatter"?"Drag to Pan, Scroll to Zoom":"Wähle Achsen für die Visualisierung"})]})}const ue=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Ht=e=>{const t=["winner","won","gift card","urgent","rolex","viagra","cash","prize","singles","marketing","buy","free","money","security alert","click","claim","fake","verification"],n=e.toLowerCase();let i=0;t.forEach(f=>{n.includes(f)&&(i+=1)}),i>10&&(i=10);const o=(e.match(/[A-Z]/g)||[]).length,s=(e.match(/http/g)||[]).length,c=e.split(/\s+/).length;return[i,o,s,c]},St={id:"spam_advanced",title:"Phase 3: Erweiterter Spam-Filter (4 Eingaben)",description:"Spam-Erkennung mit 4 Merkmalen: Spam-Worte, Großbuchstaben, Links, Gesamtworte.",Model:Re,GroundTruth:qt,CanvasComponent:Zt,defaultParams:{weights:[0,0,0,0],bias:0},groundTruthDefaults:[[1.5,.5,2,-.5],-5],getInput:e=>{const t=Math.floor(e*.3),n=ue(t)>.5,i=n?St.examples.spam:St.examples.ham,o=Math.floor(ue(t+99)*i.length),s=i[o],c=Ht(s);return c.text=s,c.groundTruth=n?1:0,c},examples:{spam:["WINNER! Won $1000 Gift Card! Claim at http://prize-giveaway.net","URGENT: Verify account at http://secure-bank-login.com/fraud","Cheap Rolex watches! 50% OFF at www.fake-watches.cn","Lose weight fast! Buy pills: http://diet-miracle.com","CONGRATS! Cash prize waiting: http://claim-money.org","HOT singles waiting! Chat now: http://local-dating.xyz","Refinance 1% APR. Apply: http://easy-loans.biz","Buy 1 get 1 FREE Viagra. http://meds-direct.com","Meet rich men. Signup: http://millionaire-match.com","SECURITY ALERT: Suspicious activity. Check http://account-security-check.com"],ham:["Meeting agenda for tomorrow's team sync","Hey, are we still on for lunch?","Invoice #12345 from AWS Services","Project deadline extended to Friday","Happy Birthday! Hope you have a great day.","Can you review this pull request?","Your Amazon order has shipped.","Fwd: Tickets for the concert","Question about the quarterly report","Let's catch up sometime next week."]},generateData:e=>{const t=[];St.examples.spam.forEach(n=>{const i=Ht(n),o=()=>(Math.random()-.5)*.1,s=i.map(c=>Math.max(0,c+o()));t.push({input:s,target:1,text:n})}),St.examples.ham.forEach(n=>{const o=Ht(n).map(s=>Math.max(0,s+(Math.random()-.5)*.1));t.push({input:o,target:0,text:n})});for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t},trainingConfig:{params:[{name:"w1 (Spam-Worte)",min:1,max:4,step:.5},{name:"w2 (Großbuchst.)",min:0,max:2,step:.5},{name:"w3 (Links)",min:0,max:3,step:.5},{name:"w4 (Gesamtworte)",min:-2,max:2,step:.5},{name:"bias",min:-8,max:8,step:2}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + w₃x₃ + w₄x₄ + b)",inputLabels:["Spam-Worte","Großbuchst.","Links","Gesamtworte"],outputLabel:"Spam? (p)",biasLabel:"b"},isFinished:e=>e>=50};class cn{constructor(t=2,n=10){this.inputCount=t,this.hiddenCount=n;const i=Math.sqrt(6/(t+n));this.weights1=Array(n).fill(0).map(()=>Array.from({length:t},()=>Math.random()*2*i-i)),this.biases1=Array(n).fill(0);const o=Math.sqrt(6/(n+1));this.weights2=Array.from({length:n},()=>Math.random()*2*o-o),this.bias2=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=[];for(let s=0;s<this.hiddenCount;s++){let c=this.biases1[s];for(let f=0;f<this.inputCount;f++)c+=this.weights1[s][f]*t[f];n.push(this.sigmoid(c))}let i=this.bias2;for(let s=0;s<this.hiddenCount;s++)i+=this.weights2[s]*n[s];return this.sigmoid(i)}getActivations(t){const n=[];for(let s=0;s<this.hiddenCount;s++){let c=this.biases1[s];for(let f=0;f<this.inputCount;f++)c+=this.weights1[s][f]*t[f];n.push(this.sigmoid(c))}let i=this.bias2;for(let s=0;s<this.hiddenCount;s++)i+=this.weights2[s]*n[s];const o=this.sigmoid(i);return{hidden:n,output:[o]}}setParams(t){for(let i=0;i<this.hiddenCount;i++){const o=`b1_${i}`;t[o]!==void 0&&(this.biases1[i]=t[o]);for(let s=0;s<this.inputCount;s++){const c=`w1_${i}_${s}`;t[c]!==void 0&&(this.weights1[i][s]=t[c])}}const n="b2";t[n]!==void 0&&(this.bias2=t[n]);for(let i=0;i<this.hiddenCount;i++){const o=`w2_${i}`;t[o]!==void 0&&(this.weights2[i]=t[o])}}getTopology(){return{inputCount:this.inputCount,hiddenCounts:[this.hiddenCount],outputCount:1,weights1:this.weights1,biases1:this.biases1,weights2:this.weights2,bias2:this.bias2}}}const Ee=[{label:"Gesamtworte",idx:0,max:400},{label:"Links",idx:1,max:10}],$e=()=>{const e=[],n=(i,o=.5)=>i+(Math.random()-.5)*o;for(let i=0;i<40;i++){let o,s,c;const f=Math.random();if(f<.1){const u=Math.max(0,10+Math.random()*40),p=Math.floor(Math.random()*2);o=[u,p],s=0,c="Security Alert: Login Code "+Math.floor(Math.random()*9999)}else if(f<.6){const u=50+Math.random()*200,a=Math.random()>.2?1+Math.floor(Math.random()*5):0;o=[u,a],s=a>0?1:0,c=a>0?"You won a prize! Click here.":"Just a normal short message."}else{const u=250+Math.random()*150,p=Math.floor(Math.random()*8);o=[u,p],s=0,c="Attached is the quarterly report found at..."}o[0]=Math.max(0,n(o[0],5)),o[1]=Math.max(0,n(o[1],.2)),e.push({input:o,target:s,text:c})}return e},pe={id:"spam_nonlinear",title:"Phase 4: Nicht-lineare Daten",description:"Spam-Erkennung mit nur 2 Merkmalen, aber komplexer Verteilung. Ein einfacher linearer Klassifikator (Perzeptron) wird hier scheitern.",Model:Re,GroundTruth:qt,CanvasComponent:Zt,defaultParams:{weights:[0,0],bias:0},getInput:e=>({input:[50,0],text:"Live Input"}),generateData:e=>$e(),trainingConfig:{params:[{name:"w1 (Worte)",min:-5,max:5,step:.5},{name:"w2 (Links)",min:-5,max:5,step:.5},{name:"bias",min:-10,max:10,step:1}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + b)",inputLabels:["Worte","Links"],outputLabel:"Spam?",biasLabel:"b"},featuresConfig:Ee,isFinished:e=>!1},hn=()=>{const e=[];for(let t=0;t<10;t++){e.push({name:`b1_${t}`,min:-3,max:3,step:1});for(let n=0;n<2;n++)e.push({name:`w1_${t}_${n}`,min:-3,max:3,step:1})}e.push({name:"b2",min:-3,max:3,step:1});for(let t=0;t<10;t++)e.push({name:`w2_${t}`,min:-5,max:5,step:1});return e},me={id:"spam_hidden",title:"Phase 5: Deep Learning (Hidden Layer)",description:'Spam-Erkennung mit einem Hidden Layer (10 Neuronen). Das Deep Neural Network kann die nicht-lineare Verteilung ("Spam-Insel") erkennen.',Model:cn,GroundTruth:qt,CanvasComponent:Zt,defaultParams:{},getInput:e=>({input:[50,0],text:"Live Input"}),generateData:e=>$e(),trainingConfig:{params:hn()},networkViz:{formula:"Deep Network",inputLabels:["Worte","Links"],outputLabel:"Spam?",biasLabel:"b"},featuresConfig:Ee,isFinished:e=>e>=50},ge={[he.id]:he,[de.id]:de,[St.id]:St,[pe.id]:pe,[me.id]:me};function fn(e){return ge[e]||ge.physics}function dn(){const[e,t]=rt(null),n=pt(null),i=pt(null),[o,s]=rt(0),[c,f]=rt(!1),[u,p]=rt([]),[a,d]=rt([]),[x,m]=rt(-1),[v,A]=rt(!1),[k,y]=rt("simulation"),[b,I]=rt("table"),[$,O]=rt("exhaustive"),[z,w]=rt("Bereit."),l=pt(0);bt(()=>{const D=new URLSearchParams(window.location.search).get("sim")||"physics";if(D==="gallery"){t({id:"gallery",type:"gallery"});return}const P=fn(D);if(!P){w("Fehler: Simulation nicht gefunden.");return}try{if(n.current=new P.GroundTruth(...P.groundTruthDefaults||[]),i.current=new P.Model,P.defaultParams&&(P.defaultParams.weight!==void 0&&i.current.setWeight(P.defaultParams.weight),P.defaultParams.weights!==void 0&&i.current.setWeights&&i.current.setWeights(P.defaultParams.weights),P.defaultParams.bias!==void 0&&i.current.setBias(P.defaultParams.bias)),t(P),n.current)try{const F=P.generateData(n.current);p(F)}catch(F){console.error("Auto-generate data error:",F)}}catch(F){console.error("Initialization Error:",F),w(`Init Fehler: ${F.message}`)}},[]),bt(()=>{let T;const D=P=>{if(!c)return;l.current===0&&(l.current=P);const F=(P-l.current)/1e3;l.current=P;const _=Math.min(F,.1);s(r=>{const K=r+_*3;return e&&e.isFinished&&e.isFinished(K)&&(f(!1),w("Simulation beendet.")),K}),T=requestAnimationFrame(D)};return c&&(l.current=0,T=requestAnimationFrame(D)),()=>cancelAnimationFrame(T)},[c,e]);const W=async()=>{try{if(u.length===0||!e)return;A(!0),m(0),d([]),w("Suche optimales Gewicht und Bias (Live Visualisierung)..."),y("training");const T=new je(i.current),D=(F,_)=>{if(d(r=>{const V=[...r,...F];return m(V.length-1),V}),(_&&_.message||_&&_.message)&&w(_.message),_&&_.bestParams){if(i.current.setParams)i.current.setParams(_.bestParams);else if(i.current.setWeights){const{weights:r,bias:V}=_.bestParams;i.current.setWeights(r),i.current.setBias(V)}}else _&&_.bestWeight!==void 0&&(i.current.setWeight(_.bestWeight),i.current.setBias(_.bestBias))};let P;$==="random"?(w("Suche optimales Gewicht und Bias (Random Search)..."),P=await T.trainRandomAsync(u,e.trainingConfig.params,D)):e.trainingConfig.params?P=await T.trainAsync(u,e.trainingConfig.params,D):P=await T.trainAsync(u,e.trainingConfig.weightRange,e.trainingConfig.biasRange,D),w(`Training fertig! Min Error: ${P.minError.toFixed(5)}`),A(!1)}catch(T){console.error("Training Error:",T),A(!1),w(`Fehler beim Training: ${T.message}`)}},S=()=>{s(0),f(!0),w("Simulation läuft..."),y("simulation")},g=()=>{f(!1),s(0),p([]),d([]),m(-1);try{i.current&&e?.defaultParams&&(e.defaultParams.weight!==void 0&&i.current.setWeight(e.defaultParams.weight),e.defaultParams.weights!==void 0&&i.current.setWeights&&i.current.setWeights(e.defaultParams.weights),e.defaultParams.bias!==void 0&&i.current.setBias(e.defaultParams.bias))}catch(T){console.error("Reset Error:",T)}w("Reset durchgeführt.")};if(!e)return h("div",{children:"Lade Simulation..."});if(e.type==="gallery")return h("div",{className:"container",children:[h("header",{children:[h("h1",{children:"Neural Network Demonstrator"}),h("p",{children:"Architecture Gallery (Debug)"}),h("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:h("a",{href:"?sim=physics",style:{marginRight:"10px"},children:"Back to App"})})]}),h("main",{children:h(Qe,{})})]});const L=e.CanvasComponent,R=e.networkViz||{},E=e.getInput?e.getInput(o):o;return h("div",{className:"container",children:[h("header",{children:[h("h1",{children:"Neural Network Demonstrator"}),h("p",{children:e.title}),h("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:[h("a",{href:"?sim=physics",style:{marginRight:"10px",fontWeight:e.id==="physics"?"bold":"normal"},children:"Phase 1 (Physik)"}),h("a",{href:"?sim=spam",style:{marginRight:"10px",fontWeight:e.id==="spam"?"bold":"normal"},children:"Phase 2 (Spam)"}),h("a",{href:"?sim=spam_advanced",style:{marginRight:"10px",fontWeight:e.id==="spam_advanced"?"bold":"normal"},children:"Phase 3 (Spam Extended)"}),h("a",{href:"?sim=spam_nonlinear",style:{marginRight:"10px",fontWeight:e.id==="spam_nonlinear"?"bold":"normal"},children:"Phase 4 (Nonlinear)"}),h("a",{href:"?sim=spam_hidden",style:{fontWeight:e.id==="spam_hidden"?"bold":"normal"},children:"Phase 5 (Deep)"})]})]}),h("main",{children:[h("div",{className:"top-section",style:{display:"flex",gap:"20px",flexWrap:"wrap",alignItems:"start"},children:[h("div",{className:"simulation-wrapper",style:{flex:"1 1 500px"},children:h("div",{className:"simulation-section",children:[h("div",{className:"tabs",children:[h("button",{className:`tab-button ${k==="simulation"?"active":""}`,onClick:()=>y("simulation"),children:"Simulation"}),h("button",{className:`tab-button ${k==="data"?"active":""}`,onClick:()=>y("data"),children:"Daten"}),h("button",{className:`tab-button ${k==="training"?"active":""}`,onClick:()=>y("training"),children:"Training"})]}),k==="simulation"&&h(xt,{children:[e.id==="spam"?h("div",{style:{height:"300px",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",border:"2px dashed #ddd",borderRadius:"8px"},children:h("p",{style:{color:"#999"},children:'Daten-Visualisierung jetzt im "Daten" Tab'})}):(()=>{let T=0;try{i.current&&(T=i.current.predict(E))}catch(P){console.error("Predict Error",P)}const D={};return["spam_advanced","spam_hidden","spam_nonlinear"].includes(e.id)&&(D.allowedModes=["text"],D.hideControls=!0),e.featuresConfig&&(D.features=e.featuresConfig),h(L,{time:o,data:u,currentInput:E,currentPrediction:T,groundTruth:n.current,neuralNet:i.current,...D})})(),h("div",{className:"stats",style:{marginTop:"10px"},children:[h("p",{children:e.description}),h("p",{style:{color:"#646cff",fontWeight:"bold"},children:["Status: ",z]})]})]}),k==="data"&&h("div",{className:"data-content",children:[(()=>{const T=h("div",{style:{display:"flex",justifyContent:"center"},children:h("div",{style:{background:"#eee",borderRadius:"4px",padding:"2px",display:"flex",gap:"2px"},children:[h("button",{onClick:()=>I("table"),style:{background:b==="table"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:b==="table"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:b==="table"?"bold":"normal",color:b==="table"?"#333":"#666"},children:"Tabelle"}),h("button",{onClick:()=>I("plot"),style:{background:b==="plot"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:b==="plot"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:b==="plot"?"bold":"normal",color:b==="plot"?"#333":"#666"},children:"Graph"})]})}),D=["spam_advanced","spam_hidden","spam_nonlinear"].includes(e.id);return h(xt,{children:[(!D||b==="table")&&h("div",{style:{marginBottom:"15px"},children:T}),(u.length>0||e.id!=="physics")&&b==="plot"&&h("div",{style:{marginBottom:"20px"},children:e.id==="physics"?h(Ze,{data:u,groundTruth:n.current,neuralNet:a.length>0?i.current:null}):(()=>{const P={};return D?(P.allowedModes=["scatter","3d","features"],P.showModel=a.length>0,P.additionalControls=T):(P.staticMode=!0,P.showGroundTruth=!0,P.showModel=a.length>0),e.featuresConfig&&(P.features=e.featuresConfig),h(L,{time:0,data:u,groundTruth:n.current,neuralNet:i.current,...P})})()})]})})(),b==="table"&&h(xt,{children:u.length>0?h("div",{style:{maxHeight:"400px",overflowY:"auto"},children:h("table",{style:{width:"100%",textAlign:"left",borderCollapse:"collapse",fontSize:"0.9rem"},children:[h("thead",{children:h("tr",{style:{background:"#eee",borderBottom:"2px solid #ddd"},children:[Array.isArray(R.inputLabels)?R.inputLabels.map((T,D)=>h("th",{style:{padding:"8px"},children:T},D)):h("th",{style:{padding:"8px"},children:["Input (",R.inputLabel,")"]}),h("th",{style:{padding:"8px"},children:"Target"}),u.length>0&&u[0].text&&h("th",{style:{padding:"8px"},children:"E-Mail Text"})]})}),h("tbody",{children:u.map((T,D)=>{const P=["spam","spam_advanced"].includes(e.id);let F="transparent",_=T.target,r={padding:"8px"};if(P){const V=T.target===1;F=V?"#ffebee":"#e8f5e9",_=V?"SPAM":"HAM",r={...r,fontWeight:"bold",color:V?"#c0392b":"#27ae60"}}else _=typeof T.target=="number"?T.target.toFixed(2):T.target;return h("tr",{style:{background:F,borderBottom:"1px solid #ddd"},children:[Array.isArray(T.input)?T.input.map((V,K)=>h("td",{style:{padding:"8px"},children:V.toFixed(0)},K)):h("td",{style:{padding:"8px"},children:T.input.toFixed(2)}),h("td",{style:r,children:_}),T.text&&h("td",{style:{padding:"8px",color:"#555",fontStyle:"italic",maxWidth:"300px"},children:T.text})]},D)})})]})}):h("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Noch keine Trainingsdaten generiert."})})]}),k==="training"&&h("div",{className:"training-content",children:a.length>0?h(Ke,{history:a,currentStepIndex:x,isTraining:v,paramsConfig:e.trainingConfig.params}):h("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Noch kein Training gestartet."})})]})}),h("div",{className:"network-wrapper",style:{flex:"0 0 350px"},children:h(Le,{input:E,weight:i.current?i.current.weights||i.current.weight:0,bias:i.current?i.current.bias:0,output:i.current?i.current.predict(E):0,model:i.current,formula:R.formula,inputLabel:R.inputLabels||R.inputLabel,outputLabel:R.outputLabel,biasLabel:R.biasLabel,decimals:e.id.includes("spam")?0:1})})]}),h(Je,{onTrain:W,onRun:S,onReset:g,isTraining:v,trainingStep:x,dataCount:u.length,trainerType:$,onTrainerTypeChange:O})]})]})}Be(h(dn,{}),document.getElementById("app"));
