(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();var Ht,it,Ce,At,le,Ae,We,Le,Kt,Ut,jt,Rt={},Re=[],Qe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Bt=Array.isArray;function Tt(e,t){for(var n in t)e[n]=t[n];return e}function Zt(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function tn(e,t,n){var i,o,r,c={};for(r in t)r=="key"?i=t[r]:r=="ref"?o=t[r]:c[r]=t[r];if(arguments.length>2&&(c.children=arguments.length>3?Ht.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)c[r]===void 0&&(c[r]=e.defaultProps[r]);return Et(e,c,i,o,null)}function Et(e,t,n,i,o){var r={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++Ce,__i:-1,__u:0};return o==null&&it.vnode!=null&&it.vnode(r),r}function Pt(e){return e.children}function It(e,t){this.props=e,this.context=t}function Lt(e,t){if(t==null)return e.__?Lt(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Lt(e):null}function ze(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return ze(e)}}function ce(e){(!e.__d&&(e.__d=!0)&&At.push(e)&&!Yt.__r++||le!=it.debounceRendering)&&((le=it.debounceRendering)||Ae)(Yt)}function Yt(){for(var e,t,n,i,o,r,c,h=1;At.length;)At.length>h&&At.sort(We),e=At.shift(),h=At.length,e.__d&&(n=void 0,i=void 0,o=(i=(t=e).__v).__e,r=[],c=[],t.__P&&((n=Tt({},i)).__v=i.__v+1,it.vnode&&it.vnode(n),Jt(t.__P,n,i,t.__n,t.__P.namespaceURI,32&i.__u?[o]:null,r,o??Lt(i),!!(32&i.__u),c),n.__v=i.__v,n.__.__k[n.__i]=n,Ee(r,n,c),i.__e=i.__=null,n.__e!=o&&ze(n)));Yt.__r=0}function De(e,t,n,i,o,r,c,h,g,d,a){var u,_,b,y,M,P,A,C=i&&i.__k||Re,D=t.length;for(g=en(n,t,C,g,D),u=0;u<D;u++)(b=n.__k[u])!=null&&(_=b.__i==-1?Rt:C[b.__i]||Rt,b.__i=u,P=Jt(e,b,_,o,r,c,h,g,d,a),y=b.__e,b.ref&&_.ref!=b.ref&&(_.ref&&Qt(_.ref,null,b),a.push(b.ref,b.__c||y,b)),M==null&&y!=null&&(M=y),(A=!!(4&b.__u))||_.__k===b.__k?g=$e(b,g,e,A):typeof b.type=="function"&&P!==void 0?g=P:y&&(g=y.nextSibling),b.__u&=-7);return n.__e=M,g}function en(e,t,n,i,o){var r,c,h,g,d,a=n.length,u=a,_=0;for(e.__k=new Array(o),r=0;r<o;r++)(c=t[r])!=null&&typeof c!="boolean"&&typeof c!="function"?(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?c=e.__k[r]=Et(null,c,null,null,null):Bt(c)?c=e.__k[r]=Et(Pt,{children:c},null,null,null):c.constructor==null&&c.__b>0?c=e.__k[r]=Et(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):e.__k[r]=c,g=r+_,c.__=e,c.__b=e.__b+1,h=null,(d=c.__i=nn(c,n,g,u))!=-1&&(u--,(h=n[d])&&(h.__u|=2)),h==null||h.__v==null?(d==-1&&(o>a?_--:o<a&&_++),typeof c.type!="function"&&(c.__u|=4)):d!=g&&(d==g-1?_--:d==g+1?_++:(d>g?_--:_++,c.__u|=4))):e.__k[r]=null;if(u)for(r=0;r<a;r++)(h=n[r])!=null&&(2&h.__u)==0&&(h.__e==i&&(i=Lt(h)),Ne(h,h));return i}function $e(e,t,n,i){var o,r;if(typeof e.type=="function"){for(o=e.__k,r=0;o&&r<o.length;r++)o[r]&&(o[r].__=e,t=$e(o[r],t,n,i));return t}e.__e!=t&&(i&&(t&&e.type&&!t.parentNode&&(t=Lt(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function nn(e,t,n,i){var o,r,c,h=e.key,g=e.type,d=t[n],a=d!=null&&(2&d.__u)==0;if(d===null&&h==null||a&&h==d.key&&g==d.type)return n;if(i>(a?1:0)){for(o=n-1,r=n+1;o>=0||r<t.length;)if((d=t[c=o>=0?o--:r++])!=null&&(2&d.__u)==0&&h==d.key&&g==d.type)return c}return-1}function he(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Qe.test(t)?n:n+"px"}function $t(e,t,n,i,o){var r,c;t:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||he(e.style,t,"");if(n)for(t in n)i&&n[t]==i[t]||he(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")r=t!=(t=t.replace(Le,"$1")),c=t.toLowerCase(),t=c in e||t=="onFocusOut"||t=="onFocusIn"?c.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?i?n.u=i.u:(n.u=Kt,e.addEventListener(t,r?jt:Ut,r)):e.removeEventListener(t,r?jt:Ut,r);else{if(o=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function ue(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Kt++;else if(t.t<n.u)return;return n(it.event?it.event(t):t)}}}function Jt(e,t,n,i,o,r,c,h,g,d){var a,u,_,b,y,M,P,A,C,D,Y,j,W,k,f,N,m,p=t.type;if(t.constructor!=null)return null;128&n.__u&&(g=!!(32&n.__u),r=[h=t.__e=n.__e]),(a=it.__b)&&a(t);t:if(typeof p=="function")try{if(A=t.props,C="prototype"in p&&p.prototype.render,D=(a=p.contextType)&&i[a.__c],Y=a?D?D.props.value:a.__:i,n.__c?P=(u=t.__c=n.__c).__=u.__E:(C?t.__c=u=new p(A,Y):(t.__c=u=new It(A,Y),u.constructor=p,u.render=on),D&&D.sub(u),u.state||(u.state={}),u.__n=i,_=u.__d=!0,u.__h=[],u._sb=[]),C&&u.__s==null&&(u.__s=u.state),C&&p.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Tt({},u.__s)),Tt(u.__s,p.getDerivedStateFromProps(A,u.__s))),b=u.props,y=u.state,u.__v=t,_)C&&p.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),C&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(C&&p.getDerivedStateFromProps==null&&A!==b&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(A,Y),t.__v==n.__v||!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(A,u.__s,Y)===!1){for(t.__v!=n.__v&&(u.props=A,u.state=u.__s,u.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(w){w&&(w.__=t)}),j=0;j<u._sb.length;j++)u.__h.push(u._sb[j]);u._sb=[],u.__h.length&&c.push(u);break t}u.componentWillUpdate!=null&&u.componentWillUpdate(A,u.__s,Y),C&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(b,y,M)})}if(u.context=Y,u.props=A,u.__P=e,u.__e=!1,W=it.__r,k=0,C){for(u.state=u.__s,u.__d=!1,W&&W(t),a=u.render(u.props,u.state,u.context),f=0;f<u._sb.length;f++)u.__h.push(u._sb[f]);u._sb=[]}else do u.__d=!1,W&&W(t),a=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++k<25);u.state=u.__s,u.getChildContext!=null&&(i=Tt(Tt({},i),u.getChildContext())),C&&!_&&u.getSnapshotBeforeUpdate!=null&&(M=u.getSnapshotBeforeUpdate(b,y)),N=a,a!=null&&a.type===Pt&&a.key==null&&(N=Ie(a.props.children)),h=De(e,Bt(N)?N:[N],t,n,i,o,r,c,h,g,d),u.base=t.__e,t.__u&=-161,u.__h.length&&c.push(u),P&&(u.__E=u.__=null)}catch(w){if(t.__v=null,g||r!=null)if(w.then){for(t.__u|=g?160:128;h&&h.nodeType==8&&h.nextSibling;)h=h.nextSibling;r[r.indexOf(h)]=null,t.__e=h}else{for(m=r.length;m--;)Zt(r[m]);Ot(t)}else t.__e=n.__e,t.__k=n.__k,w.then||Ot(t);it.__e(w,t,n)}else r==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):h=t.__e=rn(n.__e,t,n,i,o,r,c,g,d);return(a=it.diffed)&&a(t),128&t.__u?void 0:h}function Ot(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Ot)}function Ee(e,t,n){for(var i=0;i<n.length;i++)Qt(n[i],n[++i],n[++i]);it.__c&&it.__c(t,e),e.some(function(o){try{e=o.__h,o.__h=[],e.some(function(r){r.call(o)})}catch(r){it.__e(r,o.__v)}})}function Ie(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Bt(e)?e.map(Ie):Tt({},e)}function rn(e,t,n,i,o,r,c,h,g){var d,a,u,_,b,y,M,P=n.props||Rt,A=t.props,C=t.type;if(C=="svg"?o="http://www.w3.org/2000/svg":C=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),r!=null){for(d=0;d<r.length;d++)if((b=r[d])&&"setAttribute"in b==!!C&&(C?b.localName==C:b.nodeType==3)){e=b,r[d]=null;break}}if(e==null){if(C==null)return document.createTextNode(A);e=document.createElementNS(o,C,A.is&&A),h&&(it.__m&&it.__m(t,r),h=!1),r=null}if(C==null)P===A||h&&e.data==A||(e.data=A);else{if(r=r&&Ht.call(e.childNodes),!h&&r!=null)for(P={},d=0;d<e.attributes.length;d++)P[(b=e.attributes[d]).name]=b.value;for(d in P)if(b=P[d],d!="children"){if(d=="dangerouslySetInnerHTML")u=b;else if(!(d in A)){if(d=="value"&&"defaultValue"in A||d=="checked"&&"defaultChecked"in A)continue;$t(e,d,null,b,o)}}for(d in A)b=A[d],d=="children"?_=b:d=="dangerouslySetInnerHTML"?a=b:d=="value"?y=b:d=="checked"?M=b:h&&typeof b!="function"||P[d]===b||$t(e,d,b,P[d],o);if(a)h||u&&(a.__html==u.__html||a.__html==e.innerHTML)||(e.innerHTML=a.__html),t.__k=[];else if(u&&(e.innerHTML=""),De(t.type=="template"?e.content:e,Bt(_)?_:[_],t,n,i,C=="foreignObject"?"http://www.w3.org/1999/xhtml":o,r,c,r?r[0]:n.__k&&Lt(n,0),h,g),r!=null)for(d=r.length;d--;)Zt(r[d]);h||(d="value",C=="progress"&&y==null?e.removeAttribute("value"):y!=null&&(y!==e[d]||C=="progress"&&!y||C=="option"&&y!=P[d])&&$t(e,d,y,P[d],o),d="checked",M!=null&&M!=e[d]&&$t(e,d,M,P[d],o))}return e}function Qt(e,t,n){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&t==null||(e.__u=e(t))}else e.current=t}catch(o){it.__e(o,n)}}function Ne(e,t,n){var i,o;if(it.unmount&&it.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||Qt(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){it.__e(r,t)}i.base=i.__P=null}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&Ne(i[o],t,n||typeof e.type!="function");n||Zt(e.__e),e.__c=e.__=e.__e=void 0}function on(e,t,n){return this.constructor(e,n)}function sn(e,t,n){var i,o,r,c;t==document&&(t=document.documentElement),it.__&&it.__(e,t),o=(i=!1)?null:t.__k,r=[],c=[],Jt(t,e=t.__k=tn(Pt,null,[e]),o||Rt,Rt,t.namespaceURI,o?null:t.firstChild?Ht.call(t.childNodes):null,r,o?o.__e:t.firstChild,i,c),Ee(r,e,c)}Ht=Re.slice,it={__e:function(e,t,n,i){for(var o,r,c;t=t.__;)if((o=t.__c)&&!o.__)try{if((r=o.constructor)&&r.getDerivedStateFromError!=null&&(o.setState(r.getDerivedStateFromError(e)),c=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,i||{}),c=o.__d),c)return o.__E=o}catch(h){e=h}throw e}},Ce=0,It.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Tt({},this.state),typeof e=="function"&&(e=e(Tt({},n),this.props)),e&&Tt(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),ce(this))},It.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ce(this))},It.prototype.render=Pt,At=[],Ae=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,We=function(e,t){return e.__v.__b-t.__v.__b},Yt.__r=0,Le=/(PointerCapture)$|Capture$/i,Kt=0,Ut=ue(!1),jt=ue(!0);var an=0;function l(e,t,n,i,o,r){t||(t={});var c,h,g=t;if("ref"in g)for(h in g={},t)h=="ref"?c=t[h]:g[h]=t[h];var d={type:e,props:g,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--an,__i:-1,__u:0,__source:o,__self:r};if(typeof e=="function"&&(c=e.defaultProps))for(h in c)g[h]===void 0&&(g[h]=c[h]);return it.vnode&&it.vnode(d),d}var zt,at,Xt,de,Vt=0,Ye=[],ut=it,fe=ut.__b,pe=ut.__r,ge=ut.diffed,me=ut.__c,xe=ut.unmount,_e=ut.__;function te(e,t){ut.__h&&ut.__h(at,e,Vt||t),Vt=0;var n=at.__H||(at.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function rt(e){return Vt=1,ln(Fe,e)}function ln(e,t,n){var i=te(zt++,2);if(i.t=e,!i.__c&&(i.__=[Fe(void 0,t),function(h){var g=i.__N?i.__N[0]:i.__[0],d=i.t(g,h);g!==d&&(i.__N=[d,i.__[1]],i.__c.setState({}))}],i.__c=at,!at.__f)){var o=function(h,g,d){if(!i.__c.__H)return!0;var a=i.__c.__H.__.filter(function(_){return!!_.__c});if(a.every(function(_){return!_.__N}))return!r||r.call(this,h,g,d);var u=i.__c.props!==h;return a.forEach(function(_){if(_.__N){var b=_.__[0];_.__=_.__N,_.__N=void 0,b!==_.__[0]&&(u=!0)}}),r&&r.call(this,h,g,d)||u};at.__f=!0;var r=at.shouldComponentUpdate,c=at.componentWillUpdate;at.componentWillUpdate=function(h,g,d){if(this.__e){var a=r;r=void 0,o(h,g,d),r=a}c&&c.call(this,h,g,d)},at.shouldComponentUpdate=o}return i.__N||i.__}function St(e,t){var n=te(zt++,3);!ut.__s&&Ve(n.__H,t)&&(n.__=e,n.u=t,at.__H.__h.push(n))}function xt(e){return Vt=5,cn(function(){return{current:e}},[])}function cn(e,t){var n=te(zt++,7);return Ve(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function hn(){for(var e;e=Ye.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Nt),e.__H.__h.forEach(qt),e.__H.__h=[]}catch(t){e.__H.__h=[],ut.__e(t,e.__v)}}ut.__b=function(e){at=null,fe&&fe(e)},ut.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),_e&&_e(e,t)},ut.__r=function(e){pe&&pe(e),zt=0;var t=(at=e.__c).__H;t&&(Xt===at?(t.__h=[],at.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(Nt),t.__h.forEach(qt),t.__h=[],zt=0)),Xt=at},ut.diffed=function(e){ge&&ge(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ye.push(t)!==1&&de===ut.requestAnimationFrame||((de=ut.requestAnimationFrame)||un)(hn)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Xt=at=null},ut.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Nt),n.__h=n.__h.filter(function(i){return!i.__||qt(i)})}catch(i){t.some(function(o){o.__h&&(o.__h=[])}),t=[],ut.__e(i,n.__v)}}),me&&me(e,t)},ut.unmount=function(e){xe&&xe(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{Nt(i)}catch(o){t=o}}),n.__H=void 0,t&&ut.__e(t,n.__v))};var ye=typeof requestAnimationFrame=="function";function un(e){var t,n=function(){clearTimeout(i),ye&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,35);ye&&(t=requestAnimationFrame(n))}function Nt(e){var t=at,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),at=t}function qt(e){var t=at;e.__c=e.__(),at=t}function Ve(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function Fe(e,t){return typeof t=="function"?t(e):t}function dn(e){return function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}class fn{constructor(t){this.model=t}train(t,n,i){if(i!==void 0)return this.trainLegacy(t,n,i);const o=n,r=[];let c=1/0,h={};const g=a=>{const u=[];if(a.step<=0)return[a.min];for(let _=a.min;_<=a.max+1e-4;_+=a.step)u.push(parseFloat(_.toFixed(2)));return u},d=(a,u)=>{if(console.log({paramIndex:a,currentParams:u}),a===o.length){const y=[];let M=0;u.forEach((W,k)=>{o[k].name.toLowerCase().includes("bias")?M=W:y.push(W)}),this.model.setWeights?this.model.setWeights(y):this.model.setWeight&&this.model.setWeight(y[0]),this.model.setBias(M);let P=0,A=0;for(const W of t){const k=this.model.predict(W.input),f=W.target-k;P+=f*f,A+=Math.abs(f)}const C=P/t.length,D=A/t.length;let Y=0;for(const W of t)(this.model.predict(W.input)>=.5?1:0)===W.target&&Y++;const j=Y/t.length;C<c&&(c=C,h={weights:[...y],bias:M}),r.push({params:[...u],error:C,mae:D,accuracy:j});return}const _=o[a],b=g(_);for(const y of b)u[a]=y,d(a+1,u)};return d(0,new Array(o.length)),{bestParams:h,history:r,minError:c}}trainLegacy(t,n,i){const o=[];let r=n.min,c=i.min,h=1/0;for(let g=n.min;g<=n.max;g+=n.step)for(let d=i.min;d<=i.max;d+=i.step){const a=parseFloat(g.toFixed(2)),u=parseFloat(d.toFixed(2));this.model.setWeight(a),this.model.setBias(u);let _=0,b=0;for(const C of t){const D=this.model.predict(C.input),Y=C.target-D;_+=Y*Y,b+=Math.abs(Y)}const y=_/t.length,M=b/t.length;let P=0;for(const C of t)(this.model.predict(C.input)>=.5?1:0)===C.target&&P++;const A=P/t.length;y<h&&(h=y,r=a,c=u),o.push({weight:a,bias:u,error:y,mae:M,accuracy:A})}return{bestWeight:r,bestBias:c,history:o}}async trainAsync(t,n,i){if(!Array.isArray(n)){const b=arguments[1],y=arguments[2],M=arguments[3];let P=b.min,A=y.min,C=1/0,D=[];const Y=20;let j=0;for(let W=b.min;W<=b.max;W+=b.step)for(let k=y.min;k<=y.max;k+=y.step){const f=parseFloat(W.toFixed(2)),N=parseFloat(k.toFixed(2));this.model.setWeight(f),this.model.setBias(N);let m=0,p=0;for(const $ of t){const U=this.model.predict($.input),R=$.target-U;m+=R*R,p+=Math.abs(R)}const w=m/t.length,S=p/t.length;let v=0;for(const $ of t)(this.model.predict($.input)>=.5?1:0)===$.target&&v++;const L=v/t.length;w<C&&(C=w,P=f,A=N);const G={weight:f,bias:N,error:w,mae:S,accuracy:L};D.push(G),j++,j%Y===0&&(M&&M(D,{bestWeight:P,bestBias:A,minError:C}),D=[],await new Promise($=>setTimeout($,0)))}return D.length>0&&M&&M(D,{bestWeight:P,bestBias:A,minError:C}),{bestWeight:P,bestBias:A,minError:C}}let r=1/0,c={},h=0;const g=50;let d=[];const a=b=>{const y=[];if(b.step<=0)return[b.min];for(let M=b.min;M<=b.max+1e-4;M+=b.step)y.push(parseFloat(M.toFixed(2)));return y},u=n.map(a),_=async(b,y)=>{if(b===n.length){const P=[];let A=0;y.forEach((m,p)=>{n[p].name.toLowerCase().includes("bias")?A=m:P.push(m)});let C={};this.model.setParams?(y.forEach((m,p)=>{C[n[p].name]=m}),this.model.setParams(C),A===void 0&&(A=0)):(this.model.setWeights?this.model.setWeights(P):this.model.setWeight&&this.model.setWeight(P[0]),this.model.setBias(A),C={weights:[...P],bias:A});let D=0,Y=0;for(const m of t){const p=this.model.predict(m.input),w=m.target-p;D+=w*w,Y+=Math.abs(w)}const j=D/t.length,W=Y/t.length;let k=0;for(const m of t)(this.model.predict(m.input)>=.5?1:0)===m.target&&k++;const f=k/t.length;j<r&&(r=j,c=C);const N={params:[...y],error:j,mae:W,accuracy:f};d.push(N),h++,h%g===0&&(i&&i(d,{bestParams:c,minError:r}),d=[],await new Promise(m=>setTimeout(m,0)));return}const M=u[b];for(const P of M)y[b]=P,await _(b+1,y)};return await _(0,new Array(n.length)),d.length>0&&i&&i(d,{bestParams:c,minError:r}),{bestParams:c,minError:r}}async trainRandomAsync(t,n,i,o={}){const{patience:r=5e3,seed:c,maxSteps:h=1e4,initialRadius:g=.8,phase1Ratio:d=.8}=o,a=h,u=g,_=.999,b=d;let y=1/0,M={},P=c;P==null?(P=Math.floor(Math.random()*2147483647),console.log(`[AdaptiveRandom] Generated Seed: ${P}`)):console.log(`[AdaptiveRandom] Using Seed: ${P}`);const A=dn(P);let C=n.map(p=>({min:p.min,max:p.max,span:p.max-p.min})),D=C.map(p=>p.min+A()*p.span);const Y=p=>{const w=[];let S=0;p.forEach((R,V)=>{n[V].name.toLowerCase().includes("bias")?S=R:w.push(R)});let v={};this.model.setParams?(p.forEach((R,V)=>{v[n[V].name]=R}),this.model.setParams(v)):(this.model.setWeights?this.model.setWeights(w):this.model.setWeight&&this.model.setWeight(w[0]),this.model.setBias(S),v={weights:w,bias:S});let L=0,G=0;for(const R of t){const V=this.model.predict(R.input),x=R.target-V;L+=x*x,G+=Math.abs(x)}let $=0;for(const R of t)(this.model.predict(R.input)>=.5?1:0)===R.target&&$++;const U=$/t.length;return{mse:L/t.length,mae:G/t.length,accuracy:U,decodedParams:v,weights:w,bias:S}};let j=Y(D);y=j.mse,M=j.decodedParams?{...j.decodedParams,_array:[...D]}:{weights:j.weights,bias:j.bias,_array:[...D]},i&&i([{params:[...D],error:y,mae:j.mae,accuracy:j.accuracy}],{bestParams:M,minError:y}),await new Promise(p=>setTimeout(p,0));let W=[];const k=10;let f=y,N=[...D],m=0;for(let p=0;p<a;p++){const w=p<a*b;let S;if(w){const V=p/(a*b);S=u*(1-V*.5)}else S=u*.5*Math.pow(_,p-a*b);let v=!1;const L=[...N];let G=!1;for(;!G;)L.forEach((V,x)=>{if(A()<.4)return;G=!0;const s=C[x];let K=!1;if(w){const _t=s.span*.3,E=M._array&&Math.abs(V-M._array[x])<1e-9;E&&V<s.min+_t&&(s.min-=s.span*.4,s.span=s.max-s.min,K=!0),E&&V>s.max-_t&&(s.max+=s.span*.4,s.span=s.max-s.min,K=!0),K&&(v=!0)}let q=s.span*S;K&&(q=Math.max(q,s.span*.25));const lt=q;let ct=V+(A()-.5)*2*lt;ct<s.min&&(ct=s.min),ct>s.max&&(ct=s.max),L[x]=ct});const $=Y(L),U=$.mse-f;let R=!1;if(U<0&&(R=!0),R&&(N=L,f=$.mse),$.mse<y?(y=$.mse,M=$.decodedParams?{...$.decodedParams,_array:[...L]}:{weights:$.weights,bias:$.bias,_array:[...L]},m=0):m++,m>=r&&!w)break;if(W.push({params:[...L],error:$.mse,mae:$.mae,accuracy:$.accuracy}),W.length>=k){let V;v&&(V="Grenzen dynamisch erweitert..."),i&&i(W,{bestParams:M,minError:y,message:V}),W=[],await new Promise(x=>setTimeout(x,0))}}return W.length>0&&i&&i(W,{bestParams:M,minError:y}),{bestParams:M,minError:y}}}class pn{constructor(t=30,n=50){this.velocity=t,this.initialPosition=n}getPosition(t){return this.velocity*t+this.initialPosition}}class gn{constructor(){this.weight=0,this.bias=0}predict(t){return this.weight*t+this.bias}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function mn({time:e,groundTruth:t,neuralNet:n,maxDistance:i=300}){const o=xt(null);St(()=>{const c=o.current;if(!c)return;const h=c.getContext("2d"),g=c.width,d=c.height,a=50,u=g-2*a;h.clearRect(0,0,g,d);const _=t.getPosition(e),b=n.predict(e),y=a+_%i/i*u,M=a+b%i/i*u;h.fillStyle="#f0f0f0",h.fillRect(0,0,g,d/2),h.fillStyle="#e0e0e0",h.fillRect(0,d/2,g,d/2),h.beginPath(),h.strokeStyle="#fff",h.setLineDash([20,20]),h.moveTo(0,d/4),h.lineTo(g,d/4),h.moveTo(0,d*3/4),h.lineTo(g,d*3/4),h.stroke(),h.beginPath(),h.strokeStyle="#ccc",h.setLineDash([]),h.moveTo(a,0),h.lineTo(a,d),h.moveTo(g-a,0),h.lineTo(g-a,d),h.stroke(),r(h,y,d/4,"#2ecc71","Ground Truth"),r(h,M,d*3/4,"#e74c3c","Neural Net"),h.fillStyle="#333",h.font="14px monospace",h.fillText(`Zeit: ${e.toFixed(1)}s`,10,20),h.fillText(`Pos GT: ${_.toFixed(1)}m`,10,40),h.fillText(`Pos NN: ${b.toFixed(1)}m`,10,d/2+40)},[e,t,n,i]);function r(c,h,g,d,a){c.save(),c.translate(h,g),c.fillStyle=d,c.fillRect(-20,-10,40,20),c.fillStyle="#000",c.fillRect(-15,-15,10,5),c.fillRect(5,-15,10,5),c.fillRect(-15,10,10,5),c.fillRect(5,10,10,5),c.fillStyle="#000",c.font="10px sans-serif",c.textAlign="center",c.fillText(a,0,-20),c.restore()}return l("div",{style:{border:"2px solid #333",borderRadius:"8px",overflow:"hidden"},children:l("canvas",{ref:o,width:800,height:300,style:{width:"100%",display:"block"}})})}const be={id:"linear_regression",title:"Phase 1: Linear Regression",description:"Ein einfaches Neuron lernt den Zusammenhang zwischen Zeit und Position. Dies entspricht einer linearen Regression.",Model:gn,GroundTruth:pn,CanvasComponent:mn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[30,50],getInput:e=>e,generateData:e=>Array.from({length:20},(n,i)=>i*.5).map(n=>({input:n,target:e.getPosition(n)})),trainingConfig:{maxSteps:2e3,params:[{name:"weight",min:0,max:60,step:1},{name:"bias",min:0,max:100,step:2}]},networkViz:{formula:"pos = w * t + b",inputLabel:"Zeit (t)",outputLabel:"Pos (m)",biasLabel:"b"}};class xn{constructor(t=.5,n=-5){this.weight=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){const n=this.sigmoid(this.weight*t+this.bias);return Math.random()<n?1:0}getProbability(t){return this.sigmoid(this.weight*t+this.bias)}}class _n{constructor(){this.weight=0,this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=this.weight*t+this.bias;return this.sigmoid(n)}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function Ft(e,t,n=10){if(e===t)return[e];const i=we(t-e,!1),o=we(i/(n-1),!0),r=Math.floor(e/o)*o,c=Math.ceil(t/o)*o,h=[],g=o/1e3;for(let d=r;d<c+o/2;d+=o)d>=e-g&&d<=t+g&&h.push(Number(d.toPrecision(12)));return h}function we(e,t){const n=Math.floor(Math.log10(e)),i=e/Math.pow(10,n);let o;return t?i<1.5?o=1:i<3?o=2:i<7?o=5:o=10:i<=1?o=1:i<=2?o=2:i<=5?o=5:o=10,o*Math.pow(10,n)}function yn({time:e,groundTruth:t,neuralNet:n,data:i,staticMode:o=!1,showModel:r=!0,showGroundTruth:c=!0}){const h=xt(null),[g,d]=rt({k:1,x:0,y:0}),[a,u]=rt(!1),_=xt({x:0,y:0}),[b,y]=rt(null),M=xt([]),P=k=>{k.preventDefault();const N=-k.deltaY*.001,m=g.k;let p=m*(1+N);p=Math.max(.5,Math.min(p,10));const w=h.current.getBoundingClientRect(),S=h.current.width/w.width,v=h.current.height/w.height,L=(k.clientX-w.left)*S,G=(k.clientY-w.top)*v,$=40,U=(L-$-g.x)/m,R=(G-(300-$)-g.y)/m,V=L-$-U*p,x=G-(300-$)-R*p;d({k:p,x:V,y:x})},A=k=>{u(!0),_.current={x:k.clientX,y:k.clientY}},C=k=>{const f=h.current;if(!f)return;const N=f.getBoundingClientRect(),m=f.width/N.width,p=f.height/N.height;if(a){const w=(k.clientX-_.current.x)*m,S=(k.clientY-_.current.y)*p;_.current={x:k.clientX,y:k.clientY},d(v=>({...v,x:v.x+w,y:v.y+S})),y(null)}else{const w=(k.clientX-N.left)*m,S=(k.clientY-N.top)*p;let v=null,L=15;const G=M.current;for(let $=G.length-1;$>=0;$--){const U=G[$],R=Math.sqrt(Math.pow(U.x-w,2)+Math.pow(U.y-S,2));R<L&&(L=R,v=U.info)}y(v)}},D=()=>u(!1),Y=()=>{u(!1),y(null)},j=xt(0),W=()=>{const k=Date.now();k-j.current<300&&y(null),j.current=k};return St(()=>{const k=h.current;if(!k)return;const f=k.getContext("2d"),N=k.width,m=k.height;f.clearRect(0,0,N,m),M.current=[];const p=40,w=N-2*p,S=m-2*p,v=0,L=20,G=1,$=E=>p+E/L*w*g.k+g.x,U=E=>m-p-E/G*S*g.k+g.y,R=E=>(E-p-g.x)/(w*g.k)*L,V=E=>-((E-(m-p)-g.y)/(S*g.k))*G,x=R(p),s=R(N-p),K=V(m-p),q=V(p),lt=Ft(x,s,10),ct=Ft(K,q,5);f.beginPath(),f.strokeStyle="#eee",f.lineWidth=1,f.fillStyle="#333",f.textAlign="center",f.textBaseline="top",f.font="10px sans-serif",lt.forEach(E=>{const X=$(E);X<p||X>N-p||(f.moveTo(X,p),f.lineTo(X,m-p),f.fillText(Number(E.toFixed(2)),X,m-p+5))}),f.textAlign="right",f.textBaseline="middle",ct.forEach(E=>{const X=U(E);X<p||X>m-p||(f.moveTo(p,X),f.lineTo(N-p,X),f.fillText(Number(E.toFixed(2)),p-5,X))}),f.stroke(),f.beginPath(),f.strokeStyle="#333",f.lineWidth=1,f.rect(p,p,w,S),f.stroke(),f.fillStyle="#333",f.textAlign="center",f.textBaseline="alphabetic",f.fillText("Anzahl 'Spam' Wörter",N/2,m-10),f.save(),f.translate(15,m/2),f.rotate(-Math.PI/2),f.textAlign="center",f.fillText("Spam Wahrscheinlichkeit",0,0),f.restore(),f.save(),f.beginPath(),f.rect(p,p,w,S),f.clip();const _t=(E,X,I=[])=>{f.beginPath(),f.strokeStyle=X,f.setLineDash(I),f.lineWidth=2;const B=Math.max(v,x),z=Math.min(L,s);if(z<B)return;const T=(z-B)/100,F=Math.max(T,.05);let J=!1;for(let Z=B;Z<=z+F;Z+=F){const et=Math.min(Math.max(Z,v),L);let gt=0;typeof E.getProbability=="function"?gt=E.getProbability(et):typeof E.predict=="function"&&(gt=E.predict(et));const ft=$(et),ot=U(gt);J?f.lineTo(ft,ot):(f.moveTo(ft,ot),J=!0)}f.stroke(),f.setLineDash([])};if(c&&t&&_t(t,"#ccc",[5,5]),r&&n&&_t(n,"#e74c3c"),o&&i)i.forEach(E=>{if(E.input<x-5||E.input>s+5)return;const X=$(E.input),I=U(E.target);M.current.push({x:X,y:I,info:{x:X,y:I,input:E.input,target:E.target}});let B=null;if(n&&r)try{B=n.predict(E.input)>.5?"#e74c3c":"#2ecc71"}catch{}const z=Math.sin(E.input*123)*5,T=Math.cos(E.input*321)*5;B&&(f.beginPath(),f.arc(X+z,I+T,8,0,Math.PI*2),f.strokeStyle=B,f.lineWidth=2,f.stroke()),f.beginPath(),f.arc(X+z,I+T,5,0,Math.PI*2),f.fillStyle=E.target===1?"#e74c3c":"#2ecc71",f.fill(),f.strokeStyle="#fff",f.lineWidth=1,f.stroke()});else if(!o){const X=Math.floor(e*2),I=50,B=T=>{const F=Math.sin(T*123.456)*1e4;return F-Math.floor(F)},z=Math.min(X,I);for(let T=0;T<z;T++){const F=B(T+1),J=Math.floor(F*21),Z=t?t.getProbability(J):0,et=B(T+999)<Z?1:0;if(J<x-5||J>s+5)continue;const gt=$(J),ft=U(et);let ot=null;if(n&&r)try{ot=n.predict(J)>.5?"#e74c3c":"#2ecc71"}catch{}const pt=(B(T+333)-.5)*10,wt=(B(T+444)-.5)*10,H=gt+pt,dt=ft+wt;M.current.push({x:H,y:dt,info:{x:H,y:dt,input:J,target:et}}),ot&&(f.beginPath(),f.arc(H,dt,8,0,Math.PI*2),f.strokeStyle=ot,f.lineWidth=2,f.stroke()),f.beginPath(),f.arc(H,dt,5,0,Math.PI*2),f.fillStyle=et?"#e74c3c":"#2ecc71",f.fill(),f.strokeStyle="#fff",f.lineWidth=1,f.stroke()}if(z>0&&z<=I){const T=z-1,F=B(T+1),J=Math.floor(F*21),Z=t.getProbability(J),et=B(T+999)<Z?1:0,gt=(B(T+333)-.5)*10,ft=(B(T+444)-.5)*10,ot=$(J)+gt,pt=U(et)+ft;ot>p&&ot<N-p&&pt>p&&pt<m-p&&(f.beginPath(),f.arc(ot,pt,8,0,Math.PI*2),f.strokeStyle="#333",f.stroke(),f.fillStyle="#333",f.font="10px sans-serif",f.fillText(`${J}`,ot,pt-12))}}if(f.restore(),b){f.save(),f.fillStyle="rgba(0,0,0,0.8)",f.strokeStyle="#fff";const E=b.target===1?"SPAM":"HAM",X=`Words: ${b.input}`,I=100,B=40;let z=b.x+10,T=b.y-10;z+I>N&&(z=b.x-I-10),T+B>m&&(T=b.y-B-10),T<0&&(T=b.y+10),f.beginPath(),f.roundRect(z,T,I,B,4),f.fill(),f.lineWidth=1,f.stroke(),f.textBaseline="top",f.textAlign="left",f.font="bold 11px sans-serif",f.fillStyle=b.target===1?"#e74c3c":"#2ecc71",f.fillText(E,z+8,T+6),f.fillStyle="#ddd",f.font="10px sans-serif",f.fillText(X,z+8,T+20),f.restore()}},[e,t,n,i,o,r,c,g,b]),l("div",{className:"canvas-container",children:l("canvas",{ref:h,width:600,height:300,style:{width:"100%",border:"1px solid #ccc",background:"#fff",cursor:b?"pointer":a?"grabbing":"grab"},onWheel:P,onMouseDown:A,onMouseMove:C,onMouseUp:D,onMouseLeave:Y,onClick:W})})}const bn=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},ve={id:"logistic_regression",title:"Phase 2: Logistic Regression",description:'Klassifikation von E-Mails als "Spam" oder "Kein Spam" basierend auf der Wortanzahl. Dies ist eine logistische Regression.',Model:_n,GroundTruth:xn,CanvasComponent:yn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[.5,-5],getInput:e=>{const t=Math.floor(e);return Math.floor(bn(t)*20)},generateData:e=>{const t=[];for(let n=0;n<50;n++){const i=Math.floor(Math.random()*21),o=e.classify(i);t.push({input:i,target:o})}return t.sort((n,i)=>n.input-i.input)},trainingConfig:{maxSteps:3e3,params:[{name:"weight",min:0,max:2,step:.1},{name:"bias",min:-10,max:5,step:.5}]},networkViz:{formula:"p = σ(w * x + b)",inputLabel:"Wörter (x)",outputLabel:"Spam? (p)",biasLabel:"b"},isFinished:e=>e>=25};class ee{constructor(t=[.5,.2,.8,-.1],n=-3){this.weights=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){let n=this.bias;for(let o=0;o<this.weights.length;o++)n+=this.weights[o]*t[o];const i=this.sigmoid(n);return Math.random()<i?1:0}getProbability(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}}class He{constructor(t=4){this.weights=new Array(t).fill(0),this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}setWeights(t){this.weights=[...t]}setBias(t){this.bias=t}setWeightAt(t,n){t>=0&&t<this.weights.length&&(this.weights[t]=n)}}const wn=[{label:"Spam Words",idx:0,max:15},{label:"Großbuchstaben",idx:1,max:25},{label:"Links",idx:2,max:8},{label:"Gesamtworte",idx:3,max:100}];function ne({data:e,currentInput:t,currentPrediction:n,neuralNet:i,allowedModes:o=["features","scatter","3d","text"],hideControls:r=!1,showModel:c=!0,additionalControls:h=null,features:g=wn}){const d=xt(null),[a,u]=rt(o[0]);St(()=>{o.includes(a)||u(o[0])},[o]);const[_,b]=rt(0),[y,M]=rt(g.length===2?1:3),[P,A]=rt(2),[C,D]=rt(!1),[Y,j]=rt({x:-.5,y:.5}),[W,k]=rt({k:1,x:0,y:0}),f=xt(!1),N=xt({x:0,y:0}),[m,p]=rt(null),w=xt([]),S=x=>{if(a!=="scatter")return;x.preventDefault();const K=-x.deltaY*.001,q=W.k;let lt=q*(1+K);lt=Math.max(.5,Math.min(lt,50));const ct=d.current;if(!ct)return;const _t=ct.getBoundingClientRect(),E=ct.width/_t.width,X=ct.height/_t.height,I=(x.clientX-_t.left)*E,B=(x.clientY-_t.top)*X,z=50,T=ct.height-z,F=(I-z-W.x)/q,J=(T+W.y-B)/q,Z=I-z-F*lt,et=B-T+J*lt;k({k:lt,x:Z,y:et})},v=x=>{a!=="3d"&&a!=="scatter"||(f.current=!0,N.current={x:x.clientX,y:x.clientY})},L=x=>{const s=d.current;if(!s)return;const K=s.getBoundingClientRect(),q=s.width/K.width,lt=s.height/K.height;if(f.current){const z=(x.clientX-N.current.x)*q,T=(x.clientY-N.current.y)*lt;N.current={x:x.clientX,y:x.clientY},a==="3d"?j(F=>({x:F.x+T*.01,y:F.y+z*.01})):a==="scatter"&&k(F=>({...F,x:F.x+z,y:F.y+T}));return}const ct=(x.clientX-K.left)*q,_t=(x.clientY-K.top)*lt;let E=null,I=15;const B=w.current;for(let z=B.length-1;z>=0;z--){const T=B[z],F=Math.sqrt((T.x-ct)**2+(T.y-_t)**2);F<I&&(I=F,E=T.info)}p(E)},G=()=>{f.current=!1},$=()=>{p(null),f.current=!1},U=xt(0),R=()=>{const x=Date.now();x-U.current<300&&p(null),U.current=x};St(()=>{const x=d.current;if(!x)return;const s=x.getContext("2d"),K=x.width,q=x.height;s.clearRect(0,0,K,q),s.fillStyle="#fff",s.fillRect(0,0,K,q),w.current=[];const lt=E=>{if(!e||e.length===0)return g[E].max;const X=Math.max(...e.map(I=>I.input[E]));return X>0?X:g[E].max},ct=E=>E===2?"#3498db":E===1?"#e74c3c":"#2ecc71",_t=E=>E===3?"CLASS 3":E===1?"SPAM":"HAM";if(a==="3d"){const E=lt(_),X=lt(y),I=lt(P),B=K/2,z=q/2,T=150,F=(H,dt,yt)=>{let kt=H*Math.cos(Y.y)-yt*Math.sin(Y.y),O=H*Math.sin(Y.y)+yt*Math.cos(Y.y),Q=dt*Math.cos(Y.x)-O*Math.sin(Y.x),st=dt*Math.sin(Y.x)+O*Math.cos(Y.x);const tt=400/(400-st);return{x:B+kt*tt,y:z+Q*tt,z:st}},Z=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]].map(H=>F(H[0]*T,H[1]*T,H[2]*T)),et="#e29301ff",gt="#2980b9",ft="#c00798ff",ot=(H,dt)=>{s.beginPath(),s.strokeStyle=dt,s.lineWidth=1,H.forEach(([yt,kt])=>{s.moveTo(Z[yt].x,Z[yt].y),s.lineTo(Z[kt].x,Z[kt].y)}),s.stroke()};ot([[0,1],[3,2],[4,5],[7,6]],et),ot([[0,3],[1,2],[4,7],[5,6]],gt),ot([[0,4],[1,5],[2,6],[3,7]],ft),s.font="bold 11px sans-serif",s.fillStyle=et,s.fillText("X: "+g[_].label,Z[1].x,Z[1].y),s.fillStyle=gt,s.fillText("Y: "+g[y].label,Z[3].x,Z[3].y),s.fillStyle=ft,s.fillText("Z: "+g[P].label,Z[4].x,Z[4].y);const pt=[],wt=(H,dt)=>H/dt*2-1;if(c&&i&&i.weights){const H=i.weights[_]||0,dt=i.weights[y]||0,yt=i.weights[P]||0,kt=i.bias||0;if(Math.abs(yt)>.001){s.strokeStyle="rgba(142, 68, 173, 0.3)",s.lineWidth=1;const O=(tt,nt)=>{const mt=(tt+1)/2*E,ht=(nt+1)/2*X,vt=(-H*mt-dt*ht-kt)/yt;return wt(vt,I)},Q=(tt,nt)=>{if(Math.abs(tt.z)<=3&&Math.abs(nt.z)<=3){const mt=F(tt.x*T,-tt.y*T,tt.z*T),ht=F(nt.x*T,-nt.y*T,nt.z*T);s.beginPath(),s.moveTo(mt.x,mt.y),s.lineTo(ht.x,ht.y),s.stroke()}},st=6;for(let tt=0;tt<=st;tt++){const nt=-1+tt/st*2,mt=O(-1,nt),ht=O(1,nt);Q({x:-1,y:nt,z:mt},{x:1,y:nt,z:ht})}for(let tt=0;tt<=st;tt++){const nt=-1+tt/st*2,mt=O(nt,-1),ht=O(nt,1);Q({x:nt,y:-1,z:mt},{x:nt,y:1,z:ht})}}}e&&e.forEach(H=>{const dt=wt(H.input[_],E),yt=-wt(H.input[y],X),kt=wt(H.input[P],I),O=F(dt*T,yt*T,kt*T);let Q=null;if(i&&c)try{Q=i.predict(H.input)>.5?"#e74c3c":"#2ecc71"}catch{}pt.push({...O,color:ct(H.target),radius:3,haloColor:Q,pt:H})}),pt.sort((H,dt)=>H.z-dt.z),pt.forEach(H=>{H.z<3&&w.current.push({x:H.x,y:H.y,info:{x:H.x,y:H.y,text:H.pt.text,target:H.pt.target,isSpam:H.pt.target===1,features:{xLabel:g[_].label,xVal:H.pt.input[_],yLabel:g[y].label,yVal:H.pt.input[y],zLabel:g[P].label,zVal:H.pt.input[P]}}}),H.haloColor&&(s.beginPath(),s.arc(H.x,H.y,H.radius+2,0,Math.PI*2),s.strokeStyle=H.haloColor,s.lineWidth=1.5,s.stroke()),s.beginPath(),s.arc(H.x,H.y,H.radius,0,Math.PI*2),s.fillStyle=H.color,s.fill()})}if(a==="scatter"){const E=lt(_),X=lt(y),I=50,B=K-2*I,z=q-2*I,T=q-I,F="#c0392b",J="#2980b9",Z=O=>I+O/E*B*W.k+W.x,et=O=>T-O/X*z*W.k+W.y;s.save(),s.beginPath(),s.rect(I,I,B,z),s.clip(),s.restore();const gt=O=>(O-I-W.x)/(B*W.k)*E,ft=O=>(T+W.y-O)/(z*W.k)*X,ot=gt(I),pt=gt(I+B),wt=ft(T),H=ft(I),dt=Ft(Math.min(ot,pt),Math.max(ot,pt),8),yt=Ft(Math.min(wt,H),Math.max(wt,H),6);if(s.lineWidth=1,s.strokeStyle="#eee",s.fillStyle="#666",s.font="10px sans-serif",s.textAlign="center",s.textBaseline="top",dt.forEach(O=>{const Q=Z(O);Q<I||Q>I+B||(s.beginPath(),s.moveTo(Q,I),s.lineTo(Q,T),s.stroke(),s.fillText(Number(O.toFixed(2)),Q,T+5))}),s.textAlign="right",s.textBaseline="middle",yt.forEach(O=>{const Q=et(O);Q<I||Q>T||(s.beginPath(),s.moveTo(I,Q),s.lineTo(I+B,Q),s.stroke(),s.fillText(Number(O.toFixed(2)),I-5,Q))}),s.strokeStyle="#ccc",s.lineWidth=2,s.strokeRect(I,I,B,z),s.textAlign="center",s.font="bold 12px sans-serif",s.fillStyle=F,s.fillText(`${g[_].label}`,I+B/2,T+30),s.save(),s.translate(15,T-z/2),s.rotate(-Math.PI/2),s.fillStyle=J,s.fillText(`${g[y].label}`,0,0),s.restore(),s.save(),s.beginPath(),s.rect(I,I,B,z),s.clip(),C&&i&&g.length===2){const Q=Math.floor(ot/.5)*.5,st=Math.ceil(pt/.5)*.5,tt=Math.floor(wt/.5)*.5,nt=Math.ceil(H/.5)*.5;if((st-Q)/.5*((nt-tt)/.5)<5e4)for(let ht=Q;ht<=st;ht+=.5)for(let vt=tt;vt<=nt;vt+=.5)try{const Mt=[0,0];_<2&&(Mt[_]=ht),y<2&&(Mt[y]=vt);const bt=i.predict(Mt),Ct=Z(ht),Dt=et(vt),se=Z(ht+.5),ae=et(vt+.5),Ue=Math.abs(se-Ct),je=Math.abs(Dt-ae),Oe=Math.min(Ct,se),qe=Math.min(Dt,ae),Ke=Math.round(46*(1-bt)+231*bt),Ze=Math.round(204*(1-bt)+76*bt),Je=Math.round(113*(1-bt)+60*bt);s.fillStyle=`rgba(${Ke}, ${Ze}, ${Je}, 0.2)`,s.fillRect(Oe,qe,Ue+.5,je+.5)}catch{}}const kt=(O,Q,st,tt,nt)=>{const mt=Z(O[_]),ht=et(O[y]);nt&&(s.beginPath(),s.arc(mt,ht,st+3,0,2*Math.PI),s.strokeStyle=nt,s.lineWidth=2,s.stroke()),s.beginPath(),s.arc(mt,ht,st,0,2*Math.PI),s.fillStyle=Q,s.fill(),tt&&(s.strokeStyle=tt,s.lineWidth=2,s.stroke())};if(e&&e.forEach(O=>{const Q=Z(O.input[_]),st=et(O.input[y]);if(Q<I||Q>I+B||st<I||st>T)return;w.current.push({x:Q,y:st,info:{x:Q,y:st,text:O.text,target:O.target,isSpam:O.target===1,features:{xLabel:g[_].label,xVal:O.input[_],yLabel:g[y].label,yVal:O.input[y]}}});let tt=null;if(i&&c)try{tt=i.predict(O.input)>.5?"#e74c3c":"#2ecc71"}catch{}kt(O.input,ct(O.target),5,"#fff",tt)}),c&&i){let O=i.weights;const Q=i.bias||0;if(O){const st=O[_]||0,tt=O[y]||0,nt=Q;s.beginPath(),s.strokeStyle="rgba(142, 68, 173, 0.8)",s.lineWidth=2,s.setLineDash([10,5]);const mt=ot-(pt-ot),ht=pt+(pt-ot),vt=(Mt,bt)=>({x:Z(Mt),y:et(bt)});if(Math.abs(tt)>.001){const Mt=Dt=>(-st*Dt-nt)/tt,bt=vt(mt,Mt(mt)),Ct=vt(ht,Mt(ht));s.moveTo(bt.x,bt.y),s.lineTo(Ct.x,Ct.y)}else if(Math.abs(st)>.001){const Mt=-nt/st,bt=vt(Mt,wt-100),Ct=vt(Mt,H+100);s.moveTo(bt.x,bt.y),s.lineTo(Ct.x,Ct.y)}s.stroke(),s.setLineDash([])}}t&&kt(t,"#3498db",8,"#2980b9"),s.restore(),s.fillStyle="#666",s.textAlign="right",s.font="11px sans-serif",s.fillText("Rot=Spam, Grün=OK",K-10,20)}if(a==="text"){if(s.textAlign="center",s.textBaseline="middle",!t||!t.text){s.fillStyle="#999",s.font="20px sans-serif",s.fillText("Kein Text verfügbar",K/2,q/2);return}const E=n>.5,X=E?"#feeff0":"#effaf0";s.fillStyle=X,s.fillRect(0,0,K,q);const I=t.text;s.fillStyle="#333",s.font="24px serif";const B=I.split(" ");let z="";const T=35,F=K/2;let J=q/3;const Z=K-100;for(let ft=0;ft<B.length;ft++){const ot=z+B[ft]+" ";s.measureText(ot).width>Z&&ft>0?(s.fillText(z,F,J),z=B[ft]+" ",J+=T):z=ot}s.fillText(z,F,J),J+=60;const et=t.groundTruth===1;s.font="bold 16px sans-serif",s.fillStyle="#555",s.fillText(`Wahrheit: ${et?"SPAM":"HAM"}`,F,J),J+=30;const gt=(n*100).toFixed(1);s.font="bold 20px sans-serif",s.fillStyle=E?"#c0392b":"#27ae60",s.fillText(`Vorhersage: ${E?"SPAM":"HAM"} (${gt}%)`,F,J);return}if(a==="features"){const X=(K-90)/2,I=(q-90)/2;[{x:30,y:30,...g[0]},{x:30+X+30,y:30,...g[1]},{x:30,y:30+I+30,...g[2]},{x:30+X+30,y:30+I+30,...g[3]}].forEach(z=>{if(s.strokeStyle="#ccc",s.strokeRect(z.x,z.y,X,I),s.fillStyle="#333",s.font="12px Arial",s.textAlign="center",s.fillText(z.label,z.x+X/2,z.y-5),e&&e.forEach(T=>{const F=T.input[z.idx],J=z.x+F/z.max*X,Z=z.y+I-T.target*(I-20)-10;w.current.push({x:J,y:Z,info:{x:J,y:Z,text:T.text,target:T.target,isSpam:T.target===1,features:{valLabel:z.label,val:F}}});let et=null;if(i&&c)try{et=i.predict(T.input)>.5?"#e74c3c":"#2ecc71"}catch{}et&&(s.beginPath(),s.arc(J,Z,4.5,0,2*Math.PI),s.strokeStyle=et,s.lineWidth=1,s.stroke()),s.beginPath(),s.arc(J,Z,3,0,2*Math.PI),s.fillStyle=ct(T.target),s.globalAlpha=.6,s.fill(),s.globalAlpha=1}),t){const T=t[z.idx],F=z.x+T/z.max*X;s.beginPath(),s.moveTo(F,z.y),s.lineTo(F,z.y+I),s.strokeStyle="#3498db",s.setLineDash([5,5]),s.stroke(),s.setLineDash([])}})}if(m&&(a==="features"||a==="scatter"||a==="3d")){s.save(),s.fillStyle="rgba(0,0,0,0.85)",s.strokeStyle="#fff";const E=m.text||"No Text",X=_t(m.target!==void 0?m.target:m.isSpam?1:0),I=s.measureText(E),B=Math.max(I.width,140)+20;let z=70;m.features&&(m.features.zLabel?z=90:m.features.yLabel?z=85:z=60);let T=m.x+15,F=m.y-15;T+B>K&&(T=m.x-B-10),F+z>q&&(F=m.y-z-10),F<0&&(F=m.y+20),s.beginPath(),s.roundRect(T,F,B,z,5),s.fill(),s.lineWidth=1,s.stroke(),s.textBaseline="top",s.textAlign="left",s.font="bold 12px sans-serif",s.fillStyle=ct(m.target!==void 0?m.target:m.isSpam?1:0),s.fillText(X,T+10,F+10),s.fillStyle="#ddd",s.font="italic 11px sans-serif",s.fillText(E,T+10,F+28),m.features&&(s.fillStyle="#fff",s.font="11px monospace",m.features.xLabel?(s.fillText(`${m.features.xLabel}: ${m.features.xVal}`,T+10,F+46),s.fillText(`${m.features.yLabel}: ${m.features.yVal}`,T+10,F+60),m.features.zLabel&&s.fillText(`${m.features.zLabel}: ${m.features.zVal}`,T+10,F+74)):m.features.valLabel&&s.fillText(`${m.features.valLabel}: ${m.features.val}`,T+10,F+46)),s.restore()}},[e,t,n,i,a,_,y,P,Y,c,W,C]);const V={features:"Alle Features",scatter:"2D Plot","3d":"3D Plot",text:"Text Mode"};return l("div",{style:{textAlign:"center"},children:[!r&&l("div",{style:{marginBottom:"10px",display:"flex",gap:"5px",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",fontSize:"0.9rem"},children:[l("div",{children:h}),l("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[l("select",{value:a,onChange:x=>u(x.target.value),style:{padding:"4px"},children:o.map(x=>l("option",{value:x,children:V[x]},x))}),(a==="scatter"||a==="3d")&&l(Pt,{children:[l("span",{children:"X:"}),l("select",{value:_,onChange:x=>b(parseInt(x.target.value)),style:{padding:"4px"},children:g.map(x=>l("option",{value:x.idx,children:x.label},x.idx))}),l("span",{children:"Y:"}),l("select",{value:y,onChange:x=>M(parseInt(x.target.value)),style:{padding:"4px"},children:g.map(x=>l("option",{value:x.idx,children:x.label},x.idx))})]}),a==="scatter"&&g.length===2&&l("label",{style:{display:"flex",alignItems:"center",gap:"3px",marginLeft:"5px",fontSize:"0.8rem",cursor:"pointer",background:"#f5f5f5",padding:"2px 5px",borderRadius:"3px",border:"1px solid #ddd"},children:[l("input",{type:"checkbox",checked:C,onChange:x=>D(x.target.checked)}),"Show Grid"]}),a==="3d"&&l(Pt,{children:[l("span",{children:"Z:"}),l("select",{value:P,onChange:x=>A(parseInt(x.target.value)),style:{padding:"4px"},children:g.map(x=>l("option",{value:x.idx,children:x.label},x.idx))})]})]})]}),l("canvas",{ref:d,width:600,height:400,style:{border:"1px solid #eee",maxWidth:"100%",borderRadius:"4px",cursor:m?"pointer":a==="3d"||a==="scatter"?f.current?"grabbing":"grab":"default"},onWheel:S,onMouseDown:v,onMouseMove:L,onMouseUp:G,onMouseLeave:G,onMouseOut:$,onClick:R}),!r&&l("div",{style:{fontSize:"0.8rem",color:"#666",marginTop:"5px"},children:a==="3d"?"Drag to rotate 3D view":a==="scatter"?"Drag to Pan, Scroll to Zoom":"Wähle Achsen für die Visualisierung"})]})}const Me=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Gt=e=>{const t=["winner","won","gift card","urgent","rolex","viagra","cash","prize","singles","marketing","buy","free","money","security alert","click","claim","fake","verification"],n=e.toLowerCase();let i=0;t.forEach(h=>{n.includes(h)&&(i+=1)}),i>10&&(i=10);const o=(e.match(/[A-Z]/g)||[]).length,r=(e.match(/http/g)||[]).length,c=e.split(/\s+/).length;return[i,o,r,c]},Wt={id:"multiple_inputs",title:"Phase 3: Multiple Inputs",description:"Erweiterte Spam-Erkennung mit zwei linearen Merkmalen (Worte und Links). Das Netz lernt eine Trennlinie.",Model:He,GroundTruth:ee,CanvasComponent:ne,defaultParams:{weights:[0,0,0,0],bias:0},groundTruthDefaults:[[1.5,.5,2,-.5],-5],getInput:e=>{const t=Math.floor(e*.3),n=Me(t)>.5,i=n?Wt.examples.spam:Wt.examples.ham,o=Math.floor(Me(t+99)*i.length),r=i[o],c=Gt(r);return c.text=r,c.groundTruth=n?1:0,c},examples:{spam:["WINNER! Won $1000 Gift Card! Claim at http://prize-giveaway.net","URGENT: Verify account at http://secure-bank-login.com/fraud","Cheap Rolex watches! 50% OFF at www.fake-watches.cn","Lose weight fast! Buy pills: http://diet-miracle.com","CONGRATS! Cash prize waiting: http://claim-money.org","HOT singles waiting! Chat now: http://local-dating.xyz","Refinance 1% APR. Apply: http://easy-loans.biz","Buy 1 get 1 FREE Viagra. http://meds-direct.com","Meet rich men. Signup: http://millionaire-match.com","SECURITY ALERT: Suspicious activity. Check http://account-security-check.com"],ham:["Meeting agenda for tomorrow's team sync","Hey, are we still on for lunch?","Invoice #12345 from AWS Services","Project deadline extended to Friday","Happy Birthday! Hope you have a great day.","Can you review this pull request?","Your Amazon order has shipped.","Fwd: Tickets for the concert","Question about the quarterly report","Let's catch up sometime next week."]},generateData:e=>{const t=[];Wt.examples.spam.forEach(n=>{const i=Gt(n),o=()=>(Math.random()-.5)*.1,r=i.map(c=>Math.max(0,c+o()));t.push({input:r,target:1,text:n})}),Wt.examples.ham.forEach(n=>{const o=Gt(n).map(r=>Math.max(0,r+(Math.random()-.5)*.1));t.push({input:o,target:0,text:n})});for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t},trainingConfig:{maxSteps:3e3,params:[{name:"w1 (Spam-Worte)",min:1,max:4,step:.5},{name:"w2 (Großbuchst.)",min:0,max:2,step:.5},{name:"w3 (Links)",min:0,max:3,step:.5},{name:"w4 (Gesamtworte)",min:-2,max:2,step:.5},{name:"bias",min:-8,max:8,step:2}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + w₃x₃ + w₄x₄ + b)",inputLabels:["Spam-Worte","Großbuchst.","Links","Gesamtworte"],outputLabel:"Spam? (p)",biasLabel:"b"},isFinished:e=>e>=50};class vn{constructor(t=2,n=10){this.inputCount=t,this.hiddenCount=n;const i=Math.sqrt(6/(t+n));this.weights1=Array(n).fill(0).map(()=>Array.from({length:t},()=>Math.random()*2*i-i)),this.biases1=Array(n).fill(0);const o=Math.sqrt(6/(n+1));this.weights2=Array.from({length:n},()=>Math.random()*2*o-o),this.bias2=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=[];for(let r=0;r<this.hiddenCount;r++){let c=this.biases1[r];for(let h=0;h<this.inputCount;h++)c+=this.weights1[r][h]*t[h];n.push(this.sigmoid(c))}let i=this.bias2;for(let r=0;r<this.hiddenCount;r++)i+=this.weights2[r]*n[r];return this.sigmoid(i)}getActivations(t){const n=[];for(let r=0;r<this.hiddenCount;r++){let c=this.biases1[r];for(let h=0;h<this.inputCount;h++)c+=this.weights1[r][h]*t[h];n.push(this.sigmoid(c))}let i=this.bias2;for(let r=0;r<this.hiddenCount;r++)i+=this.weights2[r]*n[r];const o=this.sigmoid(i);return{hidden:n,output:[o]}}setParams(t){for(let i=0;i<this.hiddenCount;i++){const o=`b1_${i}`;t[o]!==void 0&&(this.biases1[i]=t[o]);for(let r=0;r<this.inputCount;r++){const c=`w1_${i}_${r}`;t[c]!==void 0&&(this.weights1[i][r]=t[c])}}const n="b2";t[n]!==void 0&&(this.bias2=t[n]);for(let i=0;i<this.hiddenCount;i++){const o=`w2_${i}`;t[o]!==void 0&&(this.weights2[i]=t[o])}}getTopology(){return{inputCount:this.inputCount,hiddenCounts:[this.hiddenCount],outputCount:1,weights1:this.weights1,biases1:this.biases1,weights2:this.weights2,bias2:this.bias2}}}const Be=[{label:"Gesamtworte",idx:0,max:400},{label:"Links",idx:1,max:10}],ke=[{input:[367,5],target:0,text:"Attached is the quarterly report found at..."},{input:[365,2],target:0,text:"Attached is the quarterly report found at..."},{input:[364,6],target:0,text:"Attached is the quarterly report found at..."},{input:[327,7],target:0,text:"Attached is the quarterly report found at..."},{input:[302,5],target:0,text:"Attached is the quarterly report found at..."},{input:[314,3],target:0,text:"Attached is the quarterly report found at..."},{input:[345,4],target:0,text:"Attached is the quarterly report found at..."},{input:[265,5],target:0,text:"Attached is the quarterly report found at..."},{input:[287,4],target:0,text:"Attached is the quarterly report found at..."},{input:[311,1],target:0,text:"Attached is the quarterly report found at..."},{input:[268,2],target:0,text:"Attached is the quarterly report found at..."},{input:[283,0],target:0,text:"Attached is the quarterly report found at..."},{input:[261,3],target:0,text:"Attached is the quarterly report found at..."},{input:[197,0],target:0,text:"Just a normal short message."},{input:[150,0],target:0,text:"Just a normal short message."},{input:[124,0],target:0,text:"Just a normal short message."},{input:[65,1],target:0,text:"Just a normal short message."},{input:[85,0],target:0,text:"Just a normal short message."},{input:[58,0],target:0,text:"Just a normal short message."},{input:[45,0],target:0,text:"Security Alert: Login Code 2542"},{input:[36,0],target:0,text:"Security Alert: Login Code 5607"},{input:[38,1],target:0,text:"Security Alert: Login Code 909"},{input:[24,1],target:0,text:"Security Alert: Login Code 8385"},{input:[17,1],target:0,text:"Security Alert: Login Code 2083"},{input:[215,1],target:1,text:"You won a prize! Click here."},{input:[230,3],target:1,text:"You won a prize! Click here."},{input:[234,5],target:1,text:"You won a prize! Click here."},{input:[221,2],target:1,text:"You won a prize! Click here."},{input:[215,4],target:1,text:"You won a prize! Click here."},{input:[153,3],target:1,text:"You won a prize! Click here."},{input:[152,1],target:1,text:"You won a prize! Click here."},{input:[137,2],target:1,text:"You won a prize! Click here."},{input:[124,4],target:1,text:"You won a prize! Click here."},{input:[120,2],target:1,text:"You won a prize! Click here."},{input:[92,3],target:1,text:"You won a prize! Click here."},{input:[93,5],target:1,text:"You won a prize! Click here."},{input:[86,5],target:1,text:"You won a prize! Click here."},{input:[84,3],target:1,text:"You won a prize! Click here."},{input:[53,4],target:1,text:"You won a prize! Click here."},{input:[55,3],target:1,text:"You won a prize! Click here."}],Xe=()=>(console.log("Using prepared data with length "+ke.length),ke),Se={id:"single_layer_nonlinear",title:"Phase 4: Single Layer Nonlinear Data",description:"Spam-Erkennung mit nur 2 Merkmalen, aber komplexer Verteilung. Ein einfacher linearer Klassifikator (Perzeptron) wird hier scheitern.",Model:He,GroundTruth:ee,CanvasComponent:ne,defaultParams:{weights:[0,0],bias:0},getInput:e=>{const t=[50,0];return t.text="Live Input",t},generateData:e=>Xe(),trainingConfig:{maxSteps:4e3,params:[{name:"w1 (Worte)",min:-5,max:5,step:.5},{name:"w2 (Links)",min:-5,max:5,step:.5},{name:"bias",min:-10,max:10,step:1}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + b)",inputLabels:["Worte","Links"],outputLabel:"Spam?",biasLabel:"b"},featuresConfig:Be,isFinished:e=>!1},Mn=()=>{const e=[];for(let t=0;t<10;t++){e.push({name:`b1_${t}`,min:-30,max:30,step:1});for(let n=0;n<2;n++)e.push({name:`w1_${t}_${n}`,min:-30,max:30,step:1})}e.push({name:"b2",min:-3,max:3,step:1});for(let t=0;t<10;t++)e.push({name:`w2_${t}`,min:-50,max:50,step:1});return e},Te={id:"double_layer_nonlinear",title:"Phase 5: Double Layer Nonlinear Data",description:'Spam-Erkennung mit einem Hidden Layer (10 Neuronen). Das Deep Neural Network kann die nicht-lineare Verteilung ("Spam-Insel") erkennen.',Model:vn,GroundTruth:ee,CanvasComponent:ne,defaultParams:{},getInput:e=>{const t=[50,0];return t.text="Live Input",t},generateData:e=>Xe(),trainingConfig:{seed:1319434789,maxSteps:1e4,params:Mn()},networkViz:{formula:"Deep Network",inputLabels:["Worte","Links"],outputLabel:"Spam?",biasLabel:"b"},featuresConfig:Be,isFinished:e=>e>=50},Pe={[be.id]:be,[ve.id]:ve,[Wt.id]:Wt,[Se.id]:Se,[Te.id]:Te};function kn(e){return Pe[e]||Pe.linear_regression}function ie(e){const[t,n]=rt(null),i=xt(null),o=xt(null),[r,c]=rt(0),[h,g]=rt(!1),[d,a]=rt([]),[u,_]=rt([]),[b,y]=rt(-1),[M,P]=rt(!1),[A,C]=rt("simulation"),[D,Y]=rt("table"),[j,W]=rt("random"),[k,f]=rt("Bereit."),N=xt(0);St(()=>{if(!e)return;if(e==="gallery"){n({id:"gallery",type:"gallery"});return}const v=kn(e);if(!v){f("Fehler: Simulation nicht gefunden.");return}try{if(i.current=new v.GroundTruth(...v.groundTruthDefaults||[]),o.current=new v.Model,v.defaultParams&&(v.defaultParams.weight!==void 0&&o.current.setWeight(v.defaultParams.weight),v.defaultParams.weights!==void 0&&o.current.setWeights&&o.current.setWeights(v.defaultParams.weights),v.defaultParams.bias!==void 0&&o.current.setBias(v.defaultParams.bias)),n(v),i.current)try{const L=v.generateData(i.current);a(L)}catch(L){console.error("Auto-generate data error:",L)}}catch(L){console.error("Initialization Error:",L),f(`Init Fehler: ${L.message}`)}},[e]),St(()=>{let v;const L=G=>{if(!h)return;N.current===0&&(N.current=G);const $=(G-N.current)/1e3;N.current=G;const U=Math.min($,.1);c(R=>{const x=R+U*3;return t&&t.isFinished&&t.isFinished(x)&&(g(!1),f("Simulation beendet.")),x}),v=requestAnimationFrame(L)};return h&&(N.current=0,v=requestAnimationFrame(L)),()=>cancelAnimationFrame(v)},[h,t]);const m=async()=>{try{if(d.length===0||!t)return;P(!0),y(0),_([]),f("Suche optimales Gewicht und Bias (Live Visualisierung)..."),C("training");const v=new t.Model,L=new fn(v),G=(U,R)=>{if(_(V=>{const x=[...V,...U];return y(x.length-1),x}),R&&R.message&&f(R.message),R&&R.bestParams){if(o.current.setParams)o.current.setParams(R.bestParams);else if(o.current.setWeights){const{weights:V,bias:x}=R.bestParams;o.current.setWeights(V),o.current.setBias(x)}}else R&&R.bestWeight!==void 0&&(o.current.setWeight(R.bestWeight),o.current.setBias(R.bestBias))};let $;if(j==="random"){f("Suche optimales Gewicht und Bias (Random Search)...");const U={seed:t.trainingConfig.seed,maxSteps:t.trainingConfig.maxSteps,initialRadius:t.trainingConfig.initialRadius,phase1Ratio:t.trainingConfig.phase1Ratio};$=await L.trainRandomAsync(d,t.trainingConfig.params,G,U)}else t.trainingConfig.params?$=await L.trainAsync(d,t.trainingConfig.params,G):$=await L.trainAsync(d,t.trainingConfig.weightRange,t.trainingConfig.biasRange,G);f(`Training fertig! Min Error: ${$.minError.toFixed(5)}`),P(!1)}catch(v){console.error("Training Error:",v),P(!1),f(`Fehler beim Training: ${v.message}`)}},p=()=>{c(0),g(!0),f("Simulation läuft..."),C("simulation")},w=()=>{if(g(!1),c(0),_([]),y(-1),t&&t.generateData&&i.current)try{const v=t.generateData(i.current);a(v),f("Reset durchgeführt & Daten neu generiert.")}catch(v){console.error("Regenerate Data Error:",v),a([])}else a([]),f("Reset durchgeführt.");try{o.current&&t?.defaultParams&&(t.defaultParams.weight!==void 0&&o.current.setWeight(t.defaultParams.weight),t.defaultParams.weights!==void 0&&o.current.setWeights&&o.current.setWeights(t.defaultParams.weights),t.defaultParams.bias!==void 0&&o.current.setBias(t.defaultParams.bias))}catch(v){console.error("Reset Error:",v)}},S=t&&t.getInput?t.getInput(r):void 0;return{simConfig:t,groundTruth:i,neuralNet:o,time:r,currentInput:S,isRunning:h,trainingData:d,trainingHistory:u,trainingStepIndex:b,isTraining:M,activeTab:A,dataViewMode:D,trainerType:j,statusMsg:k,handleTrain:m,handleRun:p,handleReset:w,setTrainerType:W,setActiveTab:C,setDataViewMode:Y}}function Sn({history:e,currentStepIndex:t,isTraining:n,paramsConfig:i}){const o=xt(null),[r,c]=rt(0),h=6;St(()=>{c(0)},[i]),St(()=>{const d=o.current;if(!d||!e||e.length===0)return;const a=d.getContext("2d"),u=d.width,_=d.height;a.clearRect(0,0,u,_),a.fillStyle="#fff",a.fillRect(0,0,u,_);const b=Math.max(...e.map(W=>W.error)),M=!n&&e.length>0?e.length-1:t!==null&&t>=0?Math.min(t,e.length-1):-1;let P=-1,A=1/0;for(let W=0;W<=M;W++)e[W].error<A&&(A=e[W].error,P=W);let C=[];if(i){const W=1+i.length,k=r*h,f=Math.min(k+h,W),N=3,m=2,p=u/N,w=_/m;for(let S=k;S<f;S++){const v=S-k,L=v%N,G=Math.floor(v/N),$=L*p,U=G*w;if(S===0){const R=Math.max(10,e.length-1);C.push({type:"accuracy_step",xLabel:"Training Step",xMin:0,xMax:R,yMode:"accuracy",getValue:(V,x)=>x,getYValue:V=>V.accuracy||0,offsetX:$,offsetY:U,w:p,h:w,showYAxis:!0})}else if(S===1){const R=Math.max(10,e.length-1);C.push({type:"error_step",xLabel:"Training Step",xMin:0,xMax:R,yMode:"error_log",getValue:(V,x)=>x,getYValue:V=>V.error,offsetX:$,offsetY:U,w:p,h:w,showYAxis:!0})}else{const R=S-2,V=i[R],x=e.map(q=>q.params[R]),s=Math.min(...x),K=Math.max(...x);C.push({type:"param_error",xLabel:V.name,xMin:s,xMax:K,yMode:"error_log",getValue:q=>q.params[R],getYValue:q=>q.error,offsetX:$,offsetY:U,w:p,h:w})}}}else{const W=u/2,k=_/2,f=e.map(p=>p.weight),N=e.map(p=>p.bias),m=Math.max(10,e.length-1);C=[{type:"accuracy_step",xLabel:"Accuracy",xMin:0,xMax:m,yMode:"accuracy",getValue:(p,w)=>w,getYValue:p=>p.accuracy||0,offsetX:0,offsetY:0,w:W,h:k,showYAxis:!0},{type:"error_step",xLabel:"Step",xMin:0,xMax:m,yMode:"error_log",getValue:(p,w)=>w,getYValue:p=>p.error,offsetX:W,offsetY:0,w:W,h:k,showYAxis:!0},{xLabel:"Weight",xMin:Math.min(...f),xMax:Math.max(...f),yMode:"error_log",getValue:p=>p.weight,getYValue:p=>p.error,offsetX:0,offsetY:k,w:W,h:k},{xLabel:"Bias",xMin:Math.min(...N),xMax:Math.max(...N),yMode:"error_log",getValue:p=>p.bias,getYValue:p=>p.error,offsetX:W,offsetY:k,w:W,h:k}]}const D=50;C.forEach(W=>{const{xLabel:k,xMin:f,xMax:N,getValue:m,getYValue:p,offsetX:w,offsetY:S,w:v,h:L,yMode:G,showYAxis:$}=W,U=x=>w+D+(x-f)/(N-f||1)*(v-2*D);let R;if(G==="accuracy")R=x=>S+L-D-x*(L-2*D);else{const s=b||1;R=K=>{const q=(K-0)/(s-0);return S+L-D-q*(L-2*D)}}a.strokeStyle="#eee",a.lineWidth=2,a.strokeRect(w,S,v,L),a.beginPath(),a.strokeStyle="#333",a.lineWidth=2,a.moveTo(w+D,S+D),a.lineTo(w+D,S+L-D),a.lineTo(w+v-D,S+L-D),a.stroke(),a.fillStyle="#333",a.font="22px sans-serif",a.textAlign="center";let V=k;if(V.length>20&&(V=V.substring(0,18)+"..."),a.fillText(V,w+v/2,S+L-15),w===0||$)if(a.save(),a.translate(w+15,S+L/2),a.rotate(-Math.PI/2),G==="accuracy")a.fillText("Accuracy",0,0),a.restore(),a.textAlign="right",a.fillStyle="#666",a.font="18px sans-serif",[0,.25,.5,.75,1].forEach(x=>{const s=R(x);a.fillText(x.toFixed(2),w+D-8,s+6),a.beginPath(),a.lineWidth=1,a.strokeStyle="#f0f0f0",a.moveTo(w+D,s),a.lineTo(w+v-D,s),a.stroke()});else{a.fillText("Error",0,0),a.restore(),a.textAlign="right",a.fillStyle="#666",a.font="18px sans-serif";const x=5;for(let s=0;s<=x;s++){const K=s/x*b,q=R(K);a.fillText(K.toFixed(2),w+D-8,q+6),s>0&&(a.beginPath(),a.lineWidth=1,a.strokeStyle="#f0f0f0",a.moveTo(w+D,q),a.lineTo(w+v-D,q),a.stroke())}}a.fillStyle="#666",a.font="18px sans-serif",a.textAlign="center",a.fillText(f.toFixed(1),w+D,S+L-D+25),a.fillText(N.toFixed(1),w+v-D,S+L-D+25),a.fillStyle=G==="accuracy"?"rgba(155, 89, 182, 0.4)":"rgba(52, 152, 219, 0.4)";for(let x=0;x<=M;x++){const s=m(e[x],x),K=p(e[x]),q=U(s),lt=R(K);a.fillRect(q,lt,4,4)}if(P>=0){const x=m(e[P],P),s=p(e[P]),K=U(x),q=R(s);a.beginPath(),a.fillStyle="#2ecc71",a.strokeStyle="#27ae60",a.lineWidth=2,a.arc(K,q,10,0,Math.PI*2),a.fill(),a.stroke()}if(n&&t!==null&&t>=0&&t<=M){const x=m(e[t],t),s=p(e[t]),K=U(x),q=R(s);a.beginPath(),a.fillStyle="#e74c3c",a.strokeStyle="#c0392b",a.lineWidth=2,a.arc(K,q,8,0,Math.PI*2),a.fill(),a.stroke()}});const Y=u-150,j=20;a.fillStyle="rgba(255,255,255,0.9)",a.fillRect(Y,j,140,70),a.strokeStyle="#ccc",a.lineWidth=1,a.strokeRect(Y,j,140,70),a.textAlign="left",a.font="16px sans-serif",a.beginPath(),a.fillStyle="#e74c3c",a.arc(Y+15,j+20,6,0,Math.PI*2),a.fill(),a.fillStyle="#333",a.fillText("Current Scan",Y+30,j+25),a.beginPath(),a.fillStyle="#2ecc71",a.arc(Y+15,j+50,6,0,Math.PI*2),a.fill(),a.fillStyle="#333",a.fillText("Best So Far",Y+30,j+55),!n&&P>=0&&(a.fillStyle="#333",a.font="bold 18px sans-serif",a.textAlign="right",a.fillText(`Min Error: ${A.toFixed(5)}`,u-20,_-20))},[e,t,n,i,r]);const g=i?Math.ceil((i.length+1)/h):1;return l("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff"},children:[l("canvas",{ref:o,width:1600,height:800,style:{width:"100%",height:"auto"}}),g>1&&l("div",{style:{display:"flex",justifyContent:"center",marginTop:"10px",gap:"10px"},children:[l("button",{onClick:()=>c(d=>Math.max(0,d-1)),disabled:r===0,children:"Previous"}),l("span",{style:{alignSelf:"center"},children:["Page ",r+1," of ",g]}),l("button",{onClick:()=>c(d=>Math.min(g-1,d+1)),disabled:r===g-1,children:"Next"})]})]})}function Tn({model:e,inputs:t,inputLabels:n,output:i,outputLabel:o}){if(!e||!e.getTopology)return null;const{inputCount:r,hiddenCounts:c,outputCount:h,weights1:g,biases1:d,weights2:a}=e.getTopology();let u={hidden:[],output:[]};e.getActivations&&(u=e.getActivations(t));const _=600,b=400,y=b/2,M=_/2,P=350,A=280,C=M-P/2,D=M+P/2,Y=[{count:r,x:C,labels:n,values:t},{count:c[0],x:M,values:u.hidden},{count:h,x:D,labels:[o],values:u.output}],j=Math.max(...Y.map(m=>m.count)),W=Math.min(50,A/j),k=(m,p)=>{const S=(Y[m].count-1)*W;return y-S/2+p*W},f=m=>{const p=Math.max(.2,Math.min(.8,Math.abs(m)/2));return m>0?`rgba(46, 204, 113, ${p})`:`rgba(231, 76, 60, ${p})`},N=m=>{const p=Math.max(0,Math.min(1,m)),w=Math.round(255+-203*p),S=Math.round(255+-103*p),v=Math.round(255+-36*p);return`rgb(${w},${S},${v})`};return l("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center"},children:[l("h3",{style:{marginBottom:"10px",fontSize:"1rem",color:"#555"},children:"Neural Network Activity"}),l("svg",{width:_,height:b,style:{overflow:"visible"},children:[l("rect",{x:C,y:y-A/2,width:P,height:A,rx:"15",fill:"none",stroke:"#333",strokeWidth:"3",strokeDasharray:"5,5"}),l("text",{x:M,y:y-A/2+20,textAnchor:"middle",fill:"#777",fontSize:"12",fontWeight:"bold",children:"NEURAL NETWORK"}),g.map((m,p)=>m.map((w,S)=>l("line",{x1:Y[0].x,y1:k(0,S),x2:Y[1].x,y2:k(1,p),stroke:f(w),strokeWidth:Math.max(1,Math.min(4,Math.abs(w)))},`L0-${S}-${p}`))),a.map((m,p)=>l("line",{x1:Y[1].x,y1:k(1,p),x2:Y[2].x,y2:k(2,0),stroke:f(m),strokeWidth:Math.max(1,Math.min(4,Math.abs(m)))},`L1-${p}-0`)),Y.map((m,p)=>l("g",{children:Array.from({length:m.count}).map((w,S)=>{const v=m.x,L=k(p,S),G=m.values&&m.values[S]!==void 0?m.values[S]:0;return l("g",{children:[l("circle",{cx:v,cy:L,r:12,fill:N(G),stroke:"#333",strokeWidth:"1.5"}),m.labels&&l("text",{x:p===0?v-30:v+30,y:L,textAnchor:p===0?"end":"start",dominantBaseline:"middle",fontSize:"13",fontWeight:"bold",fill:"#333",children:m.labels[S]||""}),l("title",{children:G.toFixed(3)})]},`n-${p}-${S}`)})},`layer-${p}`)),l("g",{transform:`translate(${_-100}, ${b-50})`,children:[l("rect",{width:"90",height:"40",fill:"white",stroke:"#ccc",rx:"4"}),l("line",{x1:"10",y1:"10",x2:"30",y2:"10",stroke:"#2ecc71",strokeWidth:"3"}),l("text",{x:"35",y:"14",fontSize:"10",children:"Positive"}),l("line",{x1:"10",y1:"28",x2:"30",y2:"28",stroke:"#e74c3c",strokeWidth:"3"}),l("text",{x:"35",y:"32",fontSize:"10",children:"Negative"})]})]})]})}function Ge({input:e,weight:t,bias:n,output:i,formula:o="y = w * x + b",inputLabel:r="Input",outputLabel:c="Output",biasLabel:h="b",decimals:g=1,model:d=null}){if(d&&d.getTopology){let $=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&($=e.input);const U=Array.isArray($)?$:[$],R=Array.isArray(r)?r:[r];return l(Tn,{model:d,inputs:U,inputLabels:R,output:i,outputLabel:c})}let a=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(a=e.input);const u=Array.isArray(a)?a:[a],_=Array.isArray(t)?t:[t],b=Array.isArray(r)?r:[r],y=Number(n)||0,M=Number(i)||0,P=u.length,A=24,C=90,D=300,Y=60,j=60,W=Math.max(1,P-1)*C,k=Math.max(150,W+Y+j),f=k+60,N=600,m=N/2,p=m-D/2,w=m+D/2,S=k/2+20,v=S-W/2,L=w-50,G=L-60;return l("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[l("h3",{style:{marginBottom:"10px"},children:"Modell Architektur"}),l("svg",{width:N,height:f,style:{overflow:"visible"},children:[l("defs",{children:l("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"27",refY:"3.5",orient:"auto",children:l("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#333"})})}),l("rect",{x:p,y:20,width:D,height:k,rx:"15",fill:"none",stroke:"#333",strokeWidth:"3",strokeDasharray:"5,5"}),l("text",{x:m,y:40,textAnchor:"middle",fill:"#777",fontSize:"12",fontWeight:"bold",children:"NEURAL NETWORK"}),(()=>{const $=S-50;return l(Pt,{children:[u.map((U,R)=>{const V=P>1?v+R*C:S,x=Number(_[R])||0,s=b[R]||`x${R+1}`,K=Number(U)||0;return l("g",{children:[l("line",{x1:p,y1:V,x2:G,y2:S,stroke:"#999",strokeWidth:"1"}),l("g",{transform:`translate(${(p+G)/2+(R-(P-1)/2)*5}, ${(V+S)/2})`,children:[l("rect",{x:"-24",y:"-9",width:"50",height:"18",fill:"#fff",rx:"4",stroke:"#e0e0e0"}),l("text",{x:"0",y:"4",textAnchor:"middle",fill:"#e74c3c",fontSize:"10",fontWeight:"bold",children:x.toFixed(1)})]}),l("circle",{cx:p,cy:V,r:A,fill:"#fff",stroke:"#333",strokeWidth:"2"}),l("text",{x:p-40,y:V,textAnchor:"end",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",children:s}),l("text",{x:p,y:V,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fill:"#333",children:K.toFixed(g)})]},R)}),l("line",{x1:G,y1:S,x2:L,y2:S,stroke:"#333",strokeWidth:"2"}),l("g",{transform:`translate(${L}, ${S})`,children:[l("rect",{x:"-18",y:"-18",width:"36",height:"36",rx:"6",fill:"#fff",stroke:"#333",strokeWidth:"2"}),l("path",{d:"M -10 8 C -4 8, -4 -8, 10 -8",stroke:"#333",strokeWidth:"2",fill:"none"})]}),l("line",{x1:L+18,y1:S,x2:w-A,y2:S,stroke:"#333",strokeWidth:"2"}),l("path",{d:`M ${L-20} ${$} Q ${L-20} ${S} ${G+10} ${S}`,fill:"none",stroke:"#f39c12",strokeWidth:"1",markerEnd:"url(#arrowhead)"}),l("circle",{cx:L-20,cy:$,r:12,fill:"#f1c40f",stroke:"#f39c12"}),l("text",{x:L-23,y:$+5,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fontWeight:"bold",fill:"#fff",children:"b"}),l("text",{x:L-5,y:$+5,textAnchor:"start",dominantBaseline:"middle",fontSize:"12",fill:"#f39c12",fontWeight:"bold",children:y.toFixed(2)})]})})(),l("circle",{cx:w,cy:S,r:A,fill:"#fff",stroke:"#333",strokeWidth:"2"}),l("text",{x:w-14,y:S+4,textAnchor:"middle",dominantBaseline:"middle",fontWeight:"bold",fontSize:"12",children:M.toFixed(2)}),l("text",{x:w+40,y:S+4,textAnchor:"start",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:c}),l("text",{x:m,y:f-15,textAnchor:"middle",fontSize:"12",fontStyle:"italic",fill:"#777",children:o})]})]})}function Pn({onTrain:e,onRun:t,onReset:n,isTraining:i,trainingStep:o,dataCount:r,trainerType:c,onTrainerTypeChange:h}){return l("div",{role:"region","aria-label":"Steuerung",style:{padding:"20px",background:"#eee",borderRadius:"8px",display:"flex",gap:"10px",flexWrap:"wrap",alignItems:"center"},children:[l("span",{"aria-live":"polite",children:["Datenpunkte: ",r]}),l("div",{style:{borderLeft:"1px solid #ccc",paddingLeft:"10px",marginLeft:"10px",display:"flex",gap:"5px",alignItems:"center"},children:[l("select",{value:c,onChange:g=>h(g.target.value),disabled:i,style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[l("option",{value:"exhaustive",children:"Grid Search "}),l("option",{value:"random",children:"Adaptive Random "})]}),l("button",{onClick:e,disabled:i||r===0,"aria-busy":i,children:i?"Suche läuft...":"2. Trainieren"})]}),l("button",{onClick:t,disabled:i,children:"3. Simulation Starten"}),l("button",{onClick:n,style:{marginLeft:"auto",background:"#e74c3c",color:"white"},"aria-label":"Simulation zurücksetzen",children:"Reset"})]})}function re({hookState:e,renderSimulationView:t,renderDataView:n,networkVizProps:i={}}){const{simConfig:o,activeTab:r,setActiveTab:c,trainingHistory:h,trainingStepIndex:g,isTraining:d,dataViewMode:a,setDataViewMode:u,trainingData:_,groundTruth:b,neuralNet:y,time:M,statusMsg:P,handleTrain:A,handleRun:C,handleReset:D,trainerType:Y,setTrainerType:j,currentInput:W}=e,[k,f]=rt(null),N=v=>{f(L=>L===v?null:v)},m={position:"absolute",top:"10px",right:"10px",zIndex:10,background:"rgba(255, 255, 255, 0.9)",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"0px"},p="all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",w=W!==void 0?W:o.getInput?o.getInput(M):M,S=o.networkViz||{};return l("div",{className:"layout-container",style:{display:"flex",flexDirection:"column",height:"100%"},children:[l("div",{className:"top-section",style:{display:"flex",gap:k?"0px":"20px",flexWrap:"nowrap",alignItems:"stretch",height:k?"calc(100vh - 200px)":"auto",minHeight:"500px",transition:p,marginBottom:"20px"},children:[l("div",{className:"simulation-wrapper",style:{flex:k==="simulation"?"1 0 100%":k==="network"?"0 0 0%":"1 1 500px",opacity:k==="network"?0:1,overflow:"hidden",maxWidth:k==="network"?"0px":"100%",transition:p,position:"relative",display:"flex",flexDirection:"column"},children:[l("button",{onClick:()=>N("simulation"),style:m,title:k==="simulation"?"Originalgröße":"Maximieren",children:k==="simulation"?l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M4 14h6v6"}),l("path",{d:"M20 10h-6V4"}),l("path",{d:"M14 10l7-7"}),l("path",{d:"M3 21l7-7"})]}):l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M15 3h6v6"}),l("path",{d:"M9 21H3v-6"}),l("path",{d:"M21 3l-7 7"}),l("path",{d:"M3 21l7-7"})]})}),l("div",{className:"simulation-section",style:{height:"100%",display:"flex",flexDirection:"column"},children:[l("div",{className:"tabs",style:{paddingRight:"120px"},children:[l("button",{className:`tab-button ${r==="simulation"?"active":""}`,onClick:()=>c("simulation"),children:"Simulation"}),l("button",{className:`tab-button ${r==="data"?"active":""}`,onClick:()=>c("data"),children:"Daten"}),l("button",{className:`tab-button ${r==="training"?"active":""}`,onClick:()=>c("training"),children:"Training"})]}),l("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[r==="simulation"&&l(Pt,{children:[t(),l("div",{className:"stats",style:{marginTop:"auto",paddingTop:"10px"},children:[l("p",{children:o.description}),l("p",{style:{color:"#646cff",fontWeight:"bold"},children:["Status: ",P]})]})]}),r==="data"&&l("div",{className:"data-content",style:{flex:1,overflowY:"auto"},children:[!["gallery"].includes(o.id)&&l("div",{style:{display:"flex",justifyContent:"center",marginBottom:"15px"},children:l("div",{style:{background:"#eee",borderRadius:"4px",padding:"2px",display:"flex",gap:"2px"},children:[l("button",{onClick:()=>u("table"),style:{background:a==="table"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:a==="table"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:a==="table"?"bold":"normal",color:a==="table"?"#333":"#666"},children:"Tabelle"}),l("button",{onClick:()=>u("plot"),style:{background:a==="plot"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:a==="plot"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:a==="plot"?"bold":"normal",color:a==="plot"?"#333":"#666"},children:"Graph"})]})}),a==="plot"&&l("div",{style:{marginBottom:"20px"},children:n?n():l("p",{children:"Kein Graph verfügbar."})}),a==="table"&&l(Pt,{children:_.length>0?l("div",{style:{maxHeight:k?"calc(100vh - 350px)":"400px",overflowY:"auto"},children:l("table",{style:{width:"100%",textAlign:"left",borderCollapse:"collapse",fontSize:"0.9rem"},children:[l("thead",{children:l("tr",{style:{background:"#eee",borderBottom:"2px solid #ddd"},children:[Array.isArray(S.inputLabels)?S.inputLabels.map((v,L)=>l("th",{style:{padding:"8px"},children:v},L)):l("th",{style:{padding:"8px"},children:["Input (",S.inputLabel,")"]}),l("th",{style:{padding:"8px"},children:"Target"}),_.length>0&&_[0].text&&l("th",{style:{padding:"8px"},children:"E-Mail Text"})]})}),l("tbody",{children:_.map((v,L)=>{const G=["spam","spam_advanced","spam_hidden","spam_nonlinear"].includes(o.id);let $="transparent",U=v.target,R={padding:"8px"};if(G){const V=v.target===1;$=V?"#ffebee":"#e8f5e9",U=V?"SPAM":"HAM",R={...R,fontWeight:"bold",color:V?"#c0392b":"#27ae60"}}else U=typeof v.target=="number"?v.target.toFixed(2):v.target;return l("tr",{style:{background:$,borderBottom:"1px solid #ddd"},children:[Array.isArray(v.input)?v.input.map((V,x)=>l("td",{style:{padding:"8px"},children:V.toFixed(0)},x)):l("td",{style:{padding:"8px"},children:v.input.toFixed(2)}),l("td",{style:R,children:U}),v.text&&l("td",{style:{padding:"8px",color:"#555",fontStyle:"italic",maxWidth:"300px"},children:v.text})]},L)})})]})}):l("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Noch keine Trainingsdaten generiert."})})]}),r==="training"&&l("div",{className:"training-content",style:{flex:1},children:h.length>0?l(Sn,{history:h,currentStepIndex:g,isTraining:d,paramsConfig:o.trainingConfig.params}):l("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"Noch kein Training gestartet."})})]})]})]}),l("div",{className:"network-wrapper",style:{flex:k==="network"?"1 0 100%":k==="simulation"?"0 0 0%":`0 0 ${o.id==="spam_hidden"?"500px":"350px"}`,opacity:k==="simulation"?0:1,overflow:"hidden",maxWidth:k==="simulation"?"0px":"100%",transition:p,position:"relative",display:"flex",flexDirection:"column"},children:[l("button",{onClick:()=>N("network"),style:m,title:k==="network"?"Originalgröße":"Maximieren",children:k==="network"?l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M4 14h6v6"}),l("path",{d:"M20 10h-6V4"}),l("path",{d:"M14 10l7-7"}),l("path",{d:"M3 21l7-7"})]}):l("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l("path",{d:"M15 3h6v6"}),l("path",{d:"M9 21H3v-6"}),l("path",{d:"M21 3l-7 7"}),l("path",{d:"M3 21l7-7"})]})}),l("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:l(Ge,{input:w,weight:y.current?y.current.weights||y.current.weight:0,bias:y.current?y.current.bias:0,output:y.current?y.current.predict(w):0,model:y.current,formula:S.formula,inputLabel:S.inputLabels||S.inputLabel,outputLabel:S.outputLabel,biasLabel:S.biasLabel,decimals:o.id.includes("spam")?0:1})})]})]}),l(Pn,{onTrain:A,onRun:C,onReset:D,isTraining:d,trainingStep:g,dataCount:_.length,trainerType:Y,onTrainerTypeChange:j,simConfig:o})]})}function Cn({data:e,groundTruth:t,neuralNet:n}){const i=xt(null);return St(()=>{const o=i.current;if(!o)return;const r=o.getContext("2d"),c=o.width,h=o.height;if(r.clearRect(0,0,c,h),!e||e.length===0){r.fillStyle="#999",r.textAlign="center",r.fillText("Keine Daten vorhanden",c/2,h/2);return}const g=40,d=c-2*g,a=h-2*g,u=Math.max(...e.map(M=>M.input))||10,_=Math.max(...e.map(M=>M.target))||100,b=M=>g+M/u*d,y=M=>h-g-M/_*a;if(r.beginPath(),r.strokeStyle="#333",r.moveTo(g,g),r.lineTo(g,h-g),r.lineTo(c-g,h-g),r.stroke(),r.fillStyle="#333",r.textAlign="center",r.fillText("Zeit (t)",c/2,h-10),r.save(),r.translate(15,h/2),r.rotate(-Math.PI/2),r.fillText("Position (s)",0,0),r.restore(),e.forEach(M=>{const P=b(M.input),A=y(M.target);r.beginPath(),r.arc(P,A,3,0,Math.PI*2),r.fillStyle="#2ecc71",r.fill()}),n){r.beginPath(),r.strokeStyle="#e74c3c",r.lineWidth=2;for(let M=0;M<=u;M+=.1){const P=n.predict(M),A=b(M),C=y(P);M===0?r.moveTo(A,C):r.lineTo(A,C)}r.stroke()}},[e,t,n]),l("div",{style:{border:"1px solid #ccc",margin:"10px 0",borderRadius:"4px"},children:l("canvas",{ref:i,width:600,height:300,style:{width:"100%",display:"block"}})})}function An(){const e=ie("linear_regression"),{simConfig:t,trainingData:n,groundTruth:i,trainingHistory:o,neuralNet:r,time:c,currentInput:h}=e;if(!t)return l("div",{className:"loading",children:"Lade Simulation..."});const g=t.CanvasComponent;return l(re,{hookState:e,renderSimulationView:()=>{let u=0;try{if(r.current){const _=h!==void 0?h:c;u=r.current.predict(_)}}catch(_){console.error("Predict Error",_)}return l("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:l(g,{time:c,data:n,currentInput:h!==void 0?h:c,currentPrediction:u,groundTruth:i.current,neuralNet:r.current})})},renderDataView:()=>l(Cn,{data:n,groundTruth:i.current,neuralNet:o.length>0?r.current:null})})}function Wn(){const e=ie("logistic_regression"),{simConfig:t,trainingData:n,groundTruth:i,trainingHistory:o,neuralNet:r}=e;if(!t)return l("div",{className:"loading",children:"Lade Simulation..."});const c=t.CanvasComponent;return l(re,{hookState:e,renderSimulationView:()=>l("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",border:"2px dashed #ddd",borderRadius:"8px",minHeight:"300px"},children:l("p",{style:{color:"#999"},children:'Daten-Visualisierung jetzt im "Daten" Tab'})}),renderDataView:()=>{const d={staticMode:!0,showGroundTruth:!0,showModel:o.length>0};return t.featuresConfig&&(d.features=t.featuresConfig),l(c,{time:0,data:n,groundTruth:i.current,neuralNet:r.current,...d})}})}function oe({simId:e}){const t=ie(e),{simConfig:n,trainingData:i,groundTruth:o,trainingHistory:r,neuralNet:c,time:h,currentInput:g,dataViewMode:d,setDataViewMode:a}=t;if(!n)return l("div",{className:"loading",children:"Lade Simulation..."});const u=n.CanvasComponent,_=l("div",{style:{display:"flex",justifyContent:"center"},children:l("div",{style:{background:"#eee",borderRadius:"4px",padding:"2px",display:"flex",gap:"2px"},children:[l("button",{onClick:()=>a("table"),style:{background:d==="table"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:d==="table"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:d==="table"?"bold":"normal",color:d==="table"?"#333":"#666"},children:"Tabelle"}),l("button",{onClick:()=>a("plot"),style:{background:d==="plot"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:d==="plot"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:d==="plot"?"bold":"normal",color:d==="plot"?"#333":"#666"},children:"Graph"})]})});return l(re,{hookState:t,renderSimulationView:()=>{let M=0;try{c.current&&g&&(M=c.current.predict(g))}catch(A){console.error("Predict Error",A)}const P={allowedModes:["text"],hideControls:!0,features:n.featuresConfig};return l("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:l(u,{time:h,data:i,currentInput:g,currentPrediction:M,groundTruth:o.current,neuralNet:c.current,...P})})},renderDataView:()=>{const M={allowedModes:["scatter","3d","features"],showModel:r.length>0,additionalControls:_,features:n.featuresConfig};return l(u,{time:0,data:i,groundTruth:o.current,neuralNet:c.current,...M})}})}function Ln(){return l(oe,{simId:"multiple_inputs"})}function Rn(){return l(oe,{simId:"single_layer_nonlinear"})}function zn(){return l(oe,{simId:"double_layer_nonlinear"})}function Dn(){const[e,t]=rt(0),n=[{name:"Simple Perceptron",input:.5,weight:.8,bias:.2,output:.6,inputLabel:"Input",formula:"y = w * x + b"},{name:"Spam Filter (2 Inputs)",input:[1,0],weight:[.5,-.2],bias:.1,output:.8,inputLabel:["Spam Word","Suspicious Link"],formula:"y = w1*x1 + w2*x2 + b"},{name:"Complex Model (5 Inputs)",input:[1,.5,-1,0,.2],weight:[.1,.2,.3,.4,.5],bias:-.5,output:.1,inputLabel:["F1","F2","F3","F4","F5"],formula:"y = Σ(wi*xi) + b"},{name:"Many Inputs (8 Inputs)",input:[1,0,1,0,1,0,1,0],weight:[.1,-.1,.1,-.1,.1,-.1,.1,-.1],bias:0,output:.5,inputLabel:["I1","I2","I3","I4","I5","I6","I7","I8"],formula:"y = ... "}],i=n[e];return l("div",{style:{padding:"20px"},children:[l("h2",{children:"Architecture Gallery"}),l("div",{style:{marginBottom:"20px"},children:[l("button",{onClick:()=>t((e-1+n.length)%n.length),children:"Previous"}),l("span",{style:{margin:"0 10px"},children:[i.name," (",e+1,"/",n.length,")"]}),l("button",{onClick:()=>t((e+1)%n.length),children:"Next"})]}),l("div",{style:{width:"400px",border:"1px dashed #ccc",padding:"10px"},children:l(Ge,{input:i.input,weight:i.weight,bias:i.bias,output:i.output,formula:i.formula,inputLabel:i.inputLabel})})]})}function $n(){const[e,t]=rt(null);return St(()=>{const o=new URLSearchParams(window.location.search).get("sim")||"linear_regression";t(o)},[]),e?e==="gallery"?l("div",{className:"container",children:[l("header",{children:[l("h1",{children:"Neural Network Demonstrator"}),l("p",{children:"Architecture Gallery (Debug)"}),l("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:l("a",{href:"?sim=linear_regression",style:{marginRight:"10px"},children:"Back to App"})})]}),l("main",{children:l(Dn,{})})]}):l("div",{className:"container",children:[l("header",{children:[l("h1",{children:"Neural Network Demonstrator"}),l("p",{children:(i=>{switch(i){case"linear_regression":return"Phase 1: Linear Regression";case"logistic_regression":return"Phase 2: Logistic Regression";case"multiple_inputs":return"Phase 3: Multiple Inputs";case"single_layer_nonlinear":return"Phase 4: Single Layer Nonlinear Data";case"double_layer_nonlinear":return"Phase 5: Double Layer Nonlinear Data";default:return"Neural Network Demonstrator"}})(e)}),l("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:[l("a",{href:"?sim=linear_regression",style:{marginRight:"10px",fontWeight:e==="linear_regression"?"bold":"normal"},children:"Phase 1 (Linear)"}),l("a",{href:"?sim=logistic_regression",style:{marginRight:"10px",fontWeight:e==="logistic_regression"?"bold":"normal"},children:"Phase 2 (Logistic)"}),l("a",{href:"?sim=multiple_inputs",style:{marginRight:"10px",fontWeight:e==="multiple_inputs"?"bold":"normal"},children:"Phase 3 (Multi)"}),l("a",{href:"?sim=single_layer_nonlinear",style:{marginRight:"10px",fontWeight:e==="single_layer_nonlinear"?"bold":"normal"},children:"Phase 4 (Nonlinear 1)"}),l("a",{href:"?sim=double_layer_nonlinear",style:{fontWeight:e==="double_layer_nonlinear"?"bold":"normal"},children:"Phase 5 (Nonlinear 2)"})]})]}),l("main",{style:{height:"100%"},children:[e==="linear_regression"&&l(An,{}),e==="logistic_regression"&&l(Wn,{}),e==="multiple_inputs"&&l(Ln,{}),e==="single_layer_nonlinear"&&l(Rn,{}),e==="double_layer_nonlinear"&&l(zn,{})]})]}):l("div",{children:"Lade App..."})}sn(l($n,{}),document.getElementById("app"));
