(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var Gt,Z,Ue,Wt,xe,je,Ge,qe,se,te,ee,$t={},Ke=[],bn=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Nt=Array.isArray;function Ct(e,t){for(var n in t)e[n]=t[n];return e}function ae(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ne(e,t,n){var i,r,o,c={};for(o in t)o=="key"?i=t[o]:o=="ref"?r=t[o]:c[o]=t[o];if(arguments.length>2&&(c.children=arguments.length>3?Gt.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)c[o]===void 0&&(c[o]=e.defaultProps[o]);return Ht(e,c,i,r,null)}function Ht(e,t,n,i,r){var o={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++Ue,__i:-1,__u:0};return r==null&&Z.vnode!=null&&Z.vnode(o),o}function xt(e){return e.children}function Pt(e,t){this.props=e,this.context=t}function Dt(e,t){if(t==null)return e.__?Dt(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Dt(e):null}function Ze(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Ze(e)}}function ye(e){(!e.__d&&(e.__d=!0)&&Wt.push(e)&&!Ft.__r++||xe!=Z.debounceRendering)&&((xe=Z.debounceRendering)||je)(Ft)}function Ft(){for(var e,t,n,i,r,o,c,h=1;Wt.length;)Wt.length>h&&Wt.sort(Ge),e=Wt.shift(),h=Wt.length,e.__d&&(n=void 0,i=void 0,r=(i=(t=e).__v).__e,o=[],c=[],t.__P&&((n=Ct({},i)).__v=i.__v+1,Z.vnode&&Z.vnode(n),le(t.__P,n,i,t.__n,t.__P.namespaceURI,32&i.__u?[r]:null,o,r??Dt(i),!!(32&i.__u),c),n.__v=i.__v,n.__.__k[n.__i]=n,tn(o,n,c),i.__e=i.__=null,n.__e!=r&&Ze(n)));Ft.__r=0}function Je(e,t,n,i,r,o,c,h,f,d,g){var l,x,p,_,y,w,C,D=i&&i.__k||Ke,X=t.length;for(f=vn(n,t,D,f,X),l=0;l<X;l++)(p=n.__k[l])!=null&&(x=p.__i==-1?$t:D[p.__i]||$t,p.__i=l,w=le(e,p,x,r,o,c,h,f,d,g),_=p.__e,p.ref&&x.ref!=p.ref&&(x.ref&&ce(x.ref,null,p),g.push(p.ref,p.__c||_,p)),y==null&&_!=null&&(y=_),(C=!!(4&p.__u))||x.__k===p.__k?f=Qe(p,f,e,C):typeof p.type=="function"&&w!==void 0?f=w:_&&(f=_.nextSibling),p.__u&=-7);return n.__e=y,f}function vn(e,t,n,i,r){var o,c,h,f,d,g=n.length,l=g,x=0;for(e.__k=new Array(r),o=0;o<r;o++)(c=t[o])!=null&&typeof c!="boolean"&&typeof c!="function"?(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?c=e.__k[o]=Ht(null,c,null,null,null):Nt(c)?c=e.__k[o]=Ht(xt,{children:c},null,null,null):c.constructor==null&&c.__b>0?c=e.__k[o]=Ht(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):e.__k[o]=c,f=o+x,c.__=e,c.__b=e.__b+1,h=null,(d=c.__i=wn(c,n,f,l))!=-1&&(l--,(h=n[d])&&(h.__u|=2)),h==null||h.__v==null?(d==-1&&(r>g?x--:r<g&&x++),typeof c.type!="function"&&(c.__u|=4)):d!=f&&(d==f-1?x--:d==f+1?x++:(d>f?x--:x++,c.__u|=4))):e.__k[o]=null;if(l)for(o=0;o<g;o++)(h=n[o])!=null&&(2&h.__u)==0&&(h.__e==i&&(i=Dt(h)),nn(h,h));return i}function Qe(e,t,n,i){var r,o;if(typeof e.type=="function"){for(r=e.__k,o=0;r&&o<r.length;o++)r[o]&&(r[o].__=e,t=Qe(r[o],t,n,i));return t}e.__e!=t&&(i&&(t&&e.type&&!t.parentNode&&(t=Dt(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Xt(e,t){return t=t||[],e==null||typeof e=="boolean"||(Nt(e)?e.some(function(n){Xt(n,t)}):t.push(e)),t}function wn(e,t,n,i){var r,o,c,h=e.key,f=e.type,d=t[n],g=d!=null&&(2&d.__u)==0;if(d===null&&h==null||g&&h==d.key&&f==d.type)return n;if(i>(g?1:0)){for(r=n-1,o=n+1;r>=0||o<t.length;)if((d=t[c=r>=0?r--:o++])!=null&&(2&d.__u)==0&&h==d.key&&f==d.type)return c}return-1}function be(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||bn.test(t)?n:n+"px"}function Vt(e,t,n,i,r){var o,c;t:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||be(e.style,t,"");if(n)for(t in n)i&&n[t]==i[t]||be(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")o=t!=(t=t.replace(qe,"$1")),c=t.toLowerCase(),t=c in e||t=="onFocusOut"||t=="onFocusIn"?c.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?i?n.u=i.u:(n.u=se,e.addEventListener(t,o?ee:te,o)):e.removeEventListener(t,o?ee:te,o);else{if(r=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function ve(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=se++;else if(t.t<n.u)return;return n(Z.event?Z.event(t):t)}}}function le(e,t,n,i,r,o,c,h,f,d){var g,l,x,p,_,y,w,C,D,X,I,J,Y,B,A,u,M,b=t.type;if(t.constructor!=null)return null;128&n.__u&&(f=!!(32&n.__u),o=[h=t.__e=n.__e]),(g=Z.__b)&&g(t);t:if(typeof b=="function")try{if(C=t.props,D="prototype"in b&&b.prototype.render,X=(g=b.contextType)&&i[g.__c],I=g?X?X.props.value:g.__:i,n.__c?w=(l=t.__c=n.__c).__=l.__E:(D?t.__c=l=new b(C,I):(t.__c=l=new Pt(C,I),l.constructor=b,l.render=Mn),X&&X.sub(l),l.state||(l.state={}),l.__n=i,x=l.__d=!0,l.__h=[],l._sb=[]),D&&l.__s==null&&(l.__s=l.state),D&&b.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=Ct({},l.__s)),Ct(l.__s,b.getDerivedStateFromProps(C,l.__s))),p=l.props,_=l.state,l.__v=t,x)D&&b.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),D&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(D&&b.getDerivedStateFromProps==null&&C!==p&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(C,I),t.__v==n.__v||!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(C,l.__s,I)===!1){for(t.__v!=n.__v&&(l.props=C,l.state=l.__s,l.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(m){m&&(m.__=t)}),J=0;J<l._sb.length;J++)l.__h.push(l._sb[J]);l._sb=[],l.__h.length&&c.push(l);break t}l.componentWillUpdate!=null&&l.componentWillUpdate(C,l.__s,I),D&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(p,_,y)})}if(l.context=I,l.props=C,l.__P=e,l.__e=!1,Y=Z.__r,B=0,D){for(l.state=l.__s,l.__d=!1,Y&&Y(t),g=l.render(l.props,l.state,l.context),A=0;A<l._sb.length;A++)l.__h.push(l._sb[A]);l._sb=[]}else do l.__d=!1,Y&&Y(t),g=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++B<25);l.state=l.__s,l.getChildContext!=null&&(i=Ct(Ct({},i),l.getChildContext())),D&&!x&&l.getSnapshotBeforeUpdate!=null&&(y=l.getSnapshotBeforeUpdate(p,_)),u=g,g!=null&&g.type===xt&&g.key==null&&(u=en(g.props.children)),h=Je(e,Nt(u)?u:[u],t,n,i,r,o,c,h,f,d),l.base=t.__e,t.__u&=-161,l.__h.length&&c.push(l),w&&(l.__E=l.__=null)}catch(m){if(t.__v=null,f||o!=null)if(m.then){for(t.__u|=f?160:128;h&&h.nodeType==8&&h.nextSibling;)h=h.nextSibling;o[o.indexOf(h)]=null,t.__e=h}else{for(M=o.length;M--;)ae(o[M]);ie(t)}else t.__e=n.__e,t.__k=n.__k,m.then||ie(t);Z.__e(m,t,n)}else o==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):h=t.__e=kn(n.__e,t,n,i,r,o,c,f,d);return(g=Z.diffed)&&g(t),128&t.__u?void 0:h}function ie(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(ie)}function tn(e,t,n){for(var i=0;i<n.length;i++)ce(n[i],n[++i],n[++i]);Z.__c&&Z.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(o){o.call(r)})}catch(o){Z.__e(o,r.__v)}})}function en(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Nt(e)?e.map(en):Ct({},e)}function kn(e,t,n,i,r,o,c,h,f){var d,g,l,x,p,_,y,w=n.props||$t,C=t.props,D=t.type;if(D=="svg"?r="http://www.w3.org/2000/svg":D=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),o!=null){for(d=0;d<o.length;d++)if((p=o[d])&&"setAttribute"in p==!!D&&(D?p.localName==D:p.nodeType==3)){e=p,o[d]=null;break}}if(e==null){if(D==null)return document.createTextNode(C);e=document.createElementNS(r,D,C.is&&C),h&&(Z.__m&&Z.__m(t,o),h=!1),o=null}if(D==null)w===C||h&&e.data==C||(e.data=C);else{if(o=o&&Gt.call(e.childNodes),!h&&o!=null)for(w={},d=0;d<e.attributes.length;d++)w[(p=e.attributes[d]).name]=p.value;for(d in w)if(p=w[d],d!="children"){if(d=="dangerouslySetInnerHTML")l=p;else if(!(d in C)){if(d=="value"&&"defaultValue"in C||d=="checked"&&"defaultChecked"in C)continue;Vt(e,d,null,p,r)}}for(d in C)p=C[d],d=="children"?x=p:d=="dangerouslySetInnerHTML"?g=p:d=="value"?_=p:d=="checked"?y=p:h&&typeof p!="function"||w[d]===p||Vt(e,d,p,w[d],r);if(g)h||l&&(g.__html==l.__html||g.__html==e.innerHTML)||(e.innerHTML=g.__html),t.__k=[];else if(l&&(e.innerHTML=""),Je(t.type=="template"?e.content:e,Nt(x)?x:[x],t,n,i,D=="foreignObject"?"http://www.w3.org/1999/xhtml":r,o,c,o?o[0]:n.__k&&Dt(n,0),h,f),o!=null)for(d=o.length;d--;)ae(o[d]);h||(d="value",D=="progress"&&_==null?e.removeAttribute("value"):_!=null&&(_!==e[d]||D=="progress"&&!_||D=="option"&&_!=w[d])&&Vt(e,d,_,w[d],r),d="checked",y!=null&&y!=e[d]&&Vt(e,d,y,w[d],r))}return e}function ce(e,t,n){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&t==null||(e.__u=e(t))}else e.current=t}catch(r){Z.__e(r,n)}}function nn(e,t,n){var i,r;if(Z.unmount&&Z.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||ce(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){Z.__e(o,t)}i.base=i.__P=null}if(i=e.__k)for(r=0;r<i.length;r++)i[r]&&nn(i[r],t,n||typeof e.type!="function");n||ae(e.__e),e.__c=e.__=e.__e=void 0}function Mn(e,t,n){return this.constructor(e,n)}function Sn(e,t,n){var i,r,o,c;t==document&&(t=document.documentElement),Z.__&&Z.__(e,t),r=(i=!1)?null:t.__k,o=[],c=[],le(t,e=t.__k=ne(xt,null,[e]),r||$t,$t,t.namespaceURI,r?null:t.firstChild?Gt.call(t.childNodes):null,o,r?r.__e:t.firstChild,i,c),tn(o,e,c)}Gt=Ke.slice,Z={__e:function(e,t,n,i){for(var r,o,c;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(e)),c=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,i||{}),c=r.__d),c)return r.__E=r}catch(h){e=h}throw e}},Ue=0,Pt.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Ct({},this.state),typeof e=="function"&&(e=e(Ct({},n),this.props)),e&&Ct(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),ye(this))},Pt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ye(this))},Pt.prototype.render=xt,Wt=[],je=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ge=function(e,t){return e.__v.__b-t.__v.__b},Ft.__r=0,qe=/(PointerCapture)$|Capture$/i,se=0,te=ve(!1),ee=ve(!0);var Tn=0;function a(e,t,n,i,r,o){t||(t={});var c,h,f=t;if("ref"in f)for(h in f={},t)h=="ref"?c=t[h]:f[h]=t[h];var d={type:e,props:f,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Tn,__i:-1,__u:0,__source:r,__self:o};if(typeof e=="function"&&(c=e.defaultProps))for(h in c)f[h]===void 0&&(f[h]=c[h]);return Z.vnode&&Z.vnode(d),d}var Et,ut,Kt,we,Ot=0,rn=[],pt=Z,ke=pt.__b,Me=pt.__r,Se=pt.diffed,Te=pt.__c,Ce=pt.unmount,Pe=pt.__;function ue(e,t){pt.__h&&pt.__h(ut,e,Ot||t),Ot=0;var n=ut.__H||(ut.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function ot(e){return Ot=1,Cn(sn,e)}function Cn(e,t,n){var i=ue(Et++,2);if(i.t=e,!i.__c&&(i.__=[n?n(t):sn(void 0,t),function(h){var f=i.__N?i.__N[0]:i.__[0],d=i.t(f,h);f!==d&&(i.__N=[d,i.__[1]],i.__c.setState({}))}],i.__c=ut,!ut.__f)){var r=function(h,f,d){if(!i.__c.__H)return!0;var g=i.__c.__H.__.filter(function(x){return!!x.__c});if(g.every(function(x){return!x.__N}))return!o||o.call(this,h,f,d);var l=i.__c.props!==h;return g.forEach(function(x){if(x.__N){var p=x.__[0];x.__=x.__N,x.__N=void 0,p!==x.__[0]&&(l=!0)}}),o&&o.call(this,h,f,d)||l};ut.__f=!0;var o=ut.shouldComponentUpdate,c=ut.componentWillUpdate;ut.componentWillUpdate=function(h,f,d){if(this.__e){var g=o;o=void 0,r(h,f,d),o=g}c&&c.call(this,h,f,d)},ut.shouldComponentUpdate=r}return i.__N||i.__}function Tt(e,t){var n=ue(Et++,3);!pt.__s&&on(n.__H,t)&&(n.__=e,n.u=t,ut.__H.__h.push(n))}function bt(e){return Ot=5,Pn(function(){return{current:e}},[])}function Pn(e,t){var n=ue(Et++,7);return on(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function An(){for(var e;e=rn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Bt),e.__H.__h.forEach(re),e.__H.__h=[]}catch(t){e.__H.__h=[],pt.__e(t,e.__v)}}pt.__b=function(e){ut=null,ke&&ke(e)},pt.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Pe&&Pe(e,t)},pt.__r=function(e){Me&&Me(e),Et=0;var t=(ut=e.__c).__H;t&&(Kt===ut?(t.__h=[],ut.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(Bt),t.__h.forEach(re),t.__h=[],Et=0)),Kt=ut},pt.diffed=function(e){Se&&Se(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(rn.push(t)!==1&&we===pt.requestAnimationFrame||((we=pt.requestAnimationFrame)||Wn)(An)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Kt=ut=null},pt.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Bt),n.__h=n.__h.filter(function(i){return!i.__||re(i)})}catch(i){t.some(function(r){r.__h&&(r.__h=[])}),t=[],pt.__e(i,n.__v)}}),Te&&Te(e,t)},pt.unmount=function(e){Ce&&Ce(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{Bt(i)}catch(r){t=r}}),n.__H=void 0,t&&pt.__e(t,n.__v))};var Ae=typeof requestAnimationFrame=="function";function Wn(e){var t,n=function(){clearTimeout(i),Ae&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,35);Ae&&(t=requestAnimationFrame(n))}function Bt(e){var t=ut,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),ut=t}function re(e){var t=ut;e.__c=e.__(),ut=t}function on(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function sn(e,t){return typeof t=="function"?t(e):t}function Ln(e){return function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}class Rn{constructor(t){this.model=t}async trainAsync(t,n,i){if(!Array.isArray(n)){const p=arguments[1],_=arguments[2],y=arguments[3];let w=p.min,C=_.min,D=1/0,X=[];const I=20;let J=0;for(let Y=p.min;Y<=p.max;Y+=p.step)for(let B=_.min;B<=_.max;B+=_.step){const A=parseFloat(Y.toFixed(2)),u=parseFloat(B.toFixed(2));this.model.setWeight(A),this.model.setBias(u);let M=0,b=0;for(const $ of t){const U=this.model.predict($.input),T=$.target-U;M+=T*T,b+=Math.abs(T)}const m=M/t.length,P=b/t.length;let F=0;for(const $ of t)(this.model.predict($.input)>=.5?1:0)===$.target&&F++;const S=F/t.length;m<D&&(D=m,w=A,C=u);const N={weight:A,bias:u,error:m,mae:P,accuracy:S};X.push(N),J++,J%I===0&&(y&&y(X,{bestWeight:w,bestBias:C,minError:D}),X=[],await new Promise($=>setTimeout($,0)))}return X.length>0&&y&&y(X,{bestWeight:w,bestBias:C,minError:D}),{bestWeight:w,bestBias:C,minError:D}}let o=1/0,c={},h=0;const f=50;let d=[];const g=p=>{const _=[];if(p.step<=0)return[p.min];for(let y=p.min;y<=p.max+1e-4;y+=p.step)_.push(parseFloat(y.toFixed(2)));return _},l=n.map(g),x=async(p,_)=>{if(p===n.length){const w=[];let C=0;_.forEach((M,b)=>{n[b].name.toLowerCase().includes("bias")?C=M:w.push(M)});let D={};this.model.setParams?(_.forEach((M,b)=>{D[n[b].name]=M}),this.model.setParams(D),C===void 0&&(C=0)):(this.model.setWeights?this.model.setWeights(w):this.model.setWeight&&this.model.setWeight(w[0]),this.model.setBias(C),D={weights:[...w],bias:C});let X=0,I=0;for(const M of t){const b=this.model.predict(M.input),m=M.target-b;X+=m*m,I+=Math.abs(m)}const J=X/t.length,Y=I/t.length;let B=0;for(const M of t)(this.model.predict(M.input)>=.5?1:0)===M.target&&B++;const A=B/t.length;J<o&&(o=J,c=D);const u={params:[..._],error:J,mae:Y,accuracy:A};d.push(u),h++,h%f===0&&(i&&i(d,{bestParams:c,minError:o}),d=[],await new Promise(M=>setTimeout(M,0)));return}const y=l[p];for(const w of y)_[p]=w,await x(p+1,_)};return await x(0,new Array(n.length)),d.length>0&&i&&i(d,{bestParams:c,minError:o}),{bestParams:c,minError:o}}async trainRandomAsync(t,n,i,r={}){const{patience:o=5e3,seed:c,maxSteps:h=1e4,initialRadius:f=.8,phase1Ratio:d=.8}=r,g=h,l=f,x=.999,p=d;let _=1/0,y={},w=c;w==null?(w=Math.floor(Math.random()*2147483647),console.log(`[AdaptiveRandom] Generated Seed: ${w}`)):console.log(`[AdaptiveRandom] Using Seed: ${w}`);const C=Ln(w);let D=n.map(b=>({min:b.min,max:b.max,span:b.max-b.min})),X=D.map(b=>b.min+C()*b.span);const I=b=>{const m=[];let P=0;b.forEach((T,k)=>{n[k].name.toLowerCase().includes("bias")?P=T:m.push(T)});let F={};this.model.setParams?(b.forEach((T,k)=>{F[n[k].name]=T}),this.model.setParams(F)):(this.model.setWeights?this.model.setWeights(m):this.model.setWeight&&this.model.setWeight(m[0]),this.model.setBias(P),F={weights:m,bias:P});let S=0,N=0;for(const T of t){const k=this.model.predict(T.input),v=T.target-k;S+=v*v,N+=Math.abs(v)}let $=0;for(const T of t)(this.model.predict(T.input)>=.5?1:0)===T.target&&$++;const U=$/t.length;return{mse:S/t.length,mae:N/t.length,accuracy:U,decodedParams:F,weights:m,bias:P}};let J=I(X);_=J.mse,y=J.decodedParams?{...J.decodedParams,_array:[...X]}:{weights:J.weights,bias:J.bias,_array:[...X]},i&&i([{params:[...X],error:_,mae:J.mae,accuracy:J.accuracy}],{bestParams:y,minError:_}),await new Promise(b=>setTimeout(b,0));let Y=[];const B=10;let A=_,u=[...X],M=0;for(let b=0;b<g;b++){const m=b<g*p;let P;if(m){const k=b/(g*p);P=l*(1-k*.5)}else P=l*.5*Math.pow(x,b-g*p);let F=!1;const S=[...u];let N=!1;for(;!N;)S.forEach((k,v)=>{if(C()<.4)return;N=!0;const s=D[v];let z=!1;if(m){const gt=s.span*.3,et=y._array&&Math.abs(k-y._array[v])<1e-9;et&&k<s.min+gt&&(s.min-=s.span*.4,s.span=s.max-s.min,z=!0),et&&k>s.max-gt&&(s.max+=s.span*.4,s.span=s.max-s.min,z=!0),z&&(F=!0)}let j=s.span*P;z&&(j=Math.max(j,s.span*.25));const K=j;let tt=k+(C()-.5)*2*K;tt<s.min&&(tt=s.min),tt>s.max&&(tt=s.max),S[v]=tt});const $=I(S),U=$.mse-A;let T=!1;if(U<0&&(T=!0),T&&(u=S,A=$.mse),$.mse<_?(_=$.mse,y=$.decodedParams?{...$.decodedParams,_array:[...S]}:{weights:$.weights,bias:$.bias,_array:[...S]},M=0):M++,M>=o&&!m)break;if(Y.push({params:[...S],error:$.mse,mae:$.mae,accuracy:$.accuracy}),Y.length>=B){let k;F&&(k="Grenzen dynamisch erweitert..."),i&&i(Y,{bestParams:y,minError:_,message:k}),Y=[],await new Promise(v=>setTimeout(v,0))}}return Y.length>0&&i&&i(Y,{bestParams:y,minError:_}),{bestParams:y,minError:_}}}class Dn{constructor(t=30,n=50){this.velocity=t,this.initialPosition=n}getPosition(t){return this.velocity*t+this.initialPosition}}class zn{constructor(){this.weight=0,this.bias=0}predict(t){return this.weight*t+this.bias}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function $n({time:e,groundTruth:t,neuralNet:n,maxDistance:i=300}){const r=bt(null);Tt(()=>{const c=r.current;if(!c)return;const h=c.getContext("2d"),f=c.width,d=c.height,g=50,l=f-2*g;h.clearRect(0,0,f,d);const x=t.getPosition(e),p=n.predict(e),_=g+x%i/i*l,y=g+p%i/i*l;h.fillStyle="#f0f0f0",h.fillRect(0,0,f,d/2),h.fillStyle="#e0e0e0",h.fillRect(0,d/2,f,d/2),h.beginPath(),h.strokeStyle="#fff",h.setLineDash([20,20]),h.moveTo(0,d/4),h.lineTo(f,d/4),h.moveTo(0,d*3/4),h.lineTo(f,d*3/4),h.stroke(),h.beginPath(),h.strokeStyle="#ccc",h.setLineDash([]),h.moveTo(g,0),h.lineTo(g,d),h.moveTo(f-g,0),h.lineTo(f-g,d),h.stroke(),o(h,_,d/4,"#2ecc71","Ground Truth"),o(h,y,d*3/4,"#e74c3c","Neural Net"),h.fillStyle="#333",h.font="14px monospace",h.fillText(`Zeit: ${e.toFixed(1)}s`,10,20),h.fillText(`Pos GT: ${x.toFixed(1)}m`,10,40),h.fillText(`Pos NN: ${p.toFixed(1)}m`,10,d/2+40)},[e,t,n,i]);function o(c,h,f,d,g){c.save(),c.translate(h,f),c.fillStyle=d,c.fillRect(-20,-10,40,20),c.fillStyle="#000",c.fillRect(-15,-15,10,5),c.fillRect(5,-15,10,5),c.fillRect(-15,10,10,5),c.fillRect(5,10,10,5),c.fillStyle="#000",c.font="10px sans-serif",c.textAlign="center",c.fillText(g,0,-20),c.restore()}return a("div",{style:{border:"2px solid #333",borderRadius:"8px",overflow:"hidden"},children:a("canvas",{ref:r,width:800,height:300,style:{width:"100%",display:"block"}})})}const We={id:"linear_regression",title:"Phase 1: Linear Regression",description:"A simple neuron learns the relationship between time and position. This corresponds to a linear regression.",Model:zn,GroundTruth:Dn,CanvasComponent:$n,defaultParams:{weight:0,bias:0},groundTruthDefaults:[30,50],getInput:e=>e,generateData:e=>Array.from({length:20},(n,i)=>i*.5).map(n=>({input:n,target:e.getPosition(n)})),trainingConfig:{maxSteps:2e3,showAccuracyPlot:!1,params:[{name:"weight",min:0,max:60,step:1},{name:"bias",min:0,max:100,step:2}]},networkViz:{formula:"pos = w * t + b",inputLabel:"Zeit (t)",outputLabel:"Pos (m)",biasLabel:"b"}};class En{constructor(t=.5,n=-5){this.weight=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){const n=this.sigmoid(this.weight*t+this.bias);return Math.random()<n?1:0}getProbability(t){return this.sigmoid(this.weight*t+this.bias)}}class Nn{constructor(){this.weight=0,this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=this.weight*t+this.bias;return this.sigmoid(n)}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function Ut(e,t,n=10){if(e===t)return[e];const i=Le(t-e,!1),r=Le(i/(n-1),!0),o=Math.floor(e/r)*r,c=Math.ceil(t/r)*r,h=[],f=r/1e3;for(let d=o;d<c+r/2;d+=r)d>=e-f&&d<=t+f&&h.push(Number(d.toPrecision(12)));return h}function Le(e,t){const n=Math.floor(Math.log10(e)),i=e/Math.pow(10,n);let r;return t?i<1.5?r=1:i<3?r=2:i<7?r=5:r=10:i<=1?r=1:i<=2?r=2:i<=5?r=5:r=10,r*Math.pow(10,n)}function In({time:e,groundTruth:t,neuralNet:n,data:i,staticMode:r=!1,showModel:o=!0,showGroundTruth:c=!0,showProbabilities:h=!1}){const f=bt(null),[d,g]=ot({k:1,x:0,y:0}),[l,x]=ot(!1),p=bt({x:0,y:0}),[_,y]=ot(null),w=bt([]),C=A=>{A.preventDefault();const M=-A.deltaY*.001,b=d.k;let m=b*(1+M);m=Math.max(.5,Math.min(m,10));const P=f.current.getBoundingClientRect(),F=f.current.width/P.width,S=f.current.height/P.height,N=(A.clientX-P.left)*F,$=(A.clientY-P.top)*S,U=40,T=(N-U-d.x)/b,k=($-(300-U)-d.y)/b,v=N-U-T*m,s=$-(300-U)-k*m;g({k:m,x:v,y:s})},D=A=>{x(!0),p.current={x:A.clientX,y:A.clientY}},X=A=>{const u=f.current;if(!u)return;const M=u.getBoundingClientRect(),b=u.width/M.width,m=u.height/M.height;if(l){const P=(A.clientX-p.current.x)*b,F=(A.clientY-p.current.y)*m;p.current={x:A.clientX,y:A.clientY},g(S=>({...S,x:S.x+P,y:S.y+F})),y(null)}else{const P=(A.clientX-M.left)*b,F=(A.clientY-M.top)*m;let S=null,N=15;const $=w.current;for(let U=$.length-1;U>=0;U--){const T=$[U],k=Math.sqrt(Math.pow(T.x-P,2)+Math.pow(T.y-F,2));k<N&&(N=k,S=T.info)}y(S)}},I=()=>x(!1),J=()=>{x(!1),y(null)},Y=bt(0),B=()=>{const A=Date.now();A-Y.current<300&&y(null),Y.current=A};return Tt(()=>{const A=f.current;if(!A)return;const u=A.getContext("2d"),M=A.width,b=A.height;u.clearRect(0,0,M,b),w.current=[];const m=40,P=M-2*m,F=b-2*m,S=0,N=20,$=1,U=V=>m+V/N*P*d.k+d.x,T=V=>b-m-V/$*F*d.k+d.y,k=V=>(V-m-d.x)/(P*d.k)*N,v=V=>-((V-(b-m)-d.y)/(F*d.k))*$,s=k(m),z=k(M-m),j=v(b-m),K=v(m),tt=Ut(s,z,10),gt=Ut(j,K,5);if(u.beginPath(),u.strokeStyle="#eee",u.lineWidth=1,u.fillStyle="#333",u.textAlign="center",u.textBaseline="top",u.font="10px sans-serif",tt.forEach(V=>{const R=U(V);R<m||R>M-m||(u.moveTo(R,m),u.lineTo(R,b-m),u.fillText(Number(V.toFixed(2)),R,b-m+5))}),u.textAlign="right",u.textBaseline="middle",gt.forEach(V=>{const R=T(V);R<m||R>b-m||(u.moveTo(m,R),u.lineTo(M-m,R),u.fillText(Number(V.toFixed(2)),m-5,R))}),u.stroke(),u.beginPath(),u.strokeStyle="#333",u.lineWidth=1,u.rect(m,m,P,F),u.stroke(),u.fillStyle="#333",u.textAlign="center",u.textBaseline="alphabetic",u.fillText("Number of 'Spam' Words",M/2,b-10),u.save(),u.translate(15,b/2),u.rotate(-Math.PI/2),u.textAlign="center",u.fillText("Spam Probability",0,0),u.restore(),u.save(),u.beginPath(),u.rect(m,m,P,F),u.clip(),o&&n&&((V,R,Q=[])=>{u.beginPath(),u.strokeStyle=R,u.setLineDash(Q),u.lineWidth=2;const L=Math.max(S,s),W=Math.min(N,z);if(W<L)return;const E=(W-L)/100,G=Math.max(E,.05);let O=!1;for(let it=L;it<=W+G;it+=G){const _t=Math.min(Math.max(it,S),N);let ct=0;typeof V.getProbability=="function"?ct=V.getProbability(_t):typeof V.predict=="function"&&(ct=V.predict(_t));const ht=U(_t),lt=T(ct);O?u.lineTo(ht,lt):(u.moveTo(ht,lt),O=!0)}u.stroke(),u.setLineDash([])})(n,"#e74c3c"),r&&i)i.forEach(V=>{if(V.input<s-5||V.input>z+5)return;const R=0,Q=0,L=U(V.input),W=T(V.target);w.current.push({x:L,y:W,info:{x:L,y:W,input:V.input,target:V.target,type:"Ground Truth"}});let E=null;if(n&&o)try{E=n.predict(V.input)>.5?"#e74c3c":"#2ecc71"}catch{}if(h&&n&&typeof n.predict=="function")try{const G=n.predict(V.input),O=T(G);o&&(u.beginPath(),u.moveTo(L,W),u.lineTo(L,O),u.setLineDash([2,4]),u.strokeStyle="rgba(0,0,0,0.15)",u.lineWidth=1,u.stroke(),u.setLineDash([]));let it=null;n&&o&&(it=n.predict(V.input)>.5?"#e74c3c":"#2ecc71"),it&&(u.beginPath(),u.arc(L,O,6,0,Math.PI*2),u.strokeStyle=it,u.lineWidth=2,u.stroke()),w.current.push({x:L,y:O,info:{x:L,y:O,input:V.input,target:V.target,prediction:G,type:"Prediction"}})}catch{}else E&&(u.beginPath(),u.arc(L+R,W+Q,8,0,Math.PI*2),u.strokeStyle=E,u.lineWidth=2,u.stroke());u.beginPath(),u.arc(L+R,W+Q,5,0,Math.PI*2),u.fillStyle=V.target===1?"#e74c3c":"#2ecc71",u.fill(),u.strokeStyle="#fff",u.lineWidth=1,u.stroke()});else if(!r){const R=Math.floor(e*2),Q=50,L=E=>{const G=Math.sin(E*123.456)*1e4;return G-Math.floor(G)},W=Math.min(R,Q);for(let E=0;E<W;E++){const G=L(E+1),O=Math.floor(G*21),it=t?t.getProbability(O):0,_t=L(E+999)<it?1:0;if(O<s-5||O>z+5)continue;const ct=U(O),ht=T(_t);let lt=null;if(n&&o)try{lt=n.predict(O)>.5?"#e74c3c":"#2ecc71"}catch{}if(h&&n&&typeof n.predict=="function")try{const dt=n.predict(O),H=T(dt);o&&(u.beginPath(),u.moveTo(ct,ht),u.lineTo(ct,H),u.setLineDash([2,4]),u.strokeStyle="rgba(0,0,0,0.35)",u.lineWidth=1,u.stroke(),u.setLineDash([]));let mt=null;n&&o&&(mt=n.predict(O)>.5?"#e74c3c":"#2ecc71"),mt&&(u.beginPath(),u.arc(ct,H,6,0,Math.PI*2),u.strokeStyle=mt,u.lineWidth=2,u.stroke())}catch{}else lt&&(u.beginPath(),u.arc(finalX,finalY,8,0,Math.PI*2),u.strokeStyle=lt,u.lineWidth=2,u.stroke());u.beginPath(),u.arc(finalX,finalY,5,0,Math.PI*2),u.fillStyle=_t?"#e74c3c":"#2ecc71",u.fill(),u.strokeStyle="#fff",u.lineWidth=1,u.stroke()}if(W>0&&W<=Q){const E=W-1,G=L(E+1),O=Math.floor(G*21),it=t.getProbability(O),_t=L(E+999)<it?1:0,ct=0,ht=0,lt=U(O)+ct,dt=T(_t)+ht;lt>m&&lt<M-m&&dt>m&&dt<b-m&&(u.beginPath(),u.arc(lt,dt,8,0,Math.PI*2),u.strokeStyle="#333",u.stroke(),u.fillStyle="#333",u.font="10px sans-serif",u.fillText(`${O}`,lt,dt-12))}}if(u.restore(),_){u.save(),u.fillStyle="rgba(0,0,0,0.8)",u.strokeStyle="#fff";const V=_.target===1?"SPAM":"HAM",R=`Words: ${_.input}`,Q=_.type?`(${_.type})`:"",L=120,W=_.type?55:40;let E=_.x+10,G=_.y-10;E+L>M&&(E=_.x-L-10),G+W>b&&(G=_.y-W-10),G<0&&(G=_.y+10),u.beginPath(),u.roundRect(E,G,L,W,4),u.fill(),u.lineWidth=1,u.stroke(),u.textBaseline="top",u.textAlign="left",u.font="bold 11px sans-serif",u.fillStyle=_.target===1?"#e74c3c":"#2ecc71",u.fillText(`${V} ${Q}`,E+8,G+6),u.fillStyle="#ddd",u.font="10px sans-serif",u.fillText(R,E+8,G+20),_.prediction!==void 0&&u.fillText(`Pred: ${_.prediction.toFixed(2)}`,E+8,G+32),u.restore()}},[e,t,n,i,r,o,c,h,d,_]),a("div",{className:"canvas-container",children:a("canvas",{ref:f,width:600,height:300,style:{width:"100%",border:"1px solid #ccc",background:"#fff",cursor:_?"pointer":l?"grabbing":"grab"},onWheel:C,onMouseDown:D,onMouseMove:X,onMouseUp:I,onMouseLeave:J,onClick:B})})}const zt=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Re={id:"logistic_regression",title:"Phase 2: Logistic Regression",description:'Classification of emails as "Spam" or "Not Spam" based on word count. This is a logistic regression.',Model:Nn,GroundTruth:En,CanvasComponent:In,defaultParams:{weight:0,bias:0},groundTruthDefaults:[.5,-5],getInput:e=>{const t=Math.floor(e);return Math.floor(zt(t)*20)},generateData:e=>{const t=new Set(["FREE","WIN","PRIZE","CLAIM","URGENT","OFFER","BONUS","CLICK","LINK","NOW","LIMITED","DISCOUNT","VERIFY","ACCOUNT","PAYMENT","SUSPENDED","APPROVED","CASH","REWARD","SECURITY","ALERT","ACT","TODAY"]),n=p=>{const _=String(p||"").match(/[A-Z0-9]+/g)||[];let y=0;for(const w of _)t.has(w)&&y++;return y},i=(p,_)=>({input:n(p),target:_,text:p}),r=Array.from(t),o=(p,_)=>{const y=[...r];for(let w=y.length-1;w>0;w--){const C=Math.floor(zt(_+w*97)*(w+1));[y[w],y[C]]=[y[C],y[w]]}return y.slice(0,p)},c=["Project update","Quick question","Invoice follow up","Meeting schedule","Account notice","Delivery status","Action required","Weekly summary"],h=["Hi, just following up. Could you take a look when you have a moment?","Hello, sharing the details below. Thanks for your time.","Hey, can you confirm receipt and let me know if anything is missing?","Hi, please review and reply when convenient. Appreciate it.","Hello, sending this over for your review. Thanks."],f=(p,_)=>{const y=c[Math.floor(zt(_+11)*c.length)],w=h[Math.floor(zt(_+29)*h.length)],C=o(p,_+101),D=C.length?` ${C.join(" ")}`:"";return`Subject: ${y}${D}
${w}`},d=[];for(let p=0;p<=20;p++)d.push(p,p);for(let p=0;p<8;p++)d.push(p);const g=d.map((p,_)=>{const y=p*1e3+_,w=f(p,y),C=e?.getProbability?e.getProbability(p):0,D=zt(y+999);return{x:p,idx:_,text:w,score:C-D}}),l=new Set([...g].sort((p,_)=>_.score-p.score).slice(0,25).map(p=>p.idx));return g.map(p=>i(p.text,l.has(p.idx)?1:0)).sort((p,_)=>p.input-_.input)},trainingConfig:{maxSteps:3e3,params:[{name:"weight",min:0,max:2,step:.1},{name:"bias",min:-10,max:5,step:.5}]},networkViz:{formula:"p = σ(w * x + b)",inputLabel:"Wörter (x)",outputLabel:"Spam (p)",biasLabel:"b"},isFinished:e=>e>=25};class he{constructor(t=[.5,.2,.8,-.1],n=-3){this.weights=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){let n=this.bias;for(let r=0;r<this.weights.length;r++)n+=this.weights[r]*t[r];const i=this.sigmoid(n);return Math.random()<i?1:0}getProbability(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}}class an{constructor(t=4){this.weights=new Array(t).fill(0),this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){let n=this.bias;for(let i=0;i<this.weights.length;i++)n+=this.weights[i]*t[i];return this.sigmoid(n)}setWeights(t){this.weights=[...t]}setBias(t){this.bias=t}setWeightAt(t,n){t>=0&&t<this.weights.length&&(this.weights[t]=n)}}const Vn=[{label:"Spam Words",idx:0,max:15},{label:"Capitals",idx:1,max:25},{label:"Links",idx:2,max:8},{label:"Total Words",idx:3,max:100}];function de({data:e,currentInput:t,currentPrediction:n,neuralNet:i,allowedModes:r=["features","scatter","3d","text"],hideControls:o=!1,showModel:c=!0,additionalControls:h=null,features:f=Vn}){const d=bt(null),[g,l]=ot(r[0]);Tt(()=>{r.includes(g)||l(r[0])},[r]);const[x,p]=ot(0),[_,y]=ot(f.length===2?1:3),[w,C]=ot(2),[D,X]=ot(!1),[I,J]=ot({x:-.5,y:.5}),[Y,B]=ot({k:1,x:0,y:0}),A=bt(!1),u=bt({x:0,y:0}),[M,b]=ot(null),m=bt([]),P=v=>{if(g!=="scatter")return;v.preventDefault();const z=-v.deltaY*.001,j=Y.k;let K=j*(1+z);K=Math.max(.5,Math.min(K,50));const tt=d.current;if(!tt)return;const gt=tt.getBoundingClientRect(),et=tt.width/gt.width,V=tt.height/gt.height,R=(v.clientX-gt.left)*et,Q=(v.clientY-gt.top)*V,L=50,W=tt.height-L,E=(R-L-Y.x)/j,G=(W+Y.y-Q)/j,O=R-L-E*K,it=Q-W+G*K;B({k:K,x:O,y:it})},F=v=>{g!=="3d"&&g!=="scatter"||(A.current=!0,u.current={x:v.clientX,y:v.clientY})},S=v=>{const s=d.current;if(!s)return;const z=s.getBoundingClientRect(),j=s.width/z.width,K=s.height/z.height;if(A.current){const L=(v.clientX-u.current.x)*j,W=(v.clientY-u.current.y)*K;u.current={x:v.clientX,y:v.clientY},g==="3d"?J(E=>({x:E.x+W*.01,y:E.y+L*.01})):g==="scatter"&&B(E=>({...E,x:E.x+L,y:E.y+W}));return}const tt=(v.clientX-z.left)*j,gt=(v.clientY-z.top)*K;let et=null,R=15;const Q=m.current;for(let L=Q.length-1;L>=0;L--){const W=Q[L],E=Math.sqrt((W.x-tt)**2+(W.y-gt)**2);E<R&&(R=E,et=W.info)}b(et)},N=()=>{A.current=!1},$=()=>{b(null),A.current=!1},U=bt(0),T=()=>{const v=Date.now();v-U.current<300&&b(null),U.current=v};Tt(()=>{const v=d.current;if(!v)return;const s=v.getContext("2d"),z=v.width,j=v.height;s.clearRect(0,0,z,j),s.fillStyle="#fff",s.fillRect(0,0,z,j),m.current=[];const K=et=>{if(!e||e.length===0)return f[et].max;const V=Math.max(...e.map(R=>R.input[et]));return V>0?V:f[et].max},tt=et=>et===2?"#3498db":et===1?"#e74c3c":"#2ecc71",gt=et=>et===3?"CLASS 3":et===1?"SPAM":"HAM";if(g==="3d"){const et=K(x),V=K(_),R=K(w),Q=z/2,L=j/2,W=150,E=(H,mt,wt)=>{let St=H*Math.cos(I.y)-wt*Math.sin(I.y),q=H*Math.sin(I.y)+wt*Math.cos(I.y),nt=mt*Math.cos(I.x)-q*Math.sin(I.x),at=mt*Math.sin(I.x)+q*Math.cos(I.x);const rt=400/(400-at);return{x:Q+St*rt,y:L+nt*rt,z:at}},O=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]].map(H=>E(H[0]*W,H[1]*W,H[2]*W)),it="#e29301ff",_t="#2980b9",ct="#c00798ff",ht=(H,mt)=>{s.beginPath(),s.strokeStyle=mt,s.lineWidth=1,H.forEach(([wt,St])=>{s.moveTo(O[wt].x,O[wt].y),s.lineTo(O[St].x,O[St].y)}),s.stroke()};ht([[0,1],[3,2],[4,5],[7,6]],it),ht([[0,3],[1,2],[4,7],[5,6]],_t),ht([[0,4],[1,5],[2,6],[3,7]],ct),s.font="bold 11px sans-serif",s.fillStyle=it,s.fillText("X: "+f[x].label,O[1].x,O[1].y),s.fillStyle=_t,s.fillText("Y: "+f[_].label,O[3].x,O[3].y),s.fillStyle=ct,s.fillText("Z: "+f[w].label,O[4].x,O[4].y);const lt=[],dt=(H,mt)=>H/mt*2-1;if(c&&i&&i.weights){const H=i.weights[x]||0,mt=i.weights[_]||0,wt=i.weights[w]||0,St=i.bias||0;if(Math.abs(wt)>.001){s.strokeStyle="rgba(142, 68, 173, 0.3)",s.lineWidth=1;const q=(rt,st)=>{const yt=(rt+1)/2*et,ft=(st+1)/2*V,kt=(-H*yt-mt*ft-St)/wt;return dt(kt,R)},nt=(rt,st)=>{if(Math.abs(rt.z)<=3&&Math.abs(st.z)<=3){const yt=E(rt.x*W,-rt.y*W,rt.z*W),ft=E(st.x*W,-st.y*W,st.z*W);s.beginPath(),s.moveTo(yt.x,yt.y),s.lineTo(ft.x,ft.y),s.stroke()}},at=6;for(let rt=0;rt<=at;rt++){const st=-1+rt/at*2,yt=q(-1,st),ft=q(1,st);nt({x:-1,y:st,z:yt},{x:1,y:st,z:ft})}for(let rt=0;rt<=at;rt++){const st=-1+rt/at*2,yt=q(st,-1),ft=q(st,1);nt({x:st,y:-1,z:yt},{x:st,y:1,z:ft})}}}e&&e.forEach(H=>{const mt=dt(H.input[x],et),wt=-dt(H.input[_],V),St=dt(H.input[w],R),q=E(mt*W,wt*W,St*W);let nt=null;if(i&&c)try{nt=i.predict(H.input)>.5?"#e74c3c":"#2ecc71"}catch{}lt.push({...q,color:tt(H.target),radius:3,haloColor:nt,pt:H})}),lt.sort((H,mt)=>H.z-mt.z),lt.forEach(H=>{H.z<3&&m.current.push({x:H.x,y:H.y,info:{x:H.x,y:H.y,text:H.pt.text,target:H.pt.target,isSpam:H.pt.target===1,features:{xLabel:f[x].label,xVal:H.pt.input[x],yLabel:f[_].label,yVal:H.pt.input[_],zLabel:f[w].label,zVal:H.pt.input[w]}}}),H.haloColor&&(s.beginPath(),s.arc(H.x,H.y,H.radius+2,0,Math.PI*2),s.strokeStyle=H.haloColor,s.lineWidth=1.5,s.stroke()),s.beginPath(),s.arc(H.x,H.y,H.radius,0,Math.PI*2),s.fillStyle=H.color,s.fill()})}if(g==="scatter"){const et=K(x),V=K(_),R=50,Q=z-2*R,L=j-2*R,W=j-R,E="#c0392b",G="#2980b9",O=q=>R+q/et*Q*Y.k+Y.x,it=q=>W-q/V*L*Y.k+Y.y;s.save(),s.beginPath(),s.rect(R,R,Q,L),s.clip(),s.restore();const _t=q=>(q-R-Y.x)/(Q*Y.k)*et,ct=q=>(W+Y.y-q)/(L*Y.k)*V,ht=_t(R),lt=_t(R+Q),dt=ct(W),H=ct(R),mt=Ut(Math.min(ht,lt),Math.max(ht,lt),8),wt=Ut(Math.min(dt,H),Math.max(dt,H),6);if(s.lineWidth=1,s.strokeStyle="#eee",s.fillStyle="#666",s.font="10px sans-serif",s.textAlign="center",s.textBaseline="top",mt.forEach(q=>{const nt=O(q);nt<R||nt>R+Q||(s.beginPath(),s.moveTo(nt,R),s.lineTo(nt,W),s.stroke(),s.fillText(Number(q.toFixed(2)),nt,W+5))}),s.textAlign="right",s.textBaseline="middle",wt.forEach(q=>{const nt=it(q);nt<R||nt>W||(s.beginPath(),s.moveTo(R,nt),s.lineTo(R+Q,nt),s.stroke(),s.fillText(Number(q.toFixed(2)),R-5,nt))}),s.strokeStyle="#ccc",s.lineWidth=2,s.strokeRect(R,R,Q,L),s.textAlign="center",s.font="bold 12px sans-serif",s.fillStyle=E,s.fillText(`${f[x].label}`,R+Q/2,W+30),s.save(),s.translate(15,W-L/2),s.rotate(-Math.PI/2),s.fillStyle=G,s.fillText(`${f[_].label}`,0,0),s.restore(),s.save(),s.beginPath(),s.rect(R,R,Q,L),s.clip(),D&&i&&f.length===2){const nt=Math.floor(ht/.5)*.5,at=Math.ceil(lt/.5)*.5,rt=Math.floor(dt/.5)*.5,st=Math.ceil(H/.5)*.5;if((at-nt)/.5*((st-rt)/.5)<5e4)for(let ft=nt;ft<=at;ft+=.5)for(let kt=rt;kt<=st;kt+=.5)try{const Mt=[0,0];x<2&&(Mt[x]=ft),_<2&&(Mt[_]=kt);const vt=i.predict(Mt),At=O(ft),It=it(kt),_e=O(ft+.5),me=it(kt+.5),fn=Math.abs(_e-At),pn=Math.abs(It-me),gn=Math.min(At,_e),_n=Math.min(It,me),mn=Math.round(46*(1-vt)+231*vt),xn=Math.round(204*(1-vt)+76*vt),yn=Math.round(113*(1-vt)+60*vt);s.fillStyle=`rgba(${mn}, ${xn}, ${yn}, 0.2)`,s.fillRect(gn,_n,fn+.5,pn+.5)}catch{}}const St=(q,nt,at,rt,st)=>{const yt=O(q[x]),ft=it(q[_]);st&&(s.beginPath(),s.arc(yt,ft,at+3,0,2*Math.PI),s.strokeStyle=st,s.lineWidth=2,s.stroke()),s.beginPath(),s.arc(yt,ft,at,0,2*Math.PI),s.fillStyle=nt,s.fill(),rt&&(s.strokeStyle=rt,s.lineWidth=2,s.stroke())};if(e&&e.forEach(q=>{const nt=O(q.input[x]),at=it(q.input[_]);if(nt<R||nt>R+Q||at<R||at>W)return;m.current.push({x:nt,y:at,info:{x:nt,y:at,text:q.text,target:q.target,isSpam:q.target===1,features:{xLabel:f[x].label,xVal:q.input[x],yLabel:f[_].label,yVal:q.input[_]}}});let rt=null;if(i&&c)try{rt=i.predict(q.input)>.5?"#e74c3c":"#2ecc71"}catch{}St(q.input,tt(q.target),5,"#fff",rt)}),c&&i){let q=i.weights;const nt=i.bias||0;if(q){const at=q[x]||0,rt=q[_]||0,st=nt;s.beginPath(),s.strokeStyle="rgba(142, 68, 173, 0.8)",s.lineWidth=2,s.setLineDash([10,5]);const yt=ht-(lt-ht),ft=lt+(lt-ht),kt=(Mt,vt)=>({x:O(Mt),y:it(vt)});if(Math.abs(rt)>.001){const Mt=It=>(-at*It-st)/rt,vt=kt(yt,Mt(yt)),At=kt(ft,Mt(ft));s.moveTo(vt.x,vt.y),s.lineTo(At.x,At.y)}else if(Math.abs(at)>.001){const Mt=-st/at,vt=kt(Mt,dt-100),At=kt(Mt,H+100);s.moveTo(vt.x,vt.y),s.lineTo(At.x,At.y)}s.stroke(),s.setLineDash([])}}t&&St(t,"#3498db",8,"#2980b9"),s.restore(),s.fillStyle="#666",s.textAlign="right",s.font="11px sans-serif",s.fillText("Red=Spam, Green=OK",z-10,20)}if(g==="text"){if(s.textAlign="center",s.textBaseline="middle",!t||!t.text){s.fillStyle="#999",s.font="20px sans-serif",s.fillText("No text available",z/2,j/2);return}const et=n>.5,V=et?"#feeff0":"#effaf0";s.fillStyle=V,s.fillRect(0,0,z,j);const R=t.text;s.fillStyle="#333",s.font="24px serif";const Q=R.split(" ");let L="";const W=35,E=z/2;let G=j/3;const O=z-100;for(let ct=0;ct<Q.length;ct++){const ht=L+Q[ct]+" ";s.measureText(ht).width>O&&ct>0?(s.fillText(L,E,G),L=Q[ct]+" ",G+=W):L=ht}s.fillText(L,E,G),G+=60;const it=t.groundTruth===1;s.font="bold 16px sans-serif",s.fillStyle="#555",s.fillText(`Truth: ${it?"SPAM":"HAM"}`,E,G),G+=30;const _t=(n*100).toFixed(1);s.font="bold 20px sans-serif",s.fillStyle=et?"#c0392b":"#27ae60",s.fillText(`Prediction: ${et?"SPAM":"HAM"} (${_t}%)`,E,G);return}if(g==="features"){const V=(z-90)/2,R=(j-90)/2;[{x:30,y:30,...f[0]},{x:30+V+30,y:30,...f[1]},{x:30,y:30+R+30,...f[2]},{x:30+V+30,y:30+R+30,...f[3]}].forEach(L=>{if(s.strokeStyle="#ccc",s.strokeRect(L.x,L.y,V,R),s.fillStyle="#333",s.font="12px Arial",s.textAlign="center",s.fillText(L.label,L.x+V/2,L.y-5),e&&e.forEach(W=>{const E=W.input[L.idx],G=L.x+E/L.max*V,O=L.y+R-W.target*(R-20)-10;m.current.push({x:G,y:O,info:{x:G,y:O,text:W.text,target:W.target,isSpam:W.target===1,features:{valLabel:L.label,val:E}}});let it=null;if(i&&c)try{it=i.predict(W.input)>.5?"#e74c3c":"#2ecc71"}catch{}it&&(s.beginPath(),s.arc(G,O,4.5,0,2*Math.PI),s.strokeStyle=it,s.lineWidth=1,s.stroke()),s.beginPath(),s.arc(G,O,3,0,2*Math.PI),s.fillStyle=tt(W.target),s.globalAlpha=.6,s.fill(),s.globalAlpha=1}),t){const W=t[L.idx],E=L.x+W/L.max*V;s.beginPath(),s.moveTo(E,L.y),s.lineTo(E,L.y+R),s.strokeStyle="#3498db",s.setLineDash([5,5]),s.stroke(),s.setLineDash([])}})}if(M&&(g==="features"||g==="scatter"||g==="3d")){s.save(),s.fillStyle="rgba(0,0,0,0.85)",s.strokeStyle="#fff";const et=M.text||"No Text",V=gt(M.target!==void 0?M.target:M.isSpam?1:0),R=s.measureText(et),Q=Math.max(R.width,140)+20;let L=70;M.features&&(M.features.zLabel?L=90:M.features.yLabel?L=85:L=60);let W=M.x+15,E=M.y-15;W+Q>z&&(W=M.x-Q-10),E+L>j&&(E=M.y-L-10),E<0&&(E=M.y+20),s.beginPath(),s.roundRect(W,E,Q,L,5),s.fill(),s.lineWidth=1,s.stroke(),s.textBaseline="top",s.textAlign="left",s.font="bold 12px sans-serif",s.fillStyle=tt(M.target!==void 0?M.target:M.isSpam?1:0),s.fillText(V,W+10,E+10),s.fillStyle="#ddd",s.font="italic 11px sans-serif",s.fillText(et,W+10,E+28),M.features&&(s.fillStyle="#fff",s.font="11px monospace",M.features.xLabel?(s.fillText(`${M.features.xLabel}: ${M.features.xVal}`,W+10,E+46),s.fillText(`${M.features.yLabel}: ${M.features.yVal}`,W+10,E+60),M.features.zLabel&&s.fillText(`${M.features.zLabel}: ${M.features.zVal}`,W+10,E+74)):M.features.valLabel&&s.fillText(`${M.features.valLabel}: ${M.features.val}`,W+10,E+46)),s.restore()}},[e,t,n,i,g,x,_,w,I,c,Y,D]);const k={features:"Alle Features",scatter:"2D Plot","3d":"3D Plot",text:"Text Mode"};return a("div",{style:{textAlign:"center"},children:[!o&&a("div",{style:{marginBottom:"10px",display:"flex",gap:"5px",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",fontSize:"0.9rem"},children:[a("div",{children:h}),a("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[a("select",{value:g,onChange:v=>l(v.target.value),style:{padding:"4px"},children:r.map(v=>a("option",{value:v,children:k[v]},v))}),(g==="scatter"||g==="3d")&&a(xt,{children:[a("span",{children:"X:"}),a("select",{value:x,onChange:v=>p(parseInt(v.target.value)),style:{padding:"4px"},children:f.map(v=>a("option",{value:v.idx,children:v.label},v.idx))}),a("span",{children:"Y:"}),a("select",{value:_,onChange:v=>y(parseInt(v.target.value)),style:{padding:"4px"},children:f.map(v=>a("option",{value:v.idx,children:v.label},v.idx))})]}),g==="scatter"&&f.length===2&&a("label",{style:{display:"flex",alignItems:"center",gap:"3px",marginLeft:"5px",fontSize:"0.8rem",cursor:"pointer",background:"#f5f5f5",padding:"2px 5px",borderRadius:"3px",border:"1px solid #ddd"},children:[a("input",{type:"checkbox",checked:D,onChange:v=>X(v.target.checked)}),"Show Grid"]}),g==="3d"&&a(xt,{children:[a("span",{children:"Z:"}),a("select",{value:w,onChange:v=>C(parseInt(v.target.value)),style:{padding:"4px"},children:f.map(v=>a("option",{value:v.idx,children:v.label},v.idx))})]})]})]}),a("canvas",{ref:d,width:600,height:400,style:{border:"1px solid #eee",maxWidth:"100%",borderRadius:"4px",cursor:M?"pointer":g==="3d"||g==="scatter"?A.current?"grabbing":"grab":"default"},onWheel:P,onMouseDown:F,onMouseMove:S,onMouseUp:N,onMouseLeave:N,onMouseOut:$,onClick:T}),!o&&a("div",{class:"control-text",style:{fontSize:"0.8rem",color:"#666",marginTop:"5px"},children:g==="3d"?"Drag to rotate 3D view":g==="scatter"?"Drag to Pan, Scroll to Zoom":"Wähle Achsen für die Visualisierung"})]})}const De=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Zt=e=>{const t=["winner","won","gift card","urgent","rolex","viagra","cash","prize","singles","marketing","buy","free","money","security alert","click","claim","fake","verification"],n=e.toLowerCase();let i=0;t.forEach(h=>{n.includes(h)&&(i+=1)}),i>10&&(i=10);const r=(e.match(/[A-Z]/g)||[]).length/10,o=(e.match(/http/g)||[]).length,c=e.split(/\s+/).length/50;return[i,r,o,c]},Rt={id:"multiple_inputs",title:"Phase 3: Multiple Inputs",description:"Advanced spam detection with two linear features (words and links). The network learns a separation line.",Model:an,GroundTruth:he,CanvasComponent:de,defaultParams:{weights:[0,0,0,0],bias:0},groundTruthDefaults:[[1.5,.5,2,-.5],-5],getInput:e=>{const t=Math.floor(e*.3),n=De(t)>.5,i=n?Rt.examples.spam:Rt.examples.ham,r=Math.floor(De(t+99)*i.length),o=i[r],c=Zt(o);return c.text=o,c.groundTruth=n?1:0,c},examples:{spam:["WINNER! Won $1000 Gift Card! Claim at http://prize-giveaway.net","URGENT: Verify account at http://secure-bank-login.com/fraud","Cheap Rolex watches! 50% OFF at www.fake-watches.cn","Lose weight fast! Buy pills: http://diet-miracle.com","CONGRATS! Cash prize waiting: http://claim-money.org","HOT singles waiting! Chat now: http://local-dating.xyz","Refinance 1% APR. Apply: http://easy-loans.biz","Buy 1 get 1 FREE Viagra. http://meds-direct.com","Meet rich men. Signup: http://millionaire-match.com","SECURITY ALERT: Suspicious activity. Check http://account-security-check.com"],ham:["Meeting agenda for tomorrow's team sync","Hey, are we still on for lunch?","Invoice #12345 from AWS Services","Project deadline extended to Friday","Happy Birthday! Hope you have a great day.","Can you review this pull request?","Your Amazon order has shipped.","Fwd: Tickets for the concert","Question about the quarterly report","Let's catch up sometime next week."]},generateData:e=>{const t=[];Rt.examples.spam.forEach(n=>{const i=Zt(n),r=()=>(Math.random()-.5)*.1,o=i.map(c=>Math.max(0,c+r()));t.push({input:o,target:1,text:n})}),Rt.examples.ham.forEach(n=>{const r=Zt(n).map(o=>Math.max(0,o+(Math.random()-.5)*.1));t.push({input:r,target:0,text:n})});for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t},trainingConfig:{maxSteps:3e3,params:[{name:"w1 (Spam Words)",min:1,max:4,step:.5},{name:"w2 (Capitals)",min:0,max:2,step:.5},{name:"w3 (Links)",min:0,max:3,step:.5},{name:"w4 (Total Words)",min:-2,max:2,step:.5},{name:"bias",min:-8,max:8,step:2}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + w₃x₃ + w₄x₄ + b)",inputLabels:["Spam Words","Caps (/10)","Links","Words (/50)"],outputLabel:"Spam (p)",biasLabel:"b"},isFinished:e=>e>=50};class Yn{constructor(t=2,n=10){this.inputCount=t,this.hiddenCount=n;const i=Math.sqrt(6/(t+n));this.weights1=Array(n).fill(0).map(()=>Array.from({length:t},()=>Math.random()*2*i-i)),this.biases1=Array(n).fill(0);const r=Math.sqrt(6/(n+1));this.weights2=Array.from({length:n},()=>Math.random()*2*r-r),this.bias2=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=[];for(let o=0;o<this.hiddenCount;o++){let c=this.biases1[o];for(let h=0;h<this.inputCount;h++)c+=this.weights1[o][h]*t[h];n.push(this.sigmoid(c))}let i=this.bias2;for(let o=0;o<this.hiddenCount;o++)i+=this.weights2[o]*n[o];return this.sigmoid(i)}getActivations(t){const n=[];for(let o=0;o<this.hiddenCount;o++){let c=this.biases1[o];for(let h=0;h<this.inputCount;h++)c+=this.weights1[o][h]*t[h];n.push(this.sigmoid(c))}let i=this.bias2;for(let o=0;o<this.hiddenCount;o++)i+=this.weights2[o]*n[o];const r=this.sigmoid(i);return{hidden:n,output:[r]}}setParams(t){for(let i=0;i<this.hiddenCount;i++){const r=`b1_${i}`;t[r]!==void 0&&(this.biases1[i]=t[r]);for(let o=0;o<this.inputCount;o++){const c=`w1_${i}_${o}`;t[c]!==void 0&&(this.weights1[i][o]=t[c])}}const n="b2";t[n]!==void 0&&(this.bias2=t[n]);for(let i=0;i<this.hiddenCount;i++){const r=`w2_${i}`;t[r]!==void 0&&(this.weights2[i]=t[r])}}getTopology(){return{inputCount:this.inputCount,hiddenCounts:[this.hiddenCount],outputCount:1,weights1:this.weights1,biases1:this.biases1,weights2:this.weights2,bias2:this.bias2}}}const ln=[{label:"Total Words",idx:0,max:400},{label:"Links",idx:1,max:10}],jt=[{input:[367,5],target:0,text:"Attached is the quarterly report found at..."},{input:[365,2],target:0,text:"Attached is the quarterly report found at..."},{input:[364,6],target:0,text:"Attached is the quarterly report found at..."},{input:[327,7],target:0,text:"Attached is the quarterly report found at..."},{input:[302,5],target:0,text:"Attached is the quarterly report found at..."},{input:[314,3],target:0,text:"Attached is the quarterly report found at..."},{input:[345,4],target:0,text:"Attached is the quarterly report found at..."},{input:[265,5],target:0,text:"Attached is the quarterly report found at..."},{input:[287,4],target:0,text:"Attached is the quarterly report found at..."},{input:[311,1],target:0,text:"Attached is the quarterly report found at..."},{input:[268,2],target:0,text:"Attached is the quarterly report found at..."},{input:[283,0],target:0,text:"Attached is the quarterly report found at..."},{input:[261,3],target:0,text:"Attached is the quarterly report found at..."},{input:[197,0],target:0,text:"Just a normal short message."},{input:[150,0],target:0,text:"Just a normal short message."},{input:[124,0],target:0,text:"Just a normal short message."},{input:[65,1],target:0,text:"Just a normal short message."},{input:[85,0],target:0,text:"Just a normal short message."},{input:[58,0],target:0,text:"Just a normal short message."},{input:[45,0],target:0,text:"Security Alert: Login Code 2542"},{input:[36,0],target:0,text:"Security Alert: Login Code 5607"},{input:[38,1],target:0,text:"Security Alert: Login Code 909"},{input:[24,1],target:0,text:"Security Alert: Login Code 8385"},{input:[17,1],target:0,text:"Security Alert: Login Code 2083"},{input:[215,1],target:1,text:"You won a prize! Click here."},{input:[230,3],target:1,text:"You won a prize! Click here."},{input:[234,5],target:1,text:"You won a prize! Click here."},{input:[221,2],target:1,text:"You won a prize! Click here."},{input:[215,4],target:1,text:"You won a prize! Click here."},{input:[153,3],target:1,text:"You won a prize! Click here."},{input:[152,1],target:1,text:"You won a prize! Click here."},{input:[137,2],target:1,text:"You won a prize! Click here."},{input:[124,4],target:1,text:"You won a prize! Click here."},{input:[120,2],target:1,text:"You won a prize! Click here."},{input:[92,3],target:1,text:"You won a prize! Click here."},{input:[93,5],target:1,text:"You won a prize! Click here."},{input:[86,5],target:1,text:"You won a prize! Click here."},{input:[84,3],target:1,text:"You won a prize! Click here."},{input:[53,4],target:1,text:"You won a prize! Click here."},{input:[55,3],target:1,text:"You won a prize! Click here."}],oe=()=>(console.log("Using prepared data with length "+jt.length),jt),ze={id:"single_layer_nonlinear",title:"Phase 4: Single Layer Nonlinear Data",description:"Spam detection with only 2 features but complex distribution. A simple linear classifier (perceptron) will fail here.",Model:an,GroundTruth:he,CanvasComponent:de,defaultParams:{weights:[0,0],bias:0},getInput:e=>{const t=Math.floor(e*.5)%jt.length,n=jt[t],i=[...n.input];return i.text=n.text,i.groundTruth=n.target,i},generateData:e=>oe(),trainingConfig:{maxSteps:4e3,params:[{name:"w1 (Words)",min:-5,max:5,step:.5},{name:"w2 (Links)",min:-5,max:5,step:.5},{name:"bias",min:-10,max:10,step:1}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + b)",inputLabels:["Spam Words","Links"],outputLabel:"Spam (p)",biasLabel:"b"},featuresConfig:ln,isFinished:e=>!1},Hn=()=>{const e=[];for(let t=0;t<10;t++){e.push({name:`b1_${t}`,min:-30,max:30,step:1});for(let n=0;n<2;n++)e.push({name:`w1_${t}_${n}`,min:-30,max:30,step:1})}e.push({name:"b2",min:-3,max:3,step:1});for(let t=0;t<10;t++)e.push({name:`w2_${t}`,min:-50,max:50,step:1});return e},$e={id:"double_layer_nonlinear",title:"Phase 5: Double Layer Nonlinear Data",description:'Spam detection with a Hidden Layer (10 neurons). The Deep Neural Network can detect the nonlinear distribution ("Spam Island").',Model:Yn,GroundTruth:he,CanvasComponent:de,defaultParams:{},getInput:e=>{const t=oe(),n=Math.floor(e*.5)%t.length,i=t[n],r=[...i.input];return r.text=i.text,r.groundTruth=i.target,r},generateData:e=>oe(),trainingConfig:{seed:1319434789,maxSteps:1e4,params:Hn()},networkViz:{formula:"p = σ(W₂ · σ(W₁ · x + b₁) + b₂)",inputLabels:[`Spam
Words`,"Links"],outputLabel:"Spam (p)",biasLabel:"b"},featuresConfig:ln,isFinished:e=>e>=50},Ee={[We.id]:We,[Re.id]:Re,[Rt.id]:Rt,[ze.id]:ze,[$e.id]:$e};function Bn(e){return Ee[e]||Ee.linear_regression}function fe(e){const[t,n]=ot(null),i=bt(null),r=bt(null),[o,c]=ot(0),[h,f]=ot(!1),[d,g]=ot([]),[l,x]=ot([]),[p,_]=ot(-1),[y,w]=ot(!1),[C,D]=ot("simulation"),[X,I]=ot("table"),[J,Y]=ot("random"),[B,A]=ot("Ready."),u=bt(0);Tt(()=>{if(!e)return;if(e==="gallery"){n({id:"gallery",type:"gallery"});return}const S=Bn(e);if(!S){A("Error: Simulation not found.");return}try{if(i.current=new S.GroundTruth(...S.groundTruthDefaults||[]),r.current=new S.Model,S.defaultParams&&(S.defaultParams.weight!==void 0&&r.current.setWeight(S.defaultParams.weight),S.defaultParams.weights!==void 0&&r.current.setWeights&&r.current.setWeights(S.defaultParams.weights),S.defaultParams.bias!==void 0&&r.current.setBias(S.defaultParams.bias)),n(S),i.current)try{const N=S.generateData(i.current);g(N)}catch(N){console.error("Auto-generate data error:",N)}}catch(N){console.error("Initialization Error:",N),A(`Init Error: ${N.message}`)}},[e]),Tt(()=>{let S;const N=$=>{if(!h)return;u.current===0&&(u.current=$);const U=($-u.current)/1e3;u.current=$;const T=Math.min(U,.1);c(k=>{const s=k+T*3;return t&&t.isFinished&&t.isFinished(s)&&(f(!1),A("Simulation finished.")),s}),S=requestAnimationFrame(N)};return h&&(u.current=0,S=requestAnimationFrame(N)),()=>cancelAnimationFrame(S)},[h,t]);const M=()=>{c(0),f(!0),A("Simulation running..."),D("simulation")},b=()=>{f(!1),A("Simulation paused.")},m=()=>{h?b():M()},P=async()=>{try{if(d.length===0||!t)return;w(!0),_(0),x([]),A("Searching for optimal weight and bias (Live Visualization)..."),D("training");const S=new t.Model,N=new Rn(S),$=(T,k)=>{if(x(v=>{const s=[...v,...T];return _(s.length-1),s}),k&&k.message&&A(k.message),k&&k.bestParams)if(r.current.setParams)r.current.setParams(k.bestParams);else if(r.current.setWeights){const{weights:v,bias:s}=k.bestParams;r.current.setWeights(v),r.current.setBias(s)}else r.current.setWeight&&k.bestParams&&k.bestParams.weights&&k.bestParams.weights.length>=1&&(r.current.setWeight(k.bestParams.weights[0]),r.current.setBias(k.bestParams.bias));else k&&k.bestWeight!==void 0&&(r.current.setWeight(k.bestWeight),r.current.setBias(k.bestBias))};let U;if(J==="random"){A("Searching for optimal weight and bias (Random Search)...");const T={seed:t.trainingConfig.seed,maxSteps:t.trainingConfig.maxSteps,initialRadius:t.trainingConfig.initialRadius,phase1Ratio:t.trainingConfig.phase1Ratio};U=await N.trainRandomAsync(d,t.trainingConfig.params,$,T)}else t.trainingConfig.params?U=await N.trainAsync(d,t.trainingConfig.params,$):U=await N.trainAsync(d,t.trainingConfig.weightRange,t.trainingConfig.biasRange,$);A(`Training finished! Min Error: ${U.minError.toFixed(5)}`),w(!1)}catch(S){console.error("Training Error:",S),w(!1),A(`Training Error: ${S.message}`)}},F=t&&t.getInput?t.getInput(o):void 0;return{simConfig:t,groundTruth:i,neuralNet:r,time:o,currentInput:F,isRunning:h,trainingData:d,trainingHistory:l,trainingStepIndex:p,isTraining:y,activeTab:C,dataViewMode:X,trainerType:J,statusMsg:B,handleTrain:P,handleRun:m,handleStop:b,toggleRun:m,setTrainerType:Y,setActiveTab:D,setDataViewMode:I}}function Fn({history:e,currentStepIndex:t,isTraining:n,paramsConfig:i,showAccuracyPlot:r=!0}){const o=bt(null),[c,h]=ot(0),f=6;Tt(()=>{h(0)},[i]),Tt(()=>{const g=o.current;if(!g||!e||e.length===0)return;const l=g.getContext("2d"),x=g.width,p=g.height;l.clearRect(0,0,x,p),l.fillStyle="#fff",l.fillRect(0,0,x,p);const _=Math.max(...e.map(B=>B.error)),w=!n&&e.length>0?e.length-1:t!==null&&t>=0?Math.min(t,e.length-1):-1;let C=-1,D=1/0;for(let B=0;B<=w;B++)e[B].error<D&&(D=e[B].error,C=B);let X=[];if(i){const B=r?2:1,A=B+i.length,u=c*f,M=Math.min(u+f,A),b=3,m=2,P=x/b,F=p/m;for(let S=u;S<M;S++){const N=S-u,$=N%b,U=Math.floor(N/b),T=$*P,k=U*F;if(r&&S===0){const v=Math.max(10,e.length-1);X.push({type:"accuracy_step",xLabel:"Training Step",xMin:0,xMax:v,yMode:"accuracy",getValue:(s,z)=>z,getYValue:s=>s.accuracy||0,offsetX:T,offsetY:k,w:P,h:F,showYAxis:!0})}else if(r&&S===1||!r&&S===0){const v=Math.max(10,e.length-1);X.push({type:"error_step",xLabel:"Training Step",xMin:0,xMax:v,yMode:"error_log",getValue:(s,z)=>z,getYValue:s=>s.error,offsetX:T,offsetY:k,w:P,h:F,showYAxis:!0})}else{const v=S-B,s=i[v],z=e.map(tt=>tt.params[v]),j=Math.min(...z),K=Math.max(...z);X.push({type:"param_error",xLabel:s.name,xMin:j,xMax:K,yMode:"error_log",getValue:tt=>tt.params[v],getYValue:tt=>tt.error,offsetX:T,offsetY:k,w:P,h:F})}}}else{const B=x/2,A=p/2,u=e.map(m=>m.weight),M=e.map(m=>m.bias),b=Math.max(10,e.length-1);X=[],r&&X.push({type:"accuracy_step",xLabel:"Accuracy",xMin:0,xMax:b,yMode:"accuracy",getValue:(m,P)=>P,getYValue:m=>m.accuracy||0,offsetX:0,offsetY:0,w:B,h:A,showYAxis:!0}),X.push({type:"error_step",xLabel:"Step",xMin:0,xMax:b,yMode:"error_log",getValue:(m,P)=>P,getYValue:m=>m.error,offsetX:r?B:0,offsetY:0,w:B,h:A,showYAxis:!0},{xLabel:"Weight",xMin:Math.min(...u),xMax:Math.max(...u),yMode:"error_log",getValue:m=>m.weight,getYValue:m=>m.error,offsetX:r?0:B,offsetY:r?A:0,w:B,h:A},{xLabel:"Bias",xMin:Math.min(...M),xMax:Math.max(...M),yMode:"error_log",getValue:m=>m.bias,getYValue:m=>m.error,offsetX:r?B:0,offsetY:A,w:B,h:A})}const I=50;X.forEach(B=>{const{xLabel:A,xMin:u,xMax:M,getValue:b,getYValue:m,offsetX:P,offsetY:F,w:S,h:N,yMode:$,showYAxis:U}=B,T=s=>P+I+(s-u)/(M-u||1)*(S-2*I);let k;if($==="accuracy")k=s=>F+N-I-s*(N-2*I);else{const z=_||1;k=j=>{const K=(j-0)/(z-0);return F+N-I-K*(N-2*I)}}l.strokeStyle="#eee",l.lineWidth=2,l.strokeRect(P,F,S,N),l.beginPath(),l.strokeStyle="#333",l.lineWidth=2,l.moveTo(P+I,F+I),l.lineTo(P+I,F+N-I),l.lineTo(P+S-I,F+N-I),l.stroke(),l.fillStyle="#333",l.font="22px sans-serif",l.textAlign="center";let v=A;if(v.length>20&&(v=v.substring(0,18)+"..."),l.fillText(v,P+S/2,F+N-15),P===0||U)if(l.save(),l.translate(P+15,F+N/2),l.rotate(-Math.PI/2),$==="accuracy")l.fillText("Accuracy",0,0),l.restore(),l.textAlign="right",l.fillStyle="#666",l.font="18px sans-serif",[0,.25,.5,.75,1].forEach(s=>{const z=k(s);l.fillText(s.toFixed(2),P+I-8,z+6),l.beginPath(),l.lineWidth=1,l.strokeStyle="#f0f0f0",l.moveTo(P+I,z),l.lineTo(P+S-I,z),l.stroke()});else{l.fillText("Error",0,0),l.restore(),l.textAlign="right",l.fillStyle="#666",l.font="18px sans-serif";const s=5;for(let z=0;z<=s;z++){const j=z/s*_,K=k(j);l.fillText(j.toFixed(2),P+I-8,K+6),z>0&&(l.beginPath(),l.lineWidth=1,l.strokeStyle="#f0f0f0",l.moveTo(P+I,K),l.lineTo(P+S-I,K),l.stroke())}}l.fillStyle="#666",l.font="18px sans-serif",l.textAlign="center",l.fillText(u.toFixed(1),P+I,F+N-I+25),l.fillText(M.toFixed(1),P+S-I,F+N-I+25),l.fillStyle=$==="accuracy"?"rgba(155, 89, 182, 0.4)":"rgba(52, 152, 219, 0.4)";for(let s=0;s<=w;s++){const z=b(e[s],s),j=m(e[s]),K=T(z),tt=k(j);l.fillRect(K,tt,4,4)}if(C>=0){const s=b(e[C],C),z=m(e[C]),j=T(s),K=k(z);l.beginPath(),l.fillStyle="#2ecc71",l.strokeStyle="#27ae60",l.lineWidth=2,l.arc(j,K,10,0,Math.PI*2),l.fill(),l.stroke()}if(n&&t!==null&&t>=0&&t<=w){const s=b(e[t],t),z=m(e[t]),j=T(s),K=k(z);l.beginPath(),l.fillStyle="#e74c3c",l.strokeStyle="#c0392b",l.lineWidth=2,l.arc(j,K,8,0,Math.PI*2),l.fill(),l.stroke()}});const J=x-150,Y=20;l.fillStyle="rgba(255,255,255,0.9)",l.fillRect(J,Y,140,70),l.strokeStyle="#ccc",l.lineWidth=1,l.strokeRect(J,Y,140,70),l.textAlign="left",l.font="16px sans-serif",l.beginPath(),l.fillStyle="#e74c3c",l.arc(J+15,Y+20,6,0,Math.PI*2),l.fill(),l.fillStyle="#333",l.fillText("Current Scan",J+30,Y+25),l.beginPath(),l.fillStyle="#2ecc71",l.arc(J+15,Y+50,6,0,Math.PI*2),l.fill(),l.fillStyle="#333",l.fillText("Best So Far",J+30,Y+55),!n&&C>=0&&(l.fillStyle="#333",l.font="bold 18px sans-serif",l.textAlign="right",l.fillText(`Min Error: ${D.toFixed(5)}`,x-20,p-20))},[e,t,n,i,c]);const d=i?Math.ceil((i.length+1)/f):1;return a("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff"},children:[a("canvas",{ref:o,width:1600,height:800,style:{width:"100%",height:"auto"}}),d>1&&a("div",{style:{display:"flex",justifyContent:"center",marginTop:"10px",gap:"10px"},children:[a("button",{onClick:()=>h(g=>Math.max(0,g-1)),disabled:c===0,children:"Previous"}),a("span",{style:{alignSelf:"center"},children:["Page ",c+1," of ",d]}),a("button",{onClick:()=>h(g=>Math.min(d-1,g+1)),disabled:c===d-1,children:"Next"})]})]})}function Xn(e,t){for(var n in t)e[n]=t[n];return e}function Ne(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var i in t)if(i!=="__source"&&e[i]!==t[i])return!0;return!1}function Ie(e,t){this.props=e,this.context=t}(Ie.prototype=new Pt).isPureReactComponent=!0,Ie.prototype.shouldComponentUpdate=function(e,t){return Ne(this.props,e)||Ne(this.state,t)};var Ve=Z.__b;Z.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Ve&&Ve(e)};var On=Z.__e;Z.__e=function(e,t,n,i){if(e.then){for(var r,o=t;o=o.__;)if((r=o.__c)&&r.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t)}On(e,t,n,i)};var Ye=Z.unmount;function cn(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(i){typeof i.__c=="function"&&i.__c()}),e.__c.__H=null),(e=Xn({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(i){return cn(i,t,n)})),e}function un(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(i){return un(i,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function Jt(){this.__u=0,this.o=null,this.__b=null}function hn(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Yt(){this.i=null,this.l=null}Z.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),Ye&&Ye(e)},(Jt.prototype=new Pt).__c=function(e,t){var n=t.__c,i=this;i.o==null&&(i.o=[]),i.o.push(n);var r=hn(i.__v),o=!1,c=function(){o||(o=!0,n.__R=null,r?r(h):h())};n.__R=c;var h=function(){if(!--i.__u){if(i.state.__a){var f=i.state.__a;i.__v.__k[0]=un(f,f.__c.__P,f.__c.__O)}var d;for(i.setState({__a:i.__b=null});d=i.o.pop();)d.forceUpdate()}};i.__u++||32&t.__u||i.setState({__a:i.__b=i.__v.__k[0]}),e.then(c,c)},Jt.prototype.componentWillUnmount=function(){this.o=[]},Jt.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=cn(this.__b,n,i.__O=i.__P)}this.__b=null}var r=t.__a&&ne(xt,null,e.fallback);return r&&(r.__u&=-33),[ne(xt,null,t.__a?null:e.children),r]};var He=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};(Yt.prototype=new Pt).__a=function(e){var t=this,n=hn(t.__v),i=t.l.get(e);return i[0]++,function(r){var o=function(){t.props.revealOrder?(i.push(r),He(t,e,i)):r()};n?n(o):o()}},Yt.prototype.render=function(e){this.i=null,this.l=new Map;var t=Xt(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},Yt.prototype.componentDidUpdate=Yt.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){He(e,n,t)})};var Un=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,jn=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Gn=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,qn=/[A-Z0-9]/g,Kn=typeof document<"u",Zn=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};Pt.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Pt.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Be=Z.event;function Jn(){}function Qn(){return this.cancelBubble}function ti(){return this.defaultPrevented}Z.event=function(e){return Be&&(e=Be(e)),e.persist=Jn,e.isPropagationStopped=Qn,e.isDefaultPrevented=ti,e.nativeEvent=e};var ei={enumerable:!1,configurable:!0,get:function(){return this.class}},Fe=Z.vnode;Z.vnode=function(e){typeof e.type=="string"&&(function(t){var n=t.props,i=t.type,r={},o=i.indexOf("-")===-1;for(var c in n){var h=n[c];if(!(c==="value"&&"defaultValue"in n&&h==null||Kn&&c==="children"&&i==="noscript"||c==="class"||c==="className")){var f=c.toLowerCase();c==="defaultValue"&&"value"in n&&n.value==null?c="value":c==="download"&&h===!0?h="":f==="translate"&&h==="no"?h=!1:f[0]==="o"&&f[1]==="n"?f==="ondoubleclick"?c="ondblclick":f!=="onchange"||i!=="input"&&i!=="textarea"||Zn(n.type)?f==="onfocus"?c="onfocusin":f==="onblur"?c="onfocusout":Gn.test(c)&&(c=f):f=c="oninput":o&&jn.test(c)?c=c.replace(qn,"-$&").toLowerCase():h===null&&(h=void 0),f==="oninput"&&r[c=f]&&(c="oninputCapture"),r[c]=h}}i=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=Xt(n.children).forEach(function(d){d.props.selected=r.value.indexOf(d.props.value)!=-1})),i=="select"&&r.defaultValue!=null&&(r.value=Xt(n.children).forEach(function(d){d.props.selected=r.multiple?r.defaultValue.indexOf(d.props.value)!=-1:r.defaultValue==d.props.value})),n.class&&!n.className?(r.class=n.class,Object.defineProperty(r,"className",ei)):(n.className&&!n.class||n.class&&n.className)&&(r.class=r.className=n.className),t.props=r})(e),e.$$typeof=Un,Fe&&Fe(e)};var Xe=Z.__r;Z.__r=function(e){Xe&&Xe(e),e.__c};var Oe=Z.diffed;Z.diffed=function(e){Oe&&Oe(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value)};function ni({model:e,inputs:t,inputLabels:n,output:i,outputLabel:r,formula:o}){if(!e||!e.getTopology)return null;const c=e.getTopology(),{inputCount:h,hiddenCounts:f,outputCount:d,weights1:g,biases1:l,weights2:x}=c,p=c.biases2||(c.bias2!==void 0?[c.bias2]:null);let _={hidden:[],output:[]};e.getActivations&&(_=e.getActivations(t));const[y,w]=ot(null),[C,D]=ot(!1),X=400,I=400,J=I/2,Y=X/2,B=300,A=300,u=Y-B/2,M=Y+B/2,b=[{count:h,x:u,labels:n,values:t},{count:f[0],x:Y,values:_.hidden},{count:d,x:M,labels:[r],values:_.output}];Math.max(...b.map(T=>T.count));const m=(T,k)=>{const v=b[T].count;let s=Math.min(50,A/v);const z=(v-1)*s;return J-z/2+k*s},P=(T,k)=>{y&&y.layer===T&&y.index===k?w(null):w({layer:T,index:k})},F=(T,k,v,s)=>y?y.layer===T&&y.index===k||y.layer===v&&y.index===s:!1,S=(T,k)=>y&&y.layer===T&&y.index===k;if(C)return a("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center",height:"400px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[a("div",{style:{flex:"0 0 auto",marginBottom:"10px"},children:a("h3",{style:{margin:"0",fontSize:"1rem",color:"#555"},children:"Network Parameters"})}),a("div",{style:{flex:"1 1 auto",overflow:"auto",display:"flex",justifyContent:"center",alignItems:"flex-start"},children:a("div",{style:{display:"flex",gap:"20px",alignItems:"flex-start",justifyContent:"center",flexWrap:"wrap",paddingBottom:"10px"},children:[a("div",{style:{textAlign:"center"},children:[a("h4",{style:{fontSize:"0.9rem",marginBottom:"5px"},children:"Layer 1 Weights"}),a(ii,{data:g}),a("h4",{style:{fontSize:"0.9rem",marginBottom:"5px",marginTop:"10px"},children:"Layer 1 Biases"}),a(Qt,{data:l})]}),a("div",{style:{textAlign:"center"},children:[a("h4",{style:{fontSize:"0.9rem",marginBottom:"5px"},children:"Layer 2 Weights (to Output)"}),a(Qt,{data:Array.isArray(x[0])?x.flat():x,isVertical:!0}),p&&a(xt,{children:[a("h4",{style:{fontSize:"0.9rem",marginBottom:"5px",marginTop:"10px"},children:"Layer 2 Bias"}),a(Qt,{data:Array.isArray(p)?p:[p]})]})]})]})}),a("div",{style:{flex:"0 0 auto",marginTop:"10px",cursor:"pointer",fontStyle:"italic",color:"#777",padding:"5px"},onClick:()=>D(!1),children:"Back to Network"})]});const N=[{fill:"#e3f2fd",stroke:"#2196f3",highlight:"#1976d2"},{fill:"#f3e5f5",stroke:"#9c27b0",highlight:"#7b1fa2"},{fill:"#e8f5e9",stroke:"#4caf50",highlight:"#388e3c"}],$="#bdbdbd",U="#ff9800";return a("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center"},children:[a("h3",{style:{marginBottom:"10px",fontSize:"1rem",color:"#555"},children:"Neural Network Activity"}),a("svg",{width:X,height:I,style:{overflow:"visible"},children:[a("rect",{x:u,y:J-A/2,width:B,height:A,rx:"15",fill:"none",stroke:"#333",strokeWidth:"2"}),g.map((T,k)=>T.map((v,s)=>{const z=F(0,s,1,k),j=y&&!z,K=z?U:$,tt=z?3:1.5,gt=j?.2:1;return a("line",{x1:b[0].x,y1:m(0,s),x2:b[1].x,y2:m(1,k),stroke:K,strokeWidth:tt,strokeOpacity:gt,style:{transition:"all 0.3s ease"}},`L0-${s}-${k}`)})),x.map((T,k)=>{const v=F(1,k,2,0),s=y&&!v,z=v?U:$,j=v?3:1.5,K=s?.2:1;return a("line",{x1:b[1].x,y1:m(1,k),x2:b[2].x,y2:m(2,0),stroke:z,strokeWidth:j,strokeOpacity:K,style:{transition:"all 0.3s ease"}},`L1-${k}-0`)}),b.map((T,k)=>a("g",{children:Array.from({length:T.count}).map((v,s)=>{const z=T.x,j=m(k,s),K=T.values&&T.values[s]!==void 0?T.values[s]:0,tt=S(k,s),gt=N[k]||N[0];return a("g",{onClick:()=>P(k,s),style:{cursor:"pointer"},children:[a("circle",{cx:z,cy:j,r:12,fill:tt?gt.highlight:gt.fill,stroke:gt.stroke,strokeWidth:tt?"3":"2",style:{transition:"all 0.3s ease"}}),T.labels&&a("text",{x:k===0?z-18:z+18,y:j,textAnchor:k===0?"end":"start",style:{textAnchor:k===0?"end":"start",pointerEvents:"none"},dominantBaseline:"middle",fontSize:"14",fontWeight:"600",fill:"#444",children:(T.labels[s]||"").toString().split(`
`).map((et,V,R)=>a("tspan",{x:k===0?z-18:z+18,dy:V===0?`${(R.length-1)*-.6}em`:"1.2em",children:et},V))}),a("title",{children:K.toFixed(3)})]},`n-${k}-${s}`)})},`layer-${k}`)),o&&a("foreignObject",{className:"formula",x:Y-200,y:I-25,width:400,height:20,children:a("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",fontSize:"18px",fontStyle:"italic",color:"#777",cursor:"pointer",userSelect:"none"},onClick:()=>D(!0),title:"Click to view matrices",children:o})})]})]})}function ii({data:e}){return e?a("div",{style:{display:"grid",gridTemplateColumns:`repeat(${e[0].length}, 1fr)`,gap:"2px",border:"1px solid #999",padding:"2px",background:"#eee"},children:e.map((t,n)=>t.map((i,r)=>a("div",{style:{padding:"2px 4px",background:"#fff",fontSize:"10px",textAlign:"center"},children:i.toFixed(2)},`${n} -${r} `)))}):null}function Qt({data:e,isVertical:t=!1}){if(!e)return null;const n=Array.isArray(e)?e:[e];return a("div",{style:{display:"flex",flexDirection:t?"column":"row",gap:"2px",border:"1px solid #999",padding:"2px",background:"#eee"},children:n.map((i,r)=>a("div",{style:{padding:"2px 4px",background:"#fff",fontSize:"10px",textAlign:"center"},children:i.toFixed(2)},r))})}function dn({input:e,weight:t,bias:n,output:i,formula:r="y = w * x + b",inputLabel:o="Input",outputLabel:c="Output",biasLabel:h="b",decimals:f=1,model:d=null}){if(d&&d.getTopology){let $=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&($=e.input);const U=Array.isArray($)?$:[$],T=Array.isArray(o)?o:[o];return a(ni,{model:d,inputs:U,inputLabels:T,output:i,outputLabel:c,formula:r})}let g=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(g=e.input);const l=Array.isArray(g)?g:[g],x=Array.isArray(t)?t:[t],p=Array.isArray(o)?o:[o],_=Number(n)||0,y=Number(i)||0,w=l.length,C=24,D=90,X=260,I=60,J=60,Y=Math.max(1,w-1)*D,B=Math.max(150,Y+I+J),A=B+60,u=600,M=u/2+10,b=M-X/2,m=M+X/2,P=B/2+20,F=P-Y/2,S=m-50,N=S-60;return a("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[a("div",{className:"model-title",style:{marginBottom:"10px"},children:"Model Architecture"}),a("svg",{width:u,height:A,style:{overflow:"visible"},children:[a("defs",{children:a("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"27",refY:"3.5",orient:"auto",children:a("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#333"})})}),a("rect",{x:b,y:20,width:X,height:B,rx:"15",fill:"none",stroke:"#333",strokeWidth:"2"}),(()=>{const $=P-50;return a(xt,{children:[l.map((U,T)=>{const k=w>1?F+T*D:P,v=Number(x[T])||0,s=p[T]||`x${T+1}`,z=Number(U)||0;return a("g",{children:[a("line",{x1:b,y1:k,x2:N,y2:P,stroke:"#666",strokeWidth:"1"}),a("g",{transform:`translate(${(b+N)/2+(1-(w-1)/2)*5}, ${(k+P)/2})`,children:[a("rect",{x:"-24",y:"-8",width:"50",height:"18",fill:"#fff",rx:"4",stroke:"#e0e0e0"}),a("text",{x:"0",y:"5",textAnchor:"middle",fill:"#e74c3c",fontSize:"10",fontWeight:"bold",children:v.toFixed(1)})]}),a("circle",{cx:b,cy:k,r:C,fill:"#fff",stroke:"#333",strokeWidth:"2"}),a("text",{x:b-30,y:k+2,textAnchor:"end",style:{textAnchor:"end"},dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:s.toString().split(`
`).map((j,K,tt)=>a("tspan",{x:b-30,dy:K===0?`${(tt.length-1)*-.6}em`:"1.2em",children:j},K))}),a("text",{x:b-1,y:k+2,textAnchor:"middle",dominantBaseline:"middle",fontSize:"14",fill:"#333",children:z.toFixed(f)})]},T)}),a("line",{x1:N,y1:P,x2:S,y2:P,stroke:"#666",strokeWidth:"1"}),a("g",{transform:`translate(${S}, ${P})`,children:[a("rect",{x:"-18",y:"-18",width:"36",height:"36",rx:"6",fill:"#fff",stroke:"#333",strokeWidth:"2"}),a("path",{d:"M -10 8 C -4 8, -4 -8, 10 -8",stroke:"#333",strokeWidth:"2",fill:"none"})]}),a("line",{x1:S+18,y1:P,x2:m-C,y2:P,stroke:"#333",strokeWidth:"2"}),a("path",{d:`M ${S-20} ${$} Q ${S-20} ${P} ${N+10} ${P}`,fill:"none",stroke:"#f39c12",strokeWidth:"1"}),a("circle",{cx:S-20,cy:$,r:12,fill:"#f1c40f",stroke:"#f39c12"}),a("text",{x:S-20,y:$+2,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fontWeight:"bold",fill:"#fff",children:"b"}),a("text",{x:S-2,y:$+1,textAnchor:"start",dominantBaseline:"middle",fontSize:"12",fill:"#f39c12",fontWeight:"bold",children:_.toFixed(2)})]})})(),a("circle",{cx:m,cy:P,r:C,fill:"#fff",stroke:"#333",strokeWidth:"2"}),a("text",{x:m+6,y:P+3,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",children:y.toFixed(2)}),a("text",{x:m+30,y:P+2,textAnchor:"start",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:c.toString().split(`
`).map(($,U,T)=>a("tspan",{x:m+33,dy:U===0?`${(T.length-1)*-.6}em`:"1.2em",children:$},U))}),a("foreignObject",{className:"formula",x:M-200,y:A-25,width:400,height:20,children:a("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",fontSize:"18px",fontStyle:"italic",color:"#777"},children:r})})]})]})}function ri({onTrain:e,onRun:t,isTraining:n,trainingStep:i,dataCount:r,trainerType:o,onTrainerTypeChange:c,isRunning:h,simulationEnabled:f=!0}){return a("div",{class:"control-panel",role:"region","aria-label":"Controls",style:{padding:"20px",background:"#eee",borderRadius:"8px",display:"flex",gap:"10px",flexWrap:"wrap",alignItems:"center"},children:[a("span",{"aria-live":"polite",children:["Data Points: ",r]}),a("div",{style:{borderLeft:"1px solid #ccc",paddingLeft:"10px",marginLeft:"10px",display:"flex",gap:"5px",alignItems:"center"},children:[a("select",{value:o,onChange:d=>c(d.target.value),disabled:n,style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[a("option",{value:"exhaustive",children:"Grid Search "}),a("option",{value:"random",children:"Adaptive Random "})]}),a("button",{onClick:e,disabled:n||r===0,"aria-busy":n,children:n?"Searching...":"2. Train"})]}),f&&a("button",{onClick:t,disabled:n,style:h?{background:"#f39c12",color:"white"}:{},children:["3. Simulation ",h?"Stop":"Start"]})]})}function Lt({viewMode:e,onChange:t}){return a("div",{style:{display:"flex"},children:a("div",{style:{background:"#eee",borderRadius:"4px",padding:"2px",display:"flex",gap:"2px"},children:[a("button",{onClick:()=>t("table"),style:{background:e==="table"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:e==="table"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:e==="table"?"bold":"normal",color:e==="table"?"#333":"#666"},children:"Table"}),a("button",{onClick:()=>t("plot"),style:{background:e==="plot"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:e==="plot"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:e==="plot"?"bold":"normal",color:e==="plot"?"#333":"#666"},children:"Graph"})]})})}function qt({data:e,vizProps:t,simConfig:n,maximizedPanel:i}){if(!e||e.length===0)return a("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No training data generated yet."});const r=["logistic_regression","spam","spam_advanced","spam_hidden","spam_nonlinear"].includes(n?.id);return a("div",{style:{maxHeight:i?"calc(100vh - 350px)":"400px",overflowY:"auto"},children:a("table",{style:{width:"100%",textAlign:"left",borderCollapse:"collapse",fontSize:"0.9rem"},children:[a("thead",{children:a("tr",{style:{background:"#eee",borderBottom:"2px solid #ddd"},children:[Array.isArray(t.inputLabels)?t.inputLabels.map((o,c)=>a("th",{style:{padding:"8px"},children:o},c)):a("th",{style:{padding:"8px"},children:["Input (",t.inputLabel,")"]}),a("th",{style:{padding:"8px"},children:r?"Spam?":"Target"}),e.length>0&&e[0].text&&a("th",{style:{padding:"8px"},children:"Email Text"})]})}),a("tbody",{children:e.map((o,c)=>{let h="transparent",f=o.target,d={padding:"8px"};if(r){const g=o.target===1;h=g?"#ffebee":"#e8f5e9",f=g?"SPAM":"HAM",d={...d,fontWeight:"bold",color:g?"#c0392b":"#27ae60"}}else f=typeof o.target=="number"?o.target.toFixed(2):o.target;return a("tr",{style:{background:h,borderBottom:"1px solid #ddd"},children:[Array.isArray(o.input)?o.input.map((g,l)=>a("td",{style:{padding:"8px"},children:g.toFixed(0)},l)):a("td",{style:{padding:"8px"},children:o.input.toFixed(2)}),a("td",{style:d,children:f}),o.text&&a("td",{style:{padding:"8px",color:"#555",fontStyle:"italic",maxWidth:"300px"},children:o.text})]},c)})})]})})}function pe({hookState:e,renderSimulationView:t,renderDataView:n,networkVizProps:i={},simulationEnabled:r=!0,customDataHandling:o=!1}){const{simConfig:c,activeTab:h,setActiveTab:f,trainingHistory:d,trainingStepIndex:g,isTraining:l,dataViewMode:x,setDataViewMode:p,trainingData:_,groundTruth:y,neuralNet:w,time:C,statusMsg:D,handleTrain:X,handleRun:I,isRunning:J,trainerType:Y,setTrainerType:B,currentInput:A}=e,[u,M]=ot(null),b=N=>{M($=>$===N?null:N)},m={position:"absolute",top:"10px",right:"10px",zIndex:10,background:"rgba(255, 255, 255, 0.9)",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"0px"},P="all 0.4s cubic-bezier(0.4, 0, 0.2, 1)";Tt(()=>{!r&&h==="simulation"&&f("data")},[r,h,f]);const F=A!==void 0?A:c.getInput?c.getInput(C):C,S=c.networkViz||{};return a("div",{className:"nn-demonstrator layout-container",style:{display:"flex",flexDirection:"column",height:"100%"},children:[a("div",{className:"top-section",style:{display:"flex",gap:u?"0px":"20px",flexWrap:"nowrap",alignItems:"stretch",height:u?"calc(100vh - 200px)":"auto",minHeight:"500px",transition:P,marginBottom:"20px"},children:[a("div",{className:"simulation-wrapper",style:{flex:u==="simulation"?"1 0 100%":u==="network"?"0 0 0%":"1 1 500px",opacity:u==="network"?0:1,overflow:"hidden",maxWidth:u==="network"?"0px":"100%",transition:P,position:"relative",display:"flex",flexDirection:"column"},children:[a("button",{onClick:()=>b("simulation"),style:m,title:u==="simulation"?"Original Size":"Maximize",children:u==="simulation"?a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a("path",{d:"M4 14h6v6"}),a("path",{d:"M20 10h-6V4"}),a("path",{d:"M14 10l7-7"}),a("path",{d:"M3 21l7-7"})]}):a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a("path",{d:"M15 3h6v6"}),a("path",{d:"M9 21H3v-6"}),a("path",{d:"M21 3l-7 7"}),a("path",{d:"M3 21l7-7"})]})}),a("div",{className:"simulation-section",style:{height:"100%",display:"flex",flexDirection:"column"},children:[a("div",{className:"tabs",style:{paddingRight:"120px"},children:[r&&a("button",{className:`tab-button ${h==="simulation"?"active":""}`,onClick:()=>f("simulation"),children:"Simulation"}),a("button",{className:`tab-button ${h==="data"?"active":""}`,onClick:()=>f("data"),children:"Data"}),a("button",{className:`tab-button ${h==="training"?"active":""}`,onClick:()=>f("training"),children:"Training"})]}),a("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[h==="simulation"&&a(xt,{children:[t(),a("div",{className:"stats",style:{marginTop:"auto",paddingTop:"10px"},children:[a("p",{children:c.description}),a("p",{style:{color:"#646cff",fontWeight:"bold"},children:["Status: ",D]})]})]}),h==="data"&&a("div",{className:"data-content",style:{flex:1,overflowY:"auto"},children:o?n?n():a("p",{children:"No data view available."}):a(xt,{children:[!["gallery"].includes(c.id)&&a("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:a(Lt,{viewMode:x,onChange:p})}),a("div",{style:{marginTop:"15px"},children:[x==="plot"&&a("div",{style:{marginBottom:"20px"},children:n?n():a("p",{children:"No graph available."})}),x==="table"&&a(qt,{data:_,vizProps:S,simConfig:c,maximizedPanel:u})]})]})}),h==="training"&&a("div",{className:"training-content",style:{flex:1},children:d.length>0?a(Fn,{history:d,currentStepIndex:g,isTraining:l,paramsConfig:c.trainingConfig.params,showAccuracyPlot:c.trainingConfig?.showAccuracyPlot??!0}):a("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No training started yet."})})]})]})]}),a("div",{className:"network-wrapper",style:{flex:u==="network"?"1 0 100%":u==="simulation"?"0 0 0%":`0 0 ${c.id==="spam_hidden","500px"}`,opacity:u==="simulation"?0:1,overflow:"hidden",maxWidth:u==="simulation"?"0px":"100%",transition:P,position:"relative",display:"flex",flexDirection:"column"},children:[a("button",{onClick:()=>b("network"),style:m,title:u==="network"?"Original Size":"Maximize",children:u==="network"?a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a("path",{d:"M4 14h6v6"}),a("path",{d:"M20 10h-6V4"}),a("path",{d:"M14 10l7-7"}),a("path",{d:"M3 21l7-7"})]}):a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a("path",{d:"M15 3h6v6"}),a("path",{d:"M9 21H3v-6"}),a("path",{d:"M21 3l-7 7"}),a("path",{d:"M3 21l7-7"})]})}),a("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:a(dn,{input:F,weight:w.current?w.current.weights||w.current.weight:0,bias:w.current?w.current.bias:0,output:w.current?w.current.predict(F):0,model:w.current,formula:S.formula,inputLabel:S.inputLabels||S.inputLabel,outputLabel:S.outputLabel,biasLabel:S.biasLabel,decimals:c.id.includes("spam")?0:1})})]})]}),a(ri,{onTrain:X,onRun:I,isTraining:l,trainingStep:g,dataCount:_.length,trainerType:Y,onTrainerTypeChange:B,simConfig:c,isRunning:J,simulationEnabled:r})]})}function oi({data:e,groundTruth:t,neuralNet:n}){const i=bt(null);return Tt(()=>{const r=i.current;if(!r)return;const o=r.getContext("2d"),c=r.width,h=r.height;if(o.clearRect(0,0,c,h),!e||e.length===0){o.fillStyle="#999",o.textAlign="center",o.fillText("No data available",c/2,h/2);return}const f=40,d=c-2*f,g=h-2*f,l=Math.max(...e.map(y=>y.input))||10,x=Math.max(...e.map(y=>y.target))||100,p=y=>f+y/l*d,_=y=>h-f-y/x*g;if(o.beginPath(),o.strokeStyle="#333",o.moveTo(f,f),o.lineTo(f,h-f),o.lineTo(c-f,h-f),o.stroke(),o.fillStyle="#333",o.textAlign="center",o.fillText("Time (t)",c/2,h-10),o.save(),o.translate(15,h/2),o.rotate(-Math.PI/2),o.fillText("Position (s)",0,0),o.restore(),e.forEach(y=>{const w=p(y.input),C=_(y.target);o.beginPath(),o.arc(w,C,3,0,Math.PI*2),o.fillStyle="#2ecc71",o.fill()}),n){o.beginPath(),o.strokeStyle="#e74c3c",o.lineWidth=2;for(let y=0;y<=l;y+=.1){const w=n.predict(y),C=p(y),D=_(w);y===0?o.moveTo(C,D):o.lineTo(C,D)}o.stroke()}},[e,t,n]),a("div",{style:{border:"1px solid #ccc",margin:"10px 0",borderRadius:"4px"},children:a("canvas",{ref:i,width:600,height:300,style:{width:"100%",display:"block"}})})}function si(){const e=fe("linear_regression"),{simConfig:t,trainingData:n,groundTruth:i,trainingHistory:r,neuralNet:o,time:c,currentInput:h}=e;if(!t)return a("div",{className:"loading",children:"Loading Simulation..."});const f=t.CanvasComponent;return a(pe,{hookState:e,renderSimulationView:()=>{let l=0;try{if(o.current){const x=h!==void 0?h:c;l=o.current.predict(x)}}catch(x){console.error("Predict Error",x)}return a("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:a(f,{time:c,data:n,currentInput:h!==void 0?h:c,currentPrediction:l,groundTruth:i.current,neuralNet:o.current})})},renderDataView:()=>{const{dataViewMode:l,setDataViewMode:x}=e;return a("div",{style:{flex:1,display:"flex",flexDirection:"column",width:"100%"},children:l==="table"?a(xt,{children:[a("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:a(Lt,{viewMode:l,onChange:x})}),a(qt,{data:n,vizProps:t.networkViz||{},simConfig:t})]}):a(xt,{children:[a("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:a(Lt,{viewMode:l,onChange:x})}),a(oi,{data:n,groundTruth:i.current,neuralNet:r.length>0?o.current:null})]})})},customDataHandling:!0})}function ai(){const e=fe("logistic_regression"),{simConfig:t,trainingData:n,groundTruth:i,trainingHistory:r,neuralNet:o}=e;if(!t)return a("div",{className:"loading",children:"Loading Simulation..."});const c=t.CanvasComponent;return a(pe,{hookState:e,renderSimulationView:()=>a("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",border:"2px dashed #ddd",borderRadius:"8px",minHeight:"300px"},children:a("p",{style:{color:"#999"},children:'Data visualization is now in the "Data" tab'})}),renderDataView:()=>{const{dataViewMode:d,setDataViewMode:g}=e,l={staticMode:!0,showGroundTruth:!0,showModel:r.length>0};return t.featuresConfig&&(l.features=t.featuresConfig),a("div",{style:{padding:"10px 0",display:"flex",flexDirection:"column",width:"100%"},children:d==="table"?a(xt,{children:[a("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:a(Lt,{viewMode:d,onChange:g})}),a(qt,{data:n,vizProps:t.networkViz||{},simConfig:t})]}):a(xt,{children:[a("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:a(Lt,{viewMode:d,onChange:g})}),a(c,{time:0,data:n,groundTruth:i.current,neuralNet:o.current,showProbabilities:!0,...l})]})})},simulationEnabled:!1,customDataHandling:!0})}function ge({simId:e}){const t=fe(e),{simConfig:n,trainingData:i,groundTruth:r,trainingHistory:o,neuralNet:c,time:h,currentInput:f,dataViewMode:d,setDataViewMode:g}=t;if(!n)return a("div",{className:"loading",children:"Loading Simulation..."});const l=n.CanvasComponent,x=a(Lt,{viewMode:d,onChange:g});return a(pe,{hookState:t,renderSimulationView:()=>{let y=0;try{c.current&&f&&(y=c.current.predict(f))}catch(C){console.error("Predict Error",C)}const w={allowedModes:["text"],hideControls:!0,features:n.featuresConfig};return a("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:a(l,{time:h,data:i,currentInput:f,currentPrediction:y,groundTruth:r.current,neuralNet:c.current,...w})})},renderDataView:()=>{const y={allowedModes:["scatter","3d","features"],showModel:o.length>0,additionalControls:x,features:n.featuresConfig};return a("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px",width:"100%"},children:d==="table"?a(xt,{children:[a("div",{style:{marginBottom:"15px"},children:a(Lt,{viewMode:d,onChange:g})}),a(qt,{data:i,vizProps:n.networkViz||{},simConfig:n})]}):a(l,{time:0,data:i,groundTruth:r.current,neuralNet:c.current,...y})})},customDataHandling:!0})}function li(){return a(ge,{simId:"multiple_inputs"})}function ci(){return a(ge,{simId:"single_layer_nonlinear"})}function ui(){return a(ge,{simId:"double_layer_nonlinear"})}function hi(){const[e,t]=ot(0),n=[{name:"Simple Perceptron",input:.5,weight:.8,bias:.2,output:.6,inputLabel:"Input",formula:"y = w * x + b"},{name:"Spam Filter (2 Inputs)",input:[1,0],weight:[.5,-.2],bias:.1,output:.8,inputLabel:["Spam Word","Suspicious Link"],formula:"y = w1*x1 + w2*x2 + b"},{name:"Complex Model (5 Inputs)",input:[1,.5,-1,0,.2],weight:[.1,.2,.3,.4,.5],bias:-.5,output:.1,inputLabel:["F1","F2","F3","F4","F5"],formula:"y = Σ(wi*xi) + b"},{name:"Many Inputs (8 Inputs)",input:[1,0,1,0,1,0,1,0],weight:[.1,-.1,.1,-.1,.1,-.1,.1,-.1],bias:0,output:.5,inputLabel:["I1","I2","I3","I4","I5","I6","I7","I8"],formula:"y = ... "}],i=n[e];return a("div",{style:{padding:"20px"},children:[a("h2",{children:"Architecture Gallery"}),a("div",{style:{marginBottom:"20px"},children:[a("button",{onClick:()=>t((e-1+n.length)%n.length),children:"Previous"}),a("span",{style:{margin:"0 10px"},children:[i.name," (",e+1,"/",n.length,")"]}),a("button",{onClick:()=>t((e+1)%n.length),children:"Next"})]}),a("div",{style:{width:"400px",border:"1px dashed #ccc",padding:"10px"},children:a(dn,{input:i.input,weight:i.weight,bias:i.bias,output:i.output,formula:i.formula,inputLabel:i.inputLabel})})]})}function di(){const[e,t]=ot(null);return Tt(()=>{const r=new URLSearchParams(window.location.search).get("sim")||"linear_regression";t(r)},[]),e?e==="gallery"?a("div",{className:"container",children:[a("header",{children:[a("h1",{children:"Neural Network Demonstrator"}),a("p",{children:"Architecture Gallery (Debug)"}),a("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:a("a",{href:"?sim=linear_regression",style:{marginRight:"10px"},children:"Back to App"})})]}),a("main",{children:a(hi,{})})]}):a("div",{className:"container",children:[a("header",{children:[a("h1",{children:"Neural Network Demonstrator"}),a("p",{children:(i=>{switch(i){case"linear_regression":return"Phase 1: Linear Regression";case"logistic_regression":return"Phase 2: Logistic Regression";case"multiple_inputs":return"Phase 3: Multiple Inputs";case"single_layer_nonlinear":return"Phase 4: Single Layer Nonlinear Data";case"double_layer_nonlinear":return"Phase 5: Double Layer Nonlinear Data";default:return"Neural Network Demonstrator"}})(e)}),a("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:[a("a",{href:"?sim=linear_regression",style:{marginRight:"10px",fontWeight:e==="linear_regression"?"bold":"normal"},children:"Phase 1 (Linear)"}),a("a",{href:"?sim=logistic_regression",style:{marginRight:"10px",fontWeight:e==="logistic_regression"?"bold":"normal"},children:"Phase 2 (Logistic)"}),a("a",{href:"?sim=multiple_inputs",style:{marginRight:"10px",fontWeight:e==="multiple_inputs"?"bold":"normal"},children:"Phase 3 (Multi)"}),a("a",{href:"?sim=single_layer_nonlinear",style:{marginRight:"10px",fontWeight:e==="single_layer_nonlinear"?"bold":"normal"},children:"Phase 4 (Nonlinear 1)"}),a("a",{href:"?sim=double_layer_nonlinear",style:{fontWeight:e==="double_layer_nonlinear"?"bold":"normal"},children:"Phase 5 (Nonlinear 2)"})]})]}),a("main",{style:{height:"100%"},children:[e==="linear_regression"&&a(si,{}),e==="logistic_regression"&&a(ai,{}),e==="multiple_inputs"&&a(li,{}),e==="single_layer_nonlinear"&&a(ci,{}),e==="double_layer_nonlinear"&&a(ui,{})]})]}):a("div",{children:"Loading App..."})}Sn(a(di,{}),document.getElementById("app"));
