(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var Zt,et,Je,It,ke,Qe,tn,en,ce,ie,re,Nt={},nn=[],Cn=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Yt=Array.isArray;function At(e,t){for(var n in t)e[n]=t[n];return e}function ue(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function oe(e,t,n){var i,r,o,c={};for(o in t)o=="key"?i=t[o]:o=="ref"?r=t[o]:c[o]=t[o];if(arguments.length>2&&(c.children=arguments.length>3?Zt.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)c[o]===void 0&&(c[o]=e.defaultProps[o]);return Ft(e,c,i,r,null)}function Ft(e,t,n,i,r){var o={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++Je,__i:-1,__u:0};return r==null&&et.vnode!=null&&et.vnode(o),o}function mt(e){return e.children}function Lt(e,t){this.props=e,this.context=t}function zt(e,t){if(t==null)return e.__?zt(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?zt(e):null}function rn(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return rn(e)}}function Me(e){(!e.__d&&(e.__d=!0)&&It.push(e)&&!jt.__r++||ke!=et.debounceRendering)&&((ke=et.debounceRendering)||Qe)(jt)}function jt(){for(var e,t,n,i,r,o,c,u=1;It.length;)It.length>u&&It.sort(tn),e=It.shift(),u=It.length,e.__d&&(n=void 0,i=void 0,r=(i=(t=e).__v).__e,o=[],c=[],t.__P&&((n=At({},i)).__v=i.__v+1,et.vnode&&et.vnode(n),he(t.__P,n,i,t.__n,t.__P.namespaceURI,32&i.__u?[r]:null,o,r??zt(i),!!(32&i.__u),c),n.__v=i.__v,n.__.__k[n.__i]=n,an(o,n,c),i.__e=i.__=null,n.__e!=r&&rn(n)));jt.__r=0}function on(e,t,n,i,r,o,c,u,f,h,y){var a,M,p,g,v,_,C,w=i&&i.__k||nn,q=t.length;for(f=Pn(n,t,w,f,q),a=0;a<q;a++)(p=n.__k[a])!=null&&(M=p.__i==-1?Nt:w[p.__i]||Nt,p.__i=a,_=he(e,p,M,r,o,c,u,f,h,y),g=p.__e,p.ref&&M.ref!=p.ref&&(M.ref&&de(M.ref,null,p),y.push(p.ref,p.__c||g,p)),v==null&&g!=null&&(v=g),(C=!!(4&p.__u))||M.__k===p.__k?f=sn(p,f,e,C):typeof p.type=="function"&&_!==void 0?f=_:g&&(f=g.nextSibling),p.__u&=-7);return n.__e=v,f}function Pn(e,t,n,i,r){var o,c,u,f,h,y=n.length,a=y,M=0;for(e.__k=new Array(r),o=0;o<r;o++)(c=t[o])!=null&&typeof c!="boolean"&&typeof c!="function"?(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?c=e.__k[o]=Ft(null,c,null,null,null):Yt(c)?c=e.__k[o]=Ft(mt,{children:c},null,null,null):c.constructor==null&&c.__b>0?c=e.__k[o]=Ft(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):e.__k[o]=c,f=o+M,c.__=e,c.__b=e.__b+1,u=null,(h=c.__i=An(c,n,f,a))!=-1&&(a--,(u=n[h])&&(u.__u|=2)),u==null||u.__v==null?(h==-1&&(r>y?M--:r<y&&M++),typeof c.type!="function"&&(c.__u|=4)):h!=f&&(h==f-1?M--:h==f+1?M++:(h>f?M--:M++,c.__u|=4))):e.__k[o]=null;if(a)for(o=0;o<y;o++)(u=n[o])!=null&&(2&u.__u)==0&&(u.__e==i&&(i=zt(u)),cn(u,u));return i}function sn(e,t,n,i){var r,o;if(typeof e.type=="function"){for(r=e.__k,o=0;r&&o<r.length;o++)r[o]&&(r[o].__=e,t=sn(r[o],t,n,i));return t}e.__e!=t&&(i&&(t&&e.type&&!t.parentNode&&(t=zt(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Ut(e,t){return t=t||[],e==null||typeof e=="boolean"||(Yt(e)?e.some(function(n){Ut(n,t)}):t.push(e)),t}function An(e,t,n,i){var r,o,c,u=e.key,f=e.type,h=t[n],y=h!=null&&(2&h.__u)==0;if(h===null&&u==null||y&&u==h.key&&f==h.type)return n;if(i>(y?1:0)){for(r=n-1,o=n+1;r>=0||o<t.length;)if((h=t[c=r>=0?r--:o++])!=null&&(2&h.__u)==0&&u==h.key&&f==h.type)return c}return-1}function Se(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Cn.test(t)?n:n+"px"}function Bt(e,t,n,i,r){var o,c;t:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||Se(e.style,t,"");if(n)for(t in n)i&&n[t]==i[t]||Se(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")o=t!=(t=t.replace(en,"$1")),c=t.toLowerCase(),t=c in e||t=="onFocusOut"||t=="onFocusIn"?c.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?i?n.u=i.u:(n.u=ce,e.addEventListener(t,o?re:ie,o)):e.removeEventListener(t,o?re:ie,o);else{if(r=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function Te(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=ce++;else if(t.t<n.u)return;return n(et.event?et.event(t):t)}}}function he(e,t,n,i,r,o,c,u,f,h){var y,a,M,p,g,v,_,C,w,q,V,K,tt,Z,T,d,W,b=t.type;if(t.constructor!=null)return null;128&n.__u&&(f=!!(32&n.__u),o=[u=t.__e=n.__e]),(y=et.__b)&&y(t);t:if(typeof b=="function")try{if(C=t.props,w="prototype"in b&&b.prototype.render,q=(y=b.contextType)&&i[y.__c],V=y?q?q.props.value:y.__:i,n.__c?_=(a=t.__c=n.__c).__=a.__E:(w?t.__c=a=new b(C,V):(t.__c=a=new Lt(C,V),a.constructor=b,a.render=Wn),q&&q.sub(a),a.state||(a.state={}),a.__n=i,M=a.__d=!0,a.__h=[],a._sb=[]),w&&a.__s==null&&(a.__s=a.state),w&&b.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=At({},a.__s)),At(a.__s,b.getDerivedStateFromProps(C,a.__s))),p=a.props,g=a.state,a.__v=t,M)w&&b.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),w&&a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(w&&b.getDerivedStateFromProps==null&&C!==p&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(C,V),t.__v==n.__v||!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(C,a.__s,V)===!1){for(t.__v!=n.__v&&(a.props=C,a.state=a.__s,a.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(x){x&&(x.__=t)}),K=0;K<a._sb.length;K++)a.__h.push(a._sb[K]);a._sb=[],a.__h.length&&c.push(a);break t}a.componentWillUpdate!=null&&a.componentWillUpdate(C,a.__s,V),w&&a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(p,g,v)})}if(a.context=V,a.props=C,a.__P=e,a.__e=!1,tt=et.__r,Z=0,w){for(a.state=a.__s,a.__d=!1,tt&&tt(t),y=a.render(a.props,a.state,a.context),T=0;T<a._sb.length;T++)a.__h.push(a._sb[T]);a._sb=[]}else do a.__d=!1,tt&&tt(t),y=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++Z<25);a.state=a.__s,a.getChildContext!=null&&(i=At(At({},i),a.getChildContext())),w&&!M&&a.getSnapshotBeforeUpdate!=null&&(v=a.getSnapshotBeforeUpdate(p,g)),d=y,y!=null&&y.type===mt&&y.key==null&&(d=ln(y.props.children)),u=on(e,Yt(d)?d:[d],t,n,i,r,o,c,u,f,h),a.base=t.__e,t.__u&=-161,a.__h.length&&c.push(a),_&&(a.__E=a.__=null)}catch(x){if(t.__v=null,f||o!=null)if(x.then){for(t.__u|=f?160:128;u&&u.nodeType==8&&u.nextSibling;)u=u.nextSibling;o[o.indexOf(u)]=null,t.__e=u}else{for(W=o.length;W--;)ue(o[W]);se(t)}else t.__e=n.__e,t.__k=n.__k,x.then||se(t);et.__e(x,t,n)}else o==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):u=t.__e=Ln(n.__e,t,n,i,r,o,c,f,h);return(y=et.diffed)&&y(t),128&t.__u?void 0:u}function se(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(se)}function an(e,t,n){for(var i=0;i<n.length;i++)de(n[i],n[++i],n[++i]);et.__c&&et.__c(t,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(o){o.call(r)})}catch(o){et.__e(o,r.__v)}})}function ln(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Yt(e)?e.map(ln):At({},e)}function Ln(e,t,n,i,r,o,c,u,f){var h,y,a,M,p,g,v,_=n.props||Nt,C=t.props,w=t.type;if(w=="svg"?r="http://www.w3.org/2000/svg":w=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),o!=null){for(h=0;h<o.length;h++)if((p=o[h])&&"setAttribute"in p==!!w&&(w?p.localName==w:p.nodeType==3)){e=p,o[h]=null;break}}if(e==null){if(w==null)return document.createTextNode(C);e=document.createElementNS(r,w,C.is&&C),u&&(et.__m&&et.__m(t,o),u=!1),o=null}if(w==null)_===C||u&&e.data==C||(e.data=C);else{if(o=o&&Zt.call(e.childNodes),!u&&o!=null)for(_={},h=0;h<e.attributes.length;h++)_[(p=e.attributes[h]).name]=p.value;for(h in _)if(p=_[h],h!="children"){if(h=="dangerouslySetInnerHTML")a=p;else if(!(h in C)){if(h=="value"&&"defaultValue"in C||h=="checked"&&"defaultChecked"in C)continue;Bt(e,h,null,p,r)}}for(h in C)p=C[h],h=="children"?M=p:h=="dangerouslySetInnerHTML"?y=p:h=="value"?g=p:h=="checked"?v=p:u&&typeof p!="function"||_[h]===p||Bt(e,h,p,_[h],r);if(y)u||a&&(y.__html==a.__html||y.__html==e.innerHTML)||(e.innerHTML=y.__html),t.__k=[];else if(a&&(e.innerHTML=""),on(t.type=="template"?e.content:e,Yt(M)?M:[M],t,n,i,w=="foreignObject"?"http://www.w3.org/1999/xhtml":r,o,c,o?o[0]:n.__k&&zt(n,0),u,f),o!=null)for(h=o.length;h--;)ue(o[h]);u||(h="value",w=="progress"&&g==null?e.removeAttribute("value"):g!=null&&(g!==e[h]||w=="progress"&&!g||w=="option"&&g!=_[h])&&Bt(e,h,g,_[h],r),h="checked",v!=null&&v!=e[h]&&Bt(e,h,v,_[h],r))}return e}function de(e,t,n){try{if(typeof e=="function"){var i=typeof e.__u=="function";i&&e.__u(),i&&t==null||(e.__u=e(t))}else e.current=t}catch(r){et.__e(r,n)}}function cn(e,t,n){var i,r;if(et.unmount&&et.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||de(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){et.__e(o,t)}i.base=i.__P=null}if(i=e.__k)for(r=0;r<i.length;r++)i[r]&&cn(i[r],t,n||typeof e.type!="function");n||ue(e.__e),e.__c=e.__=e.__e=void 0}function Wn(e,t,n){return this.constructor(e,n)}function In(e,t,n){var i,r,o,c;t==document&&(t=document.documentElement),et.__&&et.__(e,t),r=(i=!1)?null:t.__k,o=[],c=[],he(t,e=t.__k=oe(mt,null,[e]),r||Nt,Nt,t.namespaceURI,r?null:t.firstChild?Zt.call(t.childNodes):null,o,r?r.__e:t.firstChild,i,c),an(o,e,c)}Zt=nn.slice,et={__e:function(e,t,n,i){for(var r,o,c;t=t.__;)if((r=t.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(e)),c=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,i||{}),c=r.__d),c)return r.__E=r}catch(u){e=u}throw e}},Je=0,Lt.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=At({},this.state),typeof e=="function"&&(e=e(At({},n),this.props)),e&&At(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),Me(this))},Lt.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Me(this))},Lt.prototype.render=mt,It=[],Qe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,tn=function(e,t){return e.__v.__b-t.__v.__b},jt.__r=0,en=/(PointerCapture)$|Capture$/i,ce=0,ie=Te(!1),re=Te(!0);var Rn=0;function s(e,t,n,i,r,o){t||(t={});var c,u,f=t;if("ref"in f)for(u in f={},t)u=="ref"?c=t[u]:f[u]=t[u];var h={type:e,props:f,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Rn,__i:-1,__u:0,__source:r,__self:o};if(typeof e=="function"&&(c=e.defaultProps))for(u in c)f[u]===void 0&&(f[u]=c[u]);return et.vnode&&et.vnode(h),h}var Ht,ft,Qt,Ce,Gt=0,un=[],gt=et,Pe=gt.__b,Ae=gt.__r,Le=gt.diffed,We=gt.__c,Ie=gt.unmount,Re=gt.__;function fe(e,t){gt.__h&&gt.__h(ft,e,Gt||t),Gt=0;var n=ft.__H||(ft.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function at(e){return Gt=1,$n(dn,e)}function $n(e,t,n){var i=fe(Ht++,2);if(i.t=e,!i.__c&&(i.__=[n?n(t):dn(void 0,t),function(u){var f=i.__N?i.__N[0]:i.__[0],h=i.t(f,u);f!==h&&(i.__N=[h,i.__[1]],i.__c.setState({}))}],i.__c=ft,!ft.__f)){var r=function(u,f,h){if(!i.__c.__H)return!0;var y=i.__c.__H.__.filter(function(M){return!!M.__c});if(y.every(function(M){return!M.__N}))return!o||o.call(this,u,f,h);var a=i.__c.props!==u;return y.forEach(function(M){if(M.__N){var p=M.__[0];M.__=M.__N,M.__N=void 0,p!==M.__[0]&&(a=!0)}}),o&&o.call(this,u,f,h)||a};ft.__f=!0;var o=ft.shouldComponentUpdate,c=ft.componentWillUpdate;ft.componentWillUpdate=function(u,f,h){if(this.__e){var y=o;o=void 0,r(u,f,h),o=y}c&&c.call(this,u,f,h)},ft.shouldComponentUpdate=r}return i.__N||i.__}function wt(e,t){var n=fe(Ht++,3);!gt.__s&&hn(n.__H,t)&&(n.__=e,n.u=t,ft.__H.__h.push(n))}function xt(e){return Gt=5,Dn(function(){return{current:e}},[])}function Dn(e,t){var n=fe(Ht++,7);return hn(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function zn(){for(var e;e=un.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Xt),e.__H.__h.forEach(ae),e.__H.__h=[]}catch(t){e.__H.__h=[],gt.__e(t,e.__v)}}gt.__b=function(e){ft=null,Pe&&Pe(e)},gt.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Re&&Re(e,t)},gt.__r=function(e){Ae&&Ae(e),Ht=0;var t=(ft=e.__c).__H;t&&(Qt===ft?(t.__h=[],ft.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(Xt),t.__h.forEach(ae),t.__h=[],Ht=0)),Qt=ft},gt.diffed=function(e){Le&&Le(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(un.push(t)!==1&&Ce===gt.requestAnimationFrame||((Ce=gt.requestAnimationFrame)||En)(zn)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Qt=ft=null},gt.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Xt),n.__h=n.__h.filter(function(i){return!i.__||ae(i)})}catch(i){t.some(function(r){r.__h&&(r.__h=[])}),t=[],gt.__e(i,n.__v)}}),We&&We(e,t)},gt.unmount=function(e){Ie&&Ie(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{Xt(i)}catch(r){t=r}}),n.__H=void 0,t&&gt.__e(t,n.__v))};var $e=typeof requestAnimationFrame=="function";function En(e){var t,n=function(){clearTimeout(i),$e&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,35);$e&&(t=requestAnimationFrame(n))}function Xt(e){var t=ft,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),ft=t}function ae(e){var t=ft;e.__c=e.__(),ft=t}function hn(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function dn(e,t){return typeof t=="function"?t(e):t}function Nn(e){return function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}class Hn{constructor(t){this.model=t}async trainAsync(t,n,i){if(!Array.isArray(n)){const p=arguments[1],g=arguments[2],v=arguments[3];let _=p.min,C=g.min,w=1/0,q=[];const V=20;let K=0;for(let tt=p.min;tt<=p.max;tt+=p.step)for(let Z=g.min;Z<=g.max;Z+=g.step){const T=parseFloat(tt.toFixed(2)),d=parseFloat(Z.toFixed(2));this.model.setWeight(T),this.model.setBias(d);let W=0,b=0;for(const Y of t){const O=this.model.predict(Y.input),F=Y.target-O;W+=F*F,b+=Math.abs(F)}const x=W/t.length,E=b/t.length;let P=0;for(const Y of t)(this.model.predict(Y.input)>=.5?1:0)===Y.target&&P++;const k=P/t.length;x<w&&(w=x,_=T,C=d);const I={weight:T,bias:d,error:x,mae:E,accuracy:k};q.push(I),K++,K%V===0&&(v&&v(q,{bestWeight:_,bestBias:C,minError:w}),q=[],await new Promise(Y=>setTimeout(Y,0)))}return q.length>0&&v&&v(q,{bestWeight:_,bestBias:C,minError:w}),{bestWeight:_,bestBias:C,minError:w}}let o=1/0,c={},u=0;const f=50;let h=[];const y=p=>{const g=[];if(p.step<=0)return[p.min];for(let v=p.min;v<=p.max+1e-4;v+=p.step)g.push(parseFloat(v.toFixed(2)));return g},a=n.map(y),M=async(p,g)=>{if(p===n.length){const _=[];let C=0;g.forEach((W,b)=>{n[b].name.toLowerCase().includes("bias")?C=W:_.push(W)});let w={};this.model.setParams?(g.forEach((W,b)=>{w[n[b].name]=W}),this.model.setParams(w),C===void 0&&(C=0)):(this.model.setWeights?this.model.setWeights(_):this.model.setWeight&&this.model.setWeight(_[0]),this.model.setBias(C),w={weights:[..._],bias:C});let q=0,V=0;for(const W of t){const b=this.model.predict(W.input),x=W.target-b;q+=x*x,V+=Math.abs(x)}const K=q/t.length,tt=V/t.length;let Z=0;for(const W of t)(this.model.predict(W.input)>=.5?1:0)===W.target&&Z++;const T=Z/t.length;K<o&&(o=K,c=w);const d={params:[...g],error:K,mae:tt,accuracy:T};h.push(d),u++,u%f===0&&(i&&i(h,{bestParams:c,minError:o}),h=[],await new Promise(W=>setTimeout(W,0)));return}const v=a[p];for(const _ of v)g[p]=_,await M(p+1,g)};return await M(0,new Array(n.length)),h.length>0&&i&&i(h,{bestParams:c,minError:o}),{bestParams:c,minError:o}}async trainRandomAsync(t,n,i,r={}){const{patience:o=5e3,seed:c,maxSteps:u=1e4,initialRadius:f=.8,phase1Ratio:h=.8}=r,y=u,a=f,M=.999,p=h;let g=1/0,v={},_=c;_==null?(_=Math.floor(Math.random()*2147483647),console.log(`[AdaptiveRandom] Generated Seed: ${_}`)):console.log(`[AdaptiveRandom] Using Seed: ${_}`);const C=Nn(_);let w=n.map(b=>({min:b.min,max:b.max,span:b.max-b.min})),q=w.map(b=>b.min+C()*b.span);const V=b=>{const x=[];let E=0;b.forEach((F,R)=>{n[R].name.toLowerCase().includes("bias")?E=F:x.push(F)});let P={};this.model.setParams?(b.forEach((F,R)=>{P[n[R].name]=F}),this.model.setParams(P)):(this.model.setWeights?this.model.setWeights(x):this.model.setWeight&&this.model.setWeight(x[0]),this.model.setBias(E),P={weights:x,bias:E});let k=0,I=0;for(const F of t){const R=this.model.predict(F.input),j=F.target-R;k+=j*j,I+=Math.abs(j)}let Y=0;for(const F of t)(this.model.predict(F.input)>=.5?1:0)===F.target&&Y++;const O=Y/t.length;return{mse:k/t.length,mae:I/t.length,accuracy:O,decodedParams:P,weights:x,bias:E}};let K=V(q);g=K.mse,v=K.decodedParams?{...K.decodedParams,_array:[...q]}:{weights:K.weights,bias:K.bias,_array:[...q]},i&&i([{params:[...q],error:g,mae:K.mae,accuracy:K.accuracy}],{bestParams:v,minError:g}),await new Promise(b=>setTimeout(b,0));let tt=[];const Z=10;let T=g,d=[...q],W=0;for(let b=0;b<y;b++){const x=b<y*p;let E;if(x){const R=b/(y*p);E=a*(1-R*.5)}else E=a*.5*Math.pow(M,b-y*p);let P=!1;const k=[...d];let I=!1;for(;!I;)k.forEach((R,j)=>{if(C()<.4)return;I=!0;const S=w[j];let A=!1;if(x){const Q=S.span*.3,nt=v._array&&Math.abs(R-v._array[j])<1e-9;nt&&R<S.min+Q&&(S.min-=S.span*.4,S.span=S.max-S.min,A=!0),nt&&R>S.max-Q&&(S.max+=S.span*.4,S.span=S.max-S.min,A=!0),A&&(P=!0)}let X=S.span*E;A&&(X=Math.max(X,S.span*.25));const m=X;let l=R+(C()-.5)*2*m;l<S.min&&(l=S.min),l>S.max&&(l=S.max),k[j]=l});const Y=V(k),O=Y.mse-T;let F=!1;if(O<0&&(F=!0),F&&(d=k,T=Y.mse),Y.mse<g?(g=Y.mse,v=Y.decodedParams?{...Y.decodedParams,_array:[...k]}:{weights:Y.weights,bias:Y.bias,_array:[...k]},W=0):W++,W>=o&&!x)break;if(tt.push({params:[...k],error:Y.mse,mae:Y.mae,accuracy:Y.accuracy}),tt.length>=Z){let R;P&&(R="Grenzen dynamisch erweitert..."),i&&i(tt,{bestParams:v,minError:g,message:R}),tt=[],await new Promise(j=>setTimeout(j,0))}}return tt.length>0&&i&&i(tt,{bestParams:v,minError:g}),{bestParams:v,minError:g}}}class Yn{constructor(t=30,n=50){this.velocity=t,this.initialPosition=n}getPosition(t){return this.velocity*t+this.initialPosition}}class Vn{constructor(){this.weight=0,this.bias=0}predict(t){return this.weight*t+this.bias}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function Bn({time:e,groundTruth:t,neuralNet:n,maxDistance:i=300}){const r=xt(null);wt(()=>{const c=r.current;if(!c)return;const u=c.getContext("2d"),f=c.width,h=c.height,y=50,a=f-2*y;u.clearRect(0,0,f,h);const M=t.getPosition(e),p=n.predict(e),g=y+M%i/i*a,v=y+p%i/i*a;u.fillStyle="#f0f0f0",u.fillRect(0,0,f,h/2),u.fillStyle="#e0e0e0",u.fillRect(0,h/2,f,h/2),u.beginPath(),u.strokeStyle="#fff",u.setLineDash([20,20]),u.moveTo(0,h/4),u.lineTo(f,h/4),u.moveTo(0,h*3/4),u.lineTo(f,h*3/4),u.stroke(),u.beginPath(),u.strokeStyle="#ccc",u.setLineDash([]),u.moveTo(y,0),u.lineTo(y,h),u.moveTo(f-y,0),u.lineTo(f-y,h),u.stroke(),o(u,g,h/4,"#2ecc71","Ground Truth"),o(u,v,h*3/4,"#e74c3c","Neural Net"),u.fillStyle="#333",u.font="14px monospace",u.fillText(`Zeit: ${e.toFixed(1)}s`,10,20),u.fillText(`Pos GT: ${M.toFixed(1)}m`,10,40),u.fillText(`Pos NN: ${p.toFixed(1)}m`,10,h/2+40)},[e,t,n,i]);function o(c,u,f,h,y){c.save(),c.translate(u,f),c.fillStyle=h,c.fillRect(-20,-10,40,20),c.fillStyle="#000",c.fillRect(-15,-15,10,5),c.fillRect(5,-15,10,5),c.fillRect(-15,10,10,5),c.fillRect(5,10,10,5),c.fillStyle="#000",c.font="10px sans-serif",c.textAlign="center",c.fillText(y,0,-20),c.restore()}return s("div",{style:{border:"2px solid #333",borderRadius:"8px",overflow:"hidden"},children:s("canvas",{ref:r,width:800,height:300,style:{width:"100%",display:"block"}})})}const De={id:"linear_regression",title:"Phase 1: Linear Regression",description:"A simple neuron learns the relationship between time and position. This corresponds to a linear regression.",Model:Vn,GroundTruth:Yn,CanvasComponent:Bn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[30,50],getInput:e=>e,generateData:e=>Array.from({length:20},(n,i)=>i*.5).map(n=>({input:n,target:e.getPosition(n)})),trainingConfig:{maxSteps:2e3,showAccuracyPlot:!1,params:[{name:"weight",min:0,max:60,step:1},{name:"bias",min:0,max:100,step:2}]},networkViz:{formula:"pos = w * t + b",inputLabel:"Zeit (t)",outputLabel:"Pos (m)",biasLabel:"b",showActivation:!1}};class On{constructor(t=.5,n=-5){this.weight=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){const n=this.sigmoid(this.weight*t+this.bias);return Math.random()<n?1:0}getProbability(t){return this.sigmoid(this.weight*t+this.bias)}}class Fn{constructor(){this.weight=0,this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=this.weight*t+this.bias;return this.sigmoid(n)}setWeight(t){this.weight=t}setBias(t){this.bias=t}}function qt(e,t,n=10){if(e===t)return[e];const i=ze(t-e,!1),r=ze(i/(n-1),!0),o=Math.floor(e/r)*r,c=Math.ceil(t/r)*r,u=[],f=r/1e3;for(let h=o;h<c+r/2;h+=r)h>=e-f&&h<=t+f&&u.push(Number(h.toPrecision(12)));return u}function ze(e,t){const n=Math.floor(Math.log10(e)),i=e/Math.pow(10,n);let r;return t?i<1.5?r=1:i<3?r=2:i<7?r=5:r=10:i<=1?r=1:i<=2?r=2:i<=5?r=5:r=10,r*Math.pow(10,n)}function Xn({time:e,groundTruth:t,neuralNet:n,data:i,staticMode:r=!1,showModel:o=!0,showGroundTruth:c=!0,showProbabilities:u=!1}){const f=xt(null),[h,y]=at({k:1,x:0,y:0}),[a,M]=at(!1),p=xt({x:0,y:0}),[g,v]=at(null),_=xt([]),C=T=>{T.preventDefault();const W=-T.deltaY*.001,b=h.k;let x=b*(1+W);x=Math.max(.5,Math.min(x,10));const E=f.current.getBoundingClientRect(),P=f.current.width/E.width,k=f.current.height/E.height,I=(T.clientX-E.left)*P,Y=(T.clientY-E.top)*k,O=40,F=(I-O-h.x)/b,R=(Y-(300-O)-h.y)/b,j=I-O-F*x,S=Y-(300-O)-R*x;y({k:x,x:j,y:S})},w=T=>{M(!0),p.current={x:T.clientX,y:T.clientY}},q=T=>{const d=f.current;if(!d)return;const W=d.getBoundingClientRect(),b=d.width/W.width,x=d.height/W.height;if(a){const E=(T.clientX-p.current.x)*b,P=(T.clientY-p.current.y)*x;p.current={x:T.clientX,y:T.clientY},y(k=>({...k,x:k.x+E,y:k.y+P})),v(null)}else{const E=(T.clientX-W.left)*b,P=(T.clientY-W.top)*x;let k=null,I=15;const Y=_.current;for(let O=Y.length-1;O>=0;O--){const F=Y[O],R=Math.sqrt(Math.pow(F.x-E,2)+Math.pow(F.y-P,2));R<I&&(I=R,k=F.info)}v(k)}},V=()=>M(!1),K=()=>{M(!1),v(null)},tt=xt(0),Z=()=>{const T=Date.now();T-tt.current<300&&v(null),tt.current=T};return wt(()=>{const T=f.current;if(!T)return;const d=T.getContext("2d"),W=T.width,b=T.height;d.clearRect(0,0,W,b),_.current=[];const x=40,E=W-2*x,P=b-2*x,k=0,I=20,Y=1,O=$=>x+$/I*E*h.k+h.x,F=$=>b-x-$/Y*P*h.k+h.y,R=$=>($-x-h.x)/(E*h.k)*I,j=$=>-(($-(b-x)-h.y)/(P*h.k))*Y,S=R(x),A=R(W-x),X=j(b-x),m=j(x),l=qt(S,A,10),Q=qt(X,m,5);if(d.beginPath(),d.strokeStyle="#eee",d.lineWidth=1,d.fillStyle="#333",d.textAlign="center",d.textBaseline="top",d.font="10px sans-serif",l.forEach($=>{const U=O($);U<x||U>W-x||(d.moveTo(U,x),d.lineTo(U,b-x),d.fillText(Number($.toFixed(2)),U,b-x+5))}),d.textAlign="right",d.textBaseline="middle",Q.forEach($=>{const U=F($);U<x||U>b-x||(d.moveTo(x,U),d.lineTo(W-x,U),d.fillText(Number($.toFixed(2)),x-5,U))}),d.stroke(),d.beginPath(),d.strokeStyle="#333",d.lineWidth=1,d.rect(x,x,E,P),d.stroke(),d.fillStyle="#333",d.textAlign="center",d.textBaseline="alphabetic",d.fillText("Number of 'Spam' Words",W/2,b-10),d.save(),d.translate(15,b/2),d.rotate(-Math.PI/2),d.textAlign="center",d.fillText("Spam Probability",0,0),d.restore(),d.save(),d.beginPath(),d.rect(x,x,E,P),d.clip(),o&&n&&(($,U,rt=[])=>{d.beginPath(),d.strokeStyle=U,d.setLineDash(rt),d.lineWidth=2;const D=Math.max(k,S),G=Math.min(I,A);if(G<D)return;const L=(G-D)/100,z=Math.max(L,.05);let N=!1;for(let B=D;B<=G+z;B+=z){const H=Math.min(Math.max(B,k),I);let ot=0;typeof $.getProbability=="function"?ot=$.getProbability(H):typeof $.predict=="function"&&(ot=$.predict(H));const st=O(H),lt=F(ot);N?d.lineTo(st,lt):(d.moveTo(st,lt),N=!0)}d.stroke(),d.setLineDash([])})(n,"#e74c3c"),r&&i)i.forEach($=>{if($.input<S-5||$.input>A+5)return;const U=0,rt=0,D=O($.input),G=F($.target);_.current.push({x:D,y:G,info:{x:D,y:G,input:$.input,target:$.target,type:"Ground Truth"}});let L=null;if(n&&o)try{L=n.predict($.input)>.5?"#e74c3c":"#2ecc71"}catch{}if(u&&n&&typeof n.predict=="function")try{const z=n.predict($.input),N=F(z);o&&(d.beginPath(),d.moveTo(D,G),d.lineTo(D,N),d.setLineDash([2,4]),d.strokeStyle="rgba(0,0,0,0.15)",d.lineWidth=1,d.stroke(),d.setLineDash([]));let B=null;n&&o&&(B=n.predict($.input)>.5?"#e74c3c":"#2ecc71"),B&&(d.beginPath(),d.arc(D,N,6,0,Math.PI*2),d.strokeStyle=B,d.lineWidth=2,d.stroke()),_.current.push({x:D,y:N,info:{x:D,y:N,input:$.input,target:$.target,prediction:z,type:"Prediction"}})}catch{}else L&&(d.beginPath(),d.arc(D+U,G+rt,8,0,Math.PI*2),d.strokeStyle=L,d.lineWidth=2,d.stroke());d.beginPath(),d.arc(D+U,G+rt,5,0,Math.PI*2),d.fillStyle=$.target===1?"#e74c3c":"#2ecc71",d.fill(),d.strokeStyle="#fff",d.lineWidth=1,d.stroke()});else if(!r){const U=Math.floor(e*2),rt=50,D=L=>{const z=Math.sin(L*123.456)*1e4;return z-Math.floor(z)},G=Math.min(U,rt);for(let L=0;L<G;L++){const z=D(L+1),N=Math.floor(z*21),B=t?t.getProbability(N):0,H=D(L+999)<B?1:0;if(N<S-5||N>A+5)continue;const ot=O(N),st=F(H);let lt=null;if(n&&o)try{lt=n.predict(N)>.5?"#e74c3c":"#2ecc71"}catch{}if(u&&n&&typeof n.predict=="function")try{const dt=n.predict(N),_t=F(dt);o&&(d.beginPath(),d.moveTo(ot,st),d.lineTo(ot,_t),d.setLineDash([2,4]),d.strokeStyle="rgba(0,0,0,0.35)",d.lineWidth=1,d.stroke(),d.setLineDash([]));let bt=null;n&&o&&(bt=n.predict(N)>.5?"#e74c3c":"#2ecc71"),bt&&(d.beginPath(),d.arc(ot,_t,6,0,Math.PI*2),d.strokeStyle=bt,d.lineWidth=2,d.stroke())}catch{}else lt&&(d.beginPath(),d.arc(finalX,finalY,8,0,Math.PI*2),d.strokeStyle=lt,d.lineWidth=2,d.stroke());d.beginPath(),d.arc(finalX,finalY,5,0,Math.PI*2),d.fillStyle=H?"#e74c3c":"#2ecc71",d.fill(),d.strokeStyle="#fff",d.lineWidth=1,d.stroke()}if(G>0&&G<=rt){const L=G-1,z=D(L+1),N=Math.floor(z*21),B=t.getProbability(N),H=D(L+999)<B?1:0,ot=0,st=0,lt=O(N)+ot,dt=F(H)+st;lt>x&&lt<W-x&&dt>x&&dt<b-x&&(d.beginPath(),d.arc(lt,dt,8,0,Math.PI*2),d.strokeStyle="#333",d.stroke(),d.fillStyle="#333",d.font="10px sans-serif",d.fillText(`${N}`,lt,dt-12))}}if(d.restore(),g){d.save(),d.fillStyle="rgba(0,0,0,0.8)",d.strokeStyle="#fff";const $=g.target===1?"SPAM":"HAM",U=`Words: ${g.input}`,rt=g.type?`(${g.type})`:"",D=120,G=g.type?55:40;let L=g.x+10,z=g.y-10;L+D>W&&(L=g.x-D-10),z+G>b&&(z=g.y-G-10),z<0&&(z=g.y+10),d.beginPath(),d.roundRect(L,z,D,G,4),d.fill(),d.lineWidth=1,d.stroke(),d.textBaseline="top",d.textAlign="left",d.font="bold 11px sans-serif",d.fillStyle=g.target===1?"#e74c3c":"#2ecc71",d.fillText(`${$} ${rt}`,L+8,z+6),d.fillStyle="#ddd",d.font="10px sans-serif",d.fillText(U,L+8,z+20),g.prediction!==void 0&&d.fillText(`Pred: ${g.prediction.toFixed(2)}`,L+8,z+32),d.restore()}},[e,t,n,i,r,o,c,u,h,g]),s("div",{className:"canvas-container",children:s("canvas",{ref:f,width:600,height:300,style:{width:"100%",border:"1px solid #ccc",background:"#fff",cursor:g?"pointer":a?"grabbing":"grab"},onWheel:C,onMouseDown:w,onMouseMove:q,onMouseUp:V,onMouseLeave:K,onClick:Z})})}const Et=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Ee={id:"logistic_regression",title:"Phase 2: Logistic Regression",description:'Classification of emails as "Spam" or "Not Spam" based on word count. This is a logistic regression.',Model:Fn,GroundTruth:On,CanvasComponent:Xn,defaultParams:{weight:0,bias:0},groundTruthDefaults:[.5,-5],getInput:e=>{const t=Math.floor(e);return Math.floor(Et(t)*20)},generateData:e=>{const t=new Set(["FREE","WIN","PRIZE","CLAIM","URGENT","OFFER","BONUS","CLICK","LINK","NOW","LIMITED","DISCOUNT","VERIFY","ACCOUNT","PAYMENT","SUSPENDED","APPROVED","CASH","REWARD","SECURITY","ALERT","ACT","TODAY"]),n=p=>{const g=String(p||"").match(/[A-Z0-9]+/g)||[];let v=0;for(const _ of g)t.has(_)&&v++;return v},i=(p,g)=>({input:n(p),target:g,text:p}),r=Array.from(t),o=(p,g)=>{const v=[...r];for(let _=v.length-1;_>0;_--){const C=Math.floor(Et(g+_*97)*(_+1));[v[_],v[C]]=[v[C],v[_]]}return v.slice(0,p)},c=["Project update","Quick question","Invoice follow up","Meeting schedule","Account notice","Delivery status","Action required","Weekly summary"],u=["Hi, just following up. Could you take a look when you have a moment?","Hello, sharing the details below. Thanks for your time.","Hey, can you confirm receipt and let me know if anything is missing?","Hi, please review and reply when convenient. Appreciate it.","Hello, sending this over for your review. Thanks."],f=(p,g)=>{const v=c[Math.floor(Et(g+11)*c.length)],_=u[Math.floor(Et(g+29)*u.length)],C=o(p,g+101),w=C.length?` ${C.join(" ")}`:"";return`Subject: ${v}${w}
${_}`},h=[];for(let p=0;p<=20;p++)h.push(p,p);for(let p=0;p<8;p++)h.push(p);const y=h.map((p,g)=>{const v=p*1e3+g,_=f(p,v),C=e?.getProbability?e.getProbability(p):0,w=Et(v+999);return{x:p,idx:g,text:_,score:C-w}}),a=new Set([...y].sort((p,g)=>g.score-p.score).slice(0,25).map(p=>p.idx));return y.map(p=>i(p.text,a.has(p.idx)?1:0)).sort((p,g)=>p.input-g.input)},trainingConfig:{maxSteps:3e3,params:[{name:"weight",min:0,max:2,step:.1},{name:"bias",min:-10,max:5,step:.5}]},networkViz:{formula:"p = σ(w * x + b)",inputLabel:"Wörter (x)",outputLabel:"Spam (p)",biasLabel:"b"},isFinished:e=>e>=25};class pe{constructor(t=[.5,.2,.8,-.1],n=-3){this.weights=t,this.bias=n}sigmoid(t){return 1/(1+Math.exp(-t))}classify(t){let n=this.bias;const i=Math.min(this.weights.length,t?.length??0);for(let o=0;o<i;o++)n+=this.weights[o]*t[o];const r=this.sigmoid(n);return Math.random()<r?1:0}getProbability(t){let n=this.bias;const i=Math.min(this.weights.length,t?.length??0);for(let r=0;r<i;r++)n+=this.weights[r]*t[r];return this.sigmoid(n)}}class fn{constructor(t=3){this.weights=new Array(t).fill(0),this.bias=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){let n=this.bias;const i=Math.min(this.weights.length,t?.length??0);for(let r=0;r<i;r++)n+=this.weights[r]*t[r];return this.sigmoid(n)}setWeights(t){this.weights=[...t]}setBias(t){this.bias=t}setWeightAt(t,n){t>=0&&t<this.weights.length&&(this.weights[t]=n)}}const jn=[{label:"Spam Words",idx:0,max:15},{label:"Links",idx:1,max:8},{label:"Total Words",idx:2,max:100}];function ge({data:e,currentInput:t,currentPrediction:n,neuralNet:i,allowedModes:r=["features","scatter","3d","text"],hideControls:o=!1,showModel:c=!0,additionalControls:u=null,features:f=jn}){const h=m=>{const l=f.length;return!Number.isFinite(m)||l<=0?0:Math.max(0,Math.min(l-1,m))},y=(m,l,Q)=>{const nt=f.length,$=h(m),U=h(l),rt=h(Q);if(nt<3)return{x:$,y:U,z:rt};const D=new Set([$]);let G=U;D.has(G)&&(G=Array.from({length:nt},(z,N)=>N).find(z=>!D.has(z))??G),D.add(G);let L=rt;return D.has(L)&&(L=Array.from({length:nt},(z,N)=>N).find(z=>!D.has(z))??L),{x:$,y:G,z:L}},a=xt(null),M=r.filter(m=>m!=="3d"||f.length>=3),p=M[0]??r[0],[g,v]=at(p);wt(()=>{M.includes(g)||v(M[0]??r[0])},[M,r,g]);const[_,C]=at(0),[w,q]=at(f.length>1?1:0),[V,K]=at(f.length>2?2:f.length>1?1:0),[tt,Z]=at(!1),[T,d]=at({x:-.5,y:.5}),[W,b]=at({k:1,x:0,y:0}),x=xt(!1),E=xt({x:0,y:0}),[P,k]=at(null),I=xt([]),Y=m=>{if(g!=="scatter")return;m.preventDefault();const Q=-m.deltaY*.001,nt=W.k;let $=nt*(1+Q);$=Math.max(.5,Math.min($,50));const U=a.current;if(!U)return;const rt=U.getBoundingClientRect(),D=U.width/rt.width,G=U.height/rt.height,L=(m.clientX-rt.left)*D,z=(m.clientY-rt.top)*G,N=50,B=U.height-N,H=(L-N-W.x)/nt,ot=(B+W.y-z)/nt,st=L-N-H*$,lt=z-B+ot*$;b({k:$,x:st,y:lt})},O=m=>{g!=="3d"&&g!=="scatter"||(x.current=!0,E.current={x:m.clientX,y:m.clientY})},F=m=>{const l=a.current;if(!l)return;const Q=l.getBoundingClientRect(),nt=l.width/Q.width,$=l.height/Q.height;if(x.current){const N=(m.clientX-E.current.x)*nt,B=(m.clientY-E.current.y)*$;E.current={x:m.clientX,y:m.clientY},g==="3d"?d(H=>({x:H.x+B*.01,y:H.y+N*.01})):g==="scatter"&&b(H=>({...H,x:H.x+N,y:H.y+B}));return}const U=(m.clientX-Q.left)*nt,rt=(m.clientY-Q.top)*$;let D=null,L=15;const z=I.current;for(let N=z.length-1;N>=0;N--){const B=z[N],H=Math.sqrt((B.x-U)**2+(B.y-rt)**2);H<L&&(L=H,D=B.info)}k(D)},R=()=>{x.current=!1},j=()=>{k(null),x.current=!1},S=xt(0),A=()=>{const m=Date.now();m-S.current<300&&k(null),S.current=m};wt(()=>{if(g!=="3d")return;const m=y(_,w,V);(m.x!==_||m.y!==w||m.z!==V)&&(C(m.x),q(m.y),K(m.z))},[f.length,g,_,w,V]),wt(()=>{const m=a.current;if(!m)return;const l=m.getContext("2d"),Q=m.width,nt=m.height;l.clearRect(0,0,Q,nt),l.fillStyle="#fff",l.fillRect(0,0,Q,nt),I.current=[];const $=D=>{if(!e||e.length===0)return f[D].max;const G=Math.max(...e.map(L=>L.input[D]));return G>0?G:f[D].max},U=D=>D===2?"#3498db":D===1?"#e74c3c":"#2ecc71",rt=D=>D===3?"CLASS 3":D===1?"SPAM":"HAM";if(g==="3d"){const D=$(_),G=$(w),L=$(V),z=Q/2,N=nt/2,B=150,H=(J,vt,kt)=>{let St=J*Math.cos(T.y)-kt*Math.sin(T.y),it=J*Math.sin(T.y)+kt*Math.cos(T.y),ct=vt*Math.cos(T.x)-it*Math.sin(T.x),pt=vt*Math.sin(T.x)+it*Math.cos(T.x);const ut=400/(400-pt);return{x:z+St*ut,y:N+ct*ut,z:pt}},st=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]].map(J=>H(J[0]*B,J[1]*B,J[2]*B)),lt="#e29301ff",dt="#2980b9",_t="#c00798ff",bt=(J,vt)=>{l.beginPath(),l.strokeStyle=vt,l.lineWidth=1,J.forEach(([kt,St])=>{l.moveTo(st[kt].x,st[kt].y),l.lineTo(st[St].x,st[St].y)}),l.stroke()};bt([[0,1],[3,2],[4,5],[7,6]],lt),bt([[0,3],[1,2],[4,7],[5,6]],dt),bt([[0,4],[1,5],[2,6],[3,7]],_t),l.font="bold 11px sans-serif",l.fillStyle=lt,l.fillText("X: "+f[_].label,st[1].x,st[1].y),l.fillStyle=dt,l.fillText("Y: "+f[w].label,st[3].x,st[3].y),l.fillStyle=_t,l.fillText("Z: "+f[V].label,st[4].x,st[4].y);const Ct=[],Pt=(J,vt)=>J/vt*2-1;if(c&&i&&i.weights){const J=i.weights[_]||0,vt=i.weights[w]||0,kt=i.weights[V]||0,St=i.bias||0;if(Math.abs(kt)>.001){l.strokeStyle="rgba(142, 68, 173, 0.3)",l.lineWidth=1;const it=(ut,ht)=>{const Mt=(ut+1)/2*D,yt=(ht+1)/2*G,Wt=(-J*Mt-vt*yt-St)/kt;return Pt(Wt,L)},ct=(ut,ht)=>{if(Math.abs(ut.z)<=3&&Math.abs(ht.z)<=3){const Mt=H(ut.x*B,-ut.y*B,ut.z*B),yt=H(ht.x*B,-ht.y*B,ht.z*B);l.beginPath(),l.moveTo(Mt.x,Mt.y),l.lineTo(yt.x,yt.y),l.stroke()}},pt=6;for(let ut=0;ut<=pt;ut++){const ht=-1+ut/pt*2,Mt=it(-1,ht),yt=it(1,ht);ct({x:-1,y:ht,z:Mt},{x:1,y:ht,z:yt})}for(let ut=0;ut<=pt;ut++){const ht=-1+ut/pt*2,Mt=it(ht,-1),yt=it(ht,1);ct({x:ht,y:-1,z:Mt},{x:ht,y:1,z:yt})}}}e&&e.forEach(J=>{const vt=Pt(J.input[_],D),kt=-Pt(J.input[w],G),St=Pt(J.input[V],L),it=H(vt*B,kt*B,St*B);let ct=null;if(i&&c)try{ct=i.predict(J.input)>.5?"#e74c3c":"#2ecc71"}catch{}Ct.push({...it,color:U(J.target),radius:3,haloColor:ct,pt:J})}),Ct.sort((J,vt)=>J.z-vt.z),Ct.forEach(J=>{J.z<3&&I.current.push({x:J.x,y:J.y,info:{x:J.x,y:J.y,text:J.pt.text,target:J.pt.target,isSpam:J.pt.target===1,features:{xLabel:f[_].label,xVal:J.pt.input[_],yLabel:f[w].label,yVal:J.pt.input[w],zLabel:f[V].label,zVal:J.pt.input[V]}}}),J.haloColor&&(l.beginPath(),l.arc(J.x,J.y,J.radius+2,0,Math.PI*2),l.strokeStyle=J.haloColor,l.lineWidth=1.5,l.stroke()),l.beginPath(),l.arc(J.x,J.y,J.radius,0,Math.PI*2),l.fillStyle=J.color,l.fill()})}if(g==="scatter"){const D=$(_),G=$(w),L=50,z=Q-2*L,N=nt-2*L,B=nt-L,H="#c0392b",ot="#2980b9",st=it=>L+it/D*z*W.k+W.x,lt=it=>B-it/G*N*W.k+W.y;l.save(),l.beginPath(),l.rect(L,L,z,N),l.clip(),l.restore();const dt=it=>(it-L-W.x)/(z*W.k)*D,_t=it=>(B+W.y-it)/(N*W.k)*G,bt=dt(L),Ct=dt(L+z),Pt=_t(B),J=_t(L),vt=qt(Math.min(bt,Ct),Math.max(bt,Ct),8),kt=qt(Math.min(Pt,J),Math.max(Pt,J),6);if(l.lineWidth=1,l.strokeStyle="#eee",l.fillStyle="#666",l.font="10px sans-serif",l.textAlign="center",l.textBaseline="top",vt.forEach(it=>{const ct=st(it);ct<L||ct>L+z||(l.beginPath(),l.moveTo(ct,L),l.lineTo(ct,B),l.stroke(),l.fillText(Number(it.toFixed(2)),ct,B+5))}),l.textAlign="right",l.textBaseline="middle",kt.forEach(it=>{const ct=lt(it);ct<L||ct>B||(l.beginPath(),l.moveTo(L,ct),l.lineTo(L+z,ct),l.stroke(),l.fillText(Number(it.toFixed(2)),L-5,ct))}),l.strokeStyle="#ccc",l.lineWidth=2,l.strokeRect(L,L,z,N),l.textAlign="center",l.font="bold 12px sans-serif",l.fillStyle=H,l.fillText(`${f[_].label}`,L+z/2,B+30),l.save(),l.translate(15,B-N/2),l.rotate(-Math.PI/2),l.fillStyle=ot,l.fillText(`${f[w].label}`,0,0),l.restore(),l.save(),l.beginPath(),l.rect(L,L,z,N),l.clip(),tt&&i&&f.length===2){const ct=Math.floor(bt/.5)*.5,pt=Math.ceil(Ct/.5)*.5,ut=Math.floor(Pt/.5)*.5,ht=Math.ceil(J/.5)*.5;if((pt-ct)/.5*((ht-ut)/.5)<5e4)for(let yt=ct;yt<=pt;yt+=.5)for(let Wt=ut;Wt<=ht;Wt+=.5)try{const Vt=[0,0];_<2&&(Vt[_]=yt),w<2&&(Vt[w]=Wt);const $t=i.predict(Vt),ye=st(yt),be=lt(Wt),ve=st(yt+.5),we=lt(Wt+.5),bn=Math.abs(ve-ye),vn=Math.abs(be-we),wn=Math.min(ye,ve),kn=Math.min(be,we),Mn=Math.round(46*(1-$t)+231*$t),Sn=Math.round(204*(1-$t)+76*$t),Tn=Math.round(113*(1-$t)+60*$t);l.fillStyle=`rgba(${Mn}, ${Sn}, ${Tn}, 0.2)`,l.fillRect(wn,kn,bn+.5,vn+.5)}catch{}}const St=(it,ct,pt,ut,ht)=>{const Mt=st(it[_]),yt=lt(it[w]);ht&&(l.beginPath(),l.arc(Mt,yt,pt+3,0,2*Math.PI),l.strokeStyle=ht,l.lineWidth=2,l.stroke()),l.beginPath(),l.arc(Mt,yt,pt,0,2*Math.PI),l.fillStyle=ct,l.fill(),ut&&(l.strokeStyle=ut,l.lineWidth=2,l.stroke())};e&&e.forEach(it=>{const ct=st(it.input[_]),pt=lt(it.input[w]);if(ct<L||ct>L+z||pt<L||pt>B)return;I.current.push({x:ct,y:pt,info:{x:ct,y:pt,text:it.text,target:it.target,isSpam:it.target===1,features:{xLabel:f[_].label,xVal:it.input[_],yLabel:f[w].label,yVal:it.input[w]}}});let ut=null;if(i&&c)try{ut=i.predict(it.input)>.5?"#e74c3c":"#2ecc71"}catch{}St(it.input,U(it.target),5,"#fff",ut)}),t&&St(t,"#3498db",8,"#2980b9"),l.restore(),l.fillStyle="#666",l.textAlign="right",l.font="11px sans-serif",l.fillText("Red=Spam, Green=OK",Q-10,20)}if(g==="text"){if(l.textAlign="center",l.textBaseline="middle",!t||!t.text){l.fillStyle="#999",l.font="20px sans-serif",l.fillText("No text available",Q/2,nt/2);return}const D=n>.5,G=D?"#feeff0":"#effaf0";l.fillStyle=G,l.fillRect(0,0,Q,nt);const L=t.text;l.fillStyle="#333",l.font="24px serif";const z=L.split(" ");let N="";const B=35,H=Q/2;let ot=nt/3;const st=Q-100;for(let _t=0;_t<z.length;_t++){const bt=N+z[_t]+" ";l.measureText(bt).width>st&&_t>0?(l.fillText(N,H,ot),N=z[_t]+" ",ot+=B):N=bt}l.fillText(N,H,ot),ot+=60;const lt=t.groundTruth===1;l.font="bold 16px sans-serif",l.fillStyle="#555",l.fillText(`Truth: ${lt?"SPAM":"HAM"}`,H,ot),ot+=30;const dt=(n*100).toFixed(1);l.font="bold 20px sans-serif",l.fillStyle=D?"#c0392b":"#27ae60",l.fillText(`Prediction: ${D?"SPAM":"HAM"} (${dt}%)`,H,ot);return}if(g==="features"){const L=Math.max(1,Math.ceil(f.length/2)),z=(Q-90)/2,N=(nt-(L+1)*30)/L;f.map((H,ot)=>{const st=ot%2,lt=Math.floor(ot/2);return{x:30+st*(z+30),y:30+lt*(N+30),...H}}).forEach(H=>{if(l.strokeStyle="#ccc",l.strokeRect(H.x,H.y,z,N),l.fillStyle="#333",l.font="12px Arial",l.textAlign="center",l.fillText(H.label,H.x+z/2,H.y-5),e&&e.forEach(ot=>{const st=ot.input[H.idx],lt=H.x+st/H.max*z,dt=H.y+N-ot.target*(N-20)-10;I.current.push({x:lt,y:dt,info:{x:lt,y:dt,text:ot.text,target:ot.target,isSpam:ot.target===1,features:{valLabel:H.label,val:st}}});let _t=null;if(i&&c)try{_t=i.predict(ot.input)>.5?"#e74c3c":"#2ecc71"}catch{}_t&&(l.beginPath(),l.arc(lt,dt,4.5,0,2*Math.PI),l.strokeStyle=_t,l.lineWidth=1,l.stroke()),l.beginPath(),l.arc(lt,dt,3,0,2*Math.PI),l.fillStyle=U(ot.target),l.globalAlpha=.6,l.fill(),l.globalAlpha=1}),t){const ot=t[H.idx],st=H.x+ot/H.max*z;l.beginPath(),l.moveTo(st,H.y),l.lineTo(st,H.y+N),l.strokeStyle="#3498db",l.setLineDash([5,5]),l.stroke(),l.setLineDash([])}})}if(P&&(g==="features"||g==="scatter"||g==="3d")){l.save(),l.fillStyle="rgba(0,0,0,0.85)",l.strokeStyle="#fff";const D=P.text||"No Text",G=rt(P.target!==void 0?P.target:P.isSpam?1:0),L=l.measureText(D),z=Math.max(L.width,140)+20;let N=70;P.features&&(P.features.zLabel?N=90:P.features.yLabel?N=85:N=60);let B=P.x+15,H=P.y-15;B+z>Q&&(B=P.x-z-10),H+N>nt&&(H=P.y-N-10),H<0&&(H=P.y+20),l.beginPath(),l.roundRect(B,H,z,N,5),l.fill(),l.lineWidth=1,l.stroke(),l.textBaseline="top",l.textAlign="left",l.font="bold 12px sans-serif",l.fillStyle=U(P.target!==void 0?P.target:P.isSpam?1:0),l.fillText(G,B+10,H+10),l.fillStyle="#ddd",l.font="italic 11px sans-serif",l.fillText(D,B+10,H+28),P.features&&(l.fillStyle="#fff",l.font="11px monospace",P.features.xLabel?(l.fillText(`${P.features.xLabel}: ${P.features.xVal}`,B+10,H+46),l.fillText(`${P.features.yLabel}: ${P.features.yVal}`,B+10,H+60),P.features.zLabel&&l.fillText(`${P.features.zLabel}: ${P.features.zVal}`,B+10,H+74)):P.features.valLabel&&l.fillText(`${P.features.valLabel}: ${P.features.val}`,B+10,H+46)),l.restore()}},[e,t,n,i,g,_,w,V,T,c,W,tt]);const X={features:"Alle Features",scatter:"2D Plot","3d":"3D Plot",text:"Text Mode"};return s("div",{style:{textAlign:"center"},children:[!o&&s("div",{style:{marginBottom:"10px",display:"flex",gap:"5px",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",fontSize:"0.9rem"},children:[s("div",{children:u}),s("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[s("select",{value:g,onChange:m=>v(m.target.value),style:{padding:"4px"},children:M.map(m=>s("option",{value:m,children:X[m]},m))}),(g==="scatter"||g==="3d")&&s(mt,{children:[s("span",{children:"X:"}),s("select",{value:_,onChange:m=>C(parseInt(m.target.value)),style:{padding:"4px"},children:f.map(m=>s("option",{value:m.idx,children:m.label},m.idx))}),s("span",{children:"Y:"}),s("select",{value:w,onChange:m=>q(parseInt(m.target.value)),style:{padding:"4px"},children:f.map(m=>s("option",{value:m.idx,children:m.label},m.idx))})]}),g==="scatter"&&f.length===2&&s("label",{style:{display:"flex",alignItems:"center",gap:"3px",marginLeft:"5px",fontSize:"0.8rem",cursor:"pointer",background:"#f5f5f5",padding:"2px 5px",borderRadius:"3px",border:"1px solid #ddd"},children:[s("input",{type:"checkbox",checked:tt,onChange:m=>Z(m.target.checked)}),"Show Grid"]}),g==="3d"&&s(mt,{children:[s("span",{children:"Z:"}),s("select",{value:V,onChange:m=>K(parseInt(m.target.value)),style:{padding:"4px"},children:f.map(m=>s("option",{value:m.idx,children:m.label},m.idx))})]})]})]}),s("canvas",{ref:a,width:600,height:400,style:{border:"1px solid #eee",maxWidth:"100%",borderRadius:"4px",cursor:P?"pointer":g==="3d"||g==="scatter"?x.current?"grabbing":"grab":"default"},onWheel:Y,onMouseDown:O,onMouseMove:F,onMouseUp:R,onMouseLeave:R,onMouseOut:j,onClick:A}),!o&&s("div",{class:"control-text",style:{fontSize:"0.8rem",color:"#666",marginTop:"5px"},children:g==="3d"?"Drag to rotate 3D view":g==="scatter"?"Drag to Pan, Scroll to Zoom":"Wähle Achsen für die Visualisierung"})]})}const Ne=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},te=e=>{const t=["winner","won","gift card","urgent","rolex","viagra","cash","prize","singles","marketing","buy","free","money","security alert","click","claim","fake","verification"],n=e.toLowerCase();let i=0;t.forEach(c=>{n.includes(c)&&(i+=1)}),i>10&&(i=10);const r=(e.match(/http/g)||[]).length,o=e.split(/\s+/).length;return[i,r,o]},Dt={id:"multiple_inputs",title:"Phase 3: Multiple Inputs",description:"Advanced spam detection with multiple linear features (spam words, links, total words). The network learns a separation line.",Model:fn,GroundTruth:pe,CanvasComponent:ge,defaultParams:{weights:[0,0,0],bias:0},groundTruthDefaults:[[1.5,2,-.5],-5],getInput:e=>{const t=Math.floor(e*.3),n=Ne(t)>.5,i=n?Dt.examples.spam:Dt.examples.ham,r=Math.floor(Ne(t+99)*i.length),o=i[r],c=te(o);return c.text=o,c.groundTruth=n?1:0,c},examples:{spam:["See the details here: http://rewards-center.example","Free sample available today: http://meds-offer.example","Winner: you won a prize and a free gift card. Click to claim at http://rewards-center.example","Urgent verification required. Security alert: click http://secure-verify.example to claim access","Buy Viagra today, free delivery. Claim cash bonus at http://meds-offer.example","Marketing promo: winner cash prize today. Click http://promo-redeem.example to claim now","Fake Rolex deal: buy now and claim a free upgrade at http://rolex-deals.example","Singles offer: click http://dating-now.example to claim your free match","Urgent: claim money refund. Click http://money-claim.example for verification","Winner notice: free cash prize inside. Claim at http://instant-prize.example http://promo-redeem.example","Security alert: verification needed—click http://account-check.example or http://secure-verify.example to claim access","Gift card bonus: claim your prize at http://gift-redeem.example http://rewards-center.example http://instant-prize.example http://promo-redeem.example"],ham:["Quick reminder: standup is 9:15 in Room B, please be on time.","Lunch at 12:30 today? If that works, I will book a table.","Can you review the slides and leave comments by end of day?","Your package is at reception; please pick it up before 5pm.","Security alert: new sign-in from your laptop. Verification is required in the portal.","Urgent: can you review the release checklist today and reply with any blockers?","Please click the doc link and confirm the numbers match the spreadsheet.","Hi team, here are the notes from today's planning session: scope, risks, and owners. Please add comments in the doc before Thursday afternoon.","Can you review the latest API changes and confirm the error codes match the spec? I pushed a small patch and added a checklist for QA.","Reminder: the workshop is next Wednesday at 10:00. Agenda and slides are here: http://intranet.example/events/workshop. Let me know if you have topics to add.","I updated the quarterly report draft with the new charts and assumptions. If you spot any inconsistencies, reply with the section number and your suggestion.","Thanks for your help earlier. I tested the release candidate on staging and everything looks stable, including the migration and rollback steps.","Could you send the updated invoice details for vendor ACME? Finance needs the PO number, billing address, and the cost center for this month.","Please confirm whether we should keep the current caching strategy for search results. I can write up the trade-offs and share a proposal tomorrow.","Fwd: travel itinerary for the conference. Flights and hotel are attached; the venue map is here: http://maps.example/venue. I'll arrive Monday evening.","Here are the references for the design review: http://intranet.example/designs/v2 and http://intranet.example/notes/1234. Please skim before the meeting.","I uploaded the draft docs and samples here: http://intranet.example/docs/api http://intranet.example/docs/errors http://intranet.example/docs/examples. Feedback welcome.","I created a short checklist for onboarding the new engineer: accounts, access requests, and first-week tasks. Happy to walk through it on our next call.","Do you have time to pair on the UI polish? I'd like to align on spacing, typography, and accessibility before we merge the final changes."]},generateData:e=>{const t=[];Dt.examples.spam.forEach(n=>{const i=te(n),r=()=>(Math.random()-.5)*.1,o=i.map(c=>Math.max(0,c+r()));t.push({input:o,target:1,text:n})}),Dt.examples.ham.forEach(n=>{const r=te(n).map(o=>Math.max(0,o+(Math.random()-.5)*.1));t.push({input:r,target:0,text:n})});for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t},trainingConfig:{maxSteps:3e3,params:[{name:"w1 (Spam Words)",min:1,max:4,step:.5},{name:"w2 (Links)",min:0,max:3,step:.5},{name:"w3 (Total Words)",min:-2,max:2,step:.5},{name:"bias",min:-8,max:8,step:2}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + w₃x₃ + b)",inputLabels:["Spam Words","Links","Words (/50)"],outputLabel:"Spam (p)",biasLabel:"b"},featuresConfig:[{label:"Spam Words",idx:0,max:15},{label:"Links",idx:1,max:8},{label:"Total Words",idx:2,max:100}],isFinished:e=>e>=50};class Un{constructor(t=2,n=10){this.inputCount=t,this.hiddenCount=n;const i=Math.sqrt(6/(t+n));this.weights1=Array(n).fill(0).map(()=>Array.from({length:t},()=>Math.random()*2*i-i)),this.biases1=Array(n).fill(0);const r=Math.sqrt(6/(n+1));this.weights2=Array.from({length:n},()=>Math.random()*2*r-r),this.bias2=0}sigmoid(t){return 1/(1+Math.exp(-t))}predict(t){const n=[];for(let o=0;o<this.hiddenCount;o++){let c=this.biases1[o];for(let u=0;u<this.inputCount;u++)c+=this.weights1[o][u]*t[u];n.push(this.sigmoid(c))}let i=this.bias2;for(let o=0;o<this.hiddenCount;o++)i+=this.weights2[o]*n[o];return this.sigmoid(i)}getActivations(t){const n=[];for(let o=0;o<this.hiddenCount;o++){let c=this.biases1[o];for(let u=0;u<this.inputCount;u++)c+=this.weights1[o][u]*t[u];n.push(this.sigmoid(c))}let i=this.bias2;for(let o=0;o<this.hiddenCount;o++)i+=this.weights2[o]*n[o];const r=this.sigmoid(i);return{hidden:n,output:[r]}}setParams(t){for(let i=0;i<this.hiddenCount;i++){const r=`b1_${i}`;t[r]!==void 0&&(this.biases1[i]=t[r]);for(let o=0;o<this.inputCount;o++){const c=`w1_${i}_${o}`;t[c]!==void 0&&(this.weights1[i][o]=t[c])}}const n="b2";t[n]!==void 0&&(this.bias2=t[n]);for(let i=0;i<this.hiddenCount;i++){const r=`w2_${i}`;t[r]!==void 0&&(this.weights2[i]=t[r])}}getTopology(){return{inputCount:this.inputCount,hiddenCounts:[this.hiddenCount],outputCount:1,weights1:this.weights1,biases1:this.biases1,weights2:this.weights2,bias2:this.bias2}}}const pn=[{label:"Total Words",idx:0,max:400},{label:"Links",idx:1,max:10}],Kt=[{input:[367,5],target:0,text:"Attached is the quarterly report found at..."},{input:[365,2],target:0,text:"Attached is the quarterly report found at..."},{input:[364,6],target:0,text:"Attached is the quarterly report found at..."},{input:[327,7],target:0,text:"Attached is the quarterly report found at..."},{input:[302,5],target:0,text:"Attached is the quarterly report found at..."},{input:[314,3],target:0,text:"Attached is the quarterly report found at..."},{input:[345,4],target:0,text:"Attached is the quarterly report found at..."},{input:[265,5],target:0,text:"Attached is the quarterly report found at..."},{input:[287,4],target:0,text:"Attached is the quarterly report found at..."},{input:[311,1],target:0,text:"Attached is the quarterly report found at..."},{input:[268,2],target:0,text:"Attached is the quarterly report found at..."},{input:[283,0],target:0,text:"Attached is the quarterly report found at..."},{input:[261,3],target:0,text:"Attached is the quarterly report found at..."},{input:[197,0],target:0,text:"Just a normal short message."},{input:[150,0],target:0,text:"Just a normal short message."},{input:[124,0],target:0,text:"Just a normal short message."},{input:[65,1],target:0,text:"Just a normal short message."},{input:[85,0],target:0,text:"Just a normal short message."},{input:[58,0],target:0,text:"Just a normal short message."},{input:[45,0],target:0,text:"Security Alert: Login Code 2542"},{input:[36,0],target:0,text:"Security Alert: Login Code 5607"},{input:[38,1],target:0,text:"Security Alert: Login Code 909"},{input:[24,1],target:0,text:"Security Alert: Login Code 8385"},{input:[17,1],target:0,text:"Security Alert: Login Code 2083"},{input:[215,1],target:1,text:"You won a prize! Click here."},{input:[230,3],target:1,text:"You won a prize! Click here."},{input:[234,5],target:1,text:"You won a prize! Click here."},{input:[221,2],target:1,text:"You won a prize! Click here."},{input:[215,4],target:1,text:"You won a prize! Click here."},{input:[153,3],target:1,text:"You won a prize! Click here."},{input:[152,1],target:1,text:"You won a prize! Click here."},{input:[137,2],target:1,text:"You won a prize! Click here."},{input:[124,4],target:1,text:"You won a prize! Click here."},{input:[120,2],target:1,text:"You won a prize! Click here."},{input:[92,3],target:1,text:"You won a prize! Click here."},{input:[93,5],target:1,text:"You won a prize! Click here."},{input:[86,5],target:1,text:"You won a prize! Click here."},{input:[84,3],target:1,text:"You won a prize! Click here."},{input:[53,4],target:1,text:"You won a prize! Click here."},{input:[55,3],target:1,text:"You won a prize! Click here."}],le=()=>(console.log("Using prepared data with length "+Kt.length),Kt),He={id:"single_layer_nonlinear",title:"Phase 4: Single Layer Nonlinear Data",description:"Spam detection with only 2 features but complex distribution. A simple linear classifier (perceptron) will fail here.",Model:fn,GroundTruth:pe,CanvasComponent:ge,defaultParams:{weights:[0,0],bias:0},getInput:e=>{const t=Math.floor(e*.5)%Kt.length,n=Kt[t],i=[...n.input];return i.text=n.text,i.groundTruth=n.target,i},generateData:e=>le(),trainingConfig:{maxSteps:4e3,params:[{name:"w1 (Words)",min:-5,max:5,step:.5},{name:"w2 (Links)",min:-5,max:5,step:.5},{name:"bias",min:-10,max:10,step:1}]},networkViz:{formula:"p = σ(w₁x₁ + w₂x₂ + b)",inputLabels:["Spam Words","Links"],outputLabel:"Spam (p)",biasLabel:"b"},featuresConfig:pn,isFinished:e=>!1},Tt=e=>{const t=Math.sin(e)*1e4;return t-Math.floor(t)},Gn=(e,t)=>{if(!e)return"";const n=["login","verify","offer","invoice","tracking","reset","promo","survey"],i=["example.com","secure-mail.net","tracking-info.org","account-help.co","promo-deals.io"],r=[];for(let o=0;o<e;o++){const c=i[Math.floor(Tt(t+o*31)*i.length)],u=n[Math.floor(Tt(t+o*57)*n.length)];r.push(`http://${c}/${u}/${Math.floor(Tt(t+o*97)*9e3+1e3)}`)}return r.join(" ")},Ye=(e,t)=>{const[n,i]=e.input,r=n*100+i*10+t,o=["Security notice","Login code","2FA code","Device sign-in","One-time password"],c=["Quarterly report attached","Project status update","Meeting notes and next steps","Draft contract for review","Budget summary"],u=["LIMITED OFFER inside","URGENT: VERIFY ACCOUNT","WIN a PRIZE today","FREE BONUS available","SECURITY ALERT: action required"],f=["Thanks,","Best regards,","Kind regards,","Sincerely,","—"],h=["Alex","Sam","Taylor","Jordan","Casey"][Math.floor(Tt(r+7)*5)],y=`${f[Math.floor(Tt(r+13)*f.length)]} ${h}`,a=Gn(i,r+101);if(e.target===0&&n<60){const v=o[Math.floor(Tt(r+19)*o.length)],C=`Your login code is ${Math.floor(Tt(r+23)*9e5+1e5)}. It expires in 10 minutes.
If you did not request this, ignore this message.`;return`Subject: ${v}
${C}
${y}`}if(e.target===0){const v=c[Math.floor(Tt(r+29)*c.length)],_=["Hi team,","Sharing the latest update and a few action items for this week.","Please review when you have a moment and reply with any questions.",a?`References: ${a}`:""].filter(Boolean).join(`
`);return`Subject: ${v}
${_}
${y}`}const M=u[Math.floor(Tt(r+37)*u.length)],p=["CLICK LINK NOW to CLAIM your REWARD.","ACT NOW: LIMITED DISCOUNT expires TODAY.","VERIFY ACCOUNT to avoid SUSPENDED access.","WIN CASH PRIZE — CLAIM BONUS NOW.","FREE OFFER available — CLICK LINK to continue."],g=[p[Math.floor(Tt(r+41)*p.length)],a?`Links: ${a}`:"Links: http://promo-deals.io/offer/1234",y].join(`
`);return`Subject: ${M}
${g}`},qn=()=>{const e=[];for(let t=0;t<10;t++){e.push({name:`b1_${t}`,min:-30,max:30,step:1});for(let n=0;n<2;n++)e.push({name:`w1_${t}_${n}`,min:-30,max:30,step:1})}e.push({name:"b2",min:-3,max:3,step:1});for(let t=0;t<10;t++)e.push({name:`w2_${t}`,min:-50,max:50,step:1});return e},Ve={id:"double_layer_nonlinear",title:"Phase 5: Double Layer Nonlinear Data",description:'Spam detection with a Hidden Layer (10 neurons). The Deep Neural Network can detect the nonlinear distribution ("Spam Island").',Model:Un,GroundTruth:pe,CanvasComponent:ge,defaultParams:{},getInput:e=>{const t=le(),n=Math.floor(e*.5)%t.length,i=t[n],r=[...i.input];return r.text=Ye(i,n),r.groundTruth=i.target,r},generateData:e=>le().map((t,n)=>({...t,text:Ye(t,n)})),trainingConfig:{seed:1319434789,maxSteps:1e4,params:qn()},networkViz:{formula:"p = σ(W₂ · σ(W₁ · x + b₁) + b₂)",inputLabels:[`Spam
Words`,"Links"],outputLabel:"Spam (p)",biasLabel:"b"},featuresConfig:pn,isFinished:e=>e>=50},Be={[De.id]:De,[Ee.id]:Ee,[Dt.id]:Dt,[He.id]:He,[Ve.id]:Ve};function Kn(e){return Be[e]||Be.linear_regression}function me(e){const[t,n]=at(null),i=xt(null),r=xt(null),[o,c]=at(0),[u,f]=at(!1),[h,y]=at([]),[a,M]=at([]),[p,g]=at(-1),[v,_]=at(!1),[C,w]=at("simulation"),[q,V]=at("table"),[K,tt]=at("random"),[Z,T]=at("Ready."),d=xt(0);wt(()=>{if(!e)return;if(e==="gallery"){n({id:"gallery",type:"gallery"});return}const k=Kn(e);if(!k){T("Error: Simulation not found.");return}try{if(i.current=new k.GroundTruth(...k.groundTruthDefaults||[]),r.current=new k.Model,k.defaultParams&&(k.defaultParams.weight!==void 0&&r.current.setWeight(k.defaultParams.weight),k.defaultParams.weights!==void 0&&r.current.setWeights&&r.current.setWeights(k.defaultParams.weights),k.defaultParams.bias!==void 0&&r.current.setBias(k.defaultParams.bias)),n(k),i.current)try{const I=k.generateData(i.current);y(I)}catch(I){console.error("Auto-generate data error:",I)}}catch(I){console.error("Initialization Error:",I),T(`Init Error: ${I.message}`)}},[e]),wt(()=>{let k;const I=Y=>{if(!u)return;d.current===0&&(d.current=Y);const O=(Y-d.current)/1e3;d.current=Y;const F=Math.min(O,.1);c(R=>{const S=R+F*3;return t&&t.isFinished&&t.isFinished(S)&&(f(!1),T("Simulation finished.")),S}),k=requestAnimationFrame(I)};return u&&(d.current=0,k=requestAnimationFrame(I)),()=>cancelAnimationFrame(k)},[u,t]);const W=()=>{c(0),f(!0),T("Simulation running..."),w("simulation")},b=()=>{f(!1),T("Simulation paused.")},x=()=>{u?b():W()},E=async()=>{try{if(h.length===0||!t)return;_(!0),g(0),M([]),T("Searching for optimal weight and bias (Live Visualization)..."),w("training");const k=new t.Model,I=new Hn(k),Y=(F,R)=>{if(M(j=>{const S=[...j,...F];return g(S.length-1),S}),R&&R.message&&T(R.message),R&&R.bestParams)if(r.current.setParams)r.current.setParams(R.bestParams);else if(r.current.setWeights){const{weights:j,bias:S}=R.bestParams;r.current.setWeights(j),r.current.setBias(S)}else r.current.setWeight&&R.bestParams&&R.bestParams.weights&&R.bestParams.weights.length>=1&&(r.current.setWeight(R.bestParams.weights[0]),r.current.setBias(R.bestParams.bias));else R&&R.bestWeight!==void 0&&(r.current.setWeight(R.bestWeight),r.current.setBias(R.bestBias))};let O;if(K==="random"){T("Searching for optimal weight and bias (Random Search)...");const F={seed:t.trainingConfig.seed,maxSteps:t.trainingConfig.maxSteps,initialRadius:t.trainingConfig.initialRadius,phase1Ratio:t.trainingConfig.phase1Ratio};O=await I.trainRandomAsync(h,t.trainingConfig.params,Y,F)}else t.trainingConfig.params?O=await I.trainAsync(h,t.trainingConfig.params,Y):O=await I.trainAsync(h,t.trainingConfig.weightRange,t.trainingConfig.biasRange,Y);T(`Training finished! Min Error: ${O.minError.toFixed(5)}`),_(!1)}catch(k){console.error("Training Error:",k),_(!1),T(`Training Error: ${k.message}`)}},P=t&&t.getInput?t.getInput(o):void 0;return{simConfig:t,groundTruth:i,neuralNet:r,time:o,currentInput:P,isRunning:u,trainingData:h,trainingHistory:a,trainingStepIndex:p,isTraining:v,activeTab:C,dataViewMode:q,trainerType:K,statusMsg:Z,handleTrain:E,handleRun:x,handleStop:b,toggleRun:x,setTrainerType:tt,setActiveTab:w,setDataViewMode:V}}function Zn({history:e,currentStepIndex:t,isTraining:n,paramsConfig:i,showAccuracyPlot:r=!0}){const o=xt(null),[c,u]=at(0),f=6;wt(()=>{u(0)},[i]),wt(()=>{const y=o.current;if(!y||!e||e.length===0)return;const a=y.getContext("2d"),M=y.width,p=y.height;a.clearRect(0,0,M,p),a.fillStyle="#fff",a.fillRect(0,0,M,p);const g=Math.max(...e.map(Z=>Z.error)),_=!n&&e.length>0?e.length-1:t!==null&&t>=0?Math.min(t,e.length-1):-1;let C=-1,w=1/0;for(let Z=0;Z<=_;Z++)e[Z].error<w&&(w=e[Z].error,C=Z);let q=[];if(i){const Z=r?2:1,T=Z+i.length,d=c*f,W=Math.min(d+f,T),b=3,x=2,E=M/b,P=p/x;for(let k=d;k<W;k++){const I=k-d,Y=I%b,O=Math.floor(I/b),F=Y*E,R=O*P;if(r&&k===0){const j=Math.max(10,e.length-1);q.push({type:"accuracy_step",xLabel:"Training Step",xMin:0,xMax:j,yMode:"accuracy",getValue:(S,A)=>A,getYValue:S=>S.accuracy||0,offsetX:F,offsetY:R,w:E,h:P,showYAxis:!0})}else if(r&&k===1||!r&&k===0){const j=Math.max(10,e.length-1);q.push({type:"error_step",xLabel:"Training Step",xMin:0,xMax:j,yMode:"error_log",getValue:(S,A)=>A,getYValue:S=>S.error,offsetX:F,offsetY:R,w:E,h:P,showYAxis:!0})}else{const j=k-Z,S=i[j],A=e.map(l=>l.params[j]),X=Math.min(...A),m=Math.max(...A);q.push({type:"param_error",xLabel:S.name,xMin:X,xMax:m,yMode:"error_log",getValue:l=>l.params[j],getYValue:l=>l.error,offsetX:F,offsetY:R,w:E,h:P})}}}else{const Z=M/2,T=p/2,d=e.map(x=>x.weight),W=e.map(x=>x.bias),b=Math.max(10,e.length-1);q=[],r&&q.push({type:"accuracy_step",xLabel:"Accuracy",xMin:0,xMax:b,yMode:"accuracy",getValue:(x,E)=>E,getYValue:x=>x.accuracy||0,offsetX:0,offsetY:0,w:Z,h:T,showYAxis:!0}),q.push({type:"error_step",xLabel:"Step",xMin:0,xMax:b,yMode:"error_log",getValue:(x,E)=>E,getYValue:x=>x.error,offsetX:r?Z:0,offsetY:0,w:Z,h:T,showYAxis:!0},{xLabel:"Weight",xMin:Math.min(...d),xMax:Math.max(...d),yMode:"error_log",getValue:x=>x.weight,getYValue:x=>x.error,offsetX:r?0:Z,offsetY:r?T:0,w:Z,h:T},{xLabel:"Bias",xMin:Math.min(...W),xMax:Math.max(...W),yMode:"error_log",getValue:x=>x.bias,getYValue:x=>x.error,offsetX:r?Z:0,offsetY:T,w:Z,h:T})}const V=50;q.forEach(Z=>{const{xLabel:T,xMin:d,xMax:W,getValue:b,getYValue:x,offsetX:E,offsetY:P,w:k,h:I,yMode:Y,showYAxis:O}=Z,F=S=>E+V+(S-d)/(W-d||1)*(k-2*V);let R;if(Y==="accuracy")R=S=>P+I-V-S*(I-2*V);else{const A=g||1;R=X=>{const m=(X-0)/(A-0);return P+I-V-m*(I-2*V)}}a.strokeStyle="#eee",a.lineWidth=2,a.strokeRect(E,P,k,I),a.beginPath(),a.strokeStyle="#333",a.lineWidth=2,a.moveTo(E+V,P+V),a.lineTo(E+V,P+I-V),a.lineTo(E+k-V,P+I-V),a.stroke(),a.fillStyle="#333",a.font="22px sans-serif",a.textAlign="center";let j=T;if(j.length>20&&(j=j.substring(0,18)+"..."),a.fillText(j,E+k/2,P+I-15),E===0||O)if(a.save(),a.translate(E+15,P+I/2),a.rotate(-Math.PI/2),Y==="accuracy")a.fillText("Accuracy",0,0),a.restore(),a.textAlign="right",a.fillStyle="#666",a.font="18px sans-serif",[0,.25,.5,.75,1].forEach(S=>{const A=R(S);a.fillText(S.toFixed(2),E+V-8,A+6),a.beginPath(),a.lineWidth=1,a.strokeStyle="#f0f0f0",a.moveTo(E+V,A),a.lineTo(E+k-V,A),a.stroke()});else{a.fillText("Error",0,0),a.restore(),a.textAlign="right",a.fillStyle="#666",a.font="18px sans-serif";const S=5;for(let A=0;A<=S;A++){const X=A/S*g,m=R(X);a.fillText(X.toFixed(2),E+V-8,m+6),A>0&&(a.beginPath(),a.lineWidth=1,a.strokeStyle="#f0f0f0",a.moveTo(E+V,m),a.lineTo(E+k-V,m),a.stroke())}}a.fillStyle="#666",a.font="18px sans-serif",a.textAlign="center",a.fillText(d.toFixed(1),E+V,P+I-V+25),a.fillText(W.toFixed(1),E+k-V,P+I-V+25),a.fillStyle=Y==="accuracy"?"rgba(155, 89, 182, 0.4)":"rgba(52, 152, 219, 0.4)";for(let S=0;S<=_;S++){const A=b(e[S],S),X=x(e[S]),m=F(A),l=R(X);a.fillRect(m,l,4,4)}if(C>=0){const S=b(e[C],C),A=x(e[C]),X=F(S),m=R(A);a.beginPath(),a.fillStyle="#2ecc71",a.strokeStyle="#27ae60",a.lineWidth=2,a.arc(X,m,10,0,Math.PI*2),a.fill(),a.stroke()}if(n&&t!==null&&t>=0&&t<=_){const S=b(e[t],t),A=x(e[t]),X=F(S),m=R(A);a.beginPath(),a.fillStyle="#e74c3c",a.strokeStyle="#c0392b",a.lineWidth=2,a.arc(X,m,8,0,Math.PI*2),a.fill(),a.stroke()}});const K=M-150,tt=20;a.fillStyle="rgba(255,255,255,0.9)",a.fillRect(K,tt,140,70),a.strokeStyle="#ccc",a.lineWidth=1,a.strokeRect(K,tt,140,70),a.textAlign="left",a.font="16px sans-serif",a.beginPath(),a.fillStyle="#e74c3c",a.arc(K+15,tt+20,6,0,Math.PI*2),a.fill(),a.fillStyle="#333",a.fillText("Current Scan",K+30,tt+25),a.beginPath(),a.fillStyle="#2ecc71",a.arc(K+15,tt+50,6,0,Math.PI*2),a.fill(),a.fillStyle="#333",a.fillText("Best So Far",K+30,tt+55),!n&&C>=0&&(a.fillStyle="#333",a.font="bold 18px sans-serif",a.textAlign="right",a.textBaseline="bottom",a.fillText(`Min Error: ${w.toFixed(5)}`,M-20,p-8))},[e,t,n,i,c]);const h=i?Math.ceil((i.length+1)/f):1;return s("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff"},children:[s("canvas",{ref:o,width:1600,height:800,style:{width:"100%",height:"auto"}}),h>1&&s("div",{style:{display:"flex",justifyContent:"center",marginTop:"10px",gap:"10px"},children:[s("button",{onClick:()=>u(y=>Math.max(0,y-1)),disabled:c===0,children:"Previous"}),s("span",{style:{alignSelf:"center"},children:["Page ",c+1," of ",h]}),s("button",{onClick:()=>u(y=>Math.min(h-1,y+1)),disabled:c===h-1,children:"Next"})]})]})}function Jn(e,t){for(var n in t)e[n]=t[n];return e}function Oe(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var i in t)if(i!=="__source"&&e[i]!==t[i])return!0;return!1}function Fe(e,t){this.props=e,this.context=t}(Fe.prototype=new Lt).isPureReactComponent=!0,Fe.prototype.shouldComponentUpdate=function(e,t){return Oe(this.props,e)||Oe(this.state,t)};var Xe=et.__b;et.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Xe&&Xe(e)};var Qn=et.__e;et.__e=function(e,t,n,i){if(e.then){for(var r,o=t;o=o.__;)if((r=o.__c)&&r.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t)}Qn(e,t,n,i)};var je=et.unmount;function gn(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(i){typeof i.__c=="function"&&i.__c()}),e.__c.__H=null),(e=Jn({},e)).__c!=null&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(i){return gn(i,t,n)})),e}function mn(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(i){return mn(i,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function ee(){this.__u=0,this.o=null,this.__b=null}function _n(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Ot(){this.i=null,this.l=null}et.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),je&&je(e)},(ee.prototype=new Lt).__c=function(e,t){var n=t.__c,i=this;i.o==null&&(i.o=[]),i.o.push(n);var r=_n(i.__v),o=!1,c=function(){o||(o=!0,n.__R=null,r?r(u):u())};n.__R=c;var u=function(){if(!--i.__u){if(i.state.__a){var f=i.state.__a;i.__v.__k[0]=mn(f,f.__c.__P,f.__c.__O)}var h;for(i.setState({__a:i.__b=null});h=i.o.pop();)h.forceUpdate()}};i.__u++||32&t.__u||i.setState({__a:i.__b=i.__v.__k[0]}),e.then(c,c)},ee.prototype.componentWillUnmount=function(){this.o=[]},ee.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=gn(this.__b,n,i.__O=i.__P)}this.__b=null}var r=t.__a&&oe(mt,null,e.fallback);return r&&(r.__u&=-33),[oe(mt,null,t.__a?null:e.children),r]};var Ue=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.i=n=n[2]}};(Ot.prototype=new Lt).__a=function(e){var t=this,n=_n(t.__v),i=t.l.get(e);return i[0]++,function(r){var o=function(){t.props.revealOrder?(i.push(r),Ue(t,e,i)):r()};n?n(o):o()}},Ot.prototype.render=function(e){this.i=null,this.l=new Map;var t=Ut(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i]);return e.children},Ot.prototype.componentDidUpdate=Ot.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,n){Ue(e,n,t)})};var ti=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,ei=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,ni=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,ii=/[A-Z0-9]/g,ri=typeof document<"u",oi=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};Lt.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Lt.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Ge=et.event;function si(){}function ai(){return this.cancelBubble}function li(){return this.defaultPrevented}et.event=function(e){return Ge&&(e=Ge(e)),e.persist=si,e.isPropagationStopped=ai,e.isDefaultPrevented=li,e.nativeEvent=e};var ci={enumerable:!1,configurable:!0,get:function(){return this.class}},qe=et.vnode;et.vnode=function(e){typeof e.type=="string"&&(function(t){var n=t.props,i=t.type,r={},o=i.indexOf("-")===-1;for(var c in n){var u=n[c];if(!(c==="value"&&"defaultValue"in n&&u==null||ri&&c==="children"&&i==="noscript"||c==="class"||c==="className")){var f=c.toLowerCase();c==="defaultValue"&&"value"in n&&n.value==null?c="value":c==="download"&&u===!0?u="":f==="translate"&&u==="no"?u=!1:f[0]==="o"&&f[1]==="n"?f==="ondoubleclick"?c="ondblclick":f!=="onchange"||i!=="input"&&i!=="textarea"||oi(n.type)?f==="onfocus"?c="onfocusin":f==="onblur"?c="onfocusout":ni.test(c)&&(c=f):f=c="oninput":o&&ei.test(c)?c=c.replace(ii,"-$&").toLowerCase():u===null&&(u=void 0),f==="oninput"&&r[c=f]&&(c="oninputCapture"),r[c]=u}}i=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=Ut(n.children).forEach(function(h){h.props.selected=r.value.indexOf(h.props.value)!=-1})),i=="select"&&r.defaultValue!=null&&(r.value=Ut(n.children).forEach(function(h){h.props.selected=r.multiple?r.defaultValue.indexOf(h.props.value)!=-1:r.defaultValue==h.props.value})),n.class&&!n.className?(r.class=n.class,Object.defineProperty(r,"className",ci)):(n.className&&!n.class||n.class&&n.className)&&(r.class=r.className=n.className),t.props=r})(e),e.$$typeof=ti,qe&&qe(e)};var Ke=et.__r;et.__r=function(e){Ke&&Ke(e),e.__c};var Ze=et.diffed;et.diffed=function(e){Ze&&Ze(e);var t=e.props,n=e.__e;n!=null&&e.type==="textarea"&&"value"in t&&t.value!==n.value&&(n.value=t.value==null?"":t.value)};const ui={collapseModelArchitectureByDefault:!1};function xn(){return ui}function hi({model:e,inputs:t,inputLabels:n,output:i,outputLabel:r,formula:o,collapseModelArchitectureByDefault:c}){if(!e||!e.getTopology)return null;const u=e.getTopology(),{inputCount:f,hiddenCounts:h,outputCount:y,weights1:a,biases1:M,weights2:p}=u,g=u.biases2||(u.bias2!==void 0?[u.bias2]:null);let v={hidden:[],output:[]};e.getActivations&&(v=e.getActivations(t));const[_,C]=at(null),[w,q]=at(!1),V=typeof c=="boolean"?c:xn().collapseModelArchitectureByDefault,[K,tt]=at(!V),Z=400,T=400,d=T/2,W=Z/2,b=300,x=300,E=W-b/2,P=W+b/2,k=[{count:f,x:E,labels:n,values:t},{count:h[0],x:W,values:v.hidden},{count:y,x:P,labels:[r],values:v.output}];Math.max(...k.map(A=>A.count));const I=(A,X)=>{const m=k[A].count;let l=Math.min(50,x/m);const Q=(m-1)*l;return d-Q/2+X*l},Y=(A,X)=>{_&&_.layer===A&&_.index===X?C(null):C({layer:A,index:X})},O=(A,X,m,l)=>_?_.layer===A&&_.index===X||_.layer===m&&_.index===l:!1,F=(A,X)=>_&&_.layer===A&&_.index===X;if(w)return s("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center",height:"400px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[s("div",{style:{flex:"0 0 auto",marginBottom:"10px"},children:s("h3",{style:{margin:"0",fontSize:"1rem",color:"#555"},children:"Network Parameters"})}),s("div",{style:{flex:"1 1 auto",overflow:"auto",display:"flex",justifyContent:"center",alignItems:"flex-start"},children:s("div",{style:{display:"flex",gap:"20px",alignItems:"flex-start",justifyContent:"center",flexWrap:"wrap",paddingBottom:"10px"},children:[s("div",{style:{textAlign:"center"},children:[s("h4",{style:{fontSize:"0.9rem",marginBottom:"5px"},children:"Layer 1 Weights"}),s(di,{data:a}),s("h4",{style:{fontSize:"0.9rem",marginBottom:"5px",marginTop:"10px"},children:"Layer 1 Biases"}),s(ne,{data:M})]}),s("div",{style:{textAlign:"center"},children:[s("h4",{style:{fontSize:"0.9rem",marginBottom:"5px"},children:"Layer 2 Weights (to Output)"}),s(ne,{data:Array.isArray(p[0])?p.flat():p,isVertical:!0}),g&&s(mt,{children:[s("h4",{style:{fontSize:"0.9rem",marginBottom:"5px",marginTop:"10px"},children:"Layer 2 Bias"}),s(ne,{data:Array.isArray(g)?g:[g]})]})]})]})}),s("div",{style:{flex:"0 0 auto",marginTop:"10px",cursor:"pointer",fontStyle:"italic",color:"#777",padding:"5px"},onClick:()=>q(!1),children:"Back to Network"})]});const R=[{fill:"#e3f2fd",stroke:"#2196f3",highlight:"#1976d2"},{fill:"#f3e5f5",stroke:"#9c27b0",highlight:"#7b1fa2"},{fill:"#e8f5e9",stroke:"#4caf50",highlight:"#388e3c"}],j="#bdbdbd",S="#ff9800";return s("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center"},children:[s("h3",{style:{marginBottom:"10px",fontSize:"1rem",color:"#555"},children:"Neural Network Activity"}),s("svg",{width:Z,height:T,style:{overflow:"visible"},children:[s("rect",{x:E,y:d-x/2,width:b,height:x,rx:"15",fill:"transparent",stroke:"#333",strokeWidth:"2",style:{cursor:"pointer"},onClick:()=>tt(A=>!A)}),K&&a.map((A,X)=>A.map((m,l)=>{const Q=O(0,l,1,X),nt=_&&!Q,$=Q?S:j,U=Q?3:1.5,rt=nt?.2:1;return s("line",{x1:k[0].x,y1:I(0,l),x2:k[1].x,y2:I(1,X),stroke:$,strokeWidth:U,strokeOpacity:rt,style:{transition:"all 0.3s ease"}},`L0-${l}-${X}`)})),K&&p.map((A,X)=>{const m=O(1,X,2,0),l=_&&!m,Q=m?S:j,nt=m?3:1.5,$=l?.2:1;return s("line",{x1:k[1].x,y1:I(1,X),x2:k[2].x,y2:I(2,0),stroke:Q,strokeWidth:nt,strokeOpacity:$,style:{transition:"all 0.3s ease"}},`L1-${X}-0`)}),(K?k:[k[0],k[2]]).map((A,X)=>{const m=K?X:X===0?0:2;return s("g",{children:Array.from({length:A.count}).map((l,Q)=>{const nt=A.x,$=I(m,Q),U=A.values&&A.values[Q]!==void 0?A.values[Q]:0,rt=F(m,Q),D=R[m]||R[0];return s("g",{onClick:()=>Y(m,Q),style:{cursor:"pointer"},children:[s("circle",{cx:nt,cy:$,r:12,fill:rt?D.highlight:D.fill,stroke:D.stroke,strokeWidth:rt?"3":"2",style:{transition:"all 0.3s ease"}}),A.labels&&s("text",{x:m===0?nt-18:nt+18,y:$,textAnchor:m===0?"end":"start",style:{textAnchor:m===0?"end":"start",pointerEvents:"none"},dominantBaseline:"middle",fontSize:"14",fontWeight:"600",fill:"#444",children:(A.labels[Q]||"").toString().split(`
`).map((G,L,z)=>s("tspan",{x:m===0?nt-18:nt+18,dy:L===0?`${(z.length-1)*-.6}em`:"1.2em",children:G},L))}),s("title",{children:U.toFixed(3)})]},`n-${m}-${Q}`)})},`layer-${m}`)}),K&&o&&s("foreignObject",{className:"formula",x:W-200,y:T-25,width:400,height:20,children:s("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",fontSize:"18px",fontStyle:"italic",color:"#777",cursor:"pointer",userSelect:"none"},onClick:()=>q(!0),title:"Click to view matrices",children:o})})]})]})}function di({data:e}){return e?s("div",{style:{display:"grid",gridTemplateColumns:`repeat(${e[0].length}, 1fr)`,gap:"2px",border:"1px solid #999",padding:"2px",background:"#eee"},children:e.map((t,n)=>t.map((i,r)=>s("div",{style:{padding:"2px 4px",background:"#fff",fontSize:"10px",textAlign:"center"},children:i.toFixed(2)},`${n} -${r} `)))}):null}function ne({data:e,isVertical:t=!1}){if(!e)return null;const n=Array.isArray(e)?e:[e];return s("div",{style:{display:"flex",flexDirection:t?"column":"row",gap:"2px",border:"1px solid #999",padding:"2px",background:"#eee"},children:n.map((i,r)=>s("div",{style:{padding:"2px 4px",background:"#fff",fontSize:"10px",textAlign:"center"},children:i.toFixed(2)},r))})}function yn({input:e,weight:t,bias:n,output:i,formula:r="y = w * x + b",inputLabel:o="Input",outputLabel:c="Output",biasLabel:u="b",decimals:f=1,model:h=null,collapseModelArchitectureByDefault:y,showActivation:a=!0}){const M=typeof y=="boolean"?y:xn().collapseModelArchitectureByDefault,[p,g]=at(!M);if(h&&h.getTopology){let A=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(A=e.input);const X=Array.isArray(A)?A:[A],m=Array.isArray(o)?o:[o];return s(hi,{model:h,inputs:X,inputLabels:m,output:i,outputLabel:c,formula:r,collapseModelArchitectureByDefault:y})}let v=e;e&&!Array.isArray(e)&&typeof e=="object"&&e.input&&Array.isArray(e.input)&&(v=e.input);const _=Array.isArray(v)?v:[v],C=Array.isArray(t)?t:[t],w=Array.isArray(o)?o:[o],q=Number(n)||0,V=Number(i)||0,K=_.length,tt=24,Z=90,T=260,d=60,W=60,b=Math.max(1,K-1)*Z,x=Math.max(150,b+d+W),E=x+60,P=600,k=P/2+10,I=k-T/2,Y=k+T/2,O=x/2+20,F=O-b/2,R=Y-50,j=(a?R:Y-tt)-60,S=a?R-20:j;return s("div",{style:{border:"1px solid #ccc",borderRadius:"8px",padding:"10px",background:"#fff",textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[s("div",{className:"model-title",style:{marginBottom:"10px"},children:"Model Architecture"}),s("svg",{width:P,height:E,style:{overflow:"visible"},children:[s("defs",{children:s("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"27",refY:"3.5",orient:"auto",children:s("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#333"})})}),s("rect",{x:I,y:20,width:T,height:x,rx:"15",fill:"transparent",stroke:"#333",strokeWidth:"2",style:{cursor:"pointer"},onClick:()=>g(A=>!A)}),(()=>{const A=O-50;return s(mt,{children:[_.map((X,m)=>{const l=K>1?F+m*Z:O,Q=Number(C[m])||0,nt=w[m]||`x${m+1}`,$=Number(X)||0;return s("g",{children:[p&&s(mt,{children:[s("line",{x1:I,y1:l,x2:j,y2:O,stroke:"#666",strokeWidth:"1"}),s("g",{transform:`translate(${(I+j)/2+(1-(K-1)/2)*5}, ${(l+O)/2})`,children:[s("rect",{x:"-24",y:"-8",width:"50",height:"18",fill:"#fff",rx:"4",stroke:"#e0e0e0"}),s("text",{x:"0",y:"5",textAnchor:"middle",fill:"#e74c3c",fontSize:"10",fontWeight:"bold",children:Q.toFixed(1)})]})]}),s("circle",{cx:I,cy:l,r:tt,fill:"#fff",stroke:"#333",strokeWidth:"2"}),s("text",{x:I-30,y:l+2,textAnchor:"end",style:{textAnchor:"end"},dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:nt.toString().split(`
`).map((U,rt,D)=>s("tspan",{x:I-30,dy:rt===0?`${(D.length-1)*-.6}em`:"1.2em",children:U},rt))}),s("text",{x:I-1,y:l+2,textAnchor:"middle",dominantBaseline:"middle",fontSize:"14",fill:"#333",children:$.toFixed(f)})]},m)}),p&&s(mt,{children:[s("line",{x1:j,y1:O,x2:a?R:Y-tt,y2:O,stroke:"#666",strokeWidth:"1"}),a&&s(mt,{children:[s("g",{transform:`translate(${R}, ${O})`,children:[s("rect",{x:"-18",y:"-18",width:"36",height:"36",rx:"6",fill:"#fff",stroke:"#333",strokeWidth:"2"}),s("path",{d:"M -10 8 C -4 8, -4 -8, 10 -8",stroke:"#333",strokeWidth:"2",fill:"none"})]}),s("line",{x1:R+18,y1:O,x2:Y-tt,y2:O,stroke:"#333",strokeWidth:"2"})]}),s("path",{d:`M ${S} ${A} Q ${S} ${O} ${j+10} ${O}`,fill:"none",stroke:"#f39c12",strokeWidth:"1"}),s("circle",{cx:S,cy:A,r:12,fill:"#f1c40f",stroke:"#f39c12"}),s("text",{x:S,y:A+2,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",fontWeight:"bold",fill:"#fff",children:u}),s("text",{x:S+18,y:A+1,textAnchor:"start",dominantBaseline:"middle",fontSize:"12",fill:"#f39c12",fontWeight:"bold",children:q.toFixed(2)})]})]})})(),s("circle",{cx:Y,cy:O,r:tt,fill:"#fff",stroke:"#333",strokeWidth:"2"}),s("text",{x:Y+6,y:O+3,textAnchor:"middle",dominantBaseline:"middle",fontSize:"12",children:V.toFixed(2)}),s("text",{x:Y+30,y:O+2,textAnchor:"start",dominantBaseline:"middle",fontWeight:"bold",fontSize:"14",fill:"#333",children:c.toString().split(`
`).map((A,X,m)=>s("tspan",{x:Y+33,dy:X===0?`${(m.length-1)*-.6}em`:"1.2em",children:A},X))}),p&&s("foreignObject",{className:"formula",x:k-200,y:E-25,width:400,height:20,children:s("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",fontSize:"18px",fontStyle:"italic",color:"#777"},children:r})})]})]})}function fi({onTrain:e,onRun:t,isTraining:n,trainingStep:i,dataCount:r,trainerType:o,onTrainerTypeChange:c,isRunning:u,simulationEnabled:f=!0}){return s("div",{class:"control-panel",role:"region","aria-label":"Controls",style:{padding:"20px",background:"#eee",borderRadius:"8px",display:"flex",gap:"10px",flexWrap:"wrap",alignItems:"center"},children:[s("span",{"aria-live":"polite",children:["Data Points: ",r]}),s("div",{style:{borderLeft:"1px solid #ccc",paddingLeft:"10px",marginLeft:"10px",display:"flex",gap:"5px",alignItems:"center"},children:[s("select",{value:o,onChange:h=>c(h.target.value),disabled:n,style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[s("option",{value:"exhaustive",children:"Grid Search "}),s("option",{value:"random",children:"Adaptive Random "})]}),s("button",{onClick:e,disabled:n||r===0,"aria-busy":n,children:n?"Searching...":"2. Train"})]}),f&&s("button",{onClick:t,disabled:n,style:u?{background:"#f39c12",color:"white"}:{},children:["3. Simulation ",u?"Stop":"Start"]})]})}function Rt({viewMode:e,onChange:t}){return s("div",{style:{display:"flex"},children:s("div",{style:{background:"#eee",borderRadius:"4px",padding:"2px",display:"flex",gap:"2px"},children:[s("button",{onClick:()=>t("table"),style:{background:e==="table"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:e==="table"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:e==="table"?"bold":"normal",color:e==="table"?"#333":"#666"},children:"Table"}),s("button",{onClick:()=>t("plot"),style:{background:e==="plot"?"#fff":"transparent",border:"none",borderRadius:"3px",padding:"5px 15px",cursor:"pointer",boxShadow:e==="plot"?"0 1px 2px rgba(0,0,0,0.1)":"none",fontWeight:e==="plot"?"bold":"normal",color:e==="plot"?"#333":"#666"},children:"Graph"})]})})}function Jt({data:e,vizProps:t,simConfig:n}){if(!e||e.length===0)return s("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No training data generated yet."});const i=["logistic_regression","spam","spam_advanced","spam_hidden","spam_nonlinear","multiple_inputs","single_layer_nonlinear","double_layer_nonlinear"].includes(n?.id),r=(o,c=2)=>{const u=String(o??"").split(/\r?\n/);return u.length<=c?String(o??""):`${u.slice(0,c).join(`
`)}...`};return s("div",{style:{maxHeight:"400px",overflowY:"auto"},children:s("table",{style:{width:"100%",textAlign:"left",borderCollapse:"collapse",fontSize:"0.9rem"},children:[s("thead",{children:s("tr",{style:{background:"#eee",borderBottom:"2px solid #ddd"},children:[Array.isArray(t.inputLabels)?t.inputLabels.map((o,c)=>s("th",{style:{padding:"8px"},children:o},c)):s("th",{style:{padding:"8px"},children:["Input (",t.inputLabel,")"]}),s("th",{style:{padding:"8px"},children:i?"Spam?":"Target"}),e.length>0&&e[0].text&&s("th",{style:{padding:"8px"},children:"Email Text"})]})}),s("tbody",{children:e.map((o,c)=>{let u="transparent",f=o.target,h={padding:"8px"};if(i){const y=o.target===1;u=y?"#ffebee":"#e8f5e9",f=y?"SPAM":"HAM",h={...h,fontWeight:"bold",color:y?"#c0392b":"#27ae60"}}else f=typeof o.target=="number"?o.target.toFixed(2):o.target;return s("tr",{style:{background:u,borderBottom:"1px solid #ddd"},children:[Array.isArray(o.input)?o.input.map((y,a)=>s("td",{style:{padding:"8px"},children:y.toFixed(0)},a)):s("td",{style:{padding:"8px"},children:o.input.toFixed(2)}),s("td",{style:h,children:f}),o.text&&s("td",{style:{padding:"8px",color:"#555",fontStyle:"italic",maxWidth:"300px",whiteSpace:"pre-line",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:r(o.text,2)})]},c)})})]})})}function _e({hookState:e,renderSimulationView:t,renderDataView:n,networkVizProps:i={},simulationEnabled:r=!0,customDataHandling:o=!1}){const{simConfig:f,activeTab:h,setActiveTab:y,trainingHistory:a,trainingStepIndex:M,isTraining:p,dataViewMode:g,setDataViewMode:v,trainingData:_,groundTruth:C,neuralNet:w,time:q,statusMsg:V,handleTrain:K,handleRun:tt,isRunning:Z,trainerType:T,setTrainerType:d,currentInput:W}=e,[b,x]=at(null),E=xt(null),P=xt(null),k=xt(null),[I,Y]=at(null),[O,F]=at(0),[R,j]=at(0);wt(()=>{const $=()=>{const U=E.current?.offsetHeight??0,rt=k.current?.offsetHeight??0;j(U),F(rt)};return $(),window.addEventListener("resize",$),()=>window.removeEventListener("resize",$)},[]);const S=$=>{x(U=>{const rt=U===$?null:$;if(rt&&!U){const D=P.current?.offsetHeight,G=E.current?.offsetHeight,L=k.current?.offsetHeight,z=typeof G=="number"&&G>0?Math.max(0,G-(L||0)-20):null;if(typeof D=="number"&&D>0){const N=typeof z=="number"?Math.min(D,z):D;Y(N)}}else rt||Y(null);return rt})},A={position:"absolute",top:"10px",right:"10px",zIndex:10,background:"rgba(255, 255, 255, 0.9)",border:"1px solid #ccc",borderRadius:"4px",padding:"4px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"0px"},X="all 0.4s cubic-bezier(0.4, 0, 0.2, 1)";wt(()=>{!r&&h==="simulation"&&y("data")},[r,h,y]);const m=W!==void 0?W:f.getInput?f.getInput(q):q,l=f.networkViz||{},Q=I?`${I}px`:R>0?`calc(${R}px - ${O}px - 20px)`:"auto";return s("div",{ref:E,className:"nn-demonstrator layout-container",style:{display:"flex",flexDirection:"column",height:"100%",minHeight:0,overflow:"hidden"},children:[s("div",{ref:P,className:"top-section",style:{display:"flex",gap:b?"0px":"20px",flexWrap:"nowrap",alignItems:"stretch",height:b?Q:"auto",minHeight:I?0:"500px",overflow:b?"hidden":"visible",transition:X,marginBottom:"20px"},children:[s("div",{className:"simulation-wrapper",style:{flex:b==="simulation"?"1 0 100%":b==="network"?"0 0 0%":"1 1 500px",opacity:b==="network"?0:1,overflow:"hidden",maxWidth:b==="network"?"0px":"100%",transition:X,position:"relative",display:"flex",flexDirection:"column",minHeight:0},children:[s("button",{onClick:()=>S("simulation"),style:A,title:b==="simulation"?"Original Size":"Maximize",children:b==="simulation"?s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s("path",{d:"M4 14h6v6"}),s("path",{d:"M20 10h-6V4"}),s("path",{d:"M14 10l7-7"}),s("path",{d:"M3 21l7-7"})]}):s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s("path",{d:"M15 3h6v6"}),s("path",{d:"M9 21H3v-6"}),s("path",{d:"M21 3l-7 7"}),s("path",{d:"M3 21l7-7"})]})}),s("div",{className:"simulation-section",style:{height:"100%",display:"flex",flexDirection:"column",minHeight:0},children:[s("div",{className:"tabs",style:{paddingRight:"120px"},children:[r&&s("button",{className:`tab-button ${h==="simulation"?"active":""}`,onClick:()=>y("simulation"),children:"Simulation"}),s("button",{className:`tab-button ${h==="data"?"active":""}`,onClick:()=>y("data"),children:"Data"}),s("button",{className:`tab-button ${h==="training"?"active":""}`,onClick:()=>y("training"),children:"Training"})]}),s("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[h==="simulation"&&s(mt,{children:[t(),s("div",{className:"stats",style:{marginTop:"auto",paddingTop:"10px"},children:[s("p",{children:f.description}),s("p",{style:{color:"#646cff",fontWeight:"bold"},children:["Status: ",V]})]})]}),h==="data"&&s("div",{className:"data-content",style:{flex:1,overflowY:"auto",minHeight:0},children:o?n?n():s("p",{children:"No data view available."}):s(mt,{children:[!["gallery"].includes(f.id)&&s("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:s(Rt,{viewMode:g,onChange:v})}),s("div",{style:{marginTop:"15px"},children:[g==="plot"&&s("div",{style:{marginBottom:"20px"},children:n?n():s("p",{children:"No graph available."})}),g==="table"&&s(Jt,{data:_,vizProps:l,simConfig:f})]})]})}),h==="training"&&s("div",{className:"training-content",style:{flex:1,minHeight:0,overflow:"auto"},children:a.length>0?s(Zn,{history:a,currentStepIndex:M,isTraining:p,paramsConfig:f.trainingConfig.params,showAccuracyPlot:f.trainingConfig?.showAccuracyPlot??!0}):s("p",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No training started yet."})})]})]})]}),s("div",{className:"network-wrapper",style:{flex:b==="network"?"1 0 100%":b==="simulation"?"0 0 0%":`0 0 ${f.id==="spam_hidden","500px"}`,opacity:b==="simulation"?0:1,overflow:"hidden",maxWidth:b==="simulation"?"0px":"100%",transition:X,position:"relative",display:"flex",flexDirection:"column",minHeight:0},children:[s("button",{onClick:()=>S("network"),style:A,title:b==="network"?"Original Size":"Maximize",children:b==="network"?s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s("path",{d:"M4 14h6v6"}),s("path",{d:"M20 10h-6V4"}),s("path",{d:"M14 10l7-7"}),s("path",{d:"M3 21l7-7"})]}):s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s("path",{d:"M15 3h6v6"}),s("path",{d:"M9 21H3v-6"}),s("path",{d:"M21 3l-7 7"}),s("path",{d:"M3 21l7-7"})]})}),s("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:s(yn,{input:m,weight:w.current?w.current.weights||w.current.weight:0,bias:w.current?w.current.bias:0,output:w.current?w.current.predict(m):0,model:w.current,formula:l.formula,inputLabel:l.inputLabels||l.inputLabel,outputLabel:l.outputLabel,biasLabel:l.biasLabel,decimals:f.id.includes("spam")?0:1,showActivation:l.showActivation})})]})]}),s("div",{ref:k,style:{flex:"0 0 auto"},children:s(fi,{onTrain:K,onRun:tt,isTraining:p,trainingStep:M,dataCount:_.length,trainerType:T,onTrainerTypeChange:d,simConfig:f,isRunning:Z,simulationEnabled:r})})]})}function pi({data:e,groundTruth:t,neuralNet:n}){const i=xt(null);return wt(()=>{const r=i.current;if(!r)return;const o=r.getContext("2d"),c=r.width,u=r.height;if(o.clearRect(0,0,c,u),!e||e.length===0){o.fillStyle="#999",o.textAlign="center",o.fillText("No data available",c/2,u/2);return}const f=40,h=c-2*f,y=u-2*f,a=Math.max(...e.map(v=>v.input))||10,M=Math.max(...e.map(v=>v.target))||100,p=v=>f+v/a*h,g=v=>u-f-v/M*y;if(o.beginPath(),o.strokeStyle="#333",o.moveTo(f,f),o.lineTo(f,u-f),o.lineTo(c-f,u-f),o.stroke(),o.fillStyle="#333",o.textAlign="center",o.fillText("Time (t)",c/2,u-10),o.save(),o.translate(15,u/2),o.rotate(-Math.PI/2),o.fillText("Position (s)",0,0),o.restore(),e.forEach(v=>{const _=p(v.input),C=g(v.target);o.beginPath(),o.arc(_,C,3,0,Math.PI*2),o.fillStyle="#2ecc71",o.fill()}),n){o.beginPath(),o.strokeStyle="#e74c3c",o.lineWidth=2;for(let v=0;v<=a;v+=.1){const _=n.predict(v),C=p(v),w=g(_);v===0?o.moveTo(C,w):o.lineTo(C,w)}o.stroke()}},[e,t,n]),s("div",{style:{border:"1px solid #ccc",margin:"10px 0",borderRadius:"4px"},children:s("canvas",{ref:i,width:600,height:300,style:{width:"100%",display:"block"}})})}function gi(){const e=me("linear_regression"),{simConfig:t,trainingData:n,groundTruth:i,trainingHistory:r,neuralNet:o,time:c,currentInput:u}=e;if(!t)return s("div",{className:"loading",children:"Loading Simulation..."});const f=t.CanvasComponent;return s(_e,{hookState:e,renderSimulationView:()=>{let a=0;try{if(o.current){const M=u!==void 0?u:c;a=o.current.predict(M)}}catch(M){console.error("Predict Error",M)}return s("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:s(f,{time:c,data:n,currentInput:u!==void 0?u:c,currentPrediction:a,groundTruth:i.current,neuralNet:o.current})})},renderDataView:()=>{const{dataViewMode:a,setDataViewMode:M}=e;return s("div",{style:{flex:1,display:"flex",flexDirection:"column",width:"100%"},children:a==="table"?s(mt,{children:[s("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:s(Rt,{viewMode:a,onChange:M})}),s(Jt,{data:n,vizProps:t.networkViz||{},simConfig:t})]}):s(mt,{children:[s("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:s(Rt,{viewMode:a,onChange:M})}),s(pi,{data:n,groundTruth:i.current,neuralNet:r.length>0?o.current:null})]})})},customDataHandling:!0})}function mi(){const e=me("logistic_regression"),{simConfig:t,trainingData:n,groundTruth:i,trainingHistory:r,neuralNet:o}=e;if(!t)return s("div",{className:"loading",children:"Loading Simulation..."});const c=t.CanvasComponent;return s(_e,{hookState:e,renderSimulationView:()=>s("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",border:"2px dashed #ddd",borderRadius:"8px",minHeight:"300px"},children:s("p",{style:{color:"#999"},children:'Data visualization is now in the "Data" tab'})}),renderDataView:()=>{const{dataViewMode:h,setDataViewMode:y}=e,a={staticMode:!0,showGroundTruth:!0,showModel:r.length>0};return t.featuresConfig&&(a.features=t.featuresConfig),s("div",{style:{padding:"10px 0",display:"flex",flexDirection:"column",width:"100%"},children:h==="table"?s(mt,{children:[s("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:s(Rt,{viewMode:h,onChange:y})}),s(Jt,{data:n,vizProps:t.networkViz||{},simConfig:t})]}):s(mt,{children:[s("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"15px"},children:s(Rt,{viewMode:h,onChange:y})}),s(c,{time:0,data:n,groundTruth:i.current,neuralNet:o.current,showProbabilities:!0,...a})]})})},simulationEnabled:!1,customDataHandling:!0})}function xe({simId:e}){const t=me(e),{simConfig:n,trainingData:i,groundTruth:r,trainingHistory:o,neuralNet:c,time:u,currentInput:f,dataViewMode:h,setDataViewMode:y}=t;if(!n)return s("div",{className:"loading",children:"Loading Simulation..."});const a=n.CanvasComponent,M=s(Rt,{viewMode:h,onChange:y});return s(_e,{hookState:t,renderSimulationView:()=>{let v=0;try{c.current&&f&&(v=c.current.predict(f))}catch(C){console.error("Predict Error",C)}const _={allowedModes:["text"],hideControls:!0,features:n.featuresConfig};return s("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px"},children:s(a,{time:u,data:i,currentInput:f,currentPrediction:v,groundTruth:r.current,neuralNet:c.current,..._})})},renderDataView:()=>{const v={allowedModes:["scatter","3d","features"],showModel:o.length>0,additionalControls:M,features:n.featuresConfig};return s("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:"300px",width:"100%"},children:h==="table"?s(mt,{children:[s("div",{style:{marginBottom:"15px"},children:s(Rt,{viewMode:h,onChange:y})}),s(Jt,{data:i,vizProps:n.networkViz||{},simConfig:n})]}):s(a,{time:0,data:i,groundTruth:r.current,neuralNet:c.current,...v})})},simulationEnabled:!1,customDataHandling:!0})}function _i(){return s(xe,{simId:"multiple_inputs"})}function xi(){return s(xe,{simId:"single_layer_nonlinear"})}function yi(){return s(xe,{simId:"double_layer_nonlinear"})}function bi(){const[e,t]=at(0),n=[{name:"Simple Perceptron",input:.5,weight:.8,bias:.2,output:.6,inputLabel:"Input",formula:"y = w * x + b"},{name:"Spam Filter (2 Inputs)",input:[1,0],weight:[.5,-.2],bias:.1,output:.8,inputLabel:["Spam Word","Suspicious Link"],formula:"y = w1*x1 + w2*x2 + b"},{name:"Complex Model (5 Inputs)",input:[1,.5,-1,0,.2],weight:[.1,.2,.3,.4,.5],bias:-.5,output:.1,inputLabel:["F1","F2","F3","F4","F5"],formula:"y = Σ(wi*xi) + b"},{name:"Many Inputs (8 Inputs)",input:[1,0,1,0,1,0,1,0],weight:[.1,-.1,.1,-.1,.1,-.1,.1,-.1],bias:0,output:.5,inputLabel:["I1","I2","I3","I4","I5","I6","I7","I8"],formula:"y = ... "}],i=n[e];return s("div",{style:{padding:"20px"},children:[s("h2",{children:"Architecture Gallery"}),s("div",{style:{marginBottom:"20px"},children:[s("button",{onClick:()=>t((e-1+n.length)%n.length),children:"Previous"}),s("span",{style:{margin:"0 10px"},children:[i.name," (",e+1,"/",n.length,")"]}),s("button",{onClick:()=>t((e+1)%n.length),children:"Next"})]}),s("div",{style:{width:"400px",border:"1px dashed #ccc",padding:"10px"},children:s(yn,{input:i.input,weight:i.weight,bias:i.bias,output:i.output,formula:i.formula,inputLabel:i.inputLabel})})]})}function vi(){const[e,t]=at(null);return wt(()=>{const r=new URLSearchParams(window.location.search).get("sim")||"linear_regression";t(r)},[]),e?e==="gallery"?s("div",{className:"container",children:[s("header",{children:[s("h1",{children:"Neural Network Demonstrator"}),s("p",{children:"Architecture Gallery (Debug)"}),s("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:s("a",{href:"?sim=linear_regression",style:{marginRight:"10px"},children:"Back to App"})})]}),s("main",{children:s(bi,{})})]}):s("div",{className:"container",children:[s("header",{children:[s("h1",{children:"Neural Network Demonstrator"}),s("p",{children:(i=>{switch(i){case"linear_regression":return"Phase 1: Linear Regression";case"logistic_regression":return"Phase 2: Logistic Regression";case"multiple_inputs":return"Phase 3: Multiple Inputs";case"single_layer_nonlinear":return"Phase 4: Single Layer Nonlinear Data";case"double_layer_nonlinear":return"Phase 5: Double Layer Nonlinear Data";default:return"Neural Network Demonstrator"}})(e)}),s("div",{className:"sim-selector",style:{fontSize:"0.8rem",marginTop:"5px"},children:[s("a",{href:"?sim=linear_regression",style:{marginRight:"10px",fontWeight:e==="linear_regression"?"bold":"normal"},children:"Phase 1 (Linear)"}),s("a",{href:"?sim=logistic_regression",style:{marginRight:"10px",fontWeight:e==="logistic_regression"?"bold":"normal"},children:"Phase 2 (Logistic)"}),s("a",{href:"?sim=multiple_inputs",style:{marginRight:"10px",fontWeight:e==="multiple_inputs"?"bold":"normal"},children:"Phase 3 (Multi)"}),s("a",{href:"?sim=single_layer_nonlinear",style:{marginRight:"10px",fontWeight:e==="single_layer_nonlinear"?"bold":"normal"},children:"Phase 4 (Nonlinear 1)"}),s("a",{href:"?sim=double_layer_nonlinear",style:{fontWeight:e==="double_layer_nonlinear"?"bold":"normal"},children:"Phase 5 (Nonlinear 2)"})]})]}),s("main",{style:{height:"100%"},children:[e==="linear_regression"&&s(gi,{}),e==="logistic_regression"&&s(mi,{}),e==="multiple_inputs"&&s(_i,{}),e==="single_layer_nonlinear"&&s(xi,{}),e==="double_layer_nonlinear"&&s(yi,{})]})]}):s("div",{children:"Loading App..."})}In(s(vi,{}),document.getElementById("app"));
